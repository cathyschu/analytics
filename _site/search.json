[
  {
    "objectID": "geospatial/predict_hdb_resale/malls_sg.html",
    "href": "geospatial/predict_hdb_resale/malls_sg.html",
    "title": "shopping_malls_sg",
    "section": "",
    "text": "pacman::p_load(rvest, tidyverse)\n\n\nurl &lt;- \"https://en.wikipedia.org/wiki/List_of_shopping_malls_in_Singapore\"\npage &lt;- read_html(url)\n\nmall_names &lt;- page %&gt;%\n  html_nodes(\"div.mw-parser-output ul li\") %&gt;%\n  html_text() %&gt;%\n  trimws()\n\nmall_names &lt;- mall_names[nchar(mall_names) &gt; 0]\n\nmall_df &lt;- data.frame(Mall_Name = mall_names) %&gt;%\n  arrange(Mall_Name) %&gt;%\n  filter(!Mall_Name %in% c(\"v\", \"t\", \"e\")) %&gt;%\n  unique()\n\nmall_df\n\n                          Mall_Name\n1                           AMK Hub\n3           Alexandra Retail Centre\n5                    Amber Mansions\n6                        Bedok Mall\n8                       Bedok Point\n9                    Bugis Junction\n11                           Bugis+\n13              Bukit Panjang Plaza\n14                   Canberra Plaza\n16                   Capitol Centre\n17                   Capitol Piazza\n18                Capitol Singapore\n19       Cathay Cineleisure Orchard\n21                   Causeway Point\n23                   Century Square\n25                     Change Alley\n26                Changi City Point\n28                  Chinatown Point\n30                 City Square Mall\n32                    CityLink Mall\n34                    Clementi Mall\n35                      Compass One\n37                     Dawson Place\n38                     Djitsun Mall\n39                    Downtown East\n40                              Duo\n41                   Eastpoint Mall\n43              Ellenborough Market\n44                   Esplanade Mall\n45                   Far East Plaza\n47          Forum The Shopping Mall\n48               Fu Lu Shou Complex\n49                            Funan\n51            Funan DigitaLife Mall\n52                        GV Yishun\n53          Gek Poh Shopping Centre\n54                      Great World\n55                 Great World City\n56                          HDB Hub\n58              HarbourFront Centre\n60                   Heartland Mall\n62                     Hillion Mall\n64     Holland Road Shopping Centre\n65    Holland Village Shopping Mall\n66                        Hougang 1\n67                     Hougang Mall\n69                              IMM\n71                      ION Orchard\n73                            JCube\n74                              Jem\n76             Jewel Changi Airport\n78                      Junction 10\n80                       Junction 8\n82      Jurong Entertainment Centre\n83                     Jurong Point\n85                Kallang Wave Mall\n87           Katong Shopping Centre\n89                         Le Quest\n90             Leisure Park Kallang\n92                      Liang Court\n93                      Liat Towers\n94                            Lot 1\n95                          Lot One\n96                      Lucky Plaza\n98                 Mandarin Gallery\n99             Marina Bay Link Mall\n101                Marina Bay Sands\n102                   Marina Square\n104                   Millenia Walk\n106                  Mustafa Centre\n108                             NEX\n109                             Nex\n110                   Ngee Ann City\n112                 Northpoint City\n114                   Novena Square\n115     Novena Square Shopping Mall\n116                  Oasis Terraces\n118                 Orchard Central\n120                 Orchard Gateway\n122                  Orchard Towers\n123                Our Tampines Hub\n125              Palais Renaissance\n127                      Parc Point\n128                  Parkway Parade\n130              Paya Lebar Quarter\n131               Paya Lebar Square\n132                 Peninsula Plaza\n133            People's Park Centre\n135           People's Park Complex\n137                    Pioneer Mall\n139                Plantation Plaza\n140                 Plaza Singapura\n142              Punggol Coast Mall\n143                   Punggol Plaza\n145       Queensway Shopping Centre\n147                    Raffles City\n149                  Rochester Mall\n150          Scotts Shopping Centre\n151                    Seletar Mall\n152       Sembawang Shopping Centre\n154           Shaw House and Centre\n156                      Shaw Tower\n157                  Sim Lim Square\n159                 Singpost Center\n160                     South Beach\n161    Specialists' Shopping Centre\n162                        Square 2\n164                       Sun Plaza\n166                     Suntec City\n167                Suntec City Mall\n168                      Tampines 1\n170                   Tampines Mall\n172                      Tang Plaza\n173         Tanglin Shopping Centre\n174            Tanjong Pagar Centre\n175                    Tekka Centre\n177                      The Cathay\n178                 The Centrepoint\n180               The Clementi Mall\n181                 The Golden Mile\n182                    The Majestic\n183                     The Paragon\n185                   The Rail Mall\n187                The Seletar Mall\n188 The Shoppes at Marina Bay Sands\n189                 The South Beach\n190                  The Star Vista\n192                       The Verge\n193                   Thomson Plaza\n195               Tiong Bahru Plaza\n197                   United Square\n198                        VivoCity\n200                  Waterway Point\n202                West Coast Plaza\n204                       West Mall\n206                        Westgate\n208                  Wheelock Place\n210                     White Sands\n212                     Wisma Atria\n214                   Yew Tee Point\n215                      i12 Katong\n\nwrite_csv(mall_df, \"data/rawdata/singapore_malls.csv\")"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Cathy C.",
    "section": "",
    "text": "Welcome to catlytics webpage! My name is Cathy."
  },
  {
    "objectID": "about.html#education",
    "href": "about.html#education",
    "title": "Cathy C.",
    "section": "Education",
    "text": "Education\nSingapore Management University | Masters of IT in Business"
  },
  {
    "objectID": "about.html#experience",
    "href": "about.html#experience",
    "title": "Cathy C.",
    "section": "Experience",
    "text": "Experience\nMultiple MNCs | Program Manager, Training Instructor | Singapore"
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#overview",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#overview",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "1 Overview",
    "text": "1 Overview\n\n1.1 Background\nSingapore housing price is a popular subject among locals and foreigners who are interested to purchase or invest in houses. While investors are typically interested in Condo or private housing due to policies and availabilty, Government housing like HDB is generally more affordable and a critical supply to Singaporeans from all walks of life. The resale market is especially important as Singaporeans looking to upgrade or PRs looking to purchase own housing.\nThis study is modified from a Geospatial course assignment by Prof. Kam Tin Seong.\n\n\n1.2 Objective\nThe objective of this study is to develop a spatially informed model to predict HDB resale prices in Singapore, making use of appropriate geospatial analytics methods. We will calibrate predictive models to predict HDB resale prices for the period July to September 2025, using HDB resale transaction data from July 2024 to June 2025.\n\n\n1.3 The Task\nIn this study, we will first determine potential factors that influence the HDB resale price, import the data of these factors, and process them for predictive modeling. The modeling we will investigate in this task include Multi-linear Regression (MLR), Geographically Weighted Regression (GWR), non-spatial Random Forest, as well as Geographical Weighted Random Forest Model (gwRF). Among these models, we will examine and compare them to derive the best performing model."
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#installing-and-loading-r-packages",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#installing-and-loading-r-packages",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "2 Installing and Loading R packages",
    "text": "2 Installing and Loading R packages\nBelow we will load the R packages. The table shows the packages used for this study and their descriptions, including links to more details to the package.\n\nLoad PackagesPackage Intro\n\n\n\npacman::p_load(httr, tidyverse, sf, tmap, jsonlite, progress,\n               spdep, GWmodel, SpatialML, rsample, Metrics, knitr,\n               kableExtra, spatialRF, randomForestExplainer, rvest,\n               stringr, lubridate, corrplot, performance, see,\n               gtsummary, ModelMetrics, DT, plotly)\n\n\n\n\nR Packages\n\n\nR Package\nDescription\n\n\n\n\nhttr\nUseful tools for working with HTTP organised by HTTP verbs (GET(), POST(), etc).\n\n\ntidyverse\nan opinionated collection of R packages designed for data science.\\, such as ggplot2, readr, stringr, lubridate, purrr, etc.\n\n\nsf\nSupport for simple feature access, a standardized way to encode and analyze spatial vector data.\n\n\ntmap\nan R package for drawing thematic maps. The API is based on A Layered Grammar of Graphics and resembles the syntax of ggplot2, a popular R-library for drawing charts.\n\n\njsonlite\nA reasonably fast JSON parser and generator, optimized for statistical data and the web.\n\n\nprogress\nProvides a unifying API for reporting progress updates in R, including within parallel processing contexts. It was developed by Henrik Bengtsson, known for the future framework.\n\n\nspdep\nA collection of functions to create spatial weights matrix objects from polygon ‘contiguities’, from point patterns by distance and tessellations, for summarizing these objects, and for permitting their use in spatial data analysis, including regional aggregation by minimum spanning tree.\n\n\nGWmodel\nTechniques from a particular branch of spatial statistics,termed geographicallyweighted (GW) models.\n\n\nSpatialML\nImplements a spatial extension of the random forest algorithm (Georganos et al. (2019). Allows for a geographically weighted random forest regression including a function to find the optical bandwidth. (Georganos and Kalogirou (2022)\n\n\nrsample\nprovides functions to create different types of resamples and corresponding classes for their analysis.\n\n\nMetrics\nAn implementation of evaluation metrics in R that are commonly used in supervised machine learning. It implements metrics for regression, time series, binary classification, classification, and information retrieval problems.\n\n\nknitr\nProvides a general-purpose tool for dynamic report generation in R using Literate Programming techniques.\n\n\ncorrplot\nprovides a visual exploratory tool on correlation matrix that supports automatic variable reordering to help detect hidden patterns among variables.\n\n\nperformance\nprovides utilities for computing indices of model quality and goodness of fit. These include measures like r-squared (R2), root mean squared error (RMSE) or intraclass correlation coefficient (ICC).\n\n\nsee\nAs a core pillar of easystats, the see package helps users to utilize visualization for more informative, communicable, and well-rounded scientific reporting.\n\n\ngtsummary\nprovides an elegant and flexible way to create publication-ready analytical and summary tables using the R programming language.\n\n\nModelMetrics\nModelMetrics is a much faster and reliable package for evaluating models. ModelMetrics is written in using Rcpp making it faster than the other packages used for model metrics.\n\n\nDT\nprovides an R interface to the JavaScript library DataTables. R data objects (matrices or data frames) can be displayed as tables on HTML pages, and DataTables provides filtering, pagination, sorting, and many other features in the tables."
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#the-data",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#the-data",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "3 The Data",
    "text": "3 The Data\nWe will make use of the following data sets to prepare the predictors as well as dependent variable (i.e. HDB resale price) in the master dataset for predictive modeling.\n\nData setsSources\n\n\n\n\n\n\n\n\n\nData set\nDescription\n\n\n\n\nHDB\n\n\n\nHDB resale price\nResale flat prices based on registration date from Jan-2017 onwards\n\n\nEducation\n\n\n\nChildcare centers\nOrganisations offering play-based learning learning for younger kids.\n\n\nKindergarten\nSingapore kindergartens, among which many are government-run to prepare older children for primary school.\n\n\nPrimary schools\nSingapore primary schools\n\n\nTop primary schools\nTop Singapore primary schools based on PSLE exam (secondary school entrance exam) results\n\n\nBusiness\n\n\n\nCBD\nThe Central Business District areas, including RAFFLES PLACE, MARINA CENTRE, TANJONG PAGAR, CITY HALL, ENTRAL SUBZONE areas.\n\n\nBusiness park\nAreas where offices are concentrated across the island.\n\n\nRecreation\n\n\n\nShopping malls\nShopping mall buildings of all sizes.\n\n\nSports halls\nSports halls that provide sports facilities for the public use, including some school sports halls.\n\n\nParks\nIndicative polygon of Parks and Open Space in the Parks and Waterbodies Plan.\n\n\nCommunity Clubs\nCommon spaces for people of all races to come together, build friendships and promote social bonding.\n\n\nF&B\n\n\n\nSupermarkets\nRetail markets where people shop groceries.\n\n\nFoodcourt/Hawker centers\nFootcourts and Hawker centers where people grab meals conveniently.\n\n\nTransportation\n\n\n\nBus\nBus stops\n\n\nMRT\nMRT & LRT stations\n\n\nHealthcare\n\n\n\nClinics\nClinics / GP\n\n\nEldercare services\nNursing homes, senior service centers\n\n\n\n\n\n\n\n\nData set\nSource\n\n\n\n\nHDB\n\n\n\nHDB resale price\nResale flat prices\n\n\nEducation\n\n\n\nChildcare centers\nPre-Schools Location\n\n\nKindergarten\nKindergartens\n\n\nPrimary schools\nSchool Directory and Information\n\n\nTop primary schools\nPrimary school with data from sophia education\n\n\nBusiness\n\n\n\nCBD\nShape file derived from Master Plan 2019 Planning Area Boundary\n\n\nBusiness park\nJTC Business Park Land\n\n\nRecreation\n\n\n\nShopping malls\n\nShopping mall coordinates from Kaggle.\nWiki page\n\n\n\nSports halls\nSportsFields@SG\n\n\nParks\nPark Facilities\n\n\nCommunity Clubs\nCommunity clubs geojson\n\n\nF&B\n\n\n\nSupermarkets\nSupermarkets (GEOJSON)2024\n\n\nFoodcourt/Hawker centers\nHawker Centres (GEOJSON) 2025\n\n\nTransportation\n\n\n\nBus\nBus stops location\n\n\nMRT\nMRT & LRT station exits\n\n\nHealthcare\n\n\n\nClinics\nCHAS Clinics\n\n\nEldercare services\nEldercare Services\n\n\n\n\n\n\n\n2.1 Import Data\n\n2.1.0 Singapore Maps\nBelow we will import Master Plan 2019 Subzone Boundary (No Sea). from data.gov.sg.\n\nCodeOutput\n\n\n\nmpsz &lt;- st_read(\"data/rawdata/MasterPlan2019SubzoneBoundaryNoSeaKML.kml\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n\n# extract values from the HTML description\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\n# extract info\nmpsz &lt;- mpsz %&gt;%\n  mutate(\n    REGION_N = map_chr(Description, extract_kml_field, \"REGION_N\"),\n    PLN_AREA_N = map_chr(Description, extract_kml_field, \"PLN_AREA_N\"),\n    SUBZONE_N = map_chr(Description, extract_kml_field, \"SUBZONE_N\"),\n    SUBZONE_C = map_chr(Description, extract_kml_field, \"SUBZONE_C\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\nwrite_rds(mpsz, \"data/rds/mpsz.rds\")\n\n\n\n\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\n\n\n\n\n2.1.1 HDB resale data Preparation\n\nLoad dataStreet namesGeocoding Resale Datasf objects transformation\n\n\n\nLoad HDB Resale Data\n\nThis data set comprises of HDB resale transactions from July 2017 onwards. Below we will extract a sub-set of transaction records on 4-Room flat transacted during July 2024 to June 2025.\n\n\nCode\nHDBresale &lt;- read_csv(\n  \"data/rawdata/ResaleflatpricesJan2017.csv\") %&gt;%\n  filter(flat_type == \"4 ROOM\") %&gt;%\n  filter(month &gt;= \"2024-07\" & month &lt;= \"2025-09\") # filter the sample data for the exercise till 09/2025.\n\nwrite_rds(HDBresale, \"data/rds/HDBresale.rds\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmonth\ntown\nflat_type\nblock\nstreet_name\nstorey_range\nfloor_area_sqm\nflat_model\nlease_commence_date\nremaining_lease\nresale_price\n\n\n\n\n2024-07\nANG MO KIO\n4 ROOM\n335\nANG MO KIO AVE 1\n01 TO 03\n91\nNew Generation\n1982\n56 years 08 months\n528888\n\n\n2024-07\nANG MO KIO\n4 ROOM\n333\nANG MO KIO AVE 1\n01 TO 03\n93\nNew Generation\n1981\n55 years 08 months\n500000\n\n\n2024-07\nANG MO KIO\n4 ROOM\n226\nANG MO KIO AVE 1\n07 TO 09\n91\nNew Generation\n1978\n52 years 07 months\n540000\n\n\n2024-07\nANG MO KIO\n4 ROOM\n336\nANG MO KIO AVE 1\n01 TO 03\n91\nNew Generation\n1982\n56 years 08 months\n500000\n\n\n2024-07\nANG MO KIO\n4 ROOM\n303\nANG MO KIO AVE 1\n10 TO 12\n97\nNew Generation\n1977\n51 years 09 months\n620000\n\n\n\n\n\n\n\n\nFurther processing for street names\n\nWe do further processing for the data as the street names with Saint are usually written as St.\n\n\nCode\n# street names is ST, but it's actually Sait.\nHDBresale$street_name &lt;- gsub(\n  \"ST\\\\.\", \"SAINT\",\n  HDBresale$street_name\n)\n\n\n\n\nRows: 14,737\nColumns: 11\n$ month               &lt;chr&gt; \"2024-07\", \"2024-07\", \"2024-07\", \"2024-07\", \"2024-…\n$ town                &lt;chr&gt; \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO …\n$ flat_type           &lt;chr&gt; \"4 ROOM\", \"4 ROOM\", \"4 ROOM\", \"4 ROOM\", \"4 ROOM\", …\n$ block               &lt;chr&gt; \"335\", \"333\", \"226\", \"336\", \"303\", \"226\", \"337\", \"…\n$ street_name         &lt;chr&gt; \"ANG MO KIO AVE 1\", \"ANG MO KIO AVE 1\", \"ANG MO KI…\n$ storey_range        &lt;chr&gt; \"01 TO 03\", \"01 TO 03\", \"07 TO 09\", \"01 TO 03\", \"1…\n$ floor_area_sqm      &lt;dbl&gt; 91, 93, 91, 91, 97, 92, 91, 97, 94, 88, 102, 91, 8…\n$ flat_model          &lt;chr&gt; \"New Generation\", \"New Generation\", \"New Generatio…\n$ lease_commence_date &lt;dbl&gt; 1982, 1981, 1978, 1982, 1977, 1978, 1982, 1977, 20…\n$ remaining_lease     &lt;chr&gt; \"56 years 08 months\", \"55 years 08 months\", \"52 ye…\n$ resale_price        &lt;dbl&gt; 528888, 500000, 540000, 500000, 620000, 570000, 50…\n\n\n\n\nWe use OneMap Geocode API: - https://www.onemap.gov.sg/apidocs/. - https://www.onemap.gov.sg/apidocs/reverseGeocode\nBelow we will prepare a geocoding function. It aims to perform the following tasks:\n\nCombining the block and street name into an address. The addresses will be used to geocode instead of postal code\nPassing the address as the searchVal in our query\nSending the query to OneMapSG search. Note: Since we don’t need all the address details, we can set getAddrDetails as ‘N’\nConverting response (JSON object) to text\nSaving response in text form as a dataframe\nRetain the latitude and longitude for our output.\n\n\n\nCode\n# for multiple queries\ngeocode &lt;- function(block, streetname) {\n  base_url &lt;- \"https://onemap.gov.sg/api/common/elastic/search\"\n  address &lt;- paste(block, streetname, sep = \" \")\n  query &lt;- list(\"searchVal\" = address,\n                \"returnGeom\" = \"Y\",\n                \"getAddrDetails\" = \"N\", #No. can change to Y for comparison\n                \"pageNum\" = \"1\") \n  res &lt;- GET(base_url, query = query) #get URL query\n  restext &lt;- content(res, as = \"text\")\n  \n  output &lt;- fromJSON(restext) %&gt;%\n    as.data.frame %&gt;%\n    select(results.LATITUDE, results.LONGITUDE)\n  \n  return(output)\n}\n\n\n\nRun functions\n\n\n\nCode\nHDBresale$LATITUDE &lt;- 0\nHDBresale$LONGITUDE &lt;- 0\n\nfor(i in 1:nrow(HDBresale)){\n  temp_output &lt;- geocode(HDBresale[i, 4], HDBresale[i, 5])\n  \n  HDBresale$LATITUDE[i] &lt;- temp_output$results.LATITUDE\n  HDBresale$LONGITUDE[i] &lt;- temp_output$results.LONGITUDE\n}\n\n\n\n\n\nTransform to sf data frame\n\nWe want to ensure that: - both input data sets must be in sf objects - they must be in similar projected coordinates systems\n\n\nCode\nst_crs(HDBresale)\nHDBresale_sf &lt;- HDBresale %&gt;%\n  st_as_sf(\n    coords = c(\"LONGITUDE\", \"LATITUDE\"),\n    crs = 4326) %&gt;% #if decimal degree\n  st_transform(crs = 3414)\n\nwrite_rds(HDBresale_sf, \"data/rds/HDBresale_sf.rds\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmonth\ntown\nflat_type\nblock\nstreet_name\nstorey_range\nfloor_area_sqm\nflat_model\nlease_commence_date\nremaining_lease\nresale_price\ngeometry\n\n\n\n\n2024-07\nANG MO KIO\n4 ROOM\n335\nANG MO KIO AVE 1\n01 TO 03\n91\nNew Generation\n1982\n56 years 08 months\n528888\nPOINT (29933.3 38362.35)\n\n\n2024-07\nANG MO KIO\n4 ROOM\n333\nANG MO KIO AVE 1\n01 TO 03\n93\nNew Generation\n1981\n55 years 08 months\n500000\nPOINT (30045.48 38155.87)\n\n\n2024-07\nANG MO KIO\n4 ROOM\n226\nANG MO KIO AVE 1\n07 TO 09\n91\nNew Generation\n1978\n52 years 07 months\n540000\nPOINT (28566.05 38861.93)\n\n\n2024-07\nANG MO KIO\n4 ROOM\n336\nANG MO KIO AVE 1\n01 TO 03\n91\nNew Generation\n1982\n56 years 08 months\n500000\nPOINT (30055.03 38404.8)\n\n\n2024-07\nANG MO KIO\n4 ROOM\n303\nANG MO KIO AVE 1\n10 TO 12\n97\nNew Generation\n1977\n51 years 09 months\n620000\nPOINT (29328.33 38742.64)\n\n\n\n\n\n\n\n\n\n\n2.1.2 Load location factors data\nWe determined the predict factors in 2 categories. One is structural factors, and the other is location factors.\n\nStructural factorsLocation factors\n\n\n\nArea of the unit\nFloor level\nPlanning area (town)\nRemaining lease\nAge of the unit\n\n\n\n\nProxomity to CBD\nProxomity to business park\nProximity to eldercare\nProximity to foodcourt/hawker centres\nProximity to MRT\nProximity to park\nProximity to top primary school\nProximity to shopping mall\nProximity to supermarket\nProximity to healthcare facilities\nProximity to sports halls\nProximity to community clubs\nNumbers of kindergartens within 350m\nNumbers of childcare centres within 350m\nNumbers of bus stop within 350m\nNumbers of primary school within 1km\n\n\n\n\nBelow we will start processing the data for these predictive factors.\n\nEducationBusinessRecreationF&BTransportationHealthcare\n\n\nCHILDCARE CENTERS\nFor childcare centers, we derive a geometry point to compute numbers of childcare centers within 350m to the HDB units.\n\n\nCode\npreschool_data &lt;- st_read(\"data/rawdata/PreschoolsLocation.kml\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\n# extract info\npreschool_data &lt;- preschool_data %&gt;%\n  mutate(\n    name = map_chr(Description, extract_kml_field, \"CENTRE_NAME\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\nwrite_rds(preschool_data, \"data/rds/preschool_data.rds\")\n\n\n\n\n     name                    geometry   \n Length:2290        POINT        :2290  \n Class :character   epsg:3414    :   0  \n Mode  :character   +proj=tmer...:   0  \n\n\nQuick view of the data set\n\nkable(head(preschool_data, 3))\n\n\n\n\nname\ngeometry\n\n\n\n\nCHILDREN’S COVE PRESCHOOL PTE.LTD.\nPOINT (25089.46 31299.16)\n\n\nCHILDREN’S COVE PTE. LTD.\nPOINT (27189.07 32792.54)\n\n\nCHILDREN’S VINEYARD PRESCHOOL PTE. LTD\nPOINT (28844.56 36773.76)\n\n\n\n\n\nKINDERGARTENS\nFor kindergartens, we derive a geometry point to compute numbers of childcare centers within 350m to the HDB units.\n\n\nCode\nkindergarten_data &lt;- st_read(\"data/rawdata/Kindergartens.geojson\") %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(OBJECTID, NAME, geometry, DESCRIPTION)\n\nwrite_rds(kindergarten_data, \"data/rds/kindergarten_data.rds\")\n\n\n\n\n    OBJECTID        NAME           DESCRIPTION                 geometry  \n Min.   :7681   Length:448         Length:448         POINT        :448  \n 1st Qu.:7793   Class :character   Class :character   epsg:3414    :  0  \n Median :7904   Mode  :character   Mode  :character   +proj=tmer...:  0  \n Mean   :7904                                                            \n 3rd Qu.:8016                                                            \n Max.   :8128                                                            \n\n\nQuick view of the data set\n\nkable(head(kindergarten_data, 3))\n\n\n\n\n\n\n\n\n\n\nOBJECTID\nNAME\nDESCRIPTION\ngeometry\n\n\n\n\n7928\nPCF Sparkletots Preschool @ Cheng San-Seletar Blk 435 (KN)\nKindergartens\nPOINT (30325.45 38859.25)\n\n\n7929\nPCF Sparkletots Preschool @ Cheng San-Seletar Blk 533 (KN)\nKindergartens\nPOINT (30190.51 39574.18)\n\n\n7930\nPCF Sparkletots Preschool @ Cheng San-Seletar Blk 556 (DS)\nKindergartens\nPOINT (30705.05 39337.9)\n\n\n\n\n\nPRIMARY SCHOOLS\nFor primary schools, we derive a geometry point to compute numbers of childcare centers within 350m to the HDB units.\n\n\nCode\nprimschool_data &lt;- read_csv(\"data/rawdata/General Information of schools.csv\") %&gt;%\n  select(school_name, postal_code, address)\n\n\nBelow we need to geocode the primary school location because currently we have their postal codes.\n\n\nCode\ngeocode_postal &lt;- function(postal_code) {\n  url &lt;- paste0(\"https://www.onemap.gov.sg/api/common/elastic/search?\",\n                \"searchVal=\", postal_code,\n                \"&returnGeom=Y&getAddrDetails=Y\")\n  \n  response &lt;- GET(url)\n  \n  if (status_code(response) == 200) {\n    result &lt;- content(response, \"text\") %&gt;% fromJSON()\n    \n    if (result$found &gt; 0) {\n      return(data.frame(\n        latitude = as.numeric(result$results$LATITUDE[1]),\n        longitude = as.numeric(result$results$LONGITUDE[1])\n      ))\n    }\n  }\n  \n  return(data.frame(latitude = NA, longitude = NA))\n}\n\n# Geocode all primary schools\nprimschool_coords &lt;- lapply(primschool_data$postal_code, function(pc) {\n  Sys.sleep(0.2)  \n  geocode_postal(pc)\n})\n\nprimschool_coords_df &lt;- bind_rows(primschool_coords)\n\nprimschool_data &lt;- primschool_data %&gt;%\n  bind_cols(primschool_coords_df)\n\n# Convert to sf object\nprimschool_data &lt;- primschool_data %&gt;%\n  filter(!is.na(latitude)) %&gt;%  # Remove any that failed\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326) %&gt;%\n  st_transform(3414)  # Transform to SVY21\n\nnrow(primschool_data)  # How many successfully geocoded\n\n\nWe examine the school list and check what schools we will filter out using keywords, and derive the geometry point for all primary schools in the list.\n\n\nCode\nprimschool_data %&gt;%\n  filter(\n    grepl(\"SECONDARY|HIGH|INSTITUTE|INSTITUTION|SCHOOL OF|JUNIOR|COLLEGE\", \n               school_name, \n               ignore.case = TRUE)) %&gt;%\n\n# Remove non-primary schools \n  filter(school_name %in% \n           c(\"MARIS STELLA HIGH SCHOOL\", \"CATHOLIC HIGH SCHOOL\") |\n           !grepl(\"SECONDARY|HIGH|INSTITUTE|INSTITUTION|\n                  SCHOOL OF|JUNIOR|COLLEGE\", \n                  school_name, ignore.case = TRUE)) %&gt;%\n  filter(!school_name %in% \n           c(\"CHIJ KATONG CONVENT\", \"CHIJ ST. JOSEPH'S CONVENT\"))\n\nwrite_rds(primschool_data, \"data/rds/primschool_data.rds\") \n\n\n\n\n school_name         postal_code       address                   geometry  \n Length:188         Min.   :109100   Length:188         POINT        :188  \n Class :character   1st Qu.:457774   Class :character   epsg:3414    :  0  \n Mode  :character   Median :556425   Mode  :character   +proj=tmer...:  0  \n                    Mean   :553435                                         \n                    3rd Qu.:689213                                         \n                    Max.   :828869                                         \n\n\nQuick view of the data set\n\nkable(head(primschool_data, 3))\n\n\n\n\n\n\n\n\n\n\nschool_name\npostal_code\naddress\ngeometry\n\n\n\n\nADMIRALTY PRIMARY SCHOOL\n738907\n11 WOODLANDS CIRCLE\nPOINT (24296.63 47144.77)\n\n\nAHMAD IBRAHIM PRIMARY SCHOOL\n768643\n10 YISHUN STREET 11\nPOINT (27958.14 46096.26)\n\n\nAI TONG SCHOOL\n579646\n100 Bright Hill Drive\nPOINT (27966.81 38071.92)\n\n\n\n\n\nTOP PRIMARY SCHOOLS\nWe identify top 20 primary school from sophia education eestimated by exam scrores and academic excellence.\n\n\nCode\ntop_primschool_data &lt;- primschool_data %&gt;%\n  filter(school_name %in% c(\"RAFFLES GIRLS' PRIMARY SCHOOL\", \"NANYANG PRIMARY SCHOOL\",\n                          \"HENRY PARK PRIMARY SCHOOL\", \"ROSYTH SCHOOL\",\n                          \"AI TONG SCHOOL\", \"NAN HUA PRIMARY SCHOOL\", \"ST. HILDA'S PRIMARY SCHOOL\",\n                          \"TAO NAN SCHOOL\", \"CHIJ ST. NICHOLAS GIRLS' SCHOOL\",\n                          \"CATHOLIC HIGH SCHOOL\", \"PEI HWA PRESBYTERIAN PRIMARY SCHOOL\",\n                          \"METHODIST GIRLS' SCHOOL (PRIMARY)\", \"KONG HWA SCHOOL\",\n                          \"RED SWASTIKA SCHOOL\", \"SINGAPORE CHINESE GIRLS' SCHOOL\", \"MARIS STELLA HIGH SCHOOL\",\n                          \"ANGLO-CHINESE SCHOOL (PRIMARY)\", \"TEMASEK PRIMARY SCHOOL\",\"RIVER VALLEY PRIMARY SCHOOL\",\n                          \"CEDAR PRIMARY SCHOOL\"))\n\nwrite_rds(top_primschool_data, \"data/rds/top_primschool_data.rds\")\n\n\n\n\n school_name         postal_code       address                   geometry \n Length:20          Min.   :128806   Length:20          POINT        :20  \n Class :character   1st Qu.:304346   Class :character   epsg:3414    : 0  \n Mode  :character   Median :424766   Mode  :character   +proj=tmer...: 0  \n                    Mean   :417020                                        \n                    3rd Qu.:559242                                        \n                    Max.   :599986                                        \n\n\n\n\nProximity to offices is a factor when people consider buying a house. We assume that a shorter the distance to the offices drives higher purchasing value. In this study, we consider proximity to the CBD area and other business parks across the island.\nCBD\nFor CBD, we will extract the area for CBD from mpsz.\n\n\nCode\ncbd_data &lt;- mpsz %&gt;%\n  filter(SUBZONE_N %in% c(\"RAFFLES PLACE\", \"MARINA CENTRE\", \"TANJONG PAGAR\", \"CITY HALL\", \"CENTRAL SUBZONE\")) %&gt;%\n  st_union()\n\nwrite_rds(cbd_data, \"data/rds/cbd_data.rds\")\n\n\n\n\n      POLYGON     epsg:3414 +proj=tmer... \n            1             0             0 \n\n\ncbd_data is now a single merged polygon representing the entire CBD area. We will use this to calculate distance in later section.\nQuick view of the data set\n\nkable(head(cbd_data, 3))\n\n\n\n\ngeometry\n\n\n\n\nPOLYGON ((30510.72 29176.24…\n\n\n\n\n\nBUSINESS PARKS\nBusiness parks are typically smaller than planning areas, and we have multiple business parks to consider. Therefore, we will calculate centroid for measuring proximity, and transform polygon data to centroid point data.\n\n\nCode\nbizpark_data &lt;- st_read(\"data/rawdata/JTCBusinessParkLandGEOJSON.geojson\") %&gt;% \n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_centroid() %&gt;%\n  select(OBJECTID_1, LANDUSE, geometry)\n\nwrite_rds(bizpark_data, \"data/rds/bizpark_data.rds\")\n\n\n\n\n   OBJECTID_1     LANDUSE                   geometry  \n Min.   :3201   Length:292         POINT        :292  \n 1st Qu.:3274   Class :character   epsg:3414    :  0  \n Median :3346   Mode  :character   +proj=tmer...:  0  \n Mean   :3346                                         \n 3rd Qu.:3419                                         \n Max.   :3492                                         \n\n\nQuick view of the data set\n\nkable(head(bizpark_data, 3))\n\n\n\n\nOBJECTID_1\nLANDUSE\ngeometry\n\n\n\n\n3283\nBUSINESS PARK\nPOINT (42823.41 35766.39)\n\n\n3284\nBUSINESS PARK\nPOINT (42790.92 35430.63)\n\n\n3285\nBUSINESS PARK\nPOINT (42939.04 35654.4)\n\n\n\n\n\n\n\nSHOPPING MALLS\n\n\nCode\nsgmalls_rawdata &lt;- read_csv(\"data/rawdata/singapore_malls.csv\") %&gt;%\n  filter(!Mall_Name %in% c('JCube', 'JCube (closed)', 'Liang Court', 'Lot 1', \n                           'Nex', 'Novena Square Shopping Mall'))\n\nsgmalls_coordinates &lt;- read_csv(\"data/rawdata/shopping_mall_coordinates.csv\") %&gt;%\n  rename(Mall_Name = 'Mall Name')\n\nmerged_malls &lt;- full_join(sgmalls_rawdata, sgmalls_coordinates, by = \"Mall_Name\")\n\n\nAfter the merge, we examine if any shopping malls turn out without coordinates data.\n\n\nCode\nmalls_without_coords &lt;- merged_malls %&gt;%\n  filter(is.na(LONGITUDE) | is.na(LATITUDE)) %&gt;%\n  pull(Mall_Name)\n\nmalls_without_coords\n\n\nAmong checks, we identified some malls no longer in business:\n\nAmber Mansions: demolished in 1984\nBedok Point\nCapitol Centre\nEllenborough Market\nFunan DigitaLife Mall: duplicate\nGreat World: duplicate\nGV Yishun: cinema\nJurong Entertainment Centre: demolished 2010\nShaw Tower: demolished\nSpecialists’ Shopping Centre: redeveloped as Orchard Gateway\nTanglin Shopping Centre: CLOSED\nThe Golden Mile: CLOSED\nThe Verge: closed\nWoodland Mall: renamed to Woods square mall\n\nFor other malls, we manually check with Google maps and add the coordinates into the data set.\n\n\nCode\ncoords_to_fill &lt;- tibble(\n  Mall_Name = c(\"Alexandra Retail Centre\", \"Capitol Singapore\", \"Change Alley\",\n                \"Chinatown Point\", \"Clementi Mall\", \"Dawson Place\", \n                \"Esplanade Mall\", \"Forum The Shopping Mall\", \"Fu Lu Shou Complex\", \n                \"HarbourFront Centre\", \"Holland Road Shopping Centre\", \n                \"Holland Village Shopping Mall\", \n                \"Mandarin Gallery\", \"Mustafa Centre\", \"Novena Square\", \n                \"Orchard Towers\", \"Paya Lebar Quarter\", \"Peninsula Plaza\",\n                \"Punggol Coast Mall\", \"Scotts Shopping Centre\", \"Seletar Mall\",\n                \"Shaw House and Centre\", \"Singpost Center\",\n                \"South Beach\", \"Suntec City Mall\",\n                \"Tang Plaza\", \"The Cathay\", \n                \"The Majestic\", \"The Rail Mall\", \n                \"VivoCity\", \"Woodland Mall\"),\n  \n  LONGITUDE = c(103.8015, 103.8511, 103.8518, \n                103.8446, 103.7642, 103.8107,\n                103.8561, 103.8284, 103.8543,\n                103.8201, 103.7952, \n                103.7937, \n                103.8363, 103.8554, 103.8439,\n                103.8292, 103.8930, 103.8508,\n                103.9104, 103.8329, 103.8758,\n                103.8318, 103.8940, \n                103.8557, 103.8581, \n                103.8329, 103.8477,\n                103.8432, 103.7678,\n                103.8231, 103.7859\n                ),\n  LATITUDE = c(1.2741176, 1.293231, 1.284643, \n               1.285434, 1.315111, 1.293505, \n               1.290017, 1.306391, 1.301906,\n               1.265355, 1.310419, 1.319192,\n               \n               1.311708, \n               1.317859, 1.292544, 1.302237, \n               1.310192, 1.320230, 1.307743, \n               1.415818, 1.306093, 1.392464,\n               1.306507, \n               1.294485, 1.295778, \n               1.305221, 1.300409, \n               1.284871, 1.358212, \n               1.265357, 1.438082\n               )\n) \n\nmerged_malls &lt;- merged_malls %&gt;%\n  rows_update(coords_to_fill, by = \"Mall_Name\", unmatched = \"ignore\")\n\nmerged_malls &lt;-  merged_malls %&gt;%\n  mutate(\n    Mall_Name = case_when(\n      Mall_Name == \"Woods Square Mall\" ~ \"Woodland Mall\",\n      TRUE ~ Mall_Name\n    )\n  )\n\n# add new mall data\nnew_malls &lt;- tibble(\n  Mall_Name = \"Woodleigh Mall\",\n  LONGITUDE = 103.8718,\n  LATITUDE = 1.339560\n)  \n\nmerged_malls &lt;- merged_malls %&gt;%\n  bind_rows(new_malls)\n\n\nCheck the malls with missing coordinates.\n\n\nCode\nmalls_with_na &lt;- merged_malls %&gt;%\n  filter(is.na(LONGITUDE) | is.na(LATITUDE)) \n\nwrite_rds(malls_with_na, \"data/rds/malls_with_na.rds\")\n\n\n\n\n\n\n\nMall_Name\nLATITUDE\nLONGITUDE\n\n\n\n\nAmber Mansions\nNA\nNA\n\n\nBedok Point\nNA\nNA\n\n\nCapitol Centre\nNA\nNA\n\n\nEllenborough Market\nNA\nNA\n\n\nFunan DigitaLife Mall\nNA\nNA\n\n\nGV Yishun\nNA\nNA\n\n\nGreat World\nNA\nNA\n\n\nJurong Entertainment Centre\nNA\nNA\n\n\nShaw Tower\nNA\nNA\n\n\nSpecialists’ Shopping Centre\nNA\nNA\n\n\nTanglin Shopping Centre\nNA\nNA\n\n\nThe Golden Mile\nNA\nNA\n\n\nThe Verge\nNA\nNA\n\n\n\n\n\nThese malls are the ones duplicate or closed. We will go ahead to remove them. We will also remove 2 duplicate malls observed from merged_malls.\n\n\nCode\nmerged_malls &lt;- merged_malls %&gt;%\n  filter(!is.na(LONGITUDE) & !is.na(LATITUDE)) %&gt;%\n  distinct(Mall_Name, .keep_all = TRUE) %&gt;%\n  filter(!Mall_Name %in% c(\"Suntec City Mall\", \"Capitol Piazza\"))\n\n# Check how many remain\nnrow(merged_malls)\n\n# merged_malls has long, lat coordinates. We want to convert it to sf object, then SVY21.\nmerged_malls &lt;- merged_malls %&gt;%\n  st_as_sf(coords = c(\"LONGITUDE\", \"LATITUDE\"), crs = 4326) %&gt;%  # it's WGS84\n  st_transform(3414)  \n\nwrite_rds(merged_malls, \"data/rds/malls_data.rds\")\n\n\n\n\n  Mall_Name                  geometry  \n Length:184         POINT        :184  \n Class :character   epsg:3414    :  0  \n Mode  :character   +proj=tmer...:  0  \n\n\nQuick view of the data set\n\nkable(head(malls_data, 3))\n\n\n\n\nMall_Name\ngeometry\n\n\n\n\nAMK Hub\nPOINT (29685.51 39030.79)\n\n\nAlexandra Retail Centre\nPOINT (24458.84 28510.99)\n\n\nBedok Mall\nPOINT (38669.44 34109.91)\n\n\n\n\n\nSPORTS HALLS\n\n\nCode\nsports_data &lt;- st_read(\"data/rawdata/SportsFieldsSG.geojson\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\n# extract info\nsports_data &lt;- sports_data %&gt;%\n  mutate(\n    name = map_chr(Description, extract_kml_field, \"NAME\"),\n    description = map_chr(Description, extract_kml_field, \"DESCRIPTION\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col()) %&gt;%\n  select(-description)\n\nwrite_rds(sports_data, \"data/rds/sports_data.rds\")\n\n\n\n\n     name                    geometry  \n Length:182         POINT        :182  \n Class :character   epsg:3414    :  0  \n Mode  :character   +proj=tmer...:  0  \n\n\nQuick view of the data set\n\nkable(head(sports_data, 3))\n\n\n\n\nname\ngeometry\n\n\n\n\nSerangoon Garden Secondary School\nPOINT (32023.56 39127.53)\n\n\nShuqun Secondary School\nPOINT (17602.89 35813.36)\n\n\nJurong East Sports and Recreation Centre\nPOINT (16438.08 36526.17)\n\n\n\n\n\nPARKS\nFor the parks, we will compute centroid for each park and open space.\n\n\nCode\npark_data &lt;- st_read(\"data/rawdata/MasterPlan2019SDCPParkandOpenSpacelayer.kml\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414)\n\n# Calculate centroids \npark_data &lt;- park_data %&gt;%\n  mutate(centroid = st_centroid(geometry)) %&gt;%\n  select(-Description)\n\nwrite_rds(park_data, \"data/rds/park_data.rds\")\n\n\n\n\n     Name                    geometry             centroid   \n Length:1685        MULTIPOLYGON :  37   POINT        :1685  \n Class :character   POLYGON      :1648   epsg:3414    :   0  \n Mode  :character   epsg:3414    :   0   +proj=tmer...:   0  \n                    +proj=tmer...:   0                       \n\n\nQuick view of the data set\n\nkable(head(park_data, 3))\n\n\n\n\nName\ngeometry\ncentroid\n\n\n\n\nkml_1\nPOLYGON ((15876.84 37697.05…\nPOINT (16024.58 37668.09)\n\n\nkml_2\nPOLYGON ((15678.36 37672.24…\nPOINT (15522.79 37708.59)\n\n\nkml_3\nPOLYGON ((15345.81 37576.01…\nPOINT (15734.42 37525.8)\n\n\n\n\n\nCOMMUNITY CLUBS\n\n\nCode\ncc_data &lt;- st_read(\"data/rawdata/CommunityClubs.geojson\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\ncc_data &lt;- cc_data %&gt;%\n  mutate(\n    name = map_chr(Description, extract_kml_field, \"NAME\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\nwrite_rds(cc_data, \"data/rds/cc_data.rds\")\n\n\n\n\n     name                    geometry  \n Length:125         POINT        :125  \n Class :character   epsg:3414    :  0  \n Mode  :character   +proj=tmer...:  0  \n\n\nQuick view of the data set\n\nkable(head(cc_data, 3))\n\n\n\n\nname\ngeometry\n\n\n\n\nACE The Place CC\nPOINT (23428.65 45470.46)\n\n\nAljunied CC\nPOINT (34257.5 37416.8)\n\n\nAnchorvale CC\nPOINT (33936.82 42112.89)\n\n\n\n\n\n\n\nFOODCOURT/HAWKER CENTERS\n\n\nCode\nhkcenter_data &lt;- st_read(\"data/rawdata/HawkerCentresGEOJSON.geojson\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(OBJECTID, NAME, geometry, STATUS)\n\nwrite_rds(hkcenter_data, \"data/rds/hkcenter_data.rds\")\n\n\n\n\n    OBJECTID          NAME              STATUS                   geometry  \n Min.   :119041   Length:129         Length:129         POINT        :129  \n 1st Qu.:119073   Class :character   Class :character   epsg:3414    :  0  \n Median :119105   Mode  :character   Mode  :character   +proj=tmer...:  0  \n Mean   :119105                                                            \n 3rd Qu.:119137                                                            \n Max.   :119169                                                            \n\n\nQuick view of the data set\n\nkable(head(hkcenter_data, 3))\n\n\n\n\n\n\n\n\n\n\nOBJECTID\nNAME\nSTATUS\ngeometry\n\n\n\n\n119091\nAmoy Street Food Centre (Telok Ayer Food Centre)\nExisting\nPOINT (29480.26 29076.41)\n\n\n119092\nMargaret Drive Hawker Centre\nExisting (replacement)\nPOINT (24814.32 31095.01)\n\n\n119093\nPunggol Coast Hawker Centre\nExisting (new)\nPOINT (36371.37 44035.87)\n\n\n\n\n\nBelow we will check the status of these hawker centers, and find that all are either existing or under construction. None has stopped the business, so we will keep all these.\n\nunique(hkcenter_data$STATUS)\n\n[1] \"Existing\"               \"Existing (replacement)\" \"Existing (new)\"        \n[4] \"Under Construction\"     \"Interim Centre\"        \n\n\nSUPERMARKETS\n\n\nCode\nsupermarkets_data &lt;- st_read(\"data/rawdata/SupermarketsGEOJSON.geojson\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n# # calculate centroids\n#   mutate(centroid = st_centroid(geometry)) %&gt;%\n#   select(OBJECTID_1, centroid)\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\n# extract info\nsupermarkets_data &lt;- supermarkets_data %&gt;%\n  mutate(\n    name = map_chr(Description, extract_kml_field, \"LIC_NAME\"),\n    postcode = map_chr(Description, extract_kml_field, \"POSTCODE\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())  \n\nwrite_rds(supermarkets_data, \"data/rds/supermarkets_data.rds\")  \n\n\n\n\n     name             postcode                  geometry  \n Length:526         Length:526         POINT        :526  \n Class :character   Class :character   epsg:3414    :  0  \n Mode  :character   Mode  :character   +proj=tmer...:  0  \n\n\nQuick view of the data set\n\nkable(head(supermarkets_data, 3))\n\n\n\n\n\n\n\n\n\nname\npostcode\ngeometry\n\n\n\n\nLI LI CHENG SUPERMARKET (PUNGGOL) PTE. LTD.\n823273\nPOINT (35561.22 42685.17)\n\n\nSHENG SIONG SUPERMARKET PTE LTD\n380011\nPOINT (32184.01 32947.46)\n\n\nCOLD STORAGE SINGAPORE (1983) PTE LTD\n530683\nPOINT (33903.48 39480.46)\n\n\n\n\n\n\n\nMRT\nBelow we will import MRT station exit shapefile. The MRT stations may have multiple exits, and these exits matter when people go through them to enter or exit the stations. We will use the data to compute for proximity to HDB units.\n\n\nCode\nmrt_data &lt;- st_read(\"data/rawdata/TrainStationExit_Feb2025/Train_Station_Exit_Layer.shp\") %&gt;%\n  st_transform(crs = 3414)\n\n\nReading layer `Train_Station_Exit_Layer' from data source \n  `/Users/cathyc/Documents/cathyschu/analytics/geospatial/predict_hdb_resale/data/rawdata/TrainStationExit_Feb2025/Train_Station_Exit_Layer.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 595 features and 2 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 6134.086 ymin: 27499.7 xmax: 45356.36 ymax: 47865.92\nProjected CRS: SVY21\n\n\nCode\nsummary(mrt_data)\n\n\n   stn_name          exit_code                  geometry  \n Length:595         Length:595         POINT        :595  \n Class :character   Class :character   epsg:3414    :  0  \n Mode  :character   Mode  :character   +proj=tmer...:  0  \n\n\nQuick view of the data set\n\nkable(head(mrt_data, 3))\n\n\n\n\nstn_name\nexit_code\ngeometry\n\n\n\n\nMACPHERSON MRT STATION\nExit A\nPOINT (34285.07 34322.99)\n\n\nMACPHERSON MRT STATION\nExit B\nPOINT (34382.15 34231.9)\n\n\nMACPHERSON MRT STATION\nExit C\nPOINT (34337.29 34190.6)\n\n\n\n\n\nBUS STOPS\nBelow we will import Bus Stop Location shapfile from LTA DataMall.\n\n\nCode\nbus_data = st_read(dsn = \"data/rawdata/BusStopLocation_Aug2025\",\n                  layer = \"BusStop\")\nbus_data &lt;- bus_data %&gt;%\n  st_transform(crs = 3414)\n\nwrite_rds(bus_data, \"data/rds/bus_data.rds\")\n\n\n\n\n  BUS_STOP_N          LOC_DESC                  geometry   \n Length:5172        Length:5172        POINT        :5172  \n Class :character   Class :character   epsg:3414    :   0  \n Mode  :character   Mode  :character   +proj=tmer...:   0  \n\n\nQuick view of the data set\n\nkable(head(bus_data, 3))\n\n\n\n\nBUS_STOP_N\nLOC_DESC\ngeometry\n\n\n\n\n65059\nST ANNE’S CH\nPOINT (35565.66 41659.52)\n\n\n16171\nYUSOF ISHAK HSE\nPOINT (21439.91 31253.63)\n\n\n61101\nBLK 120\nPOINT (31381.06 35313.49)\n\n\n\n\n\n\n\nCLINICS\n\n\nCode\nclinics_data &lt;- st_read(\"data/rawdata/CHASClinics.geojson\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\n# extract info\nclinics_data &lt;- clinics_data %&gt;%\n  mutate(\n    name = map_chr(Description, extract_kml_field, \"HCI_NAME\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\nwrite_rds(clinics_data, \"data/rds/clinics_data.rds\")\n\n\n\n\n     name                    geometry   \n Length:1193        POINT        :1193  \n Class :character   epsg:3414    :   0  \n Mode  :character   +proj=tmer...:   0  \n\n\nQuick view of the data set\n\nkable(head(clinics_data, 3))\n\n\n\n\nname\ngeometry\n\n\n\n\nAcumed Medical Group\nPOINT (10760.19 34206.12)\n\n\nAcumed Medical Group\nPOINT (4985.534 30167.99)\n\n\nAdvantage Medical Clinic\nPOINT (23812.59 34780.58)\n\n\n\n\n\nELDERCARE SERVICES\n\n\nCode\neldercare_data &lt;- st_read(\"data/rawdata/EldercareServices.geojson\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\n# extract info\neldercare_data &lt;- eldercare_data %&gt;%\n  mutate(\n    name = map_chr(Description, extract_kml_field, \"NAME\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\nwrite_rds(eldercare_data, \"data/rds/eldercare_data.rds\")\n\n\n\n\n     name                    geometry  \n Length:133         POINT        :133  \n Class :character   epsg:3414    :  0  \n Mode  :character   +proj=tmer...:  0  \n\n\nQuick view of the data set\n\nkable(head(eldercare_data, 3))\n\n\n\n\nname\ngeometry\n\n\n\n\nYuhua Senior Activity Centre\nPOINT (16614.08 36639.12)\n\n\nTHK SAC @ Kaki Bukit\nPOINT (38803.81 35098.77)\n\n\nTHK SAC @ Boon Lay\nPOINT (14481.92 36357.61)\n\n\n\n\n\n\n\n\n\n\n2.1.3 Initial data inspection\nWe validate the coordinates of the location factor data below. It shows us that all now conform to SVY21, and ready for proximity computation.\n\nResultCode\n\n\n\n\nBusiness Park bizpark_data:  3414 \n \n CBD cbd_data:  3414 \n \n Clinics clinics_data:  3414 \n \n Eldercare Services eldercare_data:  3414 \n \n Foodcourt/Hawker Centers hkcenter_data:  3414 \n \n Shopping malls malls_data:  3414 \n \n MRT mrt_data:  3414 \n \n Parks park_data:  3414 \n \n Childcares preschool_data:  3414 \n \n Primary Schools primschool_data:  3414 \n \n Supermarkets supermarkets_data:  3414 \n \n Sports halls sports_data:  3414 \n \n Bus stops bus_data:  3414 \n \n Kindergartens kindergarten_data:  3414 \n \n Community Clubscc_data:  3414\n\n\n\n\n\ncat('Business Park bizpark_data: ',st_crs(bizpark_data)$epsg, '\\n','\\n',\n    'CBD cbd_data: ', st_crs(cbd_data)$epsg, '\\n','\\n',\n    'Clinics clinics_data: ', st_crs(clinics_data)$epsg, '\\n','\\n',\n    'Eldercare Services eldercare_data: ', st_crs(eldercare_data)$epsg, '\\n','\\n',\n    'Foodcourt/Hawker Centers hkcenter_data: ', st_crs(hkcenter_data)$epsg, '\\n','\\n',\n    'Shopping malls malls_data: ', st_crs(malls_data)$epsg, '\\n','\\n',\n    'MRT mrt_data: ', st_crs(mrt_data)$epsg, '\\n','\\n',\n    'Parks park_data: ', st_crs(park_data)$epsg, '\\n','\\n',\n    'Childcares preschool_data: ', st_crs(preschool_data)$epsg, '\\n','\\n',\n    'Primary Schools primschool_data: ', st_crs(primschool_data)$epsg, '\\n','\\n',\n    'Supermarkets supermarkets_data: ', st_crs(supermarkets_data)$epsg, '\\n','\\n',\n    'Sports halls sports_data: ', st_crs(sports_data)$epsg, '\\n','\\n',\n    'Bus stops bus_data: ', st_crs(bus_data)$epsg, '\\n','\\n',\n    'Kindergartens kindergarten_data: ', st_crs(kindergarten_data)$epsg, '\\n','\\n',\n    'Community Clubscc_data: ', st_crs(cc_data)$epsg)\n\n\n\n\n\n\n\n2.2 Structural factors\nThe tructural factors for this study include flat type, floor level, town, planning area, area of unit, age of unit, main upgrading program, and flat model. Currently in our data, we have the variables shown below:\n\nnames(HDBresale_sf)\n\n [1] \"month\"               \"town\"                \"flat_type\"          \n [4] \"block\"               \"street_name\"         \"storey_range\"       \n [7] \"floor_area_sqm\"      \"flat_model\"          \"lease_commence_date\"\n[10] \"remaining_lease\"     \"resale_price\"        \"geometry\"           \n\n\nWe will rename some of the factors and keep the factors being used for the study. In addition, we will convert the floor range storey_range to numerical variable, using its lowest level, and rename the varaible to floor_level. We will also calculate the unit age using the lease_commence_date variable.\n\n\nCode\nHDBresale_sf_rename &lt;- HDBresale_sf %&gt;%\n  rename(transact_date = month,\n         remaining_lease_mths = remaining_lease,\n         floor_level = storey_range,\n         plan_area = town) %&gt;%\n  mutate(floor_level = as.numeric(substr(floor_level, 1, 2)),\n         age = 2025 - lease_commence_date) %&gt;%\n    select(transact_date, resale_price, floor_level, plan_area, \n         floor_area_sqm, flat_model, \n         remaining_lease_mths, age, geometry) \n\nwrite_rds(HDBresale_sf_rename, \"data/rds/HDBresale_sf_rename.rds\")  \n\n\n\n\nRows: 14,737\nColumns: 9\n$ transact_date        &lt;chr&gt; \"2024-07\", \"2024-07\", \"2024-07\", \"2024-07\", \"2024…\n$ resale_price         &lt;dbl&gt; 528888, 500000, 540000, 500000, 620000, 570000, 5…\n$ floor_level          &lt;dbl&gt; 1, 1, 7, 1, 10, 10, 1, 4, 7, 19, 7, 7, 10, 4, 25,…\n$ plan_area            &lt;chr&gt; \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO…\n$ floor_area_sqm       &lt;dbl&gt; 91, 93, 91, 91, 97, 92, 91, 97, 94, 88, 102, 91, …\n$ flat_model           &lt;chr&gt; \"New Generation\", \"New Generation\", \"New Generati…\n$ remaining_lease_mths &lt;chr&gt; \"56 years 08 months\", \"55 years 08 months\", \"52 y…\n$ age                  &lt;dbl&gt; 43, 44, 47, 43, 48, 47, 43, 48, 13, 13, 32, 43, 1…\n$ geometry             &lt;POINT [m]&gt; POINT (29933.3 38362.35), POINT (30045.48 3…\n\n\nFor predictive modeling, we should change data type for the following variables: transact_date and remaining_lease_mths to date and numeric data type respectively.\n\n\nCode\n# convert transction date to date data type\nHDB_data &lt;- HDBresale_sf_rename %&gt;%\n  mutate(\n    transact_date = as.Date(paste0(transact_date, \"-01\")),\n    \n    # Extract years\n    years = as.numeric(str_extract(remaining_lease_mths, \"\\\\d+(?= year)\")),\n    # Extract months\n    months = as.numeric(str_extract(remaining_lease_mths, \"\\\\d+(?= month)\")),\n\n    years = ifelse(is.na(years), 0, years),\n    months = ifelse(is.na(months), 0, months),\n\n    remaining_lease_mths_num = years * 12 + months\n  ) %&gt;%\n  select(-years, -months)  # Remove temporary columns\nwrite_rds(HDB_data, \"data/rds/HDB_data.rds\")\n\n\nBelow we confirm the transction date is now Date data type and the remaining lease is in numeric data type as months.\n\n\n [1] \"2024-07-01\" \"2024-07-01\" \"2024-07-01\" \"2024-07-01\" \"2024-07-01\"\n [6] \"2024-07-01\" \"2024-08-01\" \"2024-09-01\" \"2024-09-01\" \"2024-09-01\"\n\n\n[1] \"Date\"\n\n\n[1] \"numeric\"\n\n\n\n\n2.3 Proximity Analysis\nIn this section, we will prepare location factors of their proximity to the HDB units and the availability of these facilities within a fixed distance of the HDB housing.\n\n2.3.1 Computing shortest distance\nWe would like to use proximity from the HDB units to the location factors to predict the resale price. When one purchases housing, distance to useful facilities is always a consideration or value drivers. For example, an HDB unit being only 100m away would be very different from 500m away from the nearest MRT station, as it takes longer time to commute and can be inconvenient in rainy and hot days.\nTherefore, below we will compute the distance between the nearest facilities/infrastructures from each HDB resale property. The distance computed would be in meters.\n\nEducationF&BHealthcareRecreationTransportationBusiness\n\n\n\n\nCode\n# Top Primary school\nHDB_combine_edu &lt;- HDB_data %&gt;%\n  mutate(\n    PROX_TOPSCHOOL = as.numeric(\n      st_distance(geometry,\n                  top_primschool_data[st_nearest_feature(\n                    geometry, top_primschool_data), ], \n                  by_element = TRUE)\n      ))\nwrite_rds(HDB_combine_edu, \"data/rds/HDB_combine_edu.rds\")\n\n\n\n\nCode\nHDB_combine_edu &lt;- read_rds(\"data/rds/HDB_combine_edu.rds\")\nkable(head(HDB_combine_edu, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n\n\n\n\n\n\n\n\n\nCode\n# Hawker centers\nHDB_combine_2fb &lt;- HDB_combine_edu %&gt;%\n  mutate(\n    PROX_HKCENTER = as.numeric(\n      st_distance(geometry,\n                  hkcenter_data[st_nearest_feature(\n                    geometry, hkcenter_data), ], \n                  by_element = TRUE)),\n# Supermarkets\n    PROX_SUPERMKT =  as.numeric(\n      st_distance(geometry,\n                  supermarkets_data[st_nearest_feature(\n                    geometry, supermarkets_data), ], \n                  by_element = TRUE))\n    )\n\nwrite_rds(HDB_combine_2fb, \"data/rds/HDB_combine_2fb.rds\")\n\n\n\n\nCode\nHDB_combine_2fb &lt;- read_rds(\"data/rds/HDB_combine_2fb.rds\")\nkable(head(HDB_combine_2fb, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n\n\n\n\n\n\n\n\n\nCode\n# Clinics\nHDB_combine_3hc &lt;- HDB_combine_2fb %&gt;%\n  mutate(\n    PROX_CLINIC = as.numeric(\n      st_distance(geometry,\n                  clinics_data[st_nearest_feature(\n                    geometry, clinics_data), ], \n                  by_element = TRUE)),\n# Eldercare\n    PROX_ELDERCARE =  as.numeric(\n      st_distance(geometry,\n                  eldercare_data[st_nearest_feature(\n                    geometry, eldercare_data), ], \n                  by_element = TRUE))\n    )\n\nwrite_rds(HDB_combine_3hc, \"data/rds/HDB_combine_3hc.rds\")\n\n\n\n\nCode\nHDB_combine_3hc &lt;- read_rds(\"data/rds/HDB_combine_3hc.rds\")\nkable(head(HDB_combine_3hc, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n\n\n\n\n\n\n\n\n\nCode\n# Shopping mall\nHDB_combine_4rc &lt;- HDB_combine_3hc %&gt;%\n  mutate(\n    PROX_MALLS = as.numeric(\n      st_distance(geometry,\n                  malls_data[st_nearest_feature(\n                    geometry, malls_data), ], \n                  by_element = TRUE)),\n# Sports hall\n    PROX_SPORTS =  as.numeric(\n      st_distance(geometry,\n                  sports_data[st_nearest_feature(\n                    geometry, sports_data), ], \n                  by_element = TRUE)),\n# Community Club\n    PROX_CC =  as.numeric(\n      st_distance(geometry,\n                  cc_data[st_nearest_feature(\n                    geometry, cc_data), ], \n                  by_element = TRUE)),\n# Parks\n    PROX_PARK =  as.numeric(\n      st_distance(geometry,\n                  park_data[st_nearest_feature(\n                    geometry, park_data), ], \n                  by_element = TRUE))\n    )\n\nwrite_rds(HDB_combine_4rc, \"data/rds/HDB_combine_4rc.rds\")\n\n\n\n\nCode\nHDB_combine_4rc &lt;- read_rds(\"data/rds/HDB_combine_4rc.rds\")\nkable(head(HDB_combine_4rc, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n\n\n\n\n\n\n\n\n\nCode\n# Shopping mall\nHDB_combine_5transp &lt;- HDB_combine_4rc %&gt;%\n  mutate(\n    PROX_MRT = as.numeric(\n      st_distance(geometry,\n                  mrt_data[st_nearest_feature(\n                    geometry, mrt_data), ], \n                  by_element = TRUE))\n    )\n\nwrite_rds(HDB_combine_5transp, \"data/rds/HDB_combine_5transp.rds\")\n\n\n\n\nCode\nHDB_combine_5transp &lt;- read_rds(\"data/rds/HDB_combine_5transp.rds\")\nkable(head(HDB_combine_5transp, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n\n\n\n\n\n\n\n\n\nCode\n# CBD\nHDB_combine_6biz &lt;- HDB_combine_5transp %&gt;%\n  mutate(\n    PROX_CBD = as.numeric(\n      st_distance(geometry,\n                  cbd_data)),\n    PROX_BIZPK = as.numeric(\n      st_distance(geometry,\n                  cbd_data)),\n# Business parks\n    PROX_BIZPK = as.numeric(\n      st_distance(geometry,\n                  bizpark_data[st_nearest_feature(\n                    geometry, bizpark_data), ], \n                  by_element = TRUE))\n    )\nwrite_rds(HDB_combine_6biz, \"data/rds/HDB_combine_6biz.rds\")\n\n\n\n\nCode\nHDB_combine_6biz &lt;- read_rds(\"data/rds/HDB_combine_6biz.rds\")\nkable(head(HDB_combine_6biz, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n\n\n\n\n\n\n\n\n\n\n2.3.2 Create binary proximity indicators\nNext we will derive a binary data to find out which schools are within 350 meters. st_is_within_distance() of sf package is used to determine whether two spatial objects (HDB property and preschool) are within a set distance of each other. It returns a logical matrix (or a sparse list of indices if sparse = TRUE) indicating for each geometry in HDB property which geometries in the facility are within the set distance.\n\nTop primary schoolMRTHawker centre\n\n\nWithin 1 km\n\n\nCode\nwithin_1km &lt;- st_is_within_distance(\n  HDB_data, top_primschool_data, dist = 1000)\n\nHDB_combine_7bi_primschool &lt;- HDB_combine_6biz %&gt;%\n  mutate(\n    WITHIN_1km_TOPPRISCH = map_int(within_1km, length),\n    WITHIN_1km_TOPPRISCH_BINARY = ifelse(WITHIN_1km_TOPPRISCH &gt; 0, 1, 0)\n)\nwrite_rds(HDB_combine_7bi_primschool, \"data/rds/HDB_combine_7bi_primschool.rds\")\n\n\n\n\nCode\nHDB_combine_7bi_primschool &lt;- \n  read_rds(\"data/rds/HDB_combine_7bi_primschool.rds\")\nkable(head(HDB_combine_7bi_primschool, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH\nWITHIN_1km_TOPPRISCH_BINARY\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n0\n0\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n0\n0\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n2\n1\n\n\n\n\n\n\n\nWithin 500 meters\n\n\nCode\nwithin_500m_mrt &lt;- st_is_within_distance(\n  HDB_data, mrt_data, dist = 500)\n\nHDB_combine_7bi_mrt &lt;- HDB_combine_7bi_primschool %&gt;%\n  mutate(\n    WITHIN_500m_MRT_BINARY = as.numeric(lengths(within_500m_mrt) &gt; 0)\n)\nwrite_rds(HDB_combine_7bi_mrt, \"data/rds/HDB_combine_7bi_mrt.rds\")\n\n\n\n\nCode\nHDB_combine_7bi_mrt &lt;- read_rds(\"data/rds/HDB_combine_7bi_mrt.rds\")\nkable(head(HDB_combine_7bi_mrt, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_MRT_BINARY\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n0\n0\n0\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n0\n0\n0\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n2\n1\n1\n\n\n\n\n\n\n\nWithin 500 meters\n\n\nCode\nwithin_500m_hkcenter &lt;- st_is_within_distance(\n  HDB_data, hkcenter_data, dist = 500)\n\nHDB_combine_7bi_hkcenter &lt;- HDB_combine_7bi_mrt %&gt;%\n  mutate(\n    WITHIN_500m_HKC_BINARY = as.numeric(lengths(within_500m_hkcenter) &gt; 0)\n)\nwrite_rds(HDB_combine_7bi_hkcenter, \"data/rds/HDB_combine_7bi_hkcenter.rds\")\n\n\n\n\nCode\nHDB_combine_7bi_hkcenter &lt;- read_rds(\"data/rds/HDB_combine_7bi_hkcenter.rds\")\nkable(head(HDB_combine_7bi_hkcenter, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_MRT_BINARY\nWITHIN_500m_HKC_BINARY\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n0\n0\n0\n1\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n0\n0\n0\n1\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n2\n1\n1\n1\n\n\n\n\n\n\n\n\n\n\n\n2.4 Amenity Density Analysis\nWe would like to compute the amenity density with the number of location factors within a designated distance. map_int() of purr package is used to the number of preschools found in the newly created WITHIN_[distance]_[amenity] field.\n\nkindergartenchildcarebus stopprimary school\n\n\nKindergartens within 350m of the HDB unit.\n\n\nCode\nwithin_350m_kindg &lt;- st_is_within_distance(\n  HDB_data, kindergarten_data, dist = 350)\n\nHDB_combine_8dense_kindg &lt;- HDB_combine_7bi_hkcenter %&gt;%\n  mutate(\n    WITHIN_350m_KINDG = map_int(within_350m_kindg, length)\n)\nwrite_rds(HDB_combine_8dense_kindg, \"data/rds/HDB_combine_8dense_kindg.rds\")\n\n\n\n\nCode\nHDB_combine_8dense_kindg &lt;- read_rds(\"data/rds/HDB_combine_8dense_kindg.rds\")\nkable(head(HDB_combine_8dense_kindg, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_MRT_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n0\n0\n0\n1\n1\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n0\n0\n0\n1\n0\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n2\n1\n1\n1\n2\n\n\n\n\n\n\n\nChildcares within 350m of the HDB unit.\n\n\nCode\nwithin_350m_childc &lt;- st_is_within_distance(\n  HDB_data, preschool_data, dist = 350)\n\nHDB_combine_8dense_childc &lt;- HDB_combine_8dense_kindg %&gt;%\n  mutate(\n    WITHIN_350m_CHILDC = map_int(within_350m_childc, length)\n)\nwrite_rds(HDB_combine_8dense_childc, \"data/rds/HDB_combine_8dense_childc.rds\")\n\n\n\n\nCode\nHDB_combine_8dense_childc &lt;- read_rds(\"data/rds/HDB_combine_8dense_childc.rds\")\nkable(head(HDB_combine_8dense_childc, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_MRT_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\nWITHIN_350m_CHILDC\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n0\n0\n0\n1\n1\n2\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n0\n0\n0\n1\n0\n1\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n2\n1\n1\n1\n2\n7\n\n\n\n\n\n\n\nBus stops within 350m of the HDB unit.\n\n\nCode\nwithin_350m_bus &lt;- st_is_within_distance(\n  HDB_data, bus_data, dist = 350)\n\nHDB_combine_8dense_bus &lt;- HDB_combine_8dense_childc %&gt;%\n  mutate(\n    WITHIN_350m_BUS = map_int(within_350m_bus, length)\n)\nwrite_rds(HDB_combine_8dense_bus, \"data/rds/HDB_combine_8dense_bus.rds\")\n\n\n\n\nCode\nHDB_combine_8dense_bus &lt;- read_rds(\"data/rds/HDB_combine_8dense_bus.rds\")\nkable(head(HDB_combine_8dense_bus, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_MRT_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\nWITHIN_350m_CHILDC\nWITHIN_350m_BUS\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n0\n0\n0\n1\n1\n2\n8\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n0\n0\n0\n1\n0\n1\n7\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n2\n1\n1\n1\n2\n7\n7\n\n\n\n\n\n\n\nKindergartens within 1km of the HDB unit. We use 1km because housing within 1km of a primary school gets the priority of entolment. This is an important factor for some parents to look for (new) housing due to children education planning.\n\n\nCode\nwithin_1km_primsch &lt;- st_is_within_distance(\n  HDB_data, primschool_data, dist = 1000)\n\nHDB_combine_8dense_primsch &lt;- HDB_combine_8dense_bus %&gt;%\n  mutate(\n    WITHIN_1km_PRISCH = map_int(within_1km_primsch, length)\n)\n\nwrite_rds(HDB_combine_8dense_primsch, \"data/rds/HDB_combine_8dense_primsch.rds\")\n\n\n\n\nCode\nHDB_combine_8dense_primsch &lt;- read_rds(\"data/rds/HDB_combine_8dense_primsch.rds\")\nkable(head(HDB_combine_8dense_primsch, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_MRT_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\nWITHIN_350m_CHILDC\nWITHIN_350m_BUS\nWITHIN_1km_PRISCH\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n0\n0\n0\n1\n1\n2\n8\n3\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n0\n0\n0\n1\n0\n1\n7\n2\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n2\n1\n1\n1\n2\n7\n7\n3\n\n\n\n\n\n\n\n\n\n\n2.5 Final Dataset Assembly\n\n2.5.1 Save the master dataset\nWith each data processing step in section 2.3 and 2.4, we have assembled all structural and location factors into the dataset HDB_combine_8dense_primsch. Below code we removed remaining_lease_mths because it has been converted to a new variable in months remaining_lease_mths_num.\n\n\nCode\nHDB_master &lt;- HDB_combine_8dense_primsch %&gt;%\n  select(-remaining_lease_mths)\n\nwrite_rds(HDB_master, \"data/rds/HDB_master.rds\")\n\n\n\n\nRows: 14,737\nColumns: 29\n$ transact_date               &lt;date&gt; 2024-07-01, 2024-07-01, 2024-07-01, 2024-…\n$ resale_price                &lt;dbl&gt; 528888, 500000, 540000, 500000, 620000, 57…\n$ floor_level                 &lt;dbl&gt; 1, 1, 7, 1, 10, 10, 1, 4, 7, 19, 7, 7, 10,…\n$ plan_area                   &lt;chr&gt; \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", …\n$ floor_area_sqm              &lt;dbl&gt; 91, 93, 91, 91, 97, 92, 91, 97, 94, 88, 10…\n$ flat_model                  &lt;chr&gt; \"New Generation\", \"New Generation\", \"New G…\n$ age                         &lt;dbl&gt; 43, 44, 47, 43, 48, 47, 43, 48, 13, 13, 32…\n$ geometry                    &lt;POINT [m]&gt; POINT (29933.3 38362.35), POINT (300…\n$ remaining_lease_mths_num    &lt;dbl&gt; 680, 668, 631, 680, 621, 631, 680, 620, 10…\n$ PROX_TOPSCHOOL              &lt;dbl&gt; 1139.9957, 1054.7401, 785.8500, 1246.3765,…\n$ PROX_HKCENTER               &lt;dbl&gt; 289.98144, 424.99822, 132.00515, 398.27582…\n$ PROX_SUPERMKT               &lt;dbl&gt; 349.25330, 468.66713, 186.27015, 237.72203…\n$ PROX_CLINIC                 &lt;dbl&gt; 9.399557e+01, 1.415401e+02, 1.011686e+02, …\n$ PROX_ELDERCARE              &lt;dbl&gt; 334.27019, 433.83460, 397.61080, 214.39384…\n$ PROX_MALLS                  &lt;dbl&gt; 712.8886, 946.0851, 959.9848, 726.9160, 45…\n$ PROX_SPORTS                 &lt;dbl&gt; 347.0061, 507.8975, 336.9090, 260.9641, 30…\n$ PROX_CC                     &lt;dbl&gt; 316.95217, 281.23633, 270.59187, 202.78502…\n$ PROX_PARK                   &lt;dbl&gt; 154.24457, 63.25578, 242.55766, 115.96037,…\n$ PROX_MRT                    &lt;dbl&gt; 696.6567, 919.2072, 383.6496, 680.8811, 54…\n$ PROX_CBD                    &lt;dbl&gt; 7080.609, 6861.176, 7868.887, 7107.071, 75…\n$ PROX_BIZPK                  &lt;dbl&gt; 8453.334, 8495.518, 8490.800, 8331.434, 87…\n$ WITHIN_1km_TOPPRISCH        &lt;int&gt; 0, 0, 2, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, …\n$ WITHIN_1km_TOPPRISCH_BINARY &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, …\n$ WITHIN_500m_MRT_BINARY      &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ WITHIN_500m_HKC_BINARY      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ WITHIN_350m_KINDG           &lt;int&gt; 1, 0, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 0, 1, …\n$ WITHIN_350m_CHILDC          &lt;int&gt; 2, 1, 7, 3, 8, 7, 3, 8, 7, 7, 5, 3, 2, 6, …\n$ WITHIN_350m_BUS             &lt;int&gt; 8, 7, 7, 6, 7, 7, 7, 7, 4, 4, 4, 7, 5, 6, …\n$ WITHIN_1km_PRISCH           &lt;int&gt; 3, 2, 3, 3, 3, 3, 3, 3, 2, 2, 3, 3, 2, 3, …\n\n\n\n\n2.5.2 Handle remaining missing values\nAfter data assembly, let’s check if there is any missing values from the master dataset. The result FALSE indicates that there is no missing value.\n\nanyNA(HDB_master)\n\n[1] FALSE"
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#data-quality-spatial-overview",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#data-quality-spatial-overview",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "3 Data Quality & Spatial Overview",
    "text": "3 Data Quality & Spatial Overview\n\n3.1 Data Quality Check\nLet’s run a summary statistics to examine is there is any obvious anomaly or outliers. From below results, there is no obvious anomaly detected. Just an interesting fact that the childcare service density could be up to 35 within 350m of range.\n\nsummary(HDB_master)\n\n transact_date         resale_price      floor_level      plan_area        \n Min.   :2024-07-01   Min.   : 300000   Min.   : 1.000   Length:14737      \n 1st Qu.:2024-10-01   1st Qu.: 552000   1st Qu.: 4.000   Class :character  \n Median :2025-02-01   Median : 620000   Median : 7.000   Mode  :character  \n Mean   :2025-01-26   Mean   : 661081   Mean   : 8.232                     \n 3rd Qu.:2025-06-01   3rd Qu.: 713888   3rd Qu.:10.000                     \n Max.   :2025-09-01   Max.   :1518000   Max.   :49.000                     \n floor_area_sqm    flat_model             age                 geometry    \n Min.   : 74.00   Length:14737       Min.   : 4.00   POINT        :14737  \n 1st Qu.: 92.00   Class :character   1st Qu.: 9.00   epsg:3414    :    0  \n Median : 93.00   Mode  :character   Median :23.00   +proj=tmer...:    0  \n Mean   : 94.83                      Mean   :22.92                        \n 3rd Qu.:100.00                      3rd Qu.:37.00                        \n Max.   :135.00                      Max.   :58.00                        \n remaining_lease_mths_num PROX_TOPSCHOOL  PROX_HKCENTER     PROX_SUPERMKT      \n Min.   : 485.0           Min.   :  121   Min.   :  25.35   Min.   :2.600e-04  \n 1st Qu.: 753.0           1st Qu.: 1797   1st Qu.: 377.90   1st Qu.:1.777e+02  \n Median : 914.0           Median : 3314   Median : 647.45   Median :2.751e+02  \n Mean   : 918.6           Mean   : 3938   Mean   : 732.41   Mean   :3.033e+02  \n 3rd Qu.:1084.0           3rd Qu.: 5679   3rd Qu.: 959.11   3rd Qu.:3.902e+02  \n Max.   :1144.0           Max.   :10448   Max.   :2500.14   Max.   :1.415e+03  \n  PROX_CLINIC        PROX_ELDERCARE        PROX_MALLS       PROX_SPORTS     \n Min.   :  0.00001   Min.   :   0.0004   Min.   :  39.14   Min.   :  36.22  \n 1st Qu.:111.99873   1st Qu.: 337.5461   1st Qu.: 368.11   1st Qu.: 259.44  \n Median :172.37676   Median : 660.4340   Median : 582.30   Median : 410.32  \n Mean   :188.62285   Mean   : 822.7558   Mean   : 643.05   Mean   : 499.02  \n 3rd Qu.:243.46665   3rd Qu.:1144.2391   3rd Qu.: 858.78   3rd Qu.: 635.99  \n Max.   :808.33274   Max.   :3301.6373   Max.   :2274.71   Max.   :2044.94  \n    PROX_CC           PROX_PARK         PROX_MRT          PROX_CBD       \n Min.   :   2.012   Min.   :  3.39   Min.   :  21.79   Min.   :   28.89  \n 1st Qu.: 320.268   1st Qu.: 75.47   1st Qu.: 284.05   1st Qu.: 8673.61  \n Median : 492.476   Median :135.67   Median : 512.38   Median :12009.99  \n Mean   : 524.277   Mean   :156.29   Mean   : 584.44   Mean   :11291.86  \n 3rd Qu.: 691.183   3rd Qu.:222.17   3rd Qu.: 790.21   3rd Qu.:14500.80  \n Max.   :1935.530   Max.   :557.58   Max.   :2120.10   Max.   :18914.27  \n   PROX_BIZPK     WITHIN_1km_TOPPRISCH WITHIN_1km_TOPPRISCH_BINARY\n Min.   : 107.1   Min.   :0.0000       Min.   :0.0000             \n 1st Qu.:2009.3   1st Qu.:0.0000       1st Qu.:0.0000             \n Median :3581.1   Median :0.0000       Median :0.0000             \n Mean   :4033.3   Mean   :0.1192       Mean   :0.1106             \n 3rd Qu.:5961.7   3rd Qu.:0.0000       3rd Qu.:0.0000             \n Max.   :9560.1   Max.   :2.0000       Max.   :1.0000             \n WITHIN_500m_MRT_BINARY WITHIN_500m_HKC_BINARY WITHIN_350m_KINDG\n Min.   :0.0000         Min.   :0.0000         Min.   :0.0000   \n 1st Qu.:0.0000         1st Qu.:0.0000         1st Qu.:0.0000   \n Median :0.0000         Median :0.0000         Median :1.0000   \n Mean   :0.4871         Mean   :0.3809         Mean   :0.9339   \n 3rd Qu.:1.0000         3rd Qu.:1.0000         3rd Qu.:1.0000   \n Max.   :1.0000         Max.   :1.0000         Max.   :8.0000   \n WITHIN_350m_CHILDC WITHIN_350m_BUS  WITHIN_1km_PRISCH\n Min.   : 0.000     Min.   : 0.000   Min.   :0.000    \n 1st Qu.: 3.000     1st Qu.: 6.000   1st Qu.:2.000    \n Median : 5.000     Median : 8.000   Median :3.000    \n Mean   : 5.493     Mean   : 8.008   Mean   :3.093    \n 3rd Qu.: 7.000     3rd Qu.:10.000   3rd Qu.:4.000    \n Max.   :25.000     Max.   :19.000   Max.   :9.000    \n\n\n\n\n3.2 Target Variable Analysis\nBefore we start data set preparation for predictive modeling training, we would like to leverage visualisations to observe the location factors and structural factors, and further examine if there are any anomalies.\n\nnames(HDB_master)\n\n [1] \"transact_date\"               \"resale_price\"               \n [3] \"floor_level\"                 \"plan_area\"                  \n [5] \"floor_area_sqm\"              \"flat_model\"                 \n [7] \"age\"                         \"geometry\"                   \n [9] \"remaining_lease_mths_num\"    \"PROX_TOPSCHOOL\"             \n[11] \"PROX_HKCENTER\"               \"PROX_SUPERMKT\"              \n[13] \"PROX_CLINIC\"                 \"PROX_ELDERCARE\"             \n[15] \"PROX_MALLS\"                  \"PROX_SPORTS\"                \n[17] \"PROX_CC\"                     \"PROX_PARK\"                  \n[19] \"PROX_MRT\"                    \"PROX_CBD\"                   \n[21] \"PROX_BIZPK\"                  \"WITHIN_1km_TOPPRISCH\"       \n[23] \"WITHIN_1km_TOPPRISCH_BINARY\" \"WITHIN_500m_MRT_BINARY\"     \n[25] \"WITHIN_500m_HKC_BINARY\"      \"WITHIN_350m_KINDG\"          \n[27] \"WITHIN_350m_CHILDC\"          \"WITHIN_350m_BUS\"            \n[29] \"WITHIN_1km_PRISCH\"          \n\n\n\n3.2.1 Plot distribution of variables\n\nPrice distributionPrice x ProximityPrice x Facility densityPrice x Availability\n\n\nThe resale prices concentrate on 700,000 and is right skewed, indicating that there are many above 1 million dollar housing and even some outliers pricing crossing 1.2 million dollars.\n\n\nCode\nggplot(HDB_master, \n       aes(x = resale_price)) + \n  geom_histogram(bins = 30, color = \"#F0F0F0\", fill = \"#B3C8CF\") +\n  labs(\n    title = \"Distribution of resale prices: HDB 4-room\",\n    subtitle = \"(July 2024 - Sep 2025)\",\n    x = \"Resale price S$\",\n    y = \"Count\",\n    colour = \"Gears\") +\n  theme(panel.background = element_rect(color = \"white\"),\n        plot.background = element_rect(fill = \"#EEEEEE\")) \n\n\n\n\n\n\n\n\n\n\n\nMost facilities show a downward trend in resale price as proximity to the facilities increases, such as clinics, MRT stations, parks, etc. Among these, CBD and top primary schools show the most obvious trends, while supermarkets and community centers show less obvious patterns. Interestingly, sports halls show a downward trend for shorter distances. However, after a distance of 1km, the trend reverses and prices begin to trend upward. Based on these observations, these variables will be retained as predicting factors in the model.\n\n\nCode\nHDB_master_long &lt;- HDB_master %&gt;%\n  pivot_longer(cols = c(PROX_TOPSCHOOL, PROX_HKCENTER, PROX_CLINIC, \n                        PROX_MALLS, PROX_CC, PROX_MRT, PROX_SUPERMKT, \n                        PROX_ELDERCARE, PROX_SPORTS, PROX_PARK,\n                        PROX_CBD),\n               names_to = \"facility\",\n               values_to = \"proximity\")\n\nggplot(HDB_master_long, aes(x = proximity, y = resale_price)) +\n  geom_point(alpha = 0.1, size = 0.4, colour = \"#B3C8CF\") +\n  geom_smooth(method = \"lm\", color = \"#FF8282\", se = FALSE) +\n  facet_wrap(~ facility, ncol = 3, scales = \"free_x\") +\n  labs(x = \"Proximity (m)\", y = \"Resale Price ($)\",\n       title = \"HDB Resale Price vs Proximity to Facilities\") +\n  theme(panel.background = element_rect(color = \"white\"),\n        plot.background = element_rect(fill = \"#EEEEEE\"),\n        strip.text = element_text(size = 15),\n        plot.title = element_text(size = 22),      \n        axis.title = element_text(size = 15),\n        axis.text.x = element_text(size = 11),\n        axis.text.y = element_text(size = 11))\n\n\n\n\n\n\n\n\n\n\n\nThe boxplots indicate that facility density variables exhibit varying relationships with HDB resale prices. Top primary schools and kindergartens demonstrate positive trends, whereas facilities like bus stops and primary schools show less pronounced associations.\nDespite these varying patterns, all density variables were retained as potential predictors given their theoretical relevance to housing valuation.\n\n\nCode\nHDB_master_long_dist &lt;- HDB_master %&gt;%\n  pivot_longer(cols = c(WITHIN_1km_TOPPRISCH,\n                        WITHIN_350m_BUS, WITHIN_350m_KINDG,\n                        WITHIN_350m_CHILDC, WITHIN_1km_PRISCH),\n               names_to = \"facility_dist\",\n               values_to = \"count\") \n\n# Violin plot with boxplot inside\nggplot(HDB_master_long_dist, aes(x = factor(count), y = resale_price)) +\n  geom_boxplot(width = 0.1, fill = \"white\", outlier.size = 0.5) +\n  facet_wrap(~ facility_dist, ncol = 2, scales = \"free_x\") +\n  labs(x = \"Number of Facilities within distance\",\n       y = \"Resale Price ($)\",\n       title = \"HDB Resale Price Distribution by Facility Density\") +\n  theme(panel.background = element_rect(color = \"white\"),\n        plot.background = element_rect(fill = \"#EEEEEE\"),\n        strip.text = element_text(size = 15),\n        plot.title = element_text(size = 22),      \n        axis.title = element_text(size = 15),\n        axis.text.x = element_text(size = 11),\n        axis.text.y = element_text(size = 11))\n\n\n\n\n\n\n\n\n\n\n\nThe availability of top primary schools within 1km, hawker centers within 500m, and MRT stations within 500m show similar patterns in the boxplots. Suggests that the presence of these facilities could be a driver for HDB resale pricing. Interestingly, the absence of these facilities results in resale prices constrained within a narrower range compared to cases where these facilities are present, although numerous outliers are observed in both groups.\n\n\nCode\nHDB_master_long_binary &lt;- HDB_master %&gt;%\n  pivot_longer(cols = c(WITHIN_1km_TOPPRISCH_BINARY, WITHIN_500m_MRT_BINARY,\n                        WITHIN_500m_HKC_BINARY),\n               names_to = \"facility_binary\",\n               values_to = \"count\") \n\n# Violin plot with boxplot inside\nggplot(HDB_master_long_binary, aes(x = factor(count), y = resale_price)) +\n  geom_boxplot(width = 0.1, fill = \"white\", outlier.size = 0.5) +\n  facet_wrap(~ facility_binary, ncol = 3, scales = \"free_x\") +\n  labs(x = \"Availability of Facilities within distance\",\n       y = \"Resale Price ($)\",\n       title = \"HDB Resale Price Distribution by Facility Availability\") +\n  theme(panel.background = element_rect(color = \"white\"),\n        plot.background = element_rect(fill = \"#EEEEEE\"),\n        strip.text = element_text(size = 15),\n        plot.title = element_text(size = 22),      \n        axis.title = element_text(size = 15),\n        axis.text.x = element_text(size = 11),\n        axis.text.y = element_text(size = 11))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n3.2.2 Visualise HDB units prices on thematic map\n\nnames(HDB_master)\n\n [1] \"transact_date\"               \"resale_price\"               \n [3] \"floor_level\"                 \"plan_area\"                  \n [5] \"floor_area_sqm\"              \"flat_model\"                 \n [7] \"age\"                         \"geometry\"                   \n [9] \"remaining_lease_mths_num\"    \"PROX_TOPSCHOOL\"             \n[11] \"PROX_HKCENTER\"               \"PROX_SUPERMKT\"              \n[13] \"PROX_CLINIC\"                 \"PROX_ELDERCARE\"             \n[15] \"PROX_MALLS\"                  \"PROX_SPORTS\"                \n[17] \"PROX_CC\"                     \"PROX_PARK\"                  \n[19] \"PROX_MRT\"                    \"PROX_CBD\"                   \n[21] \"PROX_BIZPK\"                  \"WITHIN_1km_TOPPRISCH\"       \n[23] \"WITHIN_1km_TOPPRISCH_BINARY\" \"WITHIN_500m_MRT_BINARY\"     \n[25] \"WITHIN_500m_HKC_BINARY\"      \"WITHIN_350m_KINDG\"          \n[27] \"WITHIN_350m_CHILDC\"          \"WITHIN_350m_BUS\"            \n[29] \"WITHIN_1km_PRISCH\"          \n\n\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.4, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.5,\n          col = NA,\n          fill_alpha = 0.7,\n          fill.scale = tm_scale_continuous(values = \"brewer.reds\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 1.2,      \n          text.size = 1),\n          ) +  \n  \n  tm_title(text = \"HDB Resale Prices (2024-2025)\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.text.size = 0.7,             \n    legend.title.size = 1,                \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"#EEEEEE\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\n\n\nObservation\n\n\nThe thematic map reveals that HDB resale prices are generally higher closer to the city center, demonstrating a clear distance-decay pattern from the CBD. However, substantial price variation exists within all regions, ranging from low to high values. Also note that spatial clusters of high-priced units appear in certain mature estates despite their distance from the CBD, while some peripheral areas show unexpectedly elevated prices. This spatial heterogeneity suggests that locational factors (such as proximity to MRT stations and top primary schools) and structural characteristics (such as age) interact to influence pricing patterns across different neighborhoods.\n\n\n\n\n3.2.3 Spatial Visualization of Amenities\nBelow are thematic maps of amenity variables reveal varied spatial patterns across Singapore. These visualisations suggest spatial heterogeneity in the distribution of amenities and housing attributes; altogether supporting the need for spatial analytical approaches in modeling HDB resale prices.\n\nEducationTransportCommercialBusinessRecreation & OthersHealthcare\n\n\nPrimary schools (top 20 highlighted)\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.3, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.6,\n          fill_alpha = 0.4,\n          col = \"grey\",\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(top_primschool_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +    \n    \n  tm_title(text = \"HDB Resale Prices vs Top Primary schools\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\nKindergartens\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.3, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(kindergarten_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +   \n    \n  tm_title(text = \"HDB Resale Prices vs Kindergartens\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nChildcare centres\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.3, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(preschool_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +   \n    \n  tm_title(text = \"HDB Resale Prices vs Childcare centres\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\n\n\n**MRT station exits**\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.3, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(top_primschool_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +   \n    \n  tm_title(text = \"HDB Resale Prices vs MRT station exits\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nBus stops\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.3, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(top_primschool_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Bus stops\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\n\n\nShopping malls\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.3, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(top_primschool_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +   \n  \n  tm_title(text = \"HDB Resale Prices vs Malls\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nHawker centres\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.3, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(top_primschool_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Hawkers\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nSupermarkets\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.4, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(top_primschool_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Supermarkets\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\n\n\nCBD\n\n\nCode\nmap_cbd &lt;- tm_shape(mpsz) + \n  tm_polygons(\n    fill = \"REGION_N\", col = \"white\", lwd = 0.8,\n    fill.scale = tm_scale_categorical(\n      values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \"#FDE7B3\", \"#FDCFFA\")\n    ),\n  fill_alpha = 0.4) +\n  tm_shape(cbd_data) +\n  tm_polygons(col = \"red\", col_alpha = 0.8, lwd = 2) + \n  \n  tm_shape(HDB_master) +\n  tm_dots(col = \"PROX_CBD\", \n          size = 0.2,             \n          palette = \"-RdYlBu\",     \n          alpha = 0.5) +\n\n  tm_title(text = \"HDB Resale Prices vs CBD\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\nmap_cbd\n\n\n\n\n\n\n\n\n\nBusiness parks\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.4, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(bizpark_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Business parks\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\n\n\nParks\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.4, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(park_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.2) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Parks\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nSports halls\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.4, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(sports_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.2) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Sports halls\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\n\n\nClinics\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.4, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(clinics_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.2) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Clinics\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nEldercare services\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.4, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(eldercare_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.2) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Eldercare services\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )"
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#pre-modeling-preparation",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#pre-modeling-preparation",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "4 Pre-modeling Preparation",
    "text": "4 Pre-modeling Preparation\n\n4.1 Preparing Data\nFor this study, we will divide the entire dataset of HDB_master during the period of July 2024 to September 2025 into 2 sets. The training data (Jul 2024 - June 2025) and testing data (July - Sep 2025).\n\n4.1.1 Split data for train/test data\n\nglimpse(HDB_master)\n\nRows: 14,737\nColumns: 29\n$ transact_date               &lt;date&gt; 2024-07-01, 2024-07-01, 2024-07-01, 2024-…\n$ resale_price                &lt;dbl&gt; 528888, 500000, 540000, 500000, 620000, 57…\n$ floor_level                 &lt;dbl&gt; 1, 1, 7, 1, 10, 10, 1, 4, 7, 19, 7, 7, 10,…\n$ plan_area                   &lt;chr&gt; \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", …\n$ floor_area_sqm              &lt;dbl&gt; 91, 93, 91, 91, 97, 92, 91, 97, 94, 88, 10…\n$ flat_model                  &lt;chr&gt; \"New Generation\", \"New Generation\", \"New G…\n$ age                         &lt;dbl&gt; 43, 44, 47, 43, 48, 47, 43, 48, 13, 13, 32…\n$ geometry                    &lt;POINT [m]&gt; POINT (29933.3 38362.35), POINT (300…\n$ remaining_lease_mths_num    &lt;dbl&gt; 680, 668, 631, 680, 621, 631, 680, 620, 10…\n$ PROX_TOPSCHOOL              &lt;dbl&gt; 1139.9957, 1054.7401, 785.8500, 1246.3765,…\n$ PROX_HKCENTER               &lt;dbl&gt; 289.98144, 424.99822, 132.00515, 398.27582…\n$ PROX_SUPERMKT               &lt;dbl&gt; 349.25330, 468.66713, 186.27015, 237.72203…\n$ PROX_CLINIC                 &lt;dbl&gt; 9.399557e+01, 1.415401e+02, 1.011686e+02, …\n$ PROX_ELDERCARE              &lt;dbl&gt; 334.27019, 433.83460, 397.61080, 214.39384…\n$ PROX_MALLS                  &lt;dbl&gt; 712.8886, 946.0851, 959.9848, 726.9160, 45…\n$ PROX_SPORTS                 &lt;dbl&gt; 347.0061, 507.8975, 336.9090, 260.9641, 30…\n$ PROX_CC                     &lt;dbl&gt; 316.95217, 281.23633, 270.59187, 202.78502…\n$ PROX_PARK                   &lt;dbl&gt; 154.24457, 63.25578, 242.55766, 115.96037,…\n$ PROX_MRT                    &lt;dbl&gt; 696.6567, 919.2072, 383.6496, 680.8811, 54…\n$ PROX_CBD                    &lt;dbl&gt; 7080.609, 6861.176, 7868.887, 7107.071, 75…\n$ PROX_BIZPK                  &lt;dbl&gt; 8453.334, 8495.518, 8490.800, 8331.434, 87…\n$ WITHIN_1km_TOPPRISCH        &lt;int&gt; 0, 0, 2, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, …\n$ WITHIN_1km_TOPPRISCH_BINARY &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, …\n$ WITHIN_500m_MRT_BINARY      &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ WITHIN_500m_HKC_BINARY      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ WITHIN_350m_KINDG           &lt;int&gt; 1, 0, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 0, 1, …\n$ WITHIN_350m_CHILDC          &lt;int&gt; 2, 1, 7, 3, 8, 7, 3, 8, 7, 7, 5, 3, 2, 6, …\n$ WITHIN_350m_BUS             &lt;int&gt; 8, 7, 7, 6, 7, 7, 7, 7, 4, 4, 4, 7, 5, 6, …\n$ WITHIN_1km_PRISCH           &lt;int&gt; 3, 2, 3, 3, 3, 3, 3, 3, 2, 2, 3, 3, 2, 3, …\n\n\nWe also use st_jutter() to move the point features by 1m to avoid overlapping point features.\n\n\nCode\nHDB_master_jitter &lt;- HDB_master %&gt;%\n  st_jitter(amoun = 1)\n\nwrite_rds(HDB_master_jitter, \"data/rds/HDB_master_jitter.rds\")\n\n\n\n\nCode\nset.seed(1234)\nHDB_train &lt;- HDB_master_jitter %&gt;%\n  filter(transact_date &gt;= \"2024-07-01\" & transact_date &lt;= \"2025-06-01\") \n\nHDB_test &lt;- HDB_master_jitter %&gt;%\n  filter(transact_date &gt;= \"2025-07-01\" & transact_date &lt;= \"2025-09-01\")\n\nwrite_rds(HDB_train, \"data/rds/HDB_train.rds\")\nwrite_rds(HDB_test, \"data/rds/HDB_test.rds\")\n\n\n\n\n4.1.2 Sample train data\nWe will sample 5,000 data sets for predictive modeling training.\n\nset.seed(1234)\nHDB_train_5k &lt;- HDB_train %&gt;%\n  sample_n(5000)\n\n\n\n\n4.2 Multicollinearity Check\n\n4.2.1 Correlation Matrix\nFirst we need to do a multicollinearity analysis on the predictors. We will create a correlatiom matrix. In this step, we are using this as EDA to explore the data.\n\n\nCode\npar(bg = \"#EEEEEE\",\n    mar = c(0.5, 0.5, 0.5, 0.5)) \ncorrplot(cor(st_drop_geometry(HDB_train_5k)[, c(2, 3, 5, 7, 8:28)]),\n         diag = FALSE, \n         order = \"AOE\",\n         tl.pos = \"td\", \n         tl.cex = 1, \n         tl.srt = 40, \n         tl.col = \"#3A6F43\",\n         number.cex = 0.7,\n         method = \"number\", \n         type = \"upper\",\n         bg = \"#C5C7BC\",\n         addgrid.col = \"#EEEEEE\")         \n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nFrom the scatterplot matrix, it is clear that WITHIN_1km_TOPSCH is highly correlated to WITHIN_1km_TOPSCH_BINARY. In addition, other pairs of variables PROX_TOPSCHOOL & PROX_CBD, age & remaining_lease_mths_num, PROX_MRT & WITHIN_500m_MRT_BINARY are also highly correlated (&gt;0.8 or near 0.8).\nIn view of this, it is wiser to only include either one of them in the subsequent model building. As a result, WITHIN_1km_TOPPRISCH, age, WITHIN_500m_MRT_BINARY and PROX_TOPSCHOOL are excluded in the subsequent model building.\n\n\n\nCode\ntrain_data_corr &lt;- HDB_train_5k %&gt;%\n  select(-WITHIN_1km_TOPPRISCH,\n         -age,\n         -WITHIN_500m_MRT_BINARY,\n         -PROX_TOPSCHOOL)\n\ntest_data_corr &lt;- HDB_test %&gt;%\n  select(-WITHIN_1km_TOPPRISCH,\n         -age,\n         -WITHIN_500m_MRT_BINARY,\n         -PROX_TOPSCHOOL)\n\nwrite_rds(train_data_corr, \"data/rds/train_data_corr.rds\")\nwrite_rds(test_data_corr, \"data/rds/test_data_corr.rds\")\n\n\n\n\n\n\n4.2.2 Initial Models\nAfter collinearity check, we directly removed the highly correlated variables from the datasets. Next we will perform VIF check. A high VIF indicates that a particular predictor variable is highly correlated with other predictors in the model, which can inflate the variance of its coefficient, leading to unstable and unreliable results.\nTherefore, we will check VIF before building the models, using the remaining variables below:\n\n\n [1] \"floor_level\"                 \"plan_area\"                  \n [3] \"floor_area_sqm\"              \"flat_model\"                 \n [5] \"geometry\"                    \"remaining_lease_mths_num\"   \n [7] \"PROX_HKCENTER\"               \"PROX_SUPERMKT\"              \n [9] \"PROX_CLINIC\"                 \"PROX_ELDERCARE\"             \n[11] \"PROX_MALLS\"                  \"PROX_SPORTS\"                \n[13] \"PROX_CC\"                     \"PROX_PARK\"                  \n[15] \"PROX_MRT\"                    \"PROX_CBD\"                   \n[17] \"PROX_BIZPK\"                  \"WITHIN_1km_TOPPRISCH_BINARY\"\n[19] \"WITHIN_500m_HKC_BINARY\"      \"WITHIN_350m_KINDG\"          \n[21] \"WITHIN_350m_CHILDC\"          \"WITHIN_350m_BUS\"            \n[23] \"WITHIN_1km_PRISCH\"          \n\n\nBelow we will start the VIF iteration. For each VIF iteration, we will check the VIF scores, and remove the highest to perform the next iteration until there is no high VIF scores &gt; 10.\n\nVIF1VIF2VIF3\n\n\n\n\nCode\n# Build initial model with all variables\ninitial_mlr1 &lt;- lm(\n  formula = resale_price ~ \n    floor_level + plan_area + floor_area_sqm + flat_model + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT + PROX_CLINIC + PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_PARK + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data = train_data_corr)\nwrite_rds(initial_mlr1, \"data/rds/initial_mlr1.rds\")\n\n\n\n\n\nCall:\nlm(formula = resale_price ~ floor_level + plan_area + floor_area_sqm + \n    flat_model + remaining_lease_mths_num + PROX_HKCENTER + PROX_SUPERMKT + \n    PROX_CLINIC + PROX_ELDERCARE + PROX_MALLS + PROX_SPORTS + \n    PROX_CC + PROX_PARK + PROX_MRT + PROX_CBD + PROX_BIZPK + \n    WITHIN_1km_TOPPRISCH_BINARY + WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH, \n    data = train_data_corr)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-265329  -33636   -2095   30267  233821 \n\nCoefficients:\n                                   Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                       7.970e+04  3.070e+04   2.596 0.009451 ** \nfloor_level                       4.909e+03  1.278e+02  38.417  &lt; 2e-16 ***\nplan_areaBEDOK                   -5.747e+04  9.492e+03  -6.054 1.52e-09 ***\nplan_areaBISHAN                   4.365e+04  8.396e+03   5.198 2.09e-07 ***\nplan_areaBUKIT BATOK             -6.453e+04  8.852e+03  -7.290 3.60e-13 ***\nplan_areaBUKIT MERAH              8.462e+03  1.123e+04   0.753 0.451271    \nplan_areaBUKIT PANJANG           -1.263e+05  8.915e+03 -14.164  &lt; 2e-16 ***\nplan_areaBUKIT TIMAH              1.303e+05  1.687e+04   7.720 1.40e-14 ***\nplan_areaCENTRAL AREA            -3.451e+04  1.671e+04  -2.065 0.038952 *  \nplan_areaCHOA CHU KANG           -1.042e+05  1.044e+04  -9.976  &lt; 2e-16 ***\nplan_areaCLEMENTI                 5.058e+04  9.820e+03   5.151 2.69e-07 ***\nplan_areaGEYLANG                 -2.583e+04  1.061e+04  -2.434 0.014957 *  \nplan_areaHOUGANG                 -9.220e+04  7.181e+03 -12.840  &lt; 2e-16 ***\nplan_areaJURONG EAST             -4.593e+04  1.106e+04  -4.151 3.36e-05 ***\nplan_areaJURONG WEST             -4.417e+04  1.127e+04  -3.920 8.98e-05 ***\nplan_areaKALLANG/WHAMPOA         -8.356e+03  9.575e+03  -0.873 0.382860    \nplan_areaMARINE PARADE            4.060e+04  1.867e+04   2.175 0.029667 *  \nplan_areaPASIR RIS                1.102e+04  9.241e+03   1.193 0.232986    \nplan_areaPUNGGOL                 -1.354e+05  9.448e+03 -14.328  &lt; 2e-16 ***\nplan_areaQUEENSTOWN               6.173e+04  1.194e+04   5.171 2.41e-07 ***\nplan_areaSEMBAWANG               -2.820e+04  1.183e+04  -2.383 0.017191 *  \nplan_areaSENGKANG                -1.584e+05  7.534e+03 -21.027  &lt; 2e-16 ***\nplan_areaSERANGOON                1.061e+04  8.756e+03   1.212 0.225472    \nplan_areaTAMPINES                -2.425e+04  7.888e+03  -3.074 0.002126 ** \nplan_areaTOA PAYOH                2.461e+04  8.448e+03   2.913 0.003591 ** \nplan_areaWOODLANDS               -5.409e+04  1.089e+04  -4.967 7.04e-07 ***\nplan_areaYISHUN                  -3.695e+04  8.923e+03  -4.140 3.52e-05 ***\nfloor_area_sqm                    4.452e+03  2.062e+02  21.590  &lt; 2e-16 ***\nflat_modelImproved               -1.643e+05  9.854e+03 -16.676  &lt; 2e-16 ***\nflat_modelModel A                -8.483e+04  6.438e+03 -13.176  &lt; 2e-16 ***\nflat_modelModel A2               -7.119e+04  8.044e+03  -8.849  &lt; 2e-16 ***\nflat_modelNew Generation         -9.101e+04  7.367e+03 -12.355  &lt; 2e-16 ***\nflat_modelPremium Apartment      -5.410e+04  6.865e+03  -7.880 4.00e-15 ***\nflat_modelPremium Apartment Loft  1.057e+05  2.472e+04   4.275 1.95e-05 ***\nflat_modelSimplified             -5.185e+04  7.795e+03  -6.652 3.21e-11 ***\nflat_modelStandard               -2.153e+05  2.301e+04  -9.357  &lt; 2e-16 ***\nflat_modelType S1                 2.323e+05  1.852e+04  12.543  &lt; 2e-16 ***\nremaining_lease_mths_num          5.189e+02  9.728e+00  53.337  &lt; 2e-16 ***\nPROX_HKCENTER                    -8.918e+00  2.533e+00  -3.521 0.000434 ***\nPROX_SUPERMKT                     2.312e+01  4.954e+00   4.666 3.15e-06 ***\nPROX_CLINIC                      -2.286e+00  7.725e+00  -0.296 0.767332    \nPROX_ELDERCARE                   -1.151e+01  1.850e+00  -6.222 5.31e-10 ***\nPROX_MALLS                       -2.840e+00  2.880e+00  -0.986 0.324172    \nPROX_SPORTS                       1.008e+01  2.906e+00   3.469 0.000527 ***\nPROX_CC                          -2.006e+01  3.405e+00  -5.890 4.13e-09 ***\nPROX_PARK                        -2.092e+01  7.786e+00  -2.687 0.007237 ** \nPROX_MRT                         -8.694e+01  2.926e+00 -29.709  &lt; 2e-16 ***\nPROX_CBD                         -1.466e+01  1.137e+00 -12.892  &lt; 2e-16 ***\nPROX_BIZPK                       -1.811e+00  1.096e+00  -1.653 0.098381 .  \nWITHIN_1km_TOPPRISCH_BINARY       2.031e+04  3.062e+03   6.634 3.61e-11 ***\nWITHIN_500m_HKC_BINARY            7.017e+03  2.345e+03   2.993 0.002780 ** \nWITHIN_350m_KINDG                -8.608e+02  1.021e+03  -0.843 0.399084    \nWITHIN_350m_CHILDC               -4.595e+01  3.959e+02  -0.116 0.907613    \nWITHIN_350m_BUS                   8.209e+02  2.926e+02   2.805 0.005050 ** \nWITHIN_1km_PRISCH                 1.253e+03  7.118e+02   1.761 0.078298 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 50930 on 4945 degrees of freedom\nMultiple R-squared:  0.896, Adjusted R-squared:  0.8949 \nF-statistic: 789.2 on 54 and 4945 DF,  p-value: &lt; 2.2e-16\n\n\n\n\nIn the 2nd iteration, we will remove the highest VIF plan_area.\n\n\nCode\ninitial_mlr2 &lt;- lm(\n  formula = resale_price ~ \n    floor_level + floor_area_sqm + flat_model + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT + PROX_CLINIC + PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_PARK + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data = train_data_corr)\nwrite_rds(initial_mlr2, \"data/rds/initial_mlr2.rds\")\n\n\n\n\n\nCall:\nlm(formula = resale_price ~ floor_level + floor_area_sqm + flat_model + \n    remaining_lease_mths_num + PROX_HKCENTER + PROX_SUPERMKT + \n    PROX_CLINIC + PROX_ELDERCARE + PROX_MALLS + PROX_SPORTS + \n    PROX_CC + PROX_PARK + PROX_MRT + PROX_CBD + PROX_BIZPK + \n    WITHIN_1km_TOPPRISCH_BINARY + WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH, \n    data = train_data_corr)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-216917  -41847     769   41490  328019 \n\nCoefficients:\n                                   Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                       1.326e+05  3.364e+04   3.942 8.18e-05 ***\nfloor_level                       5.578e+03  1.580e+02  35.300  &lt; 2e-16 ***\nfloor_area_sqm                    4.757e+03  2.518e+02  18.890  &lt; 2e-16 ***\nflat_modelImproved               -1.944e+05  1.176e+04 -16.525  &lt; 2e-16 ***\nflat_modelModel A                -1.174e+05  7.971e+03 -14.724  &lt; 2e-16 ***\nflat_modelModel A2               -1.080e+05  9.989e+03 -10.810  &lt; 2e-16 ***\nflat_modelNew Generation         -1.295e+05  9.062e+03 -14.286  &lt; 2e-16 ***\nflat_modelPremium Apartment      -1.069e+05  8.411e+03 -12.703  &lt; 2e-16 ***\nflat_modelPremium Apartment Loft  1.657e+05  3.047e+04   5.438 5.65e-08 ***\nflat_modelSimplified             -7.949e+04  9.715e+03  -8.182 3.51e-16 ***\nflat_modelStandard               -2.153e+05  2.887e+04  -7.459 1.02e-13 ***\nflat_modelType S1                 1.492e+05  1.724e+04   8.653  &lt; 2e-16 ***\nremaining_lease_mths_num          4.477e+02  1.181e+01  37.919  &lt; 2e-16 ***\nPROX_HKCENTER                    -2.943e+01  2.870e+00 -10.254  &lt; 2e-16 ***\nPROX_SUPERMKT                     1.996e+01  5.906e+00   3.379 0.000732 ***\nPROX_CLINIC                      -3.034e+00  9.378e+00  -0.324 0.746290    \nPROX_ELDERCARE                   -1.423e+01  1.712e+00  -8.309  &lt; 2e-16 ***\nPROX_MALLS                       -1.756e+01  3.121e+00  -5.626 1.95e-08 ***\nPROX_SPORTS                       1.590e+01  3.213e+00   4.950 7.65e-07 ***\nPROX_CC                           1.087e-01  3.949e+00   0.028 0.978050    \nPROX_PARK                         1.465e+01  9.408e+00   1.557 0.119473    \nPROX_MRT                         -5.915e+01  3.074e+00 -19.245  &lt; 2e-16 ***\nPROX_CBD                         -1.749e+01  2.875e-01 -60.819  &lt; 2e-16 ***\nPROX_BIZPK                        2.866e+00  4.162e-01   6.886 6.46e-12 ***\nWITHIN_1km_TOPPRISCH_BINARY       5.053e+04  3.260e+03  15.501  &lt; 2e-16 ***\nWITHIN_500m_HKC_BINARY           -7.367e+02  2.806e+03  -0.263 0.792893    \nWITHIN_350m_KINDG                 9.891e+03  1.223e+03   8.090 7.44e-16 ***\nWITHIN_350m_CHILDC               -2.671e+03  4.871e+02  -5.484 4.38e-08 ***\nWITHIN_350m_BUS                   6.765e+02  3.551e+02   1.905 0.056799 .  \nWITHIN_1km_PRISCH                -8.414e+03  7.735e+02 -10.877  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 64690 on 4970 degrees of freedom\nMultiple R-squared:  0.8314,    Adjusted R-squared:  0.8304 \nF-statistic: 845.2 on 29 and 4970 DF,  p-value: &lt; 2.2e-16\n\n\n\n\nIn the 3rd iteration, we will remove the highest VIF flat_model (10.98).\n\n\nCode\n# Build initial model with all variables\ninitial_mlr3 &lt;- lm(\n  formula = resale_price ~ \n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT + PROX_CLINIC + PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_PARK + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data = train_data_corr)\n\nwrite_rds(initial_mlr3, \"data/rds/initial_mlr3.rds\")\n\n\n\n\n\nCall:\nlm(formula = resale_price ~ floor_level + floor_area_sqm + remaining_lease_mths_num + \n    PROX_HKCENTER + PROX_SUPERMKT + PROX_CLINIC + PROX_ELDERCARE + \n    PROX_MALLS + PROX_SPORTS + PROX_CC + PROX_PARK + PROX_MRT + \n    PROX_CBD + PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + WITHIN_500m_HKC_BINARY + \n    WITHIN_350m_KINDG + WITHIN_350m_CHILDC + WITHIN_350m_BUS + \n    WITHIN_1km_PRISCH, data = train_data_corr)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-241242  -46501     243   44676  363447 \n\nCoefficients:\n                              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                 18618.1694 18866.9810   0.987 0.323783    \nfloor_level                  6111.9588   168.9020  36.186  &lt; 2e-16 ***\nfloor_area_sqm               4519.9072   160.3557  28.187  &lt; 2e-16 ***\nremaining_lease_mths_num      470.5848     6.9191  68.013  &lt; 2e-16 ***\nPROX_HKCENTER                 -29.7771     3.1054  -9.589  &lt; 2e-16 ***\nPROX_SUPERMKT                  21.0631     6.3281   3.328 0.000880 ***\nPROX_CLINIC                    -2.8728    10.0524  -0.286 0.775057    \nPROX_ELDERCARE                -13.4725     1.8511  -7.278 3.92e-13 ***\nPROX_MALLS                    -18.8556     3.3476  -5.633 1.87e-08 ***\nPROX_SPORTS                    20.2449     3.2844   6.164 7.65e-10 ***\nPROX_CC                       -13.0977     4.2287  -3.097 0.001964 ** \nPROX_PARK                      -1.3213    10.1503  -0.130 0.896431    \nPROX_MRT                      -58.4483     3.2705 -17.871  &lt; 2e-16 ***\nPROX_CBD                      -17.6339     0.3060 -57.620  &lt; 2e-16 ***\nPROX_BIZPK                      3.2273     0.4446   7.259 4.51e-13 ***\nWITHIN_1km_TOPPRISCH_BINARY 48496.5049  3491.3636  13.890  &lt; 2e-16 ***\nWITHIN_500m_HKC_BINARY      -8711.9213  3009.8156  -2.895 0.003814 ** \nWITHIN_350m_KINDG            8954.0938  1319.2330   6.787 1.28e-11 ***\nWITHIN_350m_CHILDC          -1478.5236   523.4964  -2.824 0.004757 ** \nWITHIN_350m_BUS              1375.4902   381.8684   3.602 0.000319 ***\nWITHIN_1km_PRISCH           -9460.8222   810.3083 -11.676  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 70150 on 4979 degrees of freedom\nMultiple R-squared:  0.8014,    Adjusted R-squared:  0.8006 \nF-statistic:  1005 on 20 and 4979 DF,  p-value: &lt; 2.2e-16\n\n\n\n\n\nCheck for multicollinearity and plot VIF scores\n\nVIF1VIF2VIF3\n\n\nBased on the following VIF scores, 4 variables are in the High Correlation category, with plan_area of 1.20e+05 being the highest.\n\n\nCode\ncheck_collinearity(initial_mlr1)\n\n\n# Check for Multicollinearity\n\nLow Correlation\n\n                        Term  VIF           VIF 95% CI adj. VIF Tolerance\n                 floor_level 1.35 [    1.31,     1.40]     1.16      0.74\n              floor_area_sqm 3.56 [    3.40,     3.73]     1.89      0.28\n               PROX_HKCENTER 2.69 [    2.57,     2.81]     1.64      0.37\n               PROX_SUPERMKT 1.46 [    1.41,     1.52]     1.21      0.68\n                 PROX_CLINIC 1.35 [    1.30,     1.40]     1.16      0.74\n              PROX_ELDERCARE 2.63 [    2.51,     2.75]     1.62      0.38\n                  PROX_MALLS 2.11 [    2.03,     2.21]     1.45      0.47\n                 PROX_SPORTS 1.83 [    1.76,     1.90]     1.35      0.55\n                     PROX_CC 1.62 [    1.57,     1.69]     1.27      0.62\n                   PROX_PARK 1.21 [    1.17,     1.25]     1.10      0.83\n                    PROX_MRT 2.36 [    2.26,     2.47]     1.54      0.42\n WITHIN_1km_TOPPRISCH_BINARY 1.70 [    1.64,     1.77]     1.30      0.59\n      WITHIN_500m_HKC_BINARY 2.48 [    2.38,     2.60]     1.58      0.40\n           WITHIN_350m_KINDG 2.21 [    2.12,     2.31]     1.49      0.45\n          WITHIN_350m_CHILDC 2.34 [    2.24,     2.44]     1.53      0.43\n             WITHIN_350m_BUS 1.33 [    1.29,     1.38]     1.15      0.75\n           WITHIN_1km_PRISCH 2.31 [    2.22,     2.42]     1.52      0.43\n Tolerance 95% CI\n     [0.71, 0.76]\n     [0.27, 0.29]\n     [0.36, 0.39]\n     [0.66, 0.71]\n     [0.72, 0.77]\n     [0.36, 0.40]\n     [0.45, 0.49]\n     [0.53, 0.57]\n     [0.59, 0.64]\n     [0.80, 0.85]\n     [0.41, 0.44]\n     [0.57, 0.61]\n     [0.39, 0.42]\n     [0.43, 0.47]\n     [0.41, 0.45]\n     [0.72, 0.78]\n     [0.41, 0.45]\n\nModerate Correlation\n\n                     Term  VIF           VIF 95% CI adj. VIF Tolerance\n remaining_lease_mths_num 5.22 [    4.97,     5.49]     2.28      0.19\n Tolerance 95% CI\n     [0.18, 0.20]\n\nHigh Correlation\n\n       Term      VIF           VIF 95% CI adj. VIF Tolerance Tolerance 95% CI\n  plan_area 1.20e+05 [1.13e+05, 1.27e+05]   346.12  8.35e-06     [0.00, 0.00]\n flat_model    44.29 [   41.96,    46.76]     6.66      0.02     [0.02, 0.02]\n   PROX_CBD    48.86 [   46.28,    51.58]     6.99      0.02     [0.02, 0.02]\n PROX_BIZPK    13.85 [   13.14,    14.60]     3.72      0.07     [0.07, 0.08]\n\n\n\n\nCode\nmlr1.vif &lt;- check_collinearity(initial_mlr1)\nplot(mlr1.vif) +\n  theme_minimal() +\n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\", color = NA),\n    panel.background = element_rect(fill = \"gray95\", color = NA),\n    axis.text.x = element_text(angle = 35, hjust = 1, vjust = 1, size = 5)\n  )\n\n\n\n\n\n\n\n\n\n\n\nAfter removing plan_area from VIF1, 1 variable remains in the High Correlation category, with flat_model of 10.98 being the highest.\n\n\nCode\ncheck_collinearity(initial_mlr2)\n\n\n# Check for Multicollinearity\n\nLow Correlation\n\n                        Term  VIF     VIF 95% CI adj. VIF Tolerance\n                 floor_level 1.28 [ 1.24,  1.33]     1.13      0.78\n              floor_area_sqm 3.29 [ 3.14,  3.45]     1.81      0.30\n    remaining_lease_mths_num 4.77 [ 4.54,  5.01]     2.18      0.21\n               PROX_HKCENTER 2.14 [ 2.05,  2.23]     1.46      0.47\n               PROX_SUPERMKT 1.29 [ 1.25,  1.33]     1.13      0.78\n                 PROX_CLINIC 1.23 [ 1.19,  1.28]     1.11      0.81\n              PROX_ELDERCARE 1.39 [ 1.35,  1.45]     1.18      0.72\n                  PROX_MALLS 1.54 [ 1.48,  1.60]     1.24      0.65\n                 PROX_SPORTS 1.38 [ 1.34,  1.43]     1.18      0.72\n                     PROX_CC 1.35 [ 1.31,  1.40]     1.16      0.74\n                   PROX_PARK 1.09 [ 1.07,  1.13]     1.05      0.91\n                    PROX_MRT 1.61 [ 1.56,  1.68]     1.27      0.62\n                    PROX_CBD 1.94 [ 1.86,  2.02]     1.39      0.52\n                  PROX_BIZPK 1.24 [ 1.20,  1.28]     1.11      0.81\n WITHIN_1km_TOPPRISCH_BINARY 1.19 [ 1.16,  1.24]     1.09      0.84\n      WITHIN_500m_HKC_BINARY 2.20 [ 2.11,  2.30]     1.48      0.45\n           WITHIN_350m_KINDG 1.97 [ 1.89,  2.05]     1.40      0.51\n          WITHIN_350m_CHILDC 2.19 [ 2.10,  2.29]     1.48      0.46\n             WITHIN_350m_BUS 1.21 [ 1.18,  1.26]     1.10      0.82\n           WITHIN_1km_PRISCH 1.69 [ 1.63,  1.76]     1.30      0.59\n Tolerance 95% CI\n     [0.75, 0.80]\n     [0.29, 0.32]\n     [0.20, 0.22]\n     [0.45, 0.49]\n     [0.75, 0.80]\n     [0.78, 0.84]\n     [0.69, 0.74]\n     [0.63, 0.67]\n     [0.70, 0.75]\n     [0.71, 0.76]\n     [0.88, 0.94]\n     [0.60, 0.64]\n     [0.50, 0.54]\n     [0.78, 0.83]\n     [0.81, 0.86]\n     [0.43, 0.47]\n     [0.49, 0.53]\n     [0.44, 0.48]\n     [0.79, 0.85]\n     [0.57, 0.61]\n\nHigh Correlation\n\n       Term   VIF     VIF 95% CI adj. VIF Tolerance Tolerance 95% CI\n flat_model 10.98 [10.42, 11.58]     3.31      0.09     [0.09, 0.10]\n\n\n\n\nCode\nmlr2.vif &lt;- check_collinearity(initial_mlr2)\nplot(mlr2.vif) +\n    theme_minimal() +\n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\", color = NA),\n    panel.background = element_rect(fill = \"gray95\", color = NA),\n    axis.text.x = element_text(angle = 35, hjust = 1, vjust = 1, size = 5)\n  )\n\n\n\n\n\n\n\n\n\n\n\nAt the 3rd iteration, we see all remaining variables are all low correlated.\n\n\nCode\ncheck_collinearity(initial_mlr3)\n\n\n# Check for Multicollinearity\n\nLow Correlation\n\n                        Term  VIF   VIF 95% CI adj. VIF Tolerance\n                 floor_level 1.25 [1.21, 1.29]     1.12      0.80\n              floor_area_sqm 1.13 [1.10, 1.17]     1.07      0.88\n    remaining_lease_mths_num 1.39 [1.35, 1.44]     1.18      0.72\n               PROX_HKCENTER 2.13 [2.05, 2.23]     1.46      0.47\n               PROX_SUPERMKT 1.26 [1.22, 1.30]     1.12      0.80\n                 PROX_CLINIC 1.20 [1.17, 1.25]     1.10      0.83\n              PROX_ELDERCARE 1.39 [1.34, 1.44]     1.18      0.72\n                  PROX_MALLS 1.51 [1.45, 1.56]     1.23      0.66\n                 PROX_SPORTS 1.23 [1.19, 1.27]     1.11      0.81\n                     PROX_CC 1.32 [1.28, 1.37]     1.15      0.76\n                   PROX_PARK 1.08 [1.06, 1.12]     1.04      0.92\n                    PROX_MRT 1.55 [1.50, 1.62]     1.25      0.64\n                    PROX_CBD 1.87 [1.79, 1.94]     1.37      0.54\n                  PROX_BIZPK 1.20 [1.17, 1.24]     1.10      0.83\n WITHIN_1km_TOPPRISCH_BINARY 1.16 [1.13, 1.21]     1.08      0.86\n      WITHIN_500m_HKC_BINARY 2.16 [2.07, 2.25]     1.47      0.46\n           WITHIN_350m_KINDG 1.95 [1.87, 2.03]     1.40      0.51\n          WITHIN_350m_CHILDC 2.15 [2.06, 2.25]     1.47      0.46\n             WITHIN_350m_BUS 1.20 [1.16, 1.24]     1.09      0.84\n           WITHIN_1km_PRISCH 1.58 [1.52, 1.64]     1.26      0.63\n Tolerance 95% CI\n     [0.77, 0.83]\n     [0.85, 0.91]\n     [0.69, 0.74]\n     [0.45, 0.49]\n     [0.77, 0.82]\n     [0.80, 0.86]\n     [0.70, 0.75]\n     [0.64, 0.69]\n     [0.79, 0.84]\n     [0.73, 0.78]\n     [0.89, 0.95]\n     [0.62, 0.67]\n     [0.51, 0.56]\n     [0.80, 0.86]\n     [0.83, 0.88]\n     [0.44, 0.48]\n     [0.49, 0.53]\n     [0.44, 0.48]\n     [0.81, 0.86]\n     [0.61, 0.66]\n\n\n\n\nCode\nmlr3.vif &lt;- check_collinearity(initial_mlr3)\nplot(mlr3.vif) +\n  theme_minimal() +\n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\", color = NA),\n    panel.background = element_rect(fill = \"gray95\", color = NA),\n    axis.text.x = element_text(angle = 35, hjust = 1, vjust = 1, size = 5)\n  )\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n4.3 Feature Selection\nFinal feature list for modeling\nAfter 3 iterations of removing high VIF variables, all VIF are now below 10. So we can conclude that there are no sign of multicollinearity among the independent variables.\nBased on the multicollinearity measuring results from VIF3, we find that some variables are not statistically significant, including PROX_CLINIC and PROX_PARK. We will revise the initial model by removing these 2 variables.\nTotal original dataset size\nTotal original dataset size was 14,737 observations, and we divided them into train set from July 2024 to June 2025 and test set from July - Sep 2025. Among 11,680 data sets during July 2024 - June 2025, we also have randomly sampled 5,000 just for training data to calibrate the machine learning models properly.\nThe rest of 3,057 obervations from July - September 2025 are test data for predictions."
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#predictive-modeling",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#predictive-modeling",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "PREDICTIVE MODELING",
    "text": "PREDICTIVE MODELING\nFrom section 5 to 6, we will calibrate 4 predictive modeling for HDB resale price using the same set of variables for a comparison and then predict the prices using the test data. The models include Multi Linear Regression model (MLR), Geographycally Weighed Regression (GWR) model, Non-spatial Random Forest model, as well as Geographical Weighted Random Forest (gwRF) model."
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#model-calibration",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#model-calibration",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "5 Model Calibration",
    "text": "5 Model Calibration\n\n5.1 MLR5.2 GWR5.3 RF5.4 GWRF\n\n\n\n5.1.1 Model calibration\nMultiple Linear Regression Building upon the initial MLR model from section 4.2.2, we calibrate the revised MLR model as below. PROX_CLINIC and PROX_PARK will be removed.\n\n\nCode\nhdb.mlr &lt;- lm(\n  formula = resale_price ~ \n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT +PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data = train_data_corr)\nwrite_rds(hdb.mlr, \"data/rds/hdb.mlr\")\n\n\n\n\n\nCall:\nlm(formula = resale_price ~ floor_level + floor_area_sqm + remaining_lease_mths_num + \n    PROX_HKCENTER + PROX_SUPERMKT + PROX_ELDERCARE + PROX_MALLS + \n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD + PROX_BIZPK + \n    WITHIN_1km_TOPPRISCH_BINARY + WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH, \n    data = train_data_corr)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-240331  -46575     262   44702  363279 \n\nCoefficients:\n                              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                 17984.8996 18744.6778   0.959 0.337370    \nfloor_level                  6110.0999   168.7308  36.212  &lt; 2e-16 ***\nfloor_area_sqm               4516.4400   159.9347  28.239  &lt; 2e-16 ***\nremaining_lease_mths_num      470.9581     6.8089  69.168  &lt; 2e-16 ***\nPROX_HKCENTER                 -29.8090     3.1031  -9.606  &lt; 2e-16 ***\nPROX_SUPERMKT                  20.5809     6.0639   3.394 0.000694 ***\nPROX_ELDERCARE                -13.5064     1.8403  -7.339 2.49e-13 ***\nPROX_MALLS                    -18.7625     3.3278  -5.638 1.81e-08 ***\nPROX_SPORTS                    20.2944     3.2784   6.190 6.49e-10 ***\nPROX_CC                       -13.1036     4.2277  -3.099 0.001950 ** \nPROX_MRT                      -58.5379     3.2571 -17.972  &lt; 2e-16 ***\nPROX_CBD                      -17.6407     0.3048 -57.880  &lt; 2e-16 ***\nPROX_BIZPK                      3.2389     0.4418   7.331 2.65e-13 ***\nWITHIN_1km_TOPPRISCH_BINARY 48512.2547  3488.1703  13.908  &lt; 2e-16 ***\nWITHIN_500m_HKC_BINARY      -8729.7068  3008.7131  -2.901 0.003730 ** \nWITHIN_350m_KINDG            8916.9919  1313.3237   6.790 1.26e-11 ***\nWITHIN_350m_CHILDC          -1468.6895   522.3372  -2.812 0.004946 ** \nWITHIN_350m_BUS              1380.1798   376.6727   3.664 0.000251 ***\nWITHIN_1km_PRISCH           -9449.7173   807.9072 -11.697  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 70130 on 4981 degrees of freedom\nMultiple R-squared:  0.8014,    Adjusted R-squared:  0.8007 \nF-statistic:  1117 on 18 and 4981 DF,  p-value: &lt; 2.2e-16\n\n\nThe output above reveals that all explanatory variables are statistically significant at 95% confident level.\n\n\n5.1.2 MLR Model calibration result\nWe use tbl_regression() to create a regression report for MLR.\n\n\nCode\ntbl_regression(hdb.mlr, \n               intercept = TRUE) %&gt;% \n  add_glance_source_note(\n    label = list(sigma ~ \"\\U03C3\"),\n    include = c(r.squared, adj.r.squared, \n                AIC, statistic,\n                p.value, sigma)) %&gt;%\n  modify_table_styling(\n    columns = label,\n    rows = variable %in% c(\"flat_type\", \"floor_range\"),\n    footnote = \"Categorical variable\"\n  ) %&gt;%\n  bold_labels()\n\n\n\n\n\n\n\n\nCharacteristic\nBeta\n95% CI\np-value\n\n\n\n\n(Intercept)\n17,985\n-18,763, 54,733\n0.3\n\n\nfloor_level\n6,110\n5,779, 6,441\n&lt;0.001\n\n\nfloor_area_sqm\n4,516\n4,203, 4,830\n&lt;0.001\n\n\nremaining_lease_mths_num\n471\n458, 484\n&lt;0.001\n\n\nPROX_HKCENTER\n-30\n-36, -24\n&lt;0.001\n\n\nPROX_SUPERMKT\n21\n8.7, 32\n&lt;0.001\n\n\nPROX_ELDERCARE\n-14\n-17, -9.9\n&lt;0.001\n\n\nPROX_MALLS\n-19\n-25, -12\n&lt;0.001\n\n\nPROX_SPORTS\n20\n14, 27\n&lt;0.001\n\n\nPROX_CC\n-13\n-21, -4.8\n0.002\n\n\nPROX_MRT\n-59\n-65, -52\n&lt;0.001\n\n\nPROX_CBD\n-18\n-18, -17\n&lt;0.001\n\n\nPROX_BIZPK\n3.2\n2.4, 4.1\n&lt;0.001\n\n\nWITHIN_1km_TOPPRISCH_BINARY\n48,512\n41,674, 55,351\n&lt;0.001\n\n\nWITHIN_500m_HKC_BINARY\n-8,730\n-14,628, -2,831\n0.004\n\n\nWITHIN_350m_KINDG\n8,917\n6,342, 11,492\n&lt;0.001\n\n\nWITHIN_350m_CHILDC\n-1,469\n-2,493, -445\n0.005\n\n\nWITHIN_350m_BUS\n1,380\n642, 2,119\n&lt;0.001\n\n\nWITHIN_1km_PRISCH\n-9,450\n-11,034, -7,866\n&lt;0.001\n\n\n\nAbbreviation: CI = Confidence Interval\n\n\nR² = 0.801; Adjusted R² = 0.801; AIC = 125,792; Statistic = 1,117; p-value = &lt;0.001; σ = 70,132\n\n\n\n\n\n\n\n\n\n\n\nWe will use Geographically Weighted Regression to build a Hedonic Pricing Model in this section.\n\n5.2.1 Bandwidth selection\nAdaptive bandwidth is the chosen approach for the GWR modeling as Singapore has varying spatial density of the housing.\nBelow we will use Cross Validation (CV) approach to compuete the Bandwidth:\nThe result below shows that the 48 is the recommended data points to be used.\n\n\nCode\nbw.adaptive &lt;- bw.gwr(\n  formula = resale_price ~ \n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT +PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data=train_data_corr, \n  approach=\"CV\", \n  kernel=\"gaussian\", \n  adaptive=TRUE, \n  longlat=FALSE)\n\nwrite_rds(bw.adaptive, \"data/rds/bw.adaptive.rds\")\n\n\n\n\n5.2.2 Model calibration\nNow we will calibrate the GWR-based hedonic pricing model using the adaptive bandwidth from section 5.2.1 and gaussian kernel.\n\n\nCode\ngwr.adaptive &lt;- gwr.basic(\n  formula = resale_price ~ \n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT +PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data = train_data_corr, \n  bw = bw.adaptive, \n  kernel = 'gaussian', \n  adaptive=TRUE, \n  longlat = FALSE)\n\nwrite_rds(gwr.adaptive, \"data/model/gwr.adaptive.rds\")\n\n\n\n\n5.2.3 GRW Model calibration\n\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2025-11-16 21:02:16.20895 \n   Call:\n   gwr.basic(formula = resale_price ~ floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + PROX_SUPERMKT + \n    PROX_ELDERCARE + PROX_MALLS + PROX_SPORTS + PROX_CC + PROX_MRT + \n    PROX_CBD + PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + WITHIN_500m_HKC_BINARY + \n    WITHIN_350m_KINDG + WITHIN_350m_CHILDC + WITHIN_350m_BUS + \n    WITHIN_1km_PRISCH, data = train_data_corr, bw = bw.adaptive, \n    kernel = \"gaussian\", adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  resale_price\n   Independent variables:  floor_level floor_area_sqm remaining_lease_mths_num PROX_HKCENTER PROX_SUPERMKT PROX_ELDERCARE PROX_MALLS PROX_SPORTS PROX_CC PROX_MRT PROX_CBD PROX_BIZPK WITHIN_1km_TOPPRISCH_BINARY WITHIN_500m_HKC_BINARY WITHIN_350m_KINDG WITHIN_350m_CHILDC WITHIN_350m_BUS WITHIN_1km_PRISCH\n   Number of data points: 5000\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n    Min      1Q  Median      3Q     Max \n-240331  -46575     262   44702  363279 \n\n   Coefficients:\n                                 Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)                 17984.8996 18744.6778   0.959 0.337370    \n   floor_level                  6110.0999   168.7308  36.212  &lt; 2e-16 ***\n   floor_area_sqm               4516.4400   159.9347  28.239  &lt; 2e-16 ***\n   remaining_lease_mths_num      470.9581     6.8089  69.168  &lt; 2e-16 ***\n   PROX_HKCENTER                 -29.8090     3.1031  -9.606  &lt; 2e-16 ***\n   PROX_SUPERMKT                  20.5809     6.0639   3.394 0.000694 ***\n   PROX_ELDERCARE                -13.5064     1.8403  -7.339 2.49e-13 ***\n   PROX_MALLS                    -18.7625     3.3278  -5.638 1.81e-08 ***\n   PROX_SPORTS                    20.2944     3.2784   6.190 6.49e-10 ***\n   PROX_CC                       -13.1036     4.2277  -3.099 0.001950 ** \n   PROX_MRT                      -58.5379     3.2571 -17.972  &lt; 2e-16 ***\n   PROX_CBD                      -17.6407     0.3048 -57.880  &lt; 2e-16 ***\n   PROX_BIZPK                      3.2389     0.4418   7.331 2.65e-13 ***\n   WITHIN_1km_TOPPRISCH_BINARY 48512.2547  3488.1703  13.908  &lt; 2e-16 ***\n   WITHIN_500m_HKC_BINARY      -8729.7068  3008.7131  -2.901 0.003730 ** \n   WITHIN_350m_KINDG            8916.9919  1313.3237   6.790 1.26e-11 ***\n   WITHIN_350m_CHILDC          -1468.6895   522.3372  -2.812 0.004946 ** \n   WITHIN_350m_BUS              1380.1798   376.6727   3.664 0.000251 ***\n   WITHIN_1km_PRISCH           -9449.7173   807.9072 -11.697  &lt; 2e-16 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 70130 on 4981 degrees of freedom\n   Multiple R-squared: 0.8014\n   Adjusted R-squared: 0.8007 \n   F-statistic:  1117 on 18 and 4981 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 2.449886e+13\n   Sigma(hat): 70012.38\n   AIC:  125791.7\n   AICc:  125791.8\n   BIC:  121092.3\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Adaptive bandwidth: 48 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                                       Min.      1st Qu.       Median\n   Intercept                    -1.2049e+07  -3.4749e+05   1.1842e+04\n   floor_level                   1.8438e+03   4.0224e+03   4.7935e+03\n   floor_area_sqm               -3.7533e+04   2.4869e+03   3.3295e+03\n   remaining_lease_mths_num     -2.2305e+03   3.5143e+02   4.2355e+02\n   PROX_HKCENTER                -3.1333e+02  -4.2946e+01  -9.7345e+00\n   PROX_SUPERMKT                -4.2869e+02  -4.0528e+01  -9.0416e+00\n   PROX_ELDERCARE               -1.3715e+03  -2.9520e+01   1.4168e+00\n   PROX_MALLS                   -4.0822e+05  -4.8520e+01  -1.6936e+01\n   PROX_SPORTS                  -1.1406e+04  -2.6529e+01  -2.5297e+00\n   PROX_CC                      -1.8800e+04  -3.7045e+01  -8.9590e+00\n   PROX_MRT                     -3.2236e+03  -1.2507e+02  -7.0820e+01\n   PROX_CBD                     -5.5311e+03  -3.9295e+01  -9.9533e+00\n   PROX_BIZPK                   -9.9768e+02  -2.2741e+01   2.1464e+00\n   WITHIN_1km_TOPPRISCH_BINARY -9.2707e+197  -3.7931e+04   1.6981e+04\n   WITHIN_500m_HKC_BINARY       -2.1467e+05  -1.4651e+04   2.6422e+03\n   WITHIN_350m_KINDG            -2.2369e+05  -1.0531e+04  -3.6266e+03\n   WITHIN_350m_CHILDC           -9.7717e+03  -1.6724e+03   3.2935e+02\n   WITHIN_350m_BUS              -7.0230e+03  -1.3048e+03   3.8400e+02\n   WITHIN_1km_PRISCH            -6.6263e+05  -5.7406e+03  -2.7017e+02\n                                    3rd Qu.        Max.\n   Intercept                     4.9035e+05  7.0323e+07\n   floor_level                   5.6303e+03  7.8355e+03\n   floor_area_sqm                4.8362e+03  2.4681e+04\n   remaining_lease_mths_num      6.5172e+02  9.7312e+02\n   PROX_HKCENTER                 3.7519e+01  3.2140e+02\n   PROX_SUPERMKT                 3.0588e+01  3.8103e+02\n   PROX_ELDERCARE                2.6409e+01  4.2582e+03\n   PROX_MALLS                    2.6397e+01  2.0714e+04\n   PROX_SPORTS                   3.6079e+01  1.0173e+03\n   PROX_CC                       2.7203e+01  3.9383e+05\n   PROX_MRT                     -3.2395e+01  2.5332e+04\n   PROX_CBD                      1.2959e+01  8.2089e+02\n   PROX_BIZPK                    2.6302e+01  2.9076e+03\n   WITHIN_1km_TOPPRISCH_BINARY   2.1687e+05 4.6772e+198\n   WITHIN_500m_HKC_BINARY        1.7253e+04  1.1974e+05\n   WITHIN_350m_KINDG             3.7494e+03  4.3950e+04\n   WITHIN_350m_CHILDC            2.9321e+03  4.2262e+04\n   WITHIN_350m_BUS               2.0789e+03  1.1532e+04\n   WITHIN_1km_PRISCH             4.3412e+03  2.4644e+04\n   ************************Diagnostic information*************************\n   Number of data points: 5000 \n   Effective number of parameters (2trace(S) - trace(S'S)): 918.0333 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 4081.967 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 119053.8 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 118063.3 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 118584.3 \n   Residual sum of squares: 4.545136e+12 \n   R-square value:  0.9631548 \n   Adjusted R-square value:  0.9548663 \n\n   ***********************************************************************\n   Program stops at: 2025-11-16 21:02:25.845373 \n\n\n\n\n\nIn this section, we want to calibrate a model to predict HDB resale price using the Random Forest method.\n\n5.3.1 Data preparation\nFirst is to extract the x, y coordinates of the training and test data sets.\n\n\nCode\ncoords &lt;- st_coordinates(HDB_master_jitter)\ncoords_train &lt;- st_coordinates(train_data_corr)\ncoords_test &lt;- st_coordinates(test_data_corr)\n\nwrite_rds(coords_train, \"data/rds/coords_train.rds\")\nwrite_rds(coords_test, \"data/rds/coords_test.rds\")\n\n\nDrop geometry field\n\ntrain_data_nogeom &lt;- train_data_corr %&gt;%\n  st_drop_geometry()\n\ntest_data_nogeom &lt;- test_data_corr %&gt;%\n  st_drop_geometry()\n\n\n\n5.3.2 Calibrate non-spatial RF model with ranger()\n\n\nCode\nset.seed(1234)\nrf &lt;- ranger(\n  formula = resale_price ~ \n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT +PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data = train_data_nogeom\n)\n\nwrite_rds(rf, \"data/model/rf.rds\")\n\n\n\n\n5.3.3 RF Model calibration\n\n\nRanger result\n\nCall:\n ranger(formula = resale_price ~ floor_level + floor_area_sqm +      remaining_lease_mths_num + PROX_HKCENTER + PROX_SUPERMKT +      PROX_ELDERCARE + PROX_MALLS + PROX_SPORTS + PROX_CC + PROX_MRT +      PROX_CBD + PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + WITHIN_500m_HKC_BINARY +      WITHIN_350m_KINDG + WITHIN_350m_CHILDC + WITHIN_350m_BUS +      WITHIN_1km_PRISCH, data = train_data_nogeom) \n\nType:                             Regression \nNumber of trees:                  500 \nSample size:                      5000 \nNumber of independent variables:  18 \nMtry:                             4 \nTarget node size:                 5 \nVariable importance mode:         none \nSplitrule:                        variance \nOOB prediction error (MSE):       1459767353 \nR squared (OOB):                  0.9408438 \n\n\n\n\n\nIn this section, we will calibrate Geographical Weighted Random Forest Model with the training data.\n\n5.4.1 Bandwidth selection\nWe will use GWR Bandwidth for GWRF: bw.adaptive.\n\n\n5.4.2 Model calibration\n\n\nCode\nset.seed(1234)\ngwRF_adaptive &lt;- grf(\n  formula = resale_price ~ \n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT +PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  dframe = train_data_nogeom, \n  bw = bw.adaptive,\n  kernel = \"adaptive\",\n  coords = coords_train,\n  ntree = 500,\n  mtry = 3)\n\nwrite_rds(gwRF_adaptive, \"data/model/gwRF_adaptive.rds\")\n\n\n\n\n5.4.3 gwRF Model calibration result\n\n\nCode\ngwRF_adaptive &lt;- read_rds(\"data/model/gwRF_adaptive.rds\")\ngwRF_adaptive$LocalModelSummary\n\n\n$l.VariableImportance\n                                  Min          Max        Mean         StD\nfloor_level                 542488469 410275437511 28189032660 45708854982\nfloor_area_sqm                      0 571507879400 28150900835 55009340082\nremaining_lease_mths_num    900986388 623058798310 57623410530 96688516999\nPROX_HKCENTER               413305074 431871320053 20045225156 34909923327\nPROX_SUPERMKT               379356298 622569970173 19054621819 41053040974\nPROX_ELDERCARE              446615197 399390161689 20454753437 36649562589\nPROX_MALLS                  416160193 331271908424 20689325809 32503530990\nPROX_SPORTS                 481791185 277757020031 18799887259 33293493181\nPROX_CC                     491092956 518543635280 20839974811 40920669707\nPROX_MRT                    428424579 427597697083 19516296558 32706153156\nPROX_CBD                    314609442 355908407481 21019515707 35952222753\nPROX_BIZPK                  420210994 318463583298 19479421208 31370709325\nWITHIN_1km_TOPPRISCH_BINARY         0 108493009910   951050624  4890233814\nWITHIN_500m_HKC_BINARY              0 187713638181  2532115068 10175776165\nWITHIN_350m_KINDG                   0 167314311957  4483184939 11515753172\nWITHIN_350m_CHILDC          129214786 366864470252 11549134264 29890189641\nWITHIN_350m_BUS             155366433 249032878802  9567379333 16437902318\nWITHIN_1km_PRISCH                   0 144862777382  4464304081  9919445580\n\n$l.MSE.OOB\n[1] 2101309087\n\n$l.r.OOB\n[1] 0.9148286\n\n$l.MSE.Pred\n[1] 209480669\n\n$l.r.Pred\n[1] 0.9915092"
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#predictions-with-test-data",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#predictions-with-test-data",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "6 Predictions with Test Data",
    "text": "6 Predictions with Test Data\n\n6.1 MLR6.2 GWR6.3 RF6.4 GWRF\n\n\n\n6.1.1 Predict with test data\n\n\nCode\nmlr_pred &lt;- predict(hdb.mlr, newdata = test_data_corr)\nwrite_rds(mlr_pred, \"data/model/mlr_pred.rds\")\n\n\n\n\n6.1.2 Append predicted values to the test dataset\n\n\nCode\nmlr_pred &lt;- read_rds(\"data/model/mlr_pred.rds\")\n\ntest_data_p_mlr &lt;- test_data_corr %&gt;%\n  mutate(mlr_pred = mlr_pred)\n\nkable(head(test_data_p_mlr))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\ngeometry\nremaining_lease_mths_num\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\nWITHIN_350m_CHILDC\nWITHIN_350m_BUS\nWITHIN_1km_PRISCH\nmlr_pred\n\n\n\n\n2025-07-01\n553000\n7\nANG MO KIO\n91\nNew Generation\nPOINT (30037.03 38360.07)\n668\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n603925.5\n\n\n2025-07-01\n630000\n7\nANG MO KIO\n97\nNew Generation\nPOINT (29298.64 38701.65)\n609\n434.3653\n350.4851\n115.6550\n270.2289\n506.7800\n291.6684\n485.2871\n177.4983\n596.5165\n7527.047\n8767.339\n0\n1\n1\n6\n6\n3\n598333.1\n\n\n2025-07-01\n550000\n7\nANG MO KIO\n91\nNew Generation\nPOINT (28566.95 38862.09)\n618\n132.0052\n186.2702\n101.1686\n397.6108\n959.9848\n336.9090\n270.5919\n242.5577\n383.6496\n7868.887\n8490.800\n1\n1\n2\n7\n7\n3\n637489.7\n\n\n2025-07-01\n878000\n4\nANG MO KIO\n95\nModel A\nPOINT (29237.64 38669.02)\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n770542.4\n\n\n2025-07-01\n966000\n19\nANG MO KIO\n97\nModel A\nPOINT (29237.37 38669.73)\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n871226.8\n\n\n2025-07-01\n520000\n1\nANG MO KIO\n91\nNew Generation\nPOINT (30036.09 38361.03)\n667\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n566793.9\n\n\n\n\n\n\n\n6.1.3 Calculate performance metrics\nCalculate RMSE, MAE and R^2 metrics\n\n\nCode\n# RMSE\nrmse_mlr &lt;- sqrt(mean((test_data_p_mlr$resale_price - test_data_p_mlr$mlr_pred)^2))\n\n# MAE\nmae_mlr &lt;- mean(abs(test_data_p_mlr$resale_price - test_data_p_mlr$mlr_pred))\n\n# R^2\nss_res &lt;- sum((test_data_p_mlr$resale_price - test_data_p_mlr$mlr_pred)^2)\nss_tot &lt;- sum((test_data_p_mlr$resale_price - mean(test_data_p_mlr$resale_price))^2)\nr2_mlr &lt;- 1 - (ss_res / ss_tot)\n\ncat(\"MLR RMSE:\", format(rmse_mlr), \"\\n\",\n    \"MLR MAE:\", format(mae_mlr), \"\\n\",\n    \"MLR R^2:\", round(r2_mlr, 4))\n\n\nMLR RMSE: 75600.55 \n MLR MAE: 58139.58 \n MLR R^2: 0.7915\n\n\n\n\n6.1.4 Visualising the predicted values\n\n\nCode\np1 &lt;- ggplot(data = test_data_p_mlr,\n       aes(x = mlr_pred,\n           y = resale_price,\n           text = paste(\"Actual: $\", format(resale_price, big.mark = \",\"),\n                       \"\\nPredicted: $\", format(mlr_pred, big.mark = \",\"),\n                       \"\\nError: $\", format(resale_price - mlr_pred, big.mark = \",\"),\n                       sep = \"\"))) +           \n  geom_point(col = \"#EF7722\", size = 0.5) +\n  geom_abline(intercept = 0, slope = 1, \n              color = \"#DC143C\", linetype = \"dashed\", linewidth = 1) +  \n  labs(title = \"MLR: Predicted vs Actual Resale Prices\",\n       x = \"Predicted Resale Price (S$)\",\n       y = \"Actual Resale Price (S$)\") +\n    theme_minimal() +  \n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\"),      \n    panel.background = element_rect(fill = \"#F5F5F5\"),   \n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\") \n  )  \nggplotly(p1, tooltip = \"text\")\n\n\n\n\n\n\nMLR predictions quite largely deviate from the actual prices, especially for higher quantums beyond $900,000.\n\n\n\n\n6.2.1 Compute predicted values\n\n\nCode\ngwr_pred &lt;- gwr.predict(\n  formula = resale_price ~\n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT +PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data=train_data_corr, \n  predictdata = test_data_corr, \n  bw=bw.adaptive, \n  kernel = 'gaussian', \n  adaptive=TRUE, \n  longlat = FALSE)\n\nwrite_rds(gwr_pred, \"data/model/gwr_pred.rds\")\n\n\n\n\n6.2.2 Append predicted values to the test dataset\nBelow is to append the predicted values using GWR moderling to the test dataset. You will see the first few rows of the result.\n\n\nCode\ngwr_predictions &lt;- gwr_pred$SDF$prediction\n\ntest_data_p &lt;- test_data_p_mlr\ntest_data_p$gwr_pred &lt;- gwr_predictions\n\nkable(head(test_data_p[, c(\"resale_price\", \"gwr_pred\")]))\n\n\n\n\n\nresale_price\ngwr_pred\ngeometry\n\n\n\n\n553000\n550220.6\nPOINT (30037.03 38360.07)\n\n\n630000\n563012.7\nPOINT (29298.64 38701.65)\n\n\n550000\n537551.9\nPOINT (28566.95 38862.09)\n\n\n878000\n855392.4\nPOINT (29237.64 38669.02)\n\n\n966000\n971465.0\nPOINT (29237.37 38669.73)\n\n\n520000\n511517.2\nPOINT (30036.09 38361.03)\n\n\n\n\n\n\n\n6.2.3 GWR Model performance metrics\nTo assess GWR modeling performance, we will obtain the performance metrics Root Mean Squared Error (RMSE), Mean Absolute Error (MAE) and R square metrics.\n\n\nCode\n# RMSE\ngwr_rmse &lt;- sqrt(mean((test_data_p$resale_price - test_data_p$gwr_pred)^2))\n\n# MAE\ngwr_mae &lt;- mean(abs(test_data_p$resale_price - test_data_p$gwr_pred))\n\n# R-squared\ngwr_rsq &lt;- cor(test_data_p$resale_price, test_data_p$gwr_pred)^2\n\nwrite_rds(gwr_rmse, \"data/rds/gwr_rmse.rds\")\nwrite_rds(gwr_mae, \"data/rds/gwr_mae.rds\")\nwrite_rds(gwr_rsq, \"data/rds/gwr_rsq.rds\")\n\n\n\n\nCode\ngwr_rmse &lt;- read_rds(\"data/rds/gwr_rmse.rds\")\ngwr_mae &lt;- read_rds(\"data/rds/gwr_mae.rds\")\ngwr_rsq &lt;- read_rds(\"data/rds/gwr_rsq.rds\")\n  \nprint(paste(\"GWR RMSE:\", round(gwr_rmse, 2)))\n\n\n[1] \"GWR RMSE: 38028.34\"\n\n\nCode\nprint(paste(\"GWR MAE:\", round(gwr_mae, 2)))\n\n\n[1] \"GWR MAE: 28750.29\"\n\n\nCode\nprint(paste(\"GWR R^2:\", round(gwr_rsq, 4)))\n\n\n[1] \"GWR R^2: 0.9587\"\n\n\n\n\n6.3.4 Visualising the predicted values\nLet’s visualise the actual resale price and the predicted resale price in the scatter plot.\n\n\nCode\np2 &lt;- ggplot(data = test_data_p,\n       aes(x = gwr_pred,\n           y = resale_price,\n           text = paste(\"Actual: $\", format(resale_price, big.mark = \",\"),\n                       \"\\nPredicted: $\", format(gwr_pred, big.mark = \",\"),\n                       \"\\nError: $\", format(resale_price - gwr_pred, big.mark = \",\"),\n                       sep = \"\"))) +           \n  geom_point(col = \"#8AA624\", size = 0.5) +\n  geom_abline(intercept = 0, slope = 1, \n              color = \"#DC143C\", linetype = \"dashed\", linewidth = 1) +\n  labs(title = \"GWR: Predicted vs Actual Resale Prices\",\n       x = \"Predicted Resale Price (S$)\",\n       y = \"Actual Resale Price (S$)\") +\n    theme_minimal() +  \n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\"),      \n    panel.background = element_rect(fill = \"#F5F5F5\"),   \n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\") \n  )  \n  \nggplotly(p2, tooltip = \"text\")\n\n\n\n\n\n\nThe scatterplot demonstrates strong predictive performance, with points clustering tightly along the 45-degree line (perfect prediction). The majority of predictions fall within a narrow band around the diagonal, indicating minimal systematic bias. Even the outliers remain within ±$150,000 of actual values. This tight concentration suggests the GWR model effectively captures the spatial variation in HDB pricing across Singapore’s diverse regions.\n\n\n\n\n6.3.1 Predict with test data\nMode\n\n\nCode\nrf_pred &lt;- predict(\n  rf, data = test_data_nogeom)\n\nwrite_rds(rf_pred, \"data/model/rf_pred.rds\")\n\n\n\n\n6.3.2 Append predicted values to the test dataset\n\n\nCode\nrf_predictions &lt;- rf_pred$predictions\n\ntest_data_p$rf_pred &lt;- rf_predictions\n\nkable(head(test_data_p[, c(\"resale_price\", \"gwr_pred\")]))\n\n\n\n\n\nresale_price\ngwr_pred\ngeometry\n\n\n\n\n553000\n550220.6\nPOINT (30037.03 38360.07)\n\n\n630000\n563012.7\nPOINT (29298.64 38701.65)\n\n\n550000\n537551.9\nPOINT (28566.95 38862.09)\n\n\n878000\n855392.4\nPOINT (29237.64 38669.02)\n\n\n966000\n971465.0\nPOINT (29237.37 38669.73)\n\n\n520000\n511517.2\nPOINT (30036.09 38361.03)\n\n\n\n\n\n\n\n6.3.3 RF Model performance metrics\n\n\nCode\n# RMSE\nrf_rmse &lt;- sqrt(mean((test_data_p$resale_price - test_data_p$rf_pred)^2))\n\n# MAE\nrf_mae &lt;- mean(abs(test_data_p$resale_price - test_data_p$rf_pred))\n\n# R^2\nrf_rsq &lt;- cor(test_data_p$resale_price, test_data_p$rf_pred)^2\n\nwrite_rds(rf_rmse, \"data/rds/rf_rmse.rds\")\nwrite_rds(rf_mae, \"data/rds/rf_mae.rds\")\nwrite_rds(rf_rsq, \"data/rds/rf_rsq.rds\")\n\n\n\n\n[1] \"RF RMSE: 41949.6061273766\"\n\n\n[1] \"RF MAE: 29540.7934540272\"\n\n\n[1] \"RF R^2: 0.950421105489941\"\n\n\n\n\n6.3.4 Visualising the predicted values\nLet’s visualise the actual resale price and the predicted resale price in the scatter plot.\n\n\nCode\np3 &lt;- ggplot(data = test_data_p,\n       aes(x = rf_pred,\n           y = resale_price,\n           text = paste(\"Actual: $\", format(resale_price, big.mark = \",\"),\n                       \"\\nPredicted: $\", format(rf_pred, big.mark = \",\"),\n                       \"\\nError: $\", format(resale_price - rf_pred, big.mark = \",\"),\n                       sep = \"\"))) +           \n  geom_point(col = \"#3396D3\", size = 0.5) +\n  geom_abline(intercept = 0, slope = 1, \n              color = \"#DC143C\", linetype = \"dashed\", linewidth = 1) +  \n  labs(title = \"RF: Predicted vs Actual Resale Prices\",\n       x = \"Predicted Resale Price (S$)\",\n       y = \"Actual Resale Price (S$)\") +\n    theme_minimal() +  \n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\"),      \n    panel.background = element_rect(fill = \"#F5F5F5\"),   \n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\") \n  )  \n  \nggplotly(p3, tooltip = \"text\")\n\n\n\n\n\n\nRF predictions are generally decent as they are all quite close to the slope of 1. The model also tends to predict lower than the actual resale prices, but there are few outliers.\n\n\n\n\n6.4.1 Prepare test data\n\n\nCode\ntest_data_gwrf &lt;- cbind(\n  test_data_corr, coords_test) %&gt;%\n  st_drop_geometry()\n\nkable(head(test_data_gwrf))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths_num\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\nWITHIN_350m_CHILDC\nWITHIN_350m_BUS\nWITHIN_1km_PRISCH\nX\nY\n\n\n\n\n2025-07-01\n553000\n7\nANG MO KIO\n91\nNew Generation\n668\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n30037.03\n38360.07\n\n\n2025-07-01\n630000\n7\nANG MO KIO\n97\nNew Generation\n609\n434.3653\n350.4851\n115.6550\n270.2289\n506.7800\n291.6684\n485.2871\n177.4983\n596.5165\n7527.047\n8767.339\n0\n1\n1\n6\n6\n3\n29298.64\n38701.65\n\n\n2025-07-01\n550000\n7\nANG MO KIO\n91\nNew Generation\n618\n132.0052\n186.2702\n101.1686\n397.6108\n959.9848\n336.9090\n270.5919\n242.5577\n383.6496\n7868.887\n8490.800\n1\n1\n2\n7\n7\n3\n28566.95\n38862.09\n\n\n2025-07-01\n878000\n4\nANG MO KIO\n95\nModel A\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n29237.64\n38669.02\n\n\n2025-07-01\n966000\n19\nANG MO KIO\n97\nModel A\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n29237.37\n38669.73\n\n\n2025-07-01\n520000\n1\nANG MO KIO\n91\nNew Generation\n667\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n30036.09\n38361.03\n\n\n\n\n\n\n\n6.4.2 gwRF Predict with test data\nBelow prediction ran for 40 sec.\n\n\nCode\ngwRF_pred &lt;- predict.grf(gwRF_adaptive,\n                         test_data_gwrf,\n                         x.var.name = \"X\",\n                         y.var.name = \"Y\",\n                         local.w = 1,\n                         global.w = 0)\n\ngwRF_pred &lt;- write_rds(gwRF_pred, \"data/model/gwRF_pred.rds\")\n\n\n\n\n6.4.3 Append predicted values to the test dataset\n\n\nCode\ngwRF_pred_df &lt;- as.data.frame(gwRF_pred)\n\ntest_data_p$gwrf_pred &lt;- gwRF_pred_df[, 1]\n\nwrite_rds(test_data_p, \"data/rds/test_data_p.rds\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\ngeometry\nremaining_lease_mths_num\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\nWITHIN_350m_CHILDC\nWITHIN_350m_BUS\nWITHIN_1km_PRISCH\nmlr_pred\ngwr_pred\nrf_pred\ngwrf_pred\ngwrf_hybrid_pred\n\n\n\n\n2025-07-01\n553000\n7\nANG MO KIO\n91\nNew Generation\nPOINT (30037.03 38360.07)\n668\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n603925.5\n550220.6\n555736.3\n547787.1\n551485.0\n\n\n2025-07-01\n630000\n7\nANG MO KIO\n97\nNew Generation\nPOINT (29298.64 38701.65)\n609\n434.3653\n350.4851\n115.6550\n270.2289\n506.7800\n291.6684\n485.2871\n177.4983\n596.5165\n7527.047\n8767.339\n0\n1\n1\n6\n6\n3\n598333.1\n563012.7\n602696.8\n662078.8\n639213.4\n\n\n2025-07-01\n550000\n7\nANG MO KIO\n91\nNew Generation\nPOINT (28566.95 38862.09)\n618\n132.0052\n186.2702\n101.1686\n397.6108\n959.9848\n336.9090\n270.5919\n242.5577\n383.6496\n7868.887\n8490.800\n1\n1\n2\n7\n7\n3\n637489.7\n537551.9\n548401.2\n542837.7\n544691.7\n\n\n2025-07-01\n878000\n4\nANG MO KIO\n95\nModel A\nPOINT (29237.64 38669.02)\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n770542.4\n855392.4\n862248.9\n858448.0\n855349.9\n\n\n2025-07-01\n966000\n19\nANG MO KIO\n97\nModel A\nPOINT (29237.37 38669.73)\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n871226.8\n971465.0\n939022.6\n897954.4\n909049.6\n\n\n2025-07-01\n520000\n1\nANG MO KIO\n91\nNew Generation\nPOINT (30036.09 38361.03)\n667\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n566793.9\n511517.2\n548529.8\n548596.2\n549775.6\n\n\n\n\n\n\n\n6.4.4 gwRF Model performance metrics\nWe calculate the root mean square error (RMSE) to measure how far predicted values are from observed values in a regression analysis.\n\n\nCode\n# RMSE\n\ngwrf_rmse &lt;- sqrt(mean((test_data_p$resale_price - test_data_p$gwrf_pred)^2))\n\n# MAE\ngwrf_mae &lt;- mean(abs(test_data_p$resale_price - test_data_p$gwrf_pred))\n\n# R^2\ngwrf_rsq &lt;- cor(test_data_p$resale_price, test_data_p$gwrf_pred)^2\n\nwrite_rds(gwrf_rmse, \"data/rds/gwrf_rmse.rds\")\nwrite_rds(gwrf_mae, \"data/rds/gwrf_mae.rds\")\nwrite_rds(gwrf_rsq, \"data/rds/gwrf_rsq.rds\")\n\n\n\n\n[1] \"gwRF MSE: 41949.6061273766\"\n\n\n[1] \"gwRF MAE: 29540.7934540272\"\n\n\n[1] \"gwRF R^2: 0.950421105489941\"\n\n\n\n\n6.4.5 Visualising the predicted values\nLet’s visualise the actual resale price and the predicted resale price in the scatter plot.\n\n\nCode\np4 &lt;- ggplot(data = test_data_p,\n       aes(x = gwrf_pred,\n           y = resale_price,\n           text = paste(\"Actual: $\", format(resale_price, big.mark = \",\"),\n                       \"\\nPredicted: $\", format(gwrf_pred, big.mark = \",\"),\n                       \"\\nError: $\", format(resale_price - gwrf_pred, big.mark = \",\"),\n                       sep = \"\"))) +           \n  geom_point(col = \"#E45A92\", size = 0.5) +\n  geom_abline(intercept = 0, slope = 1, \n              color = \"#DC143C\", linetype = \"dashed\", linewidth = 1) +   \n  labs(title = \"GWRF: Predicted vs Actual Resale Prices\",\n       x = \"Predicted Resale Price (S$)\",\n       y = \"Actual Resale Price (S$)\") +\n    theme_minimal() +  \n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\"),      \n    panel.background = element_rect(fill = \"#F5F5F5\"),   \n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\") \n  )  \n  \nggplotly(p4, tooltip = \"text\")\n\n\n\n\n\n\ngwRF model predictions are mostly close to the actual resale prices, but it has many outliers that divate for almost 50,0000 (50%) higher than the actual prices."
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#model-evaluation",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#model-evaluation",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "7 Model Evaluation",
    "text": "7 Model Evaluation\n\n\n\n\n\n\n\n\n\n\n7.1 Performance metrics (RMSE, MAE, R²)\nBased on the scatterplots and the metrics result below, we can conclude that:\n\nGeographically Weighted Regression\n\nGWR demonstrates the strongest performance, with predictions clustering tightly along the 45-degree reference line and minimal systematic bias. Even outliers remain within ±$150,000 of actual values, indicating the model effectively captures spatial variation across Singapore’s diverse housing markets.\n\nRandom Forest\n\nRandom Forest shows generally good performance with most predictions close to the diagonal, though the model exhibits a slight tendency to underpredict for higher-priced units. Outliers are minimal and predictions maintain consistency across the price range.\n\nMultiple Linear Regression\n\nMLR shows the weakest performance, with predictions substantially deviating from actual prices, especially for premium units exceeding $900,000. The scatter indicates systematic bias and inability to capture non-linear relationships in the data.\n\nGeographical Weighted Random Forest\n\ngwRF displays mixed results, with most predictions reasonably close to actual values but suffering from many significant outliers that overpredict by up to $479,244 (approximately 50% error). This inconsistency suggests the model struggles with certain spatial or feature combinations.\n\n\nCode\nmodel_comparison &lt;- data.frame(\n  Model = c(\"MLR\", \"GWR\", \"Random Forest\", \"gwRF\"),\n  RMSE = c(rmse_mlr, gwr_rmse, rf_rmse, gwrf_rmse),\n  MAE = c(mae_mlr, gwr_mae, rf_mae, gwrf_mae),\n  R_2 = c(r2_mlr, gwr_rsq, rf_rsq, gwrf_rsq)\n)\n\ndatatable(model_comparison,\n          options = list(pageLength = 10, dom = 't'),\n          rownames = FALSE,\n          class = 'cell-border stripe') %&gt;%\n  formatRound(columns = c('RMSE', 'MAE', 'R_2'), digits = 4) \n\n\n\n\n\n\nRMSE (Root Mean Squared Error) MAE (Mean Absolute Error) R² on test set Compare across all 4 models\n\n\n7.2 Model comparison\nTable from Section 7.1 is an interactive table that readers can sort the values in ascending or descending order for each metric.\nThe bar charts below helps decide that GWR is the winner among all 4 models across all 3 metrics, with the highest R² and lowest RMSE & MAE, followed by Random Forest, Geographical Weighted Random Forest and lastly Multilinear Regression.\n\nRMSE: GWR &gt; RF &gt; geRF &gt; MLR\nMAE: GWR &gt; RF &gt; geRF &gt; MLR\nR²: GWR &gt; RF &gt; geRF &gt; MLR\n\n\n\nCode\n# pivot longer\nmodel_comparison_long &lt;- model_comparison %&gt;%\n  pivot_longer(cols = c(RMSE, MAE, R_2),\n               names_to = \"metric\",\n               values_to = \"value\") %&gt;%\n  mutate(metric = recode(metric,\n                         \"R_2\" = \"R^2\",\n                         \"RMSE\" = \"RMSE\",\n                         \"MAE\" = \"MAE\"))\n\n# Create ordering within each metric\nmodel_comparison_long &lt;- model_comparison_long %&gt;%\n  group_by(metric) %&gt;%\n  mutate(\n    sort_helper = if_else(metric %in% c(\"RMSE\", \"MAE\"), value, -value),\n    Rank = if_else(metric %in% c(\"RMSE\", \"MAE\"), \n                   rank(value), \n                   rank(-value))    \n  ) %&gt;%\n  arrange(metric, sort_helper) %&gt;%  # Sort within each metric\n  mutate(\n    Model_metric = paste(Model, metric, sep = \"___\"),  # Create unique identifier\n    Model_metric = factor(Model_metric, levels = unique(Model_metric))\n  ) %&gt;%\n  ungroup()\n\np &lt;- ggplot(model_comparison_long, \n       aes(x = Model_metric, y = value, fill = Model,\n           text = paste0(\"&lt;b&gt;\", Model, \"&lt;/b&gt;\",\n                        \"\\n\", metric, \": \", format(round(value, 4), big.mark = \",\"),\n                        \"\\nRank: \", Rank, \" of 4\"))) +            \n  \n  geom_bar(stat = \"identity\", alpha = 0.8) +\n  facet_wrap(~ metric, scales = \"free\", ncol = 3) +\n  scale_x_discrete(labels = function(x) gsub(\"___.*\", \"\", x)) + \n  scale_fill_manual(values = c(\"MLR\" = \"#E2A16F\", \n                                \"GWR\" = \"#A6B28B\", \n                                \"Random Forest\" = \"#B2C6D5\", \n                                \"gwRF\" = \"#FFC6C6\")) +\n  labs(title = \"Model Performance Comparison\",\n       x = \"Model\",\n       y = \"Value\") +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"none\",\n    strip.text = element_text(size = 11, face = \"bold\"),\n    plot.background = element_rect(fill = \"#EEEEEE\"),      \n    panel.background = element_rect(fill = \"#F5F5F5\"),   \n    panel.border = element_rect(color = \"white\", fill = NA, linewidth = 1),\n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\"))\nggplotly(p, tooltip = \"text\")\n\n\n\n\n\n\n\n\n7.3 Best model selection\n\nThe best overall model\n\nThese visual patterns confirm the quantitative metrics: Geographically Weighted Regression (GWR) achieves the most reliable predictions, followed by RF, while gwRF’s outlier problem and MLR’s systematic bias limit their practical utility.\nIt has the best performance across all metrics (Lowest RMSE = 38,028; Lowest MAE = 28,750; Highest R² = 0.9587). This demonstrates superior predictive accuracy for HDB resale prices.\n\nSpatial vs Non-Spatial models\n\nThe results present an interesting finding: while GWR (spatial) outperforms all models, Random Forest outperforms Geographically Weighted Random Forest (spatial). This suggests that spatial heterogeneity matters, but its benefit depends on the modeling approach.\nGWR’s parametric framework effectively captures smooth spatial gradients in Singapore’s housing market, while GWRF’s localised tree-based partitioning may struggle with the continuous nature of spatial price variations. MLR’s poor performance (RMSE = 51,438) confirms that a simple global model is insufficient for capturing Singapore’s spatially complex housing dynamics.\n\nComputational trade-offs\n\nGWR requires significantly more computational resources, taking short time to train but 30-40 minutes to predict on 5,000 observations, as compared to negligible training and testing time for other models (tested on a high-specification laptop).\nDespite this computational cost, GWR’s superior accuracy justifies its use for applications prioritising prediction quality. For resource-constrained scenarios or applications requiring rapid retraining, Random Forest would provide a strong alternative with comparable performance (RMSE = 38,423) and minimal computational overhead."
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#discussion-conclusion",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#discussion-conclusion",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "8 Discussion & Conclusion",
    "text": "8 Discussion & Conclusion\n\n8.1 Key findings\nThe results reveal important insights about spatial modeling for HDB resale prices.\n\nSpatial heterogeneity is significant:\n\nGWR substantially outperformed all other models, achieving the lowest RMSE (38,028) and highest R² (0.9587). This demonstrates that locally-varying relationships between property characteristics and prices are crucial for accurate prediction in Singapore’s HDB market.\nDifferent neighborhoods exhibit different pricing dynamics that cannot be captured by global models. For Random Forest, despite its flexibility, its RMSE=41,950 could not match GWR’s performance. While RF can learn complex patterns, it lacks the explicit spatial weighting mechanism that allows GWR to adapt coefficients by location. The 4,000 SGD difference in RMSE represents practically significant prediction error (~10% improvement with GWR).\n\nOver-localisation problem in gwRF\n\nAdding spatial weighting to Random Forest actually degraded performance below standalone RF. With bandwidth=48 neighbors, each local RF seemed to train on insufficient data, leading to overfitting. We experimented with a hybrid approach (60% local, 40% global) partially recovered performance but still couldn’t match either GWR or RF (see Appendix).\n\nModel recommendations\n\nFor best prediction accuracy: Use GWR. It provides superior performance and spatial interpretability\nFor computational efficiency: Use RF as a faster alternative with acceptable accuracy. It ran only for 1-3 seconds for this study.\nAvoid fully local gwRF: due to overfitting and poor performance despite higher computational cost (than RF). We tested a hybrid gwRF approach to address potential over-localisation. While the hybrid model outperformed the fully local gwRF, it remained inferior to both GWR and standalone RF. This confirms that:\n\n\n8.2 Future work\nBoth GWR and gwRF used an adaptive bandwidth of 48 neighbors, optimized using cross-validation for the GWR model. Future work could explore whether gwRF benefits from a larger bandwidth given the additional data requirements of ensemble methods.\nThese findings suggest that future research on spatial ensemble methods should focus on alternative approaches to incorporating spatial information—such as spatial features or constraints—rather than geographic weighting schemes that may conflict with the inherent spatial partitioning of tree-based models\n\n\nSelf Reflection\n\n\nGeospatial studies are very exciting because the methods and models allow us to discover tremendous insights for informing policies and business strategies. Through this assignment I learned to appreciate predictive modeling methodologies in the geospatial field. The finding is also quite interesting as it kind of goes against what I initially thought - GWR and gwRF must win. It came as a surprise that gwRF actually did not!\nAll the lessons covered help me realise that there are just yet a lot more to learn. I always find data so fascinating when I come to each of the lesson since Data Analytics Lab module. Sincere thanks to Prof. Kam’s patience and encouragement on the assignments and answering questions, making the data analytics journey so amazing! Together with visual analytics, I have developed greater interest in these fields and will continue the journey. Hopefully I can really utilise the knowledge and skillset to do some good to the society."
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#reference",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#reference",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "9 Reference",
    "text": "9 Reference\n\nKam, T. S. 2025. R for Geospatial Data Science and Analytics\nGangula, K. (n.d.). Shopping mall coordinates [Data set]. Kaggle. Retrieved November 9, 2025, from https://www.kaggle.com/datasets/karthikgangula/shopping-mall-coordinates\ndata.gov.sg. (2025). multiple data sets [Data set] (refer to section 2.1) Retrieved Nov 9, 2025, from https://data.gov.sg/\nLand Transport (2025). multiple data sets [Data set] (refer to section 2.1). Retrieved Nov 9, 2025, from https://datamall.lta.gov.sg/content/datamall/en.html.\nShopping mall. (n.d.). In Wikipedia. Retrieved November 9, 2025, from https://en.wikipedia.org/wiki/Shopping_mall\nSophia Education. (2025). 2025 Singapore PSLE school rankings: Where do the top schools stand this year? Sophia Education. https://sophiaeducation.sg/2025-singapore-psle-school-rankings"
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#appendix",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#appendix",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "APPENDIX",
    "text": "APPENDIX"
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#i.-gwrf-hybrid-modeling",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#i.-gwrf-hybrid-modeling",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "I. gwRF Hybrid Modeling",
    "text": "I. gwRF Hybrid Modeling\n\ni. Adjust spatial effects\nGiven that gwRF unexpectedly underperformed relative to RF, we explore whether a hybrid approach can improve performance by balancing local spatial effects (60%) with global patterns (40%). This configuration allows the model to capture spatial heterogeneity while maintaining awareness of market-wide trends.\n\n\nCode\ngwRF_hybrid_pred &lt;- predict.grf(gwRF_adaptive,\n                         test_data_gwrf,\n                         x.var.name = \"X\",\n                         y.var.name = \"Y\",\n                         local.w = 0.6,\n                         global.w = 0.4)\n\ngwRF_hybrid_pred &lt;- write_rds(gwRF_hybrid_pred, \"data/model/gwRF_hybrid_pred.rds\")\n\n\n\n\nii. Append predicted values to the test dataset\n\n\nCode\ngwRF_hybrid_pred_df &lt;- as.data.frame(gwRF_hybrid_pred)\ntest_data_p$gwrf_hybrid_pred &lt;- gwRF_hybrid_pred_df[, 1]\nwrite_rds(test_data_p, \"data/rds/test_data_p.rds\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\ngeometry\nremaining_lease_mths_num\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\nWITHIN_350m_CHILDC\nWITHIN_350m_BUS\nWITHIN_1km_PRISCH\nmlr_pred\ngwr_pred\nrf_pred\ngwrf_pred\ngwrf_hybrid_pred\n\n\n\n\n2025-07-01\n553000\n7\nANG MO KIO\n91\nNew Generation\nPOINT (30037.03 38360.07)\n668\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n603925.5\n550220.6\n555736.3\n547787.1\n551485.0\n\n\n2025-07-01\n630000\n7\nANG MO KIO\n97\nNew Generation\nPOINT (29298.64 38701.65)\n609\n434.3653\n350.4851\n115.6550\n270.2289\n506.7800\n291.6684\n485.2871\n177.4983\n596.5165\n7527.047\n8767.339\n0\n1\n1\n6\n6\n3\n598333.1\n563012.7\n602696.8\n662078.8\n639213.4\n\n\n2025-07-01\n550000\n7\nANG MO KIO\n91\nNew Generation\nPOINT (28566.95 38862.09)\n618\n132.0052\n186.2702\n101.1686\n397.6108\n959.9848\n336.9090\n270.5919\n242.5577\n383.6496\n7868.887\n8490.800\n1\n1\n2\n7\n7\n3\n637489.7\n537551.9\n548401.2\n542837.7\n544691.7\n\n\n2025-07-01\n878000\n4\nANG MO KIO\n95\nModel A\nPOINT (29237.64 38669.02)\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n770542.4\n855392.4\n862248.9\n858448.0\n855349.9\n\n\n2025-07-01\n966000\n19\nANG MO KIO\n97\nModel A\nPOINT (29237.37 38669.73)\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n871226.8\n971465.0\n939022.6\n897954.4\n909049.6\n\n\n2025-07-01\n520000\n1\nANG MO KIO\n91\nNew Generation\nPOINT (30036.09 38361.03)\n667\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n566793.9\n511517.2\n548529.8\n548596.2\n549775.6\n\n\n\n\n\n\n\niii. gwRF Model performance metrics\n\n\nCode\n# RMSE\ngwrf_hybrid_rmse &lt;- sqrt(mean((test_data_p$resale_price - test_data_p$gwrf_hybrid_pred)^2))\n\n# MAE\ngwrf_hybrid_mae &lt;- mean(abs(test_data_p$resale_price - test_data_p$gwrf_hybrid_pred))\n\n# R^2\ngwrf_hybrid_rsq &lt;- cor(test_data_p$resale_price, test_data_p$gwrf_hybrid_pred)^2\n\nwrite_rds(gwrf_hybrid_rmse, \"data/rds/gwrf_hybrid_rmse.rds\")\nwrite_rds(gwrf_hybrid_mae, \"data/rds/gwrf_hybrid_mae.rds\")\nwrite_rds(gwrf_hybrid_rsq, \"data/rds/gwrf_hybrid_rsq.rds\")\n\n\n\n\n[1] \"gwRF_hybrid MSE: 41949.6061273766\"\n\n\n[1] \"gwRF_hybrid MAE: 29540.7934540272\"\n\n\n[1] \"gwRF_hybrid R^2: 0.950421105489941\"\n\n\n\n\niv. Visualising the predicted values\nLet’s visualise the actual resale price and the predicted resale price in the scatter plot and compare the metrics with the existing models.\nWhile the hybrid gwRF model improves upon fully localised gwRF, it still underperforms compared to non-spatial Random Forest. This result suggests that explicit geographic weighting may not be necessary when rich locational features (proximity to amenities, CBD distance) are already included as predictors.\nRandom Forest’s ability to capture complex non-linear interactions between these spatial features may be more effective than gwRF’s localized approach for this dataset.\n\nPerformance metrics tableScatterplot\n\n\n\n\nCode\nmodel_comparison_v2 &lt;- data.frame(\n  Model = c(\"MLR\", \"GWR\", \"Random Forest\", \"gwRF\", \"gwRF_hb\"),\n  RMSE = c(rmse_mlr, gwr_rmse, rf_rmse, gwrf_rmse, gwrf_hybrid_rmse),\n  MAE = c(mae_mlr, gwr_mae, rf_mae, gwrf_mae, gwrf_hybrid_mae),\n  R_2 = c(r2_mlr, gwr_rsq, rf_rsq, gwrf_rsq, gwrf_hybrid_rsq)\n)\n\ndatatable(model_comparison_v2,\n          options = list(pageLength = 10, dom = 't'),\n          rownames = FALSE,\n          class = 'cell-border stripe') %&gt;%\n  formatRound(columns = c('RMSE', 'MAE', 'R_2'), digits = 4) \n\n\n\n\n\n\n\n\n\n\nCode\nggplot(data = test_data_p,\n       aes(x = gwrf_hybrid_pred,\n           y = resale_price)) +\n  geom_point(col = \"#BB6653\", size = 0.5) +\n  geom_abline(intercept = 0, slope = 1, \n               color = \"#DC143C\", linetype = \"dashed\", linewidth = 1) +  \n  labs(title = \"GWRF Hybrid: Predicted vs Actual Resale Prices\",\n       x = \"Predicted Resale Price (S$)\",\n       y = \"Actual Resale Price (S$)\") +\n    theme_minimal() +  \n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\"),      \n    panel.background = element_rect(fill = \"#F5F5F5\"),   \n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\") \n  )"
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#ii.-gwrf-bandwidth-sensitivity-analysis",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#ii.-gwrf-bandwidth-sensitivity-analysis",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "II. gwRF bandwidth sensitivity analysis",
    "text": "II. gwRF bandwidth sensitivity analysis\n\ni. Adjust bandwidth\nWe conducted a further bandwidth sensitivity analysis testing values from 48, 75, 100, 150 to 200 neighbors.\n\n\nCode\nbandwidths &lt;- c(48, 75, 100, 150, 200)\ngwrf_results &lt;- data.frame()\n\nfor(bw in bandwidths) {\n  set.seed(1234)\n  gwRF_test &lt;- grf(\n    formula = resale_price ~ \n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT +PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n    dframe = train_data_nogeom, \n    bw = bw,\n    kernel = \"adaptive\",\n    coords = coords_train,\n    ntree = 500,\n    mtry = 3\n  )\n  \n  gwRF_test_pred &lt;- predict.grf(\n    gwRF_test,\n    test_data_gwrf,\n    x.var.name = \"X\",\n    y.var.name = \"Y\",\n    local.w = 0.6,\n    global.w = 0.4\n  )\n  \n  predictions &lt;- as.data.frame(gwRF_test_pred)[,1]\n  \n  test_actual &lt;- as.numeric(test_data_p$resale_price)\n\ngwrf_results &lt;- rbind(gwrf_results, data.frame(\n  Bandwidth = bw,\n  RMSE = sqrt(mean((test_actual - predictions)^2)),\n  MAE = mean(abs(test_actual - predictions)),\n  R_squared = cor(test_actual, predictions)^2\n))\n  \n  print(paste(\"Completed bandwidth:\", bw))\n}\n\nwrite_rds(gwrf_results, \"data/rds/gwrf_results.rds\")\n\n\n\n\n\n\n\nBandwidth\nRMSE\nMAE\nR_squared\n\n\n\n\n48\n42933.35\n30973.33\n0.9419071\n\n\n75\n42544.71\n30658.50\n0.9435401\n\n\n100\n42523.82\n30511.26\n0.9442624\n\n\n150\n41592.95\n30061.08\n0.9472267\n\n\n200\n41396.24\n29898.66\n0.9481004\n\n\n\n\n\n\n\nii. Result visualisation\n\n\nCode\np_h &lt;- ggplot(gwrf_results, aes(x = Bandwidth, y = RMSE,\n                                text = paste0(\n                                   \"&lt;b&gt;Bandwidth:&lt;/b&gt; \", Bandwidth,\n                                   \"&lt;br&gt;&lt;b&gt;RMSE:&lt;/b&gt; $\", format(round(RMSE, 2), big.mark = \",\"),\n                                   \"&lt;br&gt;&lt;b&gt;Improvement vs RF:&lt;/b&gt; $\", format(round(41950 - RMSE, 2), big.mark = \",\")\n                                 ))) +\n  geom_line(color = \"orange\", linewidth = 1, aes(text = NULL)) +\n  geom_point(color = \"orange\", size = 3) +\n  geom_hline(yintercept = 41950, color = \"blue\", linetype = \"dashed\", linewidth = 1) +\n  geom_hline(yintercept = 38028, color = \"red\", linetype = \"dashed\", linewidth = 1) +\n  annotate(\"text\", x = max(gwrf_results$Bandwidth), y = 41950, \n           label = \"Random Forest\", hjust = 1.1, color = \"blue\") +\n  annotate(\"text\", x = max(gwrf_results$Bandwidth), y = 38028, \n           label = \"GWR\", hjust = 1.1, color = \"red\") +\n  labs(title = \"gwRF Performance by Bandwidth\",\n       subtitle = \"Hybrid model (60% local, 40% global)\",\n       x = \"Adaptive Bandwidth (Number of Neighbors)\",\n       y = \"RMSE (SGD)\") +\n  theme_minimal() +\n    theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"none\",\n    strip.text = element_text(size = 11, face = \"bold\"),\n    plot.background = element_rect(fill = \"#EEEEEE\"),      \n    panel.background = element_rect(fill = \"#F5F5F5\"),   \n    panel.border = element_rect(color = \"white\", fill = NA, linewidth = 1),\n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\"),\n    plot.subtitle = element_text(hjust = 0.5, size = 10))\n\nggplotly(p_h, tooltip = \"text\")\n\n\n\n\n\n\n\n\niii. Conclusion\nResults showed that increasing bandwidth improved gwRF performance (RMSE: 46,306 at BW=48 → 41,396 at BW=200), yet even optimal gwRF’s MAE underperformed standard RF (RMSE=29,540). This reveals a fundamental paradox: gwRF requires larger bandwidths to improve accuracy, but this negates the local spatial weighting that motivated its design. The consistent superiority of RF suggests that spatial dependencies are adequately represented through proximity features. They make explicit geographic weighting unnecessary, and potentially harmful when combined with tree-based ensemble methods."
  }
]