[
  {
    "objectID": "geospatial/predict_hdb_resale/malls_sg.html",
    "href": "geospatial/predict_hdb_resale/malls_sg.html",
    "title": "shopping_malls_sg",
    "section": "",
    "text": "pacman::p_load(rvest, tidyverse)\n\n\nurl &lt;- \"https://en.wikipedia.org/wiki/List_of_shopping_malls_in_Singapore\"\npage &lt;- read_html(url)\n\nmall_names &lt;- page %&gt;%\n  html_nodes(\"div.mw-parser-output ul li\") %&gt;%\n  html_text() %&gt;%\n  trimws()\n\nmall_names &lt;- mall_names[nchar(mall_names) &gt; 0]\n\nmall_df &lt;- data.frame(Mall_Name = mall_names) %&gt;%\n  arrange(Mall_Name) %&gt;%\n  filter(!Mall_Name %in% c(\"v\", \"t\", \"e\")) %&gt;%\n  unique()\n\nmall_df\n\n                          Mall_Name\n1                           AMK Hub\n3           Alexandra Retail Centre\n5                    Amber Mansions\n6                        Bedok Mall\n8                       Bedok Point\n9                    Bugis Junction\n11                           Bugis+\n13              Bukit Panjang Plaza\n14                   Canberra Plaza\n16                   Capitol Centre\n17                   Capitol Piazza\n18                Capitol Singapore\n19       Cathay Cineleisure Orchard\n21                   Causeway Point\n23                   Century Square\n25                     Change Alley\n26                Changi City Point\n28                  Chinatown Point\n30                 City Square Mall\n32                    CityLink Mall\n34                    Clementi Mall\n35                      Compass One\n37                     Dawson Place\n38                     Djitsun Mall\n39                    Downtown East\n40                              Duo\n41                   Eastpoint Mall\n43              Ellenborough Market\n44                   Esplanade Mall\n45                   Far East Plaza\n47          Forum The Shopping Mall\n48               Fu Lu Shou Complex\n49                            Funan\n51            Funan DigitaLife Mall\n52                        GV Yishun\n53          Gek Poh Shopping Centre\n54                      Great World\n55                 Great World City\n56                          HDB Hub\n58              HarbourFront Centre\n60                   Heartland Mall\n62                     Hillion Mall\n64     Holland Road Shopping Centre\n65    Holland Village Shopping Mall\n66                        Hougang 1\n67                     Hougang Mall\n69                              IMM\n71                      ION Orchard\n73                            JCube\n74                              Jem\n76             Jewel Changi Airport\n78                      Junction 10\n80                       Junction 8\n82      Jurong Entertainment Centre\n83                     Jurong Point\n85                Kallang Wave Mall\n87           Katong Shopping Centre\n89                         Le Quest\n90             Leisure Park Kallang\n92                      Liang Court\n93                      Liat Towers\n94                            Lot 1\n95                          Lot One\n96                      Lucky Plaza\n98                 Mandarin Gallery\n99             Marina Bay Link Mall\n101                Marina Bay Sands\n102                   Marina Square\n104                   Millenia Walk\n106                  Mustafa Centre\n108                             NEX\n109                             Nex\n110                   Ngee Ann City\n112                 Northpoint City\n114                   Novena Square\n115     Novena Square Shopping Mall\n116                  Oasis Terraces\n118                 Orchard Central\n120                 Orchard Gateway\n122                  Orchard Towers\n123                Our Tampines Hub\n125              Palais Renaissance\n127                      Parc Point\n128                  Parkway Parade\n130              Paya Lebar Quarter\n131               Paya Lebar Square\n132                 Peninsula Plaza\n133            People's Park Centre\n135           People's Park Complex\n137                    Pioneer Mall\n139                Plantation Plaza\n140                 Plaza Singapura\n142              Punggol Coast Mall\n143                   Punggol Plaza\n145       Queensway Shopping Centre\n147                    Raffles City\n149                  Rochester Mall\n150          Scotts Shopping Centre\n151                    Seletar Mall\n152       Sembawang Shopping Centre\n154           Shaw House and Centre\n156                      Shaw Tower\n157                  Sim Lim Square\n159                 Singpost Center\n160                     South Beach\n161    Specialists' Shopping Centre\n162                        Square 2\n164                       Sun Plaza\n166                     Suntec City\n167                Suntec City Mall\n168                      Tampines 1\n170                   Tampines Mall\n172                      Tang Plaza\n173         Tanglin Shopping Centre\n174            Tanjong Pagar Centre\n175                    Tekka Centre\n177                      The Cathay\n178                 The Centrepoint\n180               The Clementi Mall\n181                 The Golden Mile\n182                    The Majestic\n183                     The Paragon\n185                   The Rail Mall\n187                The Seletar Mall\n188 The Shoppes at Marina Bay Sands\n189                 The South Beach\n190                  The Star Vista\n192                       The Verge\n193                   Thomson Plaza\n195               Tiong Bahru Plaza\n197                   United Square\n198                        VivoCity\n200                  Waterway Point\n202                West Coast Plaza\n204                       West Mall\n206                        Westgate\n208                  Wheelock Place\n210                     White Sands\n212                     Wisma Atria\n214                   Yew Tee Point\n215                      i12 Katong\n\nwrite_csv(mall_df, \"data/rawdata/singapore_malls.csv\")"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Cathy C.",
    "section": "",
    "text": "Welcome to catlytics webpage! My name is Cathy."
  },
  {
    "objectID": "about.html#education",
    "href": "about.html#education",
    "title": "Cathy C.",
    "section": "Education",
    "text": "Education\nSingapore Management University | Masters of IT in Business"
  },
  {
    "objectID": "about.html#experience",
    "href": "about.html#experience",
    "title": "Cathy C.",
    "section": "Experience",
    "text": "Experience\nMultiple MNCs | Program Manager, Training Instructor | Singapore"
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#overview",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#overview",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "1 Overview",
    "text": "1 Overview\n\n1.1 Background\nSingapore housing price is a popular subject among locals and foreigners who are interested to purchase or invest in houses. While investors are typically interested in Condo or private housing due to policies and availabilty, Government housing like HDB is generally more affordable and a critical supply to Singaporeans from all walks of life. The resale market is especially important as Singaporeans looking to upgrade or PRs looking to purchase own housing.\nThis study is modified from a Geospatial course assignment by Prof. Kam Tin Seong.\n\n\n1.2 Objective\nThe objective of this study is to develop a spatially informed model to predict HDB resale prices in Singapore, making use of appropriate geospatial analytics methods. We will calibrate predictive models to predict HDB resale prices for the period July to September 2025, using HDB resale transaction data from July 2024 to June 2025.\n\n\n1.3 The Task\nIn this study, we will first determine potential factors that influence the HDB resale price, import the data of these factors, and process them for predictive modeling. The modeling we will investigate in this task include Multi-linear Regression (MLR), Geographically Weighted Regression (GWR), non-spatial Random Forest, as well as Geographical Weighted Random Forest Model (gwRF). Among these models, we will examine and compare them to derive the best performing model."
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#installing-and-loading-r-packages",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#installing-and-loading-r-packages",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "2 Installing and Loading R packages",
    "text": "2 Installing and Loading R packages\nBelow we will load the R packages. The table shows the packages used for this study and their descriptions, including links to more details to the package.\n\nLoad PackagesPackage Intro\n\n\n\npacman::p_load(httr, tidyverse, sf, tmap, jsonlite, progress,\n               spdep, GWmodel, SpatialML, rsample, Metrics, knitr,\n               kableExtra, spatialRF, randomForestExplainer, rvest,\n               stringr, lubridate, corrplot, performance, see,\n               gtsummary, ModelMetrics, DT, plotly)\n\n\n\n\nR Packages\n\n\nR Package\nDescription\n\n\n\n\nhttr\nUseful tools for working with HTTP organised by HTTP verbs (GET(), POST(), etc).\n\n\ntidyverse\nan opinionated collection of R packages designed for data science.\\, such as ggplot2, readr, stringr, lubridate, purrr, etc.\n\n\nsf\nSupport for simple feature access, a standardized way to encode and analyze spatial vector data.\n\n\ntmap\nan R package for drawing thematic maps. The API is based on A Layered Grammar of Graphics and resembles the syntax of ggplot2, a popular R-library for drawing charts.\n\n\njsonlite\nA reasonably fast JSON parser and generator, optimized for statistical data and the web.\n\n\nprogress\nProvides a unifying API for reporting progress updates in R, including within parallel processing contexts. It was developed by Henrik Bengtsson, known for the future framework.\n\n\nspdep\nA collection of functions to create spatial weights matrix objects from polygon ‘contiguities’, from point patterns by distance and tessellations, for summarizing these objects, and for permitting their use in spatial data analysis, including regional aggregation by minimum spanning tree.\n\n\nGWmodel\nTechniques from a particular branch of spatial statistics,termed geographicallyweighted (GW) models.\n\n\nSpatialML\nImplements a spatial extension of the random forest algorithm (Georganos et al. (2019). Allows for a geographically weighted random forest regression including a function to find the optical bandwidth. (Georganos and Kalogirou (2022)\n\n\nrsample\nprovides functions to create different types of resamples and corresponding classes for their analysis.\n\n\nMetrics\nAn implementation of evaluation metrics in R that are commonly used in supervised machine learning. It implements metrics for regression, time series, binary classification, classification, and information retrieval problems.\n\n\nknitr\nProvides a general-purpose tool for dynamic report generation in R using Literate Programming techniques.\n\n\ncorrplot\nprovides a visual exploratory tool on correlation matrix that supports automatic variable reordering to help detect hidden patterns among variables.\n\n\nperformance\nprovides utilities for computing indices of model quality and goodness of fit. These include measures like r-squared (R2), root mean squared error (RMSE) or intraclass correlation coefficient (ICC).\n\n\nsee\nAs a core pillar of easystats, the see package helps users to utilize visualization for more informative, communicable, and well-rounded scientific reporting.\n\n\ngtsummary\nprovides an elegant and flexible way to create publication-ready analytical and summary tables using the R programming language.\n\n\nModelMetrics\nModelMetrics is a much faster and reliable package for evaluating models. ModelMetrics is written in using Rcpp making it faster than the other packages used for model metrics.\n\n\nDT\nprovides an R interface to the JavaScript library DataTables. R data objects (matrices or data frames) can be displayed as tables on HTML pages, and DataTables provides filtering, pagination, sorting, and many other features in the tables."
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#the-data",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#the-data",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "3 The Data",
    "text": "3 The Data\nWe will make use of the following data sets to prepare the predictors as well as dependent variable (i.e. HDB resale price) in the master dataset for predictive modeling.\n\nData setsSources\n\n\n\n\n\n\n\n\n\nData set\nDescription\n\n\n\n\nHDB\n\n\n\nHDB resale price\nResale flat prices based on registration date from Jan-2017 onwards\n\n\nEducation\n\n\n\nChildcare centers\nOrganisations offering play-based learning learning for younger kids.\n\n\nKindergarten\nSingapore kindergartens, among which many are government-run to prepare older children for primary school.\n\n\nPrimary schools\nSingapore primary schools\n\n\nTop primary schools\nTop Singapore primary schools based on PSLE exam (secondary school entrance exam) results\n\n\nBusiness\n\n\n\nCBD\nThe Central Business District areas, including RAFFLES PLACE, MARINA CENTRE, TANJONG PAGAR, CITY HALL, ENTRAL SUBZONE areas.\n\n\nBusiness park\nAreas where offices are concentrated across the island.\n\n\nRecreation\n\n\n\nShopping malls\nShopping mall buildings of all sizes.\n\n\nSports halls\nSports halls that provide sports facilities for the public use, including some school sports halls.\n\n\nParks\nIndicative polygon of Parks and Open Space in the Parks and Waterbodies Plan.\n\n\nCommunity Clubs\nCommon spaces for people of all races to come together, build friendships and promote social bonding.\n\n\nF&B\n\n\n\nSupermarkets\nRetail markets where people shop groceries.\n\n\nFoodcourt/Hawker centers\nFootcourts and Hawker centers where people grab meals conveniently.\n\n\nTransportation\n\n\n\nBus\nBus stops\n\n\nMRT\nMRT & LRT stations\n\n\nHealthcare\n\n\n\nClinics\nClinics / GP\n\n\nEldercare services\nNursing homes, senior service centers\n\n\n\n\n\n\n\n\nData set\nSource\n\n\n\n\nHDB\n\n\n\nHDB resale price\nResale flat prices\n\n\nEducation\n\n\n\nChildcare centers\nPre-Schools Location\n\n\nKindergarten\nKindergartens\n\n\nPrimary schools\nSchool Directory and Information\n\n\nTop primary schools\nPrimary school with data from sophia education\n\n\nBusiness\n\n\n\nCBD\nShape file derived from Master Plan 2019 Planning Area Boundary\n\n\nBusiness park\nJTC Business Park Land\n\n\nRecreation\n\n\n\nShopping malls\n\nShopping mall coordinates from Kaggle.\nWiki page\n\n\n\nSports halls\nSportsFields@SG\n\n\nParks\nPark Facilities\n\n\nCommunity Clubs\nCommunity clubs geojson\n\n\nF&B\n\n\n\nSupermarkets\nSupermarkets (GEOJSON)2024\n\n\nFoodcourt/Hawker centers\nHawker Centres (GEOJSON) 2025\n\n\nTransportation\n\n\n\nBus\nBus stops location\n\n\nMRT\nMRT & LRT station exits\n\n\nHealthcare\n\n\n\nClinics\nCHAS Clinics\n\n\nEldercare services\nEldercare Services\n\n\n\n\n\n\n\n2.1 Import Data\n\n2.1.0 Singapore Maps\nBelow we will import Master Plan 2019 Subzone Boundary (No Sea). from data.gov.sg.\n\nCodeOutput\n\n\n\nmpsz &lt;- st_read(\"data/rawdata/MasterPlan2019SubzoneBoundaryNoSeaKML.kml\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n\n# extract values from the HTML description\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\n# extract info\nmpsz &lt;- mpsz %&gt;%\n  mutate(\n    REGION_N = map_chr(Description, extract_kml_field, \"REGION_N\"),\n    PLN_AREA_N = map_chr(Description, extract_kml_field, \"PLN_AREA_N\"),\n    SUBZONE_N = map_chr(Description, extract_kml_field, \"SUBZONE_N\"),\n    SUBZONE_C = map_chr(Description, extract_kml_field, \"SUBZONE_C\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\nwrite_rds(mpsz, \"data/rds/mpsz.rds\")\n\n\n\n\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\n\n\n\n\n2.1.1 HDB resale data Preparation\n\nLoad dataStreet namesGeocoding Resale Datasf objects transformation\n\n\n\nLoad HDB Resale Data\n\nThis data set comprises of HDB resale transactions from July 2017 onwards. Below we will extract a sub-set of transaction records on 4-Room flat transacted during July 2024 to June 2025.\n\n\nCode\nHDBresale &lt;- read_csv(\n  \"data/rawdata/ResaleflatpricesJan2017.csv\") %&gt;%\n  filter(flat_type == \"4 ROOM\") %&gt;%\n  filter(month &gt;= \"2024-07\" & month &lt;= \"2025-09\") # filter the sample data for the exercise till 09/2025.\n\nwrite_rds(HDBresale, \"data/rds/HDBresale.rds\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmonth\ntown\nflat_type\nblock\nstreet_name\nstorey_range\nfloor_area_sqm\nflat_model\nlease_commence_date\nremaining_lease\nresale_price\n\n\n\n\n2024-07\nANG MO KIO\n4 ROOM\n335\nANG MO KIO AVE 1\n01 TO 03\n91\nNew Generation\n1982\n56 years 08 months\n528888\n\n\n2024-07\nANG MO KIO\n4 ROOM\n333\nANG MO KIO AVE 1\n01 TO 03\n93\nNew Generation\n1981\n55 years 08 months\n500000\n\n\n2024-07\nANG MO KIO\n4 ROOM\n226\nANG MO KIO AVE 1\n07 TO 09\n91\nNew Generation\n1978\n52 years 07 months\n540000\n\n\n2024-07\nANG MO KIO\n4 ROOM\n336\nANG MO KIO AVE 1\n01 TO 03\n91\nNew Generation\n1982\n56 years 08 months\n500000\n\n\n2024-07\nANG MO KIO\n4 ROOM\n303\nANG MO KIO AVE 1\n10 TO 12\n97\nNew Generation\n1977\n51 years 09 months\n620000\n\n\n\n\n\n\n\n\nFurther processing for street names\n\nWe do further processing for the data as the street names with Saint are usually written as St.\n\n\nCode\n# street names is ST, but it's actually Sait.\nHDBresale$street_name &lt;- gsub(\n  \"ST\\\\.\", \"SAINT\",\n  HDBresale$street_name\n)\n\n\n\n\nRows: 14,737\nColumns: 11\n$ month               &lt;chr&gt; \"2024-07\", \"2024-07\", \"2024-07\", \"2024-07\", \"2024-…\n$ town                &lt;chr&gt; \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO …\n$ flat_type           &lt;chr&gt; \"4 ROOM\", \"4 ROOM\", \"4 ROOM\", \"4 ROOM\", \"4 ROOM\", …\n$ block               &lt;chr&gt; \"335\", \"333\", \"226\", \"336\", \"303\", \"226\", \"337\", \"…\n$ street_name         &lt;chr&gt; \"ANG MO KIO AVE 1\", \"ANG MO KIO AVE 1\", \"ANG MO KI…\n$ storey_range        &lt;chr&gt; \"01 TO 03\", \"01 TO 03\", \"07 TO 09\", \"01 TO 03\", \"1…\n$ floor_area_sqm      &lt;dbl&gt; 91, 93, 91, 91, 97, 92, 91, 97, 94, 88, 102, 91, 8…\n$ flat_model          &lt;chr&gt; \"New Generation\", \"New Generation\", \"New Generatio…\n$ lease_commence_date &lt;dbl&gt; 1982, 1981, 1978, 1982, 1977, 1978, 1982, 1977, 20…\n$ remaining_lease     &lt;chr&gt; \"56 years 08 months\", \"55 years 08 months\", \"52 ye…\n$ resale_price        &lt;dbl&gt; 528888, 500000, 540000, 500000, 620000, 570000, 50…\n\n\n\n\nWe use OneMap Geocode API: - https://www.onemap.gov.sg/apidocs/. - https://www.onemap.gov.sg/apidocs/reverseGeocode\nBelow we will prepare a geocoding function. It aims to perform the following tasks:\n\nCombining the block and street name into an address. The addresses will be used to geocode instead of postal code\nPassing the address as the searchVal in our query\nSending the query to OneMapSG search. Note: Since we don’t need all the address details, we can set getAddrDetails as ‘N’\nConverting response (JSON object) to text\nSaving response in text form as a dataframe\nRetain the latitude and longitude for our output.\n\n\n\nCode\n# for multiple queries\ngeocode &lt;- function(block, streetname) {\n  base_url &lt;- \"https://onemap.gov.sg/api/common/elastic/search\"\n  address &lt;- paste(block, streetname, sep = \" \")\n  query &lt;- list(\"searchVal\" = address,\n                \"returnGeom\" = \"Y\",\n                \"getAddrDetails\" = \"N\", #No. can change to Y for comparison\n                \"pageNum\" = \"1\") \n  res &lt;- GET(base_url, query = query) #get URL query\n  restext &lt;- content(res, as = \"text\")\n  \n  output &lt;- fromJSON(restext) %&gt;%\n    as.data.frame %&gt;%\n    select(results.LATITUDE, results.LONGITUDE)\n  \n  return(output)\n}\n\n\n\nRun functions\n\n\n\nCode\nHDBresale$LATITUDE &lt;- 0\nHDBresale$LONGITUDE &lt;- 0\n\nfor(i in 1:nrow(HDBresale)){\n  temp_output &lt;- geocode(HDBresale[i, 4], HDBresale[i, 5])\n  \n  HDBresale$LATITUDE[i] &lt;- temp_output$results.LATITUDE\n  HDBresale$LONGITUDE[i] &lt;- temp_output$results.LONGITUDE\n}\n\n\n\n\n\nTransform to sf data frame\n\nWe want to ensure that: - both input data sets must be in sf objects - they must be in similar projected coordinates systems\n\n\nCode\nst_crs(HDBresale)\nHDBresale_sf &lt;- HDBresale %&gt;%\n  st_as_sf(\n    coords = c(\"LONGITUDE\", \"LATITUDE\"),\n    crs = 4326) %&gt;% #if decimal degree\n  st_transform(crs = 3414)\n\nwrite_rds(HDBresale_sf, \"data/rds/HDBresale_sf.rds\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmonth\ntown\nflat_type\nblock\nstreet_name\nstorey_range\nfloor_area_sqm\nflat_model\nlease_commence_date\nremaining_lease\nresale_price\ngeometry\n\n\n\n\n2024-07\nANG MO KIO\n4 ROOM\n335\nANG MO KIO AVE 1\n01 TO 03\n91\nNew Generation\n1982\n56 years 08 months\n528888\nPOINT (29933.3 38362.35)\n\n\n2024-07\nANG MO KIO\n4 ROOM\n333\nANG MO KIO AVE 1\n01 TO 03\n93\nNew Generation\n1981\n55 years 08 months\n500000\nPOINT (30045.48 38155.87)\n\n\n2024-07\nANG MO KIO\n4 ROOM\n226\nANG MO KIO AVE 1\n07 TO 09\n91\nNew Generation\n1978\n52 years 07 months\n540000\nPOINT (28566.05 38861.93)\n\n\n2024-07\nANG MO KIO\n4 ROOM\n336\nANG MO KIO AVE 1\n01 TO 03\n91\nNew Generation\n1982\n56 years 08 months\n500000\nPOINT (30055.03 38404.8)\n\n\n2024-07\nANG MO KIO\n4 ROOM\n303\nANG MO KIO AVE 1\n10 TO 12\n97\nNew Generation\n1977\n51 years 09 months\n620000\nPOINT (29328.33 38742.64)\n\n\n\n\n\n\n\n\n\n\n2.1.2 Load location factors data\nWe determined the predict factors in 2 categories. One is structural factors, and the other is location factors.\n\nStructural factorsLocation factors\n\n\n\nArea of the unit\nFloor level\nPlanning area (town)\nRemaining lease\nAge of the unit\n\n\n\n\nProxomity to CBD\nProxomity to business park\nProximity to eldercare\nProximity to foodcourt/hawker centres\nProximity to MRT\nProximity to park\nProximity to top primary school\nProximity to shopping mall\nProximity to supermarket\nProximity to healthcare facilities\nProximity to sports halls\nProximity to community clubs\nNumbers of kindergartens within 350m\nNumbers of childcare centres within 350m\nNumbers of bus stop within 350m\nNumbers of primary school within 1km\n\n\n\n\nBelow we will start processing the data for these predictive factors.\n\nEducationBusinessRecreationF&BTransportationHealthcare\n\n\nCHILDCARE CENTERS\nFor childcare centers, we derive a geometry point to compute numbers of childcare centers within 350m to the HDB units.\n\n\nCode\npreschool_data &lt;- st_read(\"data/rawdata/PreschoolsLocation.kml\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\n# extract info\npreschool_data &lt;- preschool_data %&gt;%\n  mutate(\n    name = map_chr(Description, extract_kml_field, \"CENTRE_NAME\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\nwrite_rds(preschool_data, \"data/rds/preschool_data.rds\")\n\n\n\n\n     name                    geometry   \n Length:2290        POINT        :2290  \n Class :character   epsg:3414    :   0  \n Mode  :character   +proj=tmer...:   0  \n\n\nQuick view of the data set\n\nkable(head(preschool_data, 3))\n\n\n\n\nname\ngeometry\n\n\n\n\nCHILDREN’S COVE PRESCHOOL PTE.LTD.\nPOINT (25089.46 31299.16)\n\n\nCHILDREN’S COVE PTE. LTD.\nPOINT (27189.07 32792.54)\n\n\nCHILDREN’S VINEYARD PRESCHOOL PTE. LTD\nPOINT (28844.56 36773.76)\n\n\n\n\n\nKINDERGARTENS\nFor kindergartens, we derive a geometry point to compute numbers of childcare centers within 350m to the HDB units.\n\n\nCode\nkindergarten_data &lt;- st_read(\"data/rawdata/Kindergartens.geojson\") %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(OBJECTID, NAME, geometry, DESCRIPTION)\n\nwrite_rds(kindergarten_data, \"data/rds/kindergarten_data.rds\")\n\n\n\n\n    OBJECTID        NAME           DESCRIPTION                 geometry  \n Min.   :7681   Length:448         Length:448         POINT        :448  \n 1st Qu.:7793   Class :character   Class :character   epsg:3414    :  0  \n Median :7904   Mode  :character   Mode  :character   +proj=tmer...:  0  \n Mean   :7904                                                            \n 3rd Qu.:8016                                                            \n Max.   :8128                                                            \n\n\nQuick view of the data set\n\nkable(head(kindergarten_data, 3))\n\n\n\n\n\n\n\n\n\n\nOBJECTID\nNAME\nDESCRIPTION\ngeometry\n\n\n\n\n7928\nPCF Sparkletots Preschool @ Cheng San-Seletar Blk 435 (KN)\nKindergartens\nPOINT (30325.45 38859.25)\n\n\n7929\nPCF Sparkletots Preschool @ Cheng San-Seletar Blk 533 (KN)\nKindergartens\nPOINT (30190.51 39574.18)\n\n\n7930\nPCF Sparkletots Preschool @ Cheng San-Seletar Blk 556 (DS)\nKindergartens\nPOINT (30705.05 39337.9)\n\n\n\n\n\nPRIMARY SCHOOLS\nFor primary schools, we derive a geometry point to compute numbers of childcare centers within 350m to the HDB units.\n\n\nCode\nprimschool_data &lt;- read_csv(\"data/rawdata/General Information of schools.csv\") %&gt;%\n  select(school_name, postal_code, address)\n\n\nBelow we need to geocode the primary school location because currently we have their postal codes.\n\n\nCode\ngeocode_postal &lt;- function(postal_code) {\n  url &lt;- paste0(\"https://www.onemap.gov.sg/api/common/elastic/search?\",\n                \"searchVal=\", postal_code,\n                \"&returnGeom=Y&getAddrDetails=Y\")\n  \n  response &lt;- GET(url)\n  \n  if (status_code(response) == 200) {\n    result &lt;- content(response, \"text\") %&gt;% fromJSON()\n    \n    if (result$found &gt; 0) {\n      return(data.frame(\n        latitude = as.numeric(result$results$LATITUDE[1]),\n        longitude = as.numeric(result$results$LONGITUDE[1])\n      ))\n    }\n  }\n  \n  return(data.frame(latitude = NA, longitude = NA))\n}\n\n# Geocode all primary schools\nprimschool_coords &lt;- lapply(primschool_data$postal_code, function(pc) {\n  Sys.sleep(0.2)  \n  geocode_postal(pc)\n})\n\nprimschool_coords_df &lt;- bind_rows(primschool_coords)\n\nprimschool_data &lt;- primschool_data %&gt;%\n  bind_cols(primschool_coords_df)\n\n# Convert to sf object\nprimschool_data &lt;- primschool_data %&gt;%\n  filter(!is.na(latitude)) %&gt;%  # Remove any that failed\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326) %&gt;%\n  st_transform(3414)  # Transform to SVY21\n\nnrow(primschool_data)  # How many successfully geocoded\n\n\nWe examine the school list and check what schools we will filter out using keywords, and derive the geometry point for all primary schools in the list.\n\n\nCode\nprimschool_data %&gt;%\n  filter(\n    grepl(\"SECONDARY|HIGH|INSTITUTE|INSTITUTION|SCHOOL OF|JUNIOR|COLLEGE\", \n               school_name, \n               ignore.case = TRUE)) %&gt;%\n\n# Remove non-primary schools \n  filter(school_name %in% \n           c(\"MARIS STELLA HIGH SCHOOL\", \"CATHOLIC HIGH SCHOOL\") |\n           !grepl(\"SECONDARY|HIGH|INSTITUTE|INSTITUTION|\n                  SCHOOL OF|JUNIOR|COLLEGE\", \n                  school_name, ignore.case = TRUE)) %&gt;%\n  filter(!school_name %in% \n           c(\"CHIJ KATONG CONVENT\", \"CHIJ ST. JOSEPH'S CONVENT\"))\n\nwrite_rds(primschool_data, \"data/rds/primschool_data.rds\") \n\n\n\n\n school_name         postal_code       address                   geometry  \n Length:188         Min.   :109100   Length:188         POINT        :188  \n Class :character   1st Qu.:457774   Class :character   epsg:3414    :  0  \n Mode  :character   Median :556425   Mode  :character   +proj=tmer...:  0  \n                    Mean   :553435                                         \n                    3rd Qu.:689213                                         \n                    Max.   :828869                                         \n\n\nQuick view of the data set\n\nkable(head(primschool_data, 3))\n\n\n\n\n\n\n\n\n\n\nschool_name\npostal_code\naddress\ngeometry\n\n\n\n\nADMIRALTY PRIMARY SCHOOL\n738907\n11 WOODLANDS CIRCLE\nPOINT (24296.63 47144.77)\n\n\nAHMAD IBRAHIM PRIMARY SCHOOL\n768643\n10 YISHUN STREET 11\nPOINT (27958.14 46096.26)\n\n\nAI TONG SCHOOL\n579646\n100 Bright Hill Drive\nPOINT (27966.81 38071.92)\n\n\n\n\n\nTOP PRIMARY SCHOOLS\nWe identify top 20 primary school from sophia education eestimated by exam scrores and academic excellence.\n\n\nCode\ntop_primschool_data &lt;- primschool_data %&gt;%\n  filter(school_name %in% c(\"RAFFLES GIRLS' PRIMARY SCHOOL\", \"NANYANG PRIMARY SCHOOL\",\n                          \"HENRY PARK PRIMARY SCHOOL\", \"ROSYTH SCHOOL\",\n                          \"AI TONG SCHOOL\", \"NAN HUA PRIMARY SCHOOL\", \"ST. HILDA'S PRIMARY SCHOOL\",\n                          \"TAO NAN SCHOOL\", \"CHIJ ST. NICHOLAS GIRLS' SCHOOL\",\n                          \"CATHOLIC HIGH SCHOOL\", \"PEI HWA PRESBYTERIAN PRIMARY SCHOOL\",\n                          \"METHODIST GIRLS' SCHOOL (PRIMARY)\", \"KONG HWA SCHOOL\",\n                          \"RED SWASTIKA SCHOOL\", \"SINGAPORE CHINESE GIRLS' SCHOOL\", \"MARIS STELLA HIGH SCHOOL\",\n                          \"ANGLO-CHINESE SCHOOL (PRIMARY)\", \"TEMASEK PRIMARY SCHOOL\",\"RIVER VALLEY PRIMARY SCHOOL\",\n                          \"CEDAR PRIMARY SCHOOL\"))\n\nwrite_rds(top_primschool_data, \"data/rds/top_primschool_data.rds\")\n\n\n\n\n school_name         postal_code       address                   geometry \n Length:20          Min.   :128806   Length:20          POINT        :20  \n Class :character   1st Qu.:304346   Class :character   epsg:3414    : 0  \n Mode  :character   Median :424766   Mode  :character   +proj=tmer...: 0  \n                    Mean   :417020                                        \n                    3rd Qu.:559242                                        \n                    Max.   :599986                                        \n\n\n\n\nProximity to offices is a factor when people consider buying a house. We assume that a shorter the distance to the offices drives higher purchasing value. In this study, we consider proximity to the CBD area and other business parks across the island.\nCBD\nFor CBD, we will extract the area for CBD from mpsz.\n\n\nCode\ncbd_data &lt;- mpsz %&gt;%\n  filter(SUBZONE_N %in% c(\"RAFFLES PLACE\", \"MARINA CENTRE\", \"TANJONG PAGAR\", \"CITY HALL\", \"CENTRAL SUBZONE\")) %&gt;%\n  st_union()\n\nwrite_rds(cbd_data, \"data/rds/cbd_data.rds\")\n\n\n\n\n      POLYGON     epsg:3414 +proj=tmer... \n            1             0             0 \n\n\ncbd_data is now a single merged polygon representing the entire CBD area. We will use this to calculate distance in later section.\nQuick view of the data set\n\nkable(head(cbd_data, 3))\n\n\n\n\ngeometry\n\n\n\n\nPOLYGON ((30510.72 29176.24…\n\n\n\n\n\nBUSINESS PARKS\nBusiness parks are typically smaller than planning areas, and we have multiple business parks to consider. Therefore, we will calculate centroid for measuring proximity, and transform polygon data to centroid point data.\n\n\nCode\nbizpark_data &lt;- st_read(\"data/rawdata/JTCBusinessParkLandGEOJSON.geojson\") %&gt;% \n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_centroid() %&gt;%\n  select(OBJECTID_1, LANDUSE, geometry)\n\nwrite_rds(bizpark_data, \"data/rds/bizpark_data.rds\")\n\n\n\n\n   OBJECTID_1     LANDUSE                   geometry  \n Min.   :3201   Length:292         POINT        :292  \n 1st Qu.:3274   Class :character   epsg:3414    :  0  \n Median :3346   Mode  :character   +proj=tmer...:  0  \n Mean   :3346                                         \n 3rd Qu.:3419                                         \n Max.   :3492                                         \n\n\nQuick view of the data set\n\nkable(head(bizpark_data, 3))\n\n\n\n\nOBJECTID_1\nLANDUSE\ngeometry\n\n\n\n\n3283\nBUSINESS PARK\nPOINT (42823.41 35766.39)\n\n\n3284\nBUSINESS PARK\nPOINT (42790.92 35430.63)\n\n\n3285\nBUSINESS PARK\nPOINT (42939.04 35654.4)\n\n\n\n\n\n\n\nSHOPPING MALLS\n\n\nCode\nsgmalls_rawdata &lt;- read_csv(\"data/rawdata/singapore_malls.csv\") %&gt;%\n  filter(!Mall_Name %in% c('JCube', 'JCube (closed)', 'Liang Court', 'Lot 1', \n                           'Nex', 'Novena Square Shopping Mall'))\n\nsgmalls_coordinates &lt;- read_csv(\"data/rawdata/shopping_mall_coordinates.csv\") %&gt;%\n  rename(Mall_Name = 'Mall Name')\n\nmerged_malls &lt;- full_join(sgmalls_rawdata, sgmalls_coordinates, by = \"Mall_Name\")\n\n\nAfter the merge, we examine if any shopping malls turn out without coordinates data.\n\n\nCode\nmalls_without_coords &lt;- merged_malls %&gt;%\n  filter(is.na(LONGITUDE) | is.na(LATITUDE)) %&gt;%\n  pull(Mall_Name)\n\nmalls_without_coords\n\n\nAmong checks, we identified some malls no longer in business:\n\nAmber Mansions: demolished in 1984\nBedok Point\nCapitol Centre\nEllenborough Market\nFunan DigitaLife Mall: duplicate\nGreat World: duplicate\nGV Yishun: cinema\nJurong Entertainment Centre: demolished 2010\nShaw Tower: demolished\nSpecialists’ Shopping Centre: redeveloped as Orchard Gateway\nTanglin Shopping Centre: CLOSED\nThe Golden Mile: CLOSED\nThe Verge: closed\nWoodland Mall: renamed to Woods square mall\n\nFor other malls, we manually check with Google maps and add the coordinates into the data set.\n\n\nCode\ncoords_to_fill &lt;- tibble(\n  Mall_Name = c(\"Alexandra Retail Centre\", \"Capitol Singapore\", \"Change Alley\",\n                \"Chinatown Point\", \"Clementi Mall\", \"Dawson Place\", \n                \"Esplanade Mall\", \"Forum The Shopping Mall\", \"Fu Lu Shou Complex\", \n                \"HarbourFront Centre\", \"Holland Road Shopping Centre\", \n                \"Holland Village Shopping Mall\", \n                \"Mandarin Gallery\", \"Mustafa Centre\", \"Novena Square\", \n                \"Orchard Towers\", \"Paya Lebar Quarter\", \"Peninsula Plaza\",\n                \"Punggol Coast Mall\", \"Scotts Shopping Centre\", \"Seletar Mall\",\n                \"Shaw House and Centre\", \"Singpost Center\",\n                \"South Beach\", \"Suntec City Mall\",\n                \"Tang Plaza\", \"The Cathay\", \n                \"The Majestic\", \"The Rail Mall\", \n                \"VivoCity\", \"Woodland Mall\"),\n  \n  LONGITUDE = c(103.8015, 103.8511, 103.8518, \n                103.8446, 103.7642, 103.8107,\n                103.8561, 103.8284, 103.8543,\n                103.8201, 103.7952, \n                103.7937, \n                103.8363, 103.8554, 103.8439,\n                103.8292, 103.8930, 103.8508,\n                103.9104, 103.8329, 103.8758,\n                103.8318, 103.8940, \n                103.8557, 103.8581, \n                103.8329, 103.8477,\n                103.8432, 103.7678,\n                103.8231, 103.7859\n                ),\n  LATITUDE = c(1.2741176, 1.293231, 1.284643, \n               1.285434, 1.315111, 1.293505, \n               1.290017, 1.306391, 1.301906,\n               1.265355, 1.310419, 1.319192,\n               \n               1.311708, \n               1.317859, 1.292544, 1.302237, \n               1.310192, 1.320230, 1.307743, \n               1.415818, 1.306093, 1.392464,\n               1.306507, \n               1.294485, 1.295778, \n               1.305221, 1.300409, \n               1.284871, 1.358212, \n               1.265357, 1.438082\n               )\n) \n\nmerged_malls &lt;- merged_malls %&gt;%\n  rows_update(coords_to_fill, by = \"Mall_Name\", unmatched = \"ignore\")\n\nmerged_malls &lt;-  merged_malls %&gt;%\n  mutate(\n    Mall_Name = case_when(\n      Mall_Name == \"Woods Square Mall\" ~ \"Woodland Mall\",\n      TRUE ~ Mall_Name\n    )\n  )\n\n# add new mall data\nnew_malls &lt;- tibble(\n  Mall_Name = \"Woodleigh Mall\",\n  LONGITUDE = 103.8718,\n  LATITUDE = 1.339560\n)  \n\nmerged_malls &lt;- merged_malls %&gt;%\n  bind_rows(new_malls)\n\n\nCheck the malls with missing coordinates.\n\n\nCode\nmalls_with_na &lt;- merged_malls %&gt;%\n  filter(is.na(LONGITUDE) | is.na(LATITUDE)) \n\nwrite_rds(malls_with_na, \"data/rds/malls_with_na.rds\")\n\n\n\n\n\n\n\nMall_Name\nLATITUDE\nLONGITUDE\n\n\n\n\nAmber Mansions\nNA\nNA\n\n\nBedok Point\nNA\nNA\n\n\nCapitol Centre\nNA\nNA\n\n\nEllenborough Market\nNA\nNA\n\n\nFunan DigitaLife Mall\nNA\nNA\n\n\nGV Yishun\nNA\nNA\n\n\nGreat World\nNA\nNA\n\n\nJurong Entertainment Centre\nNA\nNA\n\n\nShaw Tower\nNA\nNA\n\n\nSpecialists’ Shopping Centre\nNA\nNA\n\n\nTanglin Shopping Centre\nNA\nNA\n\n\nThe Golden Mile\nNA\nNA\n\n\nThe Verge\nNA\nNA\n\n\n\n\n\nThese malls are the ones duplicate or closed. We will go ahead to remove them. We will also remove 2 duplicate malls observed from merged_malls.\n\n\nCode\nmerged_malls &lt;- merged_malls %&gt;%\n  filter(!is.na(LONGITUDE) & !is.na(LATITUDE)) %&gt;%\n  distinct(Mall_Name, .keep_all = TRUE) %&gt;%\n  filter(!Mall_Name %in% c(\"Suntec City Mall\", \"Capitol Piazza\"))\n\n# Check how many remain\nnrow(merged_malls)\n\n# merged_malls has long, lat coordinates. We want to convert it to sf object, then SVY21.\nmerged_malls &lt;- merged_malls %&gt;%\n  st_as_sf(coords = c(\"LONGITUDE\", \"LATITUDE\"), crs = 4326) %&gt;%  # it's WGS84\n  st_transform(3414)  \n\nwrite_rds(merged_malls, \"data/rds/malls_data.rds\")\n\n\n\n\n  Mall_Name                  geometry  \n Length:184         POINT        :184  \n Class :character   epsg:3414    :  0  \n Mode  :character   +proj=tmer...:  0  \n\n\nQuick view of the data set\n\nkable(head(malls_data, 3))\n\n\n\n\nMall_Name\ngeometry\n\n\n\n\nAMK Hub\nPOINT (29685.51 39030.79)\n\n\nAlexandra Retail Centre\nPOINT (24458.84 28510.99)\n\n\nBedok Mall\nPOINT (38669.44 34109.91)\n\n\n\n\n\nSPORTS HALLS\n\n\nCode\nsports_data &lt;- st_read(\"data/rawdata/SportsFieldsSG.geojson\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\n# extract info\nsports_data &lt;- sports_data %&gt;%\n  mutate(\n    name = map_chr(Description, extract_kml_field, \"NAME\"),\n    description = map_chr(Description, extract_kml_field, \"DESCRIPTION\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col()) %&gt;%\n  select(-description)\n\nwrite_rds(sports_data, \"data/rds/sports_data.rds\")\n\n\n\n\n     name                    geometry  \n Length:182         POINT        :182  \n Class :character   epsg:3414    :  0  \n Mode  :character   +proj=tmer...:  0  \n\n\nQuick view of the data set\n\nkable(head(sports_data, 3))\n\n\n\n\nname\ngeometry\n\n\n\n\nSerangoon Garden Secondary School\nPOINT (32023.56 39127.53)\n\n\nShuqun Secondary School\nPOINT (17602.89 35813.36)\n\n\nJurong East Sports and Recreation Centre\nPOINT (16438.08 36526.17)\n\n\n\n\n\nPARKS\nFor the parks, we will compute centroid for each park and open space.\n\n\nCode\npark_data &lt;- st_read(\"data/rawdata/MasterPlan2019SDCPParkandOpenSpacelayer.kml\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414)\n\n# Calculate centroids \npark_data &lt;- park_data %&gt;%\n  mutate(centroid = st_centroid(geometry)) %&gt;%\n  select(-Description)\n\nwrite_rds(park_data, \"data/rds/park_data.rds\")\n\n\n\n\n     Name                    geometry             centroid   \n Length:1685        MULTIPOLYGON :  37   POINT        :1685  \n Class :character   POLYGON      :1648   epsg:3414    :   0  \n Mode  :character   epsg:3414    :   0   +proj=tmer...:   0  \n                    +proj=tmer...:   0                       \n\n\nQuick view of the data set\n\nkable(head(park_data, 3))\n\n\n\n\nName\ngeometry\ncentroid\n\n\n\n\nkml_1\nPOLYGON ((15876.84 37697.05…\nPOINT (16024.58 37668.09)\n\n\nkml_2\nPOLYGON ((15678.36 37672.24…\nPOINT (15522.79 37708.59)\n\n\nkml_3\nPOLYGON ((15345.81 37576.01…\nPOINT (15734.42 37525.8)\n\n\n\n\n\nCOMMUNITY CLUBS\n\n\nCode\ncc_data &lt;- st_read(\"data/rawdata/CommunityClubs.geojson\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\ncc_data &lt;- cc_data %&gt;%\n  mutate(\n    name = map_chr(Description, extract_kml_field, \"NAME\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\nwrite_rds(cc_data, \"data/rds/cc_data.rds\")\n\n\n\n\n     name                    geometry  \n Length:125         POINT        :125  \n Class :character   epsg:3414    :  0  \n Mode  :character   +proj=tmer...:  0  \n\n\nQuick view of the data set\n\nkable(head(cc_data, 3))\n\n\n\n\nname\ngeometry\n\n\n\n\nACE The Place CC\nPOINT (23428.65 45470.46)\n\n\nAljunied CC\nPOINT (34257.5 37416.8)\n\n\nAnchorvale CC\nPOINT (33936.82 42112.89)\n\n\n\n\n\n\n\nFOODCOURT/HAWKER CENTERS\n\n\nCode\nhkcenter_data &lt;- st_read(\"data/rawdata/HawkerCentresGEOJSON.geojson\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(OBJECTID, NAME, geometry, STATUS)\n\nwrite_rds(hkcenter_data, \"data/rds/hkcenter_data.rds\")\n\n\n\n\n    OBJECTID          NAME              STATUS                   geometry  \n Min.   :119041   Length:129         Length:129         POINT        :129  \n 1st Qu.:119073   Class :character   Class :character   epsg:3414    :  0  \n Median :119105   Mode  :character   Mode  :character   +proj=tmer...:  0  \n Mean   :119105                                                            \n 3rd Qu.:119137                                                            \n Max.   :119169                                                            \n\n\nQuick view of the data set\n\nkable(head(hkcenter_data, 3))\n\n\n\n\n\n\n\n\n\n\nOBJECTID\nNAME\nSTATUS\ngeometry\n\n\n\n\n119091\nAmoy Street Food Centre (Telok Ayer Food Centre)\nExisting\nPOINT (29480.26 29076.41)\n\n\n119092\nMargaret Drive Hawker Centre\nExisting (replacement)\nPOINT (24814.32 31095.01)\n\n\n119093\nPunggol Coast Hawker Centre\nExisting (new)\nPOINT (36371.37 44035.87)\n\n\n\n\n\nBelow we will check the status of these hawker centers, and find that all are either existing or under construction. None has stopped the business, so we will keep all these.\n\nunique(hkcenter_data$STATUS)\n\n[1] \"Existing\"               \"Existing (replacement)\" \"Existing (new)\"        \n[4] \"Under Construction\"     \"Interim Centre\"        \n\n\nSUPERMARKETS\n\n\nCode\nsupermarkets_data &lt;- st_read(\"data/rawdata/SupermarketsGEOJSON.geojson\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n# # calculate centroids\n#   mutate(centroid = st_centroid(geometry)) %&gt;%\n#   select(OBJECTID_1, centroid)\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\n# extract info\nsupermarkets_data &lt;- supermarkets_data %&gt;%\n  mutate(\n    name = map_chr(Description, extract_kml_field, \"LIC_NAME\"),\n    postcode = map_chr(Description, extract_kml_field, \"POSTCODE\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())  \n\nwrite_rds(supermarkets_data, \"data/rds/supermarkets_data.rds\")  \n\n\n\n\n     name             postcode                  geometry  \n Length:526         Length:526         POINT        :526  \n Class :character   Class :character   epsg:3414    :  0  \n Mode  :character   Mode  :character   +proj=tmer...:  0  \n\n\nQuick view of the data set\n\nkable(head(supermarkets_data, 3))\n\n\n\n\n\n\n\n\n\nname\npostcode\ngeometry\n\n\n\n\nLI LI CHENG SUPERMARKET (PUNGGOL) PTE. LTD.\n823273\nPOINT (35561.22 42685.17)\n\n\nSHENG SIONG SUPERMARKET PTE LTD\n380011\nPOINT (32184.01 32947.46)\n\n\nCOLD STORAGE SINGAPORE (1983) PTE LTD\n530683\nPOINT (33903.48 39480.46)\n\n\n\n\n\n\n\nMRT\nBelow we will import MRT station exit shapefile. The MRT stations may have multiple exits, and these exits matter when people go through them to enter or exit the stations. We will use the data to compute for proximity to HDB units.\n\n\nCode\nmrt_data &lt;- st_read(\"data/rawdata/TrainStationExit_Feb2025/Train_Station_Exit_Layer.shp\") %&gt;%\n  st_transform(crs = 3414)\n\n\nReading layer `Train_Station_Exit_Layer' from data source \n  `/Users/cathyc/Documents/cathyschu/analytics/geospatial/predict_hdb_resale/data/rawdata/TrainStationExit_Feb2025/Train_Station_Exit_Layer.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 595 features and 2 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 6134.086 ymin: 27499.7 xmax: 45356.36 ymax: 47865.92\nProjected CRS: SVY21\n\n\nCode\nsummary(mrt_data)\n\n\n   stn_name          exit_code                  geometry  \n Length:595         Length:595         POINT        :595  \n Class :character   Class :character   epsg:3414    :  0  \n Mode  :character   Mode  :character   +proj=tmer...:  0  \n\n\nQuick view of the data set\n\nkable(head(mrt_data, 3))\n\n\n\n\nstn_name\nexit_code\ngeometry\n\n\n\n\nMACPHERSON MRT STATION\nExit A\nPOINT (34285.07 34322.99)\n\n\nMACPHERSON MRT STATION\nExit B\nPOINT (34382.15 34231.9)\n\n\nMACPHERSON MRT STATION\nExit C\nPOINT (34337.29 34190.6)\n\n\n\n\n\nBUS STOPS\nBelow we will import Bus Stop Location shapfile from LTA DataMall.\n\n\nCode\nbus_data = st_read(dsn = \"data/rawdata/BusStopLocation_Aug2025\",\n                  layer = \"BusStop\")\nbus_data &lt;- bus_data %&gt;%\n  st_transform(crs = 3414)\n\nwrite_rds(bus_data, \"data/rds/bus_data.rds\")\n\n\n\n\n  BUS_STOP_N          LOC_DESC                  geometry   \n Length:5172        Length:5172        POINT        :5172  \n Class :character   Class :character   epsg:3414    :   0  \n Mode  :character   Mode  :character   +proj=tmer...:   0  \n\n\nQuick view of the data set\n\nkable(head(bus_data, 3))\n\n\n\n\nBUS_STOP_N\nLOC_DESC\ngeometry\n\n\n\n\n65059\nST ANNE’S CH\nPOINT (35565.66 41659.52)\n\n\n16171\nYUSOF ISHAK HSE\nPOINT (21439.91 31253.63)\n\n\n61101\nBLK 120\nPOINT (31381.06 35313.49)\n\n\n\n\n\n\n\nCLINICS\n\n\nCode\nclinics_data &lt;- st_read(\"data/rawdata/CHASClinics.geojson\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\n# extract info\nclinics_data &lt;- clinics_data %&gt;%\n  mutate(\n    name = map_chr(Description, extract_kml_field, \"HCI_NAME\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\nwrite_rds(clinics_data, \"data/rds/clinics_data.rds\")\n\n\n\n\n     name                    geometry   \n Length:1193        POINT        :1193  \n Class :character   epsg:3414    :   0  \n Mode  :character   +proj=tmer...:   0  \n\n\nQuick view of the data set\n\nkable(head(clinics_data, 3))\n\n\n\n\nname\ngeometry\n\n\n\n\nAcumed Medical Group\nPOINT (10760.19 34206.12)\n\n\nAcumed Medical Group\nPOINT (4985.534 30167.99)\n\n\nAdvantage Medical Clinic\nPOINT (23812.59 34780.58)\n\n\n\n\n\nELDERCARE SERVICES\n\n\nCode\neldercare_data &lt;- st_read(\"data/rawdata/EldercareServices.geojson\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\n# extract info\neldercare_data &lt;- eldercare_data %&gt;%\n  mutate(\n    name = map_chr(Description, extract_kml_field, \"NAME\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\nwrite_rds(eldercare_data, \"data/rds/eldercare_data.rds\")\n\n\n\n\n     name                    geometry  \n Length:133         POINT        :133  \n Class :character   epsg:3414    :  0  \n Mode  :character   +proj=tmer...:  0  \n\n\nQuick view of the data set\n\nkable(head(eldercare_data, 3))\n\n\n\n\nname\ngeometry\n\n\n\n\nYuhua Senior Activity Centre\nPOINT (16614.08 36639.12)\n\n\nTHK SAC @ Kaki Bukit\nPOINT (38803.81 35098.77)\n\n\nTHK SAC @ Boon Lay\nPOINT (14481.92 36357.61)\n\n\n\n\n\n\n\n\n\n\n2.1.3 Initial data inspection\nWe validate the coordinates of the location factor data below. It shows us that all now conform to SVY21, and ready for proximity computation.\n\nResultCode\n\n\n\n\nBusiness Park bizpark_data:  3414 \n \n CBD cbd_data:  3414 \n \n Clinics clinics_data:  3414 \n \n Eldercare Services eldercare_data:  3414 \n \n Foodcourt/Hawker Centers hkcenter_data:  3414 \n \n Shopping malls malls_data:  3414 \n \n MRT mrt_data:  3414 \n \n Parks park_data:  3414 \n \n Childcares preschool_data:  3414 \n \n Primary Schools primschool_data:  3414 \n \n Supermarkets supermarkets_data:  3414 \n \n Sports halls sports_data:  3414 \n \n Bus stops bus_data:  3414 \n \n Kindergartens kindergarten_data:  3414 \n \n Community Clubscc_data:  3414\n\n\n\n\n\ncat('Business Park bizpark_data: ',st_crs(bizpark_data)$epsg, '\\n','\\n',\n    'CBD cbd_data: ', st_crs(cbd_data)$epsg, '\\n','\\n',\n    'Clinics clinics_data: ', st_crs(clinics_data)$epsg, '\\n','\\n',\n    'Eldercare Services eldercare_data: ', st_crs(eldercare_data)$epsg, '\\n','\\n',\n    'Foodcourt/Hawker Centers hkcenter_data: ', st_crs(hkcenter_data)$epsg, '\\n','\\n',\n    'Shopping malls malls_data: ', st_crs(malls_data)$epsg, '\\n','\\n',\n    'MRT mrt_data: ', st_crs(mrt_data)$epsg, '\\n','\\n',\n    'Parks park_data: ', st_crs(park_data)$epsg, '\\n','\\n',\n    'Childcares preschool_data: ', st_crs(preschool_data)$epsg, '\\n','\\n',\n    'Primary Schools primschool_data: ', st_crs(primschool_data)$epsg, '\\n','\\n',\n    'Supermarkets supermarkets_data: ', st_crs(supermarkets_data)$epsg, '\\n','\\n',\n    'Sports halls sports_data: ', st_crs(sports_data)$epsg, '\\n','\\n',\n    'Bus stops bus_data: ', st_crs(bus_data)$epsg, '\\n','\\n',\n    'Kindergartens kindergarten_data: ', st_crs(kindergarten_data)$epsg, '\\n','\\n',\n    'Community Clubscc_data: ', st_crs(cc_data)$epsg)\n\n\n\n\n\n\n\n2.2 Structural factors\nThe tructural factors for this study include flat type, floor level, town, planning area, area of unit, age of unit, main upgrading program, and flat model. Currently in our data, we have the variables shown below:\n\nnames(HDBresale_sf)\n\n [1] \"month\"               \"town\"                \"flat_type\"          \n [4] \"block\"               \"street_name\"         \"storey_range\"       \n [7] \"floor_area_sqm\"      \"flat_model\"          \"lease_commence_date\"\n[10] \"remaining_lease\"     \"resale_price\"        \"geometry\"           \n\n\nWe will rename some of the factors and keep the factors being used for the study. In addition, we will convert the floor range storey_range to numerical variable, using its lowest level, and rename the varaible to floor_level. We will also calculate the unit age using the lease_commence_date variable.\n\n\nCode\nHDBresale_sf_rename &lt;- HDBresale_sf %&gt;%\n  rename(transact_date = month,\n         remaining_lease_mths = remaining_lease,\n         floor_level = storey_range,\n         plan_area = town) %&gt;%\n  mutate(floor_level = as.numeric(substr(floor_level, 1, 2)),\n         age = 2025 - lease_commence_date) %&gt;%\n    select(transact_date, resale_price, floor_level, plan_area, \n         floor_area_sqm, flat_model, \n         remaining_lease_mths, age, geometry) \n\nwrite_rds(HDBresale_sf_rename, \"data/rds/HDBresale_sf_rename.rds\")  \n\n\n\n\nRows: 14,737\nColumns: 9\n$ transact_date        &lt;chr&gt; \"2024-07\", \"2024-07\", \"2024-07\", \"2024-07\", \"2024…\n$ resale_price         &lt;dbl&gt; 528888, 500000, 540000, 500000, 620000, 570000, 5…\n$ floor_level          &lt;dbl&gt; 1, 1, 7, 1, 10, 10, 1, 4, 7, 19, 7, 7, 10, 4, 25,…\n$ plan_area            &lt;chr&gt; \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO…\n$ floor_area_sqm       &lt;dbl&gt; 91, 93, 91, 91, 97, 92, 91, 97, 94, 88, 102, 91, …\n$ flat_model           &lt;chr&gt; \"New Generation\", \"New Generation\", \"New Generati…\n$ remaining_lease_mths &lt;chr&gt; \"56 years 08 months\", \"55 years 08 months\", \"52 y…\n$ age                  &lt;dbl&gt; 43, 44, 47, 43, 48, 47, 43, 48, 13, 13, 32, 43, 1…\n$ geometry             &lt;POINT [m]&gt; POINT (29933.3 38362.35), POINT (30045.48 3…\n\n\nFor predictive modeling, we should change data type for the following variables: transact_date and remaining_lease_mths to date and numeric data type respectively.\n\n\nCode\n# convert transction date to date data type\nHDB_data &lt;- HDBresale_sf_rename %&gt;%\n  mutate(\n    transact_date = as.Date(paste0(transact_date, \"-01\")),\n    \n    # Extract years\n    years = as.numeric(str_extract(remaining_lease_mths, \"\\\\d+(?= year)\")),\n    # Extract months\n    months = as.numeric(str_extract(remaining_lease_mths, \"\\\\d+(?= month)\")),\n\n    years = ifelse(is.na(years), 0, years),\n    months = ifelse(is.na(months), 0, months),\n\n    remaining_lease_mths_num = years * 12 + months\n  ) %&gt;%\n  select(-years, -months)  # Remove temporary columns\nwrite_rds(HDB_data, \"data/rds/HDB_data.rds\")\n\n\nBelow we confirm the transction date is now Date data type and the remaining lease is in numeric data type as months.\n\n\n [1] \"2024-07-01\" \"2024-07-01\" \"2024-07-01\" \"2024-07-01\" \"2024-07-01\"\n [6] \"2024-07-01\" \"2024-08-01\" \"2024-09-01\" \"2024-09-01\" \"2024-09-01\"\n\n\n[1] \"Date\"\n\n\n[1] \"numeric\"\n\n\n\n\n2.3 Proximity Analysis\nIn this section, we will prepare location factors of their proximity to the HDB units and the availability of these facilities within a fixed distance of the HDB housing.\n\n2.3.1 Computing shortest distance\nWe would like to use proximity from the HDB units to the location factors to predict the resale price. When one purchases housing, distance to useful facilities is always a consideration or value drivers. For example, an HDB unit being only 100m away would be very different from 500m away from the nearest MRT station, as it takes longer time to commute and can be inconvenient in rainy and hot days.\nTherefore, below we will compute the distance between the nearest facilities/infrastructures from each HDB resale property. The distance computed would be in meters.\n\nEducationF&BHealthcareRecreationTransportationBusiness\n\n\n\n\nCode\n# Top Primary school\nHDB_combine_edu &lt;- HDB_data %&gt;%\n  mutate(\n    PROX_TOPSCHOOL = as.numeric(\n      st_distance(geometry,\n                  top_primschool_data[st_nearest_feature(\n                    geometry, top_primschool_data), ], \n                  by_element = TRUE)\n      ))\nwrite_rds(HDB_combine_edu, \"data/rds/HDB_combine_edu.rds\")\n\n\n\n\nCode\nHDB_combine_edu &lt;- read_rds(\"data/rds/HDB_combine_edu.rds\")\nkable(head(HDB_combine_edu, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n\n\n\n\n\n\n\n\n\nCode\n# Hawker centers\nHDB_combine_2fb &lt;- HDB_combine_edu %&gt;%\n  mutate(\n    PROX_HKCENTER = as.numeric(\n      st_distance(geometry,\n                  hkcenter_data[st_nearest_feature(\n                    geometry, hkcenter_data), ], \n                  by_element = TRUE)),\n# Supermarkets\n    PROX_SUPERMKT =  as.numeric(\n      st_distance(geometry,\n                  supermarkets_data[st_nearest_feature(\n                    geometry, supermarkets_data), ], \n                  by_element = TRUE))\n    )\n\nwrite_rds(HDB_combine_2fb, \"data/rds/HDB_combine_2fb.rds\")\n\n\n\n\nCode\nHDB_combine_2fb &lt;- read_rds(\"data/rds/HDB_combine_2fb.rds\")\nkable(head(HDB_combine_2fb, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n\n\n\n\n\n\n\n\n\nCode\n# Clinics\nHDB_combine_3hc &lt;- HDB_combine_2fb %&gt;%\n  mutate(\n    PROX_CLINIC = as.numeric(\n      st_distance(geometry,\n                  clinics_data[st_nearest_feature(\n                    geometry, clinics_data), ], \n                  by_element = TRUE)),\n# Eldercare\n    PROX_ELDERCARE =  as.numeric(\n      st_distance(geometry,\n                  eldercare_data[st_nearest_feature(\n                    geometry, eldercare_data), ], \n                  by_element = TRUE))\n    )\n\nwrite_rds(HDB_combine_3hc, \"data/rds/HDB_combine_3hc.rds\")\n\n\n\n\nCode\nHDB_combine_3hc &lt;- read_rds(\"data/rds/HDB_combine_3hc.rds\")\nkable(head(HDB_combine_3hc, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n\n\n\n\n\n\n\n\n\nCode\n# Shopping mall\nHDB_combine_4rc &lt;- HDB_combine_3hc %&gt;%\n  mutate(\n    PROX_MALLS = as.numeric(\n      st_distance(geometry,\n                  malls_data[st_nearest_feature(\n                    geometry, malls_data), ], \n                  by_element = TRUE)),\n# Sports hall\n    PROX_SPORTS =  as.numeric(\n      st_distance(geometry,\n                  sports_data[st_nearest_feature(\n                    geometry, sports_data), ], \n                  by_element = TRUE)),\n# Community Club\n    PROX_CC =  as.numeric(\n      st_distance(geometry,\n                  cc_data[st_nearest_feature(\n                    geometry, cc_data), ], \n                  by_element = TRUE)),\n# Parks\n    PROX_PARK =  as.numeric(\n      st_distance(geometry,\n                  park_data[st_nearest_feature(\n                    geometry, park_data), ], \n                  by_element = TRUE))\n    )\n\nwrite_rds(HDB_combine_4rc, \"data/rds/HDB_combine_4rc.rds\")\n\n\n\n\nCode\nHDB_combine_4rc &lt;- read_rds(\"data/rds/HDB_combine_4rc.rds\")\nkable(head(HDB_combine_4rc, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n\n\n\n\n\n\n\n\n\nCode\n# Shopping mall\nHDB_combine_5transp &lt;- HDB_combine_4rc %&gt;%\n  mutate(\n    PROX_MRT = as.numeric(\n      st_distance(geometry,\n                  mrt_data[st_nearest_feature(\n                    geometry, mrt_data), ], \n                  by_element = TRUE))\n    )\n\nwrite_rds(HDB_combine_5transp, \"data/rds/HDB_combine_5transp.rds\")\n\n\n\n\nCode\nHDB_combine_5transp &lt;- read_rds(\"data/rds/HDB_combine_5transp.rds\")\nkable(head(HDB_combine_5transp, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n\n\n\n\n\n\n\n\n\nCode\n# CBD\nHDB_combine_6biz &lt;- HDB_combine_5transp %&gt;%\n  mutate(\n    PROX_CBD = as.numeric(\n      st_distance(geometry,\n                  cbd_data)),\n    PROX_BIZPK = as.numeric(\n      st_distance(geometry,\n                  cbd_data)),\n# Business parks\n    PROX_BIZPK = as.numeric(\n      st_distance(geometry,\n                  bizpark_data[st_nearest_feature(\n                    geometry, bizpark_data), ], \n                  by_element = TRUE))\n    )\nwrite_rds(HDB_combine_6biz, \"data/rds/HDB_combine_6biz.rds\")\n\n\n\n\nCode\nHDB_combine_6biz &lt;- read_rds(\"data/rds/HDB_combine_6biz.rds\")\nkable(head(HDB_combine_6biz, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n\n\n\n\n\n\n\n\n\n\n2.3.2 Create binary proximity indicators\nNext we will derive a binary data to find out which schools are within 350 meters. st_is_within_distance() of sf package is used to determine whether two spatial objects (HDB property and preschool) are within a set distance of each other. It returns a logical matrix (or a sparse list of indices if sparse = TRUE) indicating for each geometry in HDB property which geometries in the facility are within the set distance.\n\nTop primary schoolMRTHawker centre\n\n\nWithin 1 km\n\n\nCode\nwithin_1km &lt;- st_is_within_distance(\n  HDB_data, top_primschool_data, dist = 1000)\n\nHDB_combine_7bi_primschool &lt;- HDB_combine_6biz %&gt;%\n  mutate(\n    WITHIN_1km_TOPPRISCH = map_int(within_1km, length),\n    WITHIN_1km_TOPPRISCH_BINARY = ifelse(WITHIN_1km_TOPPRISCH &gt; 0, 1, 0)\n)\nwrite_rds(HDB_combine_7bi_primschool, \"data/rds/HDB_combine_7bi_primschool.rds\")\n\n\n\n\nCode\nHDB_combine_7bi_primschool &lt;- \n  read_rds(\"data/rds/HDB_combine_7bi_primschool.rds\")\nkable(head(HDB_combine_7bi_primschool, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH\nWITHIN_1km_TOPPRISCH_BINARY\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n0\n0\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n0\n0\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n2\n1\n\n\n\n\n\n\n\nWithin 500 meters\n\n\nCode\nwithin_500m_mrt &lt;- st_is_within_distance(\n  HDB_data, mrt_data, dist = 500)\n\nHDB_combine_7bi_mrt &lt;- HDB_combine_7bi_primschool %&gt;%\n  mutate(\n    WITHIN_500m_MRT_BINARY = as.numeric(lengths(within_500m_mrt) &gt; 0)\n)\nwrite_rds(HDB_combine_7bi_mrt, \"data/rds/HDB_combine_7bi_mrt.rds\")\n\n\n\n\nCode\nHDB_combine_7bi_mrt &lt;- read_rds(\"data/rds/HDB_combine_7bi_mrt.rds\")\nkable(head(HDB_combine_7bi_mrt, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_MRT_BINARY\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n0\n0\n0\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n0\n0\n0\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n2\n1\n1\n\n\n\n\n\n\n\nWithin 500 meters\n\n\nCode\nwithin_500m_hkcenter &lt;- st_is_within_distance(\n  HDB_data, hkcenter_data, dist = 500)\n\nHDB_combine_7bi_hkcenter &lt;- HDB_combine_7bi_mrt %&gt;%\n  mutate(\n    WITHIN_500m_HKC_BINARY = as.numeric(lengths(within_500m_hkcenter) &gt; 0)\n)\nwrite_rds(HDB_combine_7bi_hkcenter, \"data/rds/HDB_combine_7bi_hkcenter.rds\")\n\n\n\n\nCode\nHDB_combine_7bi_hkcenter &lt;- read_rds(\"data/rds/HDB_combine_7bi_hkcenter.rds\")\nkable(head(HDB_combine_7bi_hkcenter, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_MRT_BINARY\nWITHIN_500m_HKC_BINARY\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n0\n0\n0\n1\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n0\n0\n0\n1\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n2\n1\n1\n1\n\n\n\n\n\n\n\n\n\n\n\n2.4 Amenity Density Analysis\nWe would like to compute the amenity density with the number of location factors within a designated distance. map_int() of purr package is used to the number of preschools found in the newly created WITHIN_[distance]_[amenity] field.\n\nkindergartenchildcarebus stopprimary school\n\n\nKindergartens within 350m of the HDB unit.\n\n\nCode\nwithin_350m_kindg &lt;- st_is_within_distance(\n  HDB_data, kindergarten_data, dist = 350)\n\nHDB_combine_8dense_kindg &lt;- HDB_combine_7bi_hkcenter %&gt;%\n  mutate(\n    WITHIN_350m_KINDG = map_int(within_350m_kindg, length)\n)\nwrite_rds(HDB_combine_8dense_kindg, \"data/rds/HDB_combine_8dense_kindg.rds\")\n\n\n\n\nCode\nHDB_combine_8dense_kindg &lt;- read_rds(\"data/rds/HDB_combine_8dense_kindg.rds\")\nkable(head(HDB_combine_8dense_kindg, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_MRT_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n0\n0\n0\n1\n1\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n0\n0\n0\n1\n0\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n2\n1\n1\n1\n2\n\n\n\n\n\n\n\nChildcares within 350m of the HDB unit.\n\n\nCode\nwithin_350m_childc &lt;- st_is_within_distance(\n  HDB_data, preschool_data, dist = 350)\n\nHDB_combine_8dense_childc &lt;- HDB_combine_8dense_kindg %&gt;%\n  mutate(\n    WITHIN_350m_CHILDC = map_int(within_350m_childc, length)\n)\nwrite_rds(HDB_combine_8dense_childc, \"data/rds/HDB_combine_8dense_childc.rds\")\n\n\n\n\nCode\nHDB_combine_8dense_childc &lt;- read_rds(\"data/rds/HDB_combine_8dense_childc.rds\")\nkable(head(HDB_combine_8dense_childc, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_MRT_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\nWITHIN_350m_CHILDC\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n0\n0\n0\n1\n1\n2\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n0\n0\n0\n1\n0\n1\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n2\n1\n1\n1\n2\n7\n\n\n\n\n\n\n\nBus stops within 350m of the HDB unit.\n\n\nCode\nwithin_350m_bus &lt;- st_is_within_distance(\n  HDB_data, bus_data, dist = 350)\n\nHDB_combine_8dense_bus &lt;- HDB_combine_8dense_childc %&gt;%\n  mutate(\n    WITHIN_350m_BUS = map_int(within_350m_bus, length)\n)\nwrite_rds(HDB_combine_8dense_bus, \"data/rds/HDB_combine_8dense_bus.rds\")\n\n\n\n\nCode\nHDB_combine_8dense_bus &lt;- read_rds(\"data/rds/HDB_combine_8dense_bus.rds\")\nkable(head(HDB_combine_8dense_bus, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_MRT_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\nWITHIN_350m_CHILDC\nWITHIN_350m_BUS\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n0\n0\n0\n1\n1\n2\n8\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n0\n0\n0\n1\n0\n1\n7\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n2\n1\n1\n1\n2\n7\n7\n\n\n\n\n\n\n\nKindergartens within 1km of the HDB unit. We use 1km because housing within 1km of a primary school gets the priority of entolment. This is an important factor for some parents to look for (new) housing due to children education planning.\n\n\nCode\nwithin_1km_primsch &lt;- st_is_within_distance(\n  HDB_data, primschool_data, dist = 1000)\n\nHDB_combine_8dense_primsch &lt;- HDB_combine_8dense_bus %&gt;%\n  mutate(\n    WITHIN_1km_PRISCH = map_int(within_1km_primsch, length)\n)\n\nwrite_rds(HDB_combine_8dense_primsch, \"data/rds/HDB_combine_8dense_primsch.rds\")\n\n\n\n\nCode\nHDB_combine_8dense_primsch &lt;- read_rds(\"data/rds/HDB_combine_8dense_primsch.rds\")\nkable(head(HDB_combine_8dense_primsch, 3))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths\nage\ngeometry\nremaining_lease_mths_num\nPROX_TOPSCHOOL\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_MRT_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\nWITHIN_350m_CHILDC\nWITHIN_350m_BUS\nWITHIN_1km_PRISCH\n\n\n\n\n2024-07-01\n528888\n1\nANG MO KIO\n91\nNew Generation\n56 years 08 months\n43\nPOINT (29933.3 38362.35)\n680\n1139.996\n289.9814\n349.2533\n93.99557\n334.2702\n712.8886\n347.0061\n316.9522\n154.24457\n696.6567\n7080.609\n8453.334\n0\n0\n0\n1\n1\n2\n8\n3\n\n\n2024-07-01\n500000\n1\nANG MO KIO\n93\nNew Generation\n55 years 08 months\n44\nPOINT (30045.48 38155.87)\n668\n1054.740\n424.9982\n468.6671\n141.54013\n433.8346\n946.0851\n507.8975\n281.2363\n63.25578\n919.2072\n6861.176\n8495.518\n0\n0\n0\n1\n0\n1\n7\n2\n\n\n2024-07-01\n540000\n7\nANG MO KIO\n91\nNew Generation\n52 years 07 months\n47\nPOINT (28566.05 38861.93)\n631\n785.850\n132.0052\n186.2702\n101.16857\n397.6108\n959.9848\n336.9090\n270.5919\n242.55766\n383.6496\n7868.887\n8490.800\n2\n1\n1\n1\n2\n7\n7\n3\n\n\n\n\n\n\n\n\n\n\n2.5 Final Dataset Assembly\n\n2.5.1 Save the master dataset\nWith each data processing step in section 2.3 and 2.4, we have assembled all structural and location factors into the dataset HDB_combine_8dense_primsch. Below code we removed remaining_lease_mths because it has been converted to a new variable in months remaining_lease_mths_num.\n\n\nCode\nHDB_master &lt;- HDB_combine_8dense_primsch %&gt;%\n  select(-remaining_lease_mths)\n\nwrite_rds(HDB_master, \"data/rds/HDB_master.rds\")\n\n\n\n\nRows: 14,737\nColumns: 29\n$ transact_date               &lt;date&gt; 2024-07-01, 2024-07-01, 2024-07-01, 2024-…\n$ resale_price                &lt;dbl&gt; 528888, 500000, 540000, 500000, 620000, 57…\n$ floor_level                 &lt;dbl&gt; 1, 1, 7, 1, 10, 10, 1, 4, 7, 19, 7, 7, 10,…\n$ plan_area                   &lt;chr&gt; \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", …\n$ floor_area_sqm              &lt;dbl&gt; 91, 93, 91, 91, 97, 92, 91, 97, 94, 88, 10…\n$ flat_model                  &lt;chr&gt; \"New Generation\", \"New Generation\", \"New G…\n$ age                         &lt;dbl&gt; 43, 44, 47, 43, 48, 47, 43, 48, 13, 13, 32…\n$ geometry                    &lt;POINT [m]&gt; POINT (29933.3 38362.35), POINT (300…\n$ remaining_lease_mths_num    &lt;dbl&gt; 680, 668, 631, 680, 621, 631, 680, 620, 10…\n$ PROX_TOPSCHOOL              &lt;dbl&gt; 1139.9957, 1054.7401, 785.8500, 1246.3765,…\n$ PROX_HKCENTER               &lt;dbl&gt; 289.98144, 424.99822, 132.00515, 398.27582…\n$ PROX_SUPERMKT               &lt;dbl&gt; 349.25330, 468.66713, 186.27015, 237.72203…\n$ PROX_CLINIC                 &lt;dbl&gt; 9.399557e+01, 1.415401e+02, 1.011686e+02, …\n$ PROX_ELDERCARE              &lt;dbl&gt; 334.27019, 433.83460, 397.61080, 214.39384…\n$ PROX_MALLS                  &lt;dbl&gt; 712.8886, 946.0851, 959.9848, 726.9160, 45…\n$ PROX_SPORTS                 &lt;dbl&gt; 347.0061, 507.8975, 336.9090, 260.9641, 30…\n$ PROX_CC                     &lt;dbl&gt; 316.95217, 281.23633, 270.59187, 202.78502…\n$ PROX_PARK                   &lt;dbl&gt; 154.24457, 63.25578, 242.55766, 115.96037,…\n$ PROX_MRT                    &lt;dbl&gt; 696.6567, 919.2072, 383.6496, 680.8811, 54…\n$ PROX_CBD                    &lt;dbl&gt; 7080.609, 6861.176, 7868.887, 7107.071, 75…\n$ PROX_BIZPK                  &lt;dbl&gt; 8453.334, 8495.518, 8490.800, 8331.434, 87…\n$ WITHIN_1km_TOPPRISCH        &lt;int&gt; 0, 0, 2, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, …\n$ WITHIN_1km_TOPPRISCH_BINARY &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, …\n$ WITHIN_500m_MRT_BINARY      &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ WITHIN_500m_HKC_BINARY      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ WITHIN_350m_KINDG           &lt;int&gt; 1, 0, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 0, 1, …\n$ WITHIN_350m_CHILDC          &lt;int&gt; 2, 1, 7, 3, 8, 7, 3, 8, 7, 7, 5, 3, 2, 6, …\n$ WITHIN_350m_BUS             &lt;int&gt; 8, 7, 7, 6, 7, 7, 7, 7, 4, 4, 4, 7, 5, 6, …\n$ WITHIN_1km_PRISCH           &lt;int&gt; 3, 2, 3, 3, 3, 3, 3, 3, 2, 2, 3, 3, 2, 3, …\n\n\n\n\n2.5.2 Handle remaining missing values\nAfter data assembly, let’s check if there is any missing values from the master dataset. The result FALSE indicates that there is no missing value.\n\nanyNA(HDB_master)\n\n[1] FALSE"
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#data-quality-spatial-overview",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#data-quality-spatial-overview",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "3 Data Quality & Spatial Overview",
    "text": "3 Data Quality & Spatial Overview\n\n3.1 Data Quality Check\nLet’s run a summary statistics to examine is there is any obvious anomaly or outliers. From below results, there is no obvious anomaly detected. Just an interesting fact that the childcare service density could be up to 35 within 350m of range.\n\nsummary(HDB_master)\n\n transact_date         resale_price      floor_level      plan_area        \n Min.   :2024-07-01   Min.   : 300000   Min.   : 1.000   Length:14737      \n 1st Qu.:2024-10-01   1st Qu.: 552000   1st Qu.: 4.000   Class :character  \n Median :2025-02-01   Median : 620000   Median : 7.000   Mode  :character  \n Mean   :2025-01-26   Mean   : 661081   Mean   : 8.232                     \n 3rd Qu.:2025-06-01   3rd Qu.: 713888   3rd Qu.:10.000                     \n Max.   :2025-09-01   Max.   :1518000   Max.   :49.000                     \n floor_area_sqm    flat_model             age                 geometry    \n Min.   : 74.00   Length:14737       Min.   : 4.00   POINT        :14737  \n 1st Qu.: 92.00   Class :character   1st Qu.: 9.00   epsg:3414    :    0  \n Median : 93.00   Mode  :character   Median :23.00   +proj=tmer...:    0  \n Mean   : 94.83                      Mean   :22.92                        \n 3rd Qu.:100.00                      3rd Qu.:37.00                        \n Max.   :135.00                      Max.   :58.00                        \n remaining_lease_mths_num PROX_TOPSCHOOL  PROX_HKCENTER     PROX_SUPERMKT      \n Min.   : 485.0           Min.   :  121   Min.   :  25.35   Min.   :2.600e-04  \n 1st Qu.: 753.0           1st Qu.: 1797   1st Qu.: 377.90   1st Qu.:1.777e+02  \n Median : 914.0           Median : 3314   Median : 647.45   Median :2.751e+02  \n Mean   : 918.6           Mean   : 3938   Mean   : 732.41   Mean   :3.033e+02  \n 3rd Qu.:1084.0           3rd Qu.: 5679   3rd Qu.: 959.11   3rd Qu.:3.902e+02  \n Max.   :1144.0           Max.   :10448   Max.   :2500.14   Max.   :1.415e+03  \n  PROX_CLINIC        PROX_ELDERCARE        PROX_MALLS       PROX_SPORTS     \n Min.   :  0.00001   Min.   :   0.0004   Min.   :  39.14   Min.   :  36.22  \n 1st Qu.:111.99873   1st Qu.: 337.5461   1st Qu.: 368.11   1st Qu.: 259.44  \n Median :172.37676   Median : 660.4340   Median : 582.30   Median : 410.32  \n Mean   :188.62285   Mean   : 822.7558   Mean   : 643.05   Mean   : 499.02  \n 3rd Qu.:243.46665   3rd Qu.:1144.2391   3rd Qu.: 858.78   3rd Qu.: 635.99  \n Max.   :808.33274   Max.   :3301.6373   Max.   :2274.71   Max.   :2044.94  \n    PROX_CC           PROX_PARK         PROX_MRT          PROX_CBD       \n Min.   :   2.012   Min.   :  3.39   Min.   :  21.79   Min.   :   28.89  \n 1st Qu.: 320.268   1st Qu.: 75.47   1st Qu.: 284.05   1st Qu.: 8673.61  \n Median : 492.476   Median :135.67   Median : 512.38   Median :12009.99  \n Mean   : 524.277   Mean   :156.29   Mean   : 584.44   Mean   :11291.86  \n 3rd Qu.: 691.183   3rd Qu.:222.17   3rd Qu.: 790.21   3rd Qu.:14500.80  \n Max.   :1935.530   Max.   :557.58   Max.   :2120.10   Max.   :18914.27  \n   PROX_BIZPK     WITHIN_1km_TOPPRISCH WITHIN_1km_TOPPRISCH_BINARY\n Min.   : 107.1   Min.   :0.0000       Min.   :0.0000             \n 1st Qu.:2009.3   1st Qu.:0.0000       1st Qu.:0.0000             \n Median :3581.1   Median :0.0000       Median :0.0000             \n Mean   :4033.3   Mean   :0.1192       Mean   :0.1106             \n 3rd Qu.:5961.7   3rd Qu.:0.0000       3rd Qu.:0.0000             \n Max.   :9560.1   Max.   :2.0000       Max.   :1.0000             \n WITHIN_500m_MRT_BINARY WITHIN_500m_HKC_BINARY WITHIN_350m_KINDG\n Min.   :0.0000         Min.   :0.0000         Min.   :0.0000   \n 1st Qu.:0.0000         1st Qu.:0.0000         1st Qu.:0.0000   \n Median :0.0000         Median :0.0000         Median :1.0000   \n Mean   :0.4871         Mean   :0.3809         Mean   :0.9339   \n 3rd Qu.:1.0000         3rd Qu.:1.0000         3rd Qu.:1.0000   \n Max.   :1.0000         Max.   :1.0000         Max.   :8.0000   \n WITHIN_350m_CHILDC WITHIN_350m_BUS  WITHIN_1km_PRISCH\n Min.   : 0.000     Min.   : 0.000   Min.   :0.000    \n 1st Qu.: 3.000     1st Qu.: 6.000   1st Qu.:2.000    \n Median : 5.000     Median : 8.000   Median :3.000    \n Mean   : 5.493     Mean   : 8.008   Mean   :3.093    \n 3rd Qu.: 7.000     3rd Qu.:10.000   3rd Qu.:4.000    \n Max.   :25.000     Max.   :19.000   Max.   :9.000    \n\n\n\n\n3.2 Target Variable Analysis\nBefore we start data set preparation for predictive modeling training, we would like to leverage visualisations to observe the location factors and structural factors, and further examine if there are any anomalies.\n\nnames(HDB_master)\n\n [1] \"transact_date\"               \"resale_price\"               \n [3] \"floor_level\"                 \"plan_area\"                  \n [5] \"floor_area_sqm\"              \"flat_model\"                 \n [7] \"age\"                         \"geometry\"                   \n [9] \"remaining_lease_mths_num\"    \"PROX_TOPSCHOOL\"             \n[11] \"PROX_HKCENTER\"               \"PROX_SUPERMKT\"              \n[13] \"PROX_CLINIC\"                 \"PROX_ELDERCARE\"             \n[15] \"PROX_MALLS\"                  \"PROX_SPORTS\"                \n[17] \"PROX_CC\"                     \"PROX_PARK\"                  \n[19] \"PROX_MRT\"                    \"PROX_CBD\"                   \n[21] \"PROX_BIZPK\"                  \"WITHIN_1km_TOPPRISCH\"       \n[23] \"WITHIN_1km_TOPPRISCH_BINARY\" \"WITHIN_500m_MRT_BINARY\"     \n[25] \"WITHIN_500m_HKC_BINARY\"      \"WITHIN_350m_KINDG\"          \n[27] \"WITHIN_350m_CHILDC\"          \"WITHIN_350m_BUS\"            \n[29] \"WITHIN_1km_PRISCH\"          \n\n\n\n3.2.1 Plot distribution of variables\n\nPrice distributionPrice x ProximityPrice x Facility densityPrice x Availability\n\n\nThe resale prices concentrate on 700,000 and is right skewed, indicating that there are many above 1 million dollar housing and even some outliers pricing crossing 1.2 million dollars.\n\n\nCode\nggplot(HDB_master, \n       aes(x = resale_price)) + \n  geom_histogram(bins = 30, color = \"#F0F0F0\", fill = \"#B3C8CF\") +\n  labs(\n    title = \"Distribution of resale prices: HDB 4-room\",\n    subtitle = \"(July 2024 - Sep 2025)\",\n    x = \"Resale price S$\",\n    y = \"Count\",\n    colour = \"Gears\") +\n  theme(panel.background = element_rect(color = \"white\"),\n        plot.background = element_rect(fill = \"#EEEEEE\")) \n\n\n\n\n\n\n\n\n\n\n\nMost facilities show a downward trend in resale price as proximity to the facilities increases, such as clinics, MRT stations, parks, etc. Among these, CBD and top primary schools show the most obvious trends, while supermarkets and community centers show less obvious patterns. Interestingly, sports halls show a downward trend for shorter distances. However, after a distance of 1km, the trend reverses and prices begin to trend upward. Based on these observations, these variables will be retained as predicting factors in the model.\n\n\nCode\nHDB_master_long &lt;- HDB_master %&gt;%\n  pivot_longer(cols = c(PROX_TOPSCHOOL, PROX_HKCENTER, PROX_CLINIC, \n                        PROX_MALLS, PROX_CC, PROX_MRT, PROX_SUPERMKT, \n                        PROX_ELDERCARE, PROX_SPORTS, PROX_PARK,\n                        PROX_CBD),\n               names_to = \"facility\",\n               values_to = \"proximity\")\n\nggplot(HDB_master_long, aes(x = proximity, y = resale_price)) +\n  geom_point(alpha = 0.1, size = 0.4, colour = \"#B3C8CF\") +\n  geom_smooth(method = \"lm\", color = \"#FF8282\", se = FALSE) +\n  facet_wrap(~ facility, ncol = 3, scales = \"free_x\") +\n  labs(x = \"Proximity (m)\", y = \"Resale Price ($)\",\n       title = \"HDB Resale Price vs Proximity to Facilities\") +\n  theme(panel.background = element_rect(color = \"white\"),\n        plot.background = element_rect(fill = \"#EEEEEE\"),\n        strip.text = element_text(size = 15),\n        plot.title = element_text(size = 22),      \n        axis.title = element_text(size = 15),\n        axis.text.x = element_text(size = 11),\n        axis.text.y = element_text(size = 11))\n\n\n\n\n\n\n\n\n\n\n\nThe boxplots indicate that facility density variables exhibit varying relationships with HDB resale prices. Top primary schools and kindergartens demonstrate positive trends, whereas facilities like bus stops and primary schools show less pronounced associations.\nDespite these varying patterns, all density variables were retained as potential predictors given their theoretical relevance to housing valuation.\n\n\nCode\nHDB_master_long_dist &lt;- HDB_master %&gt;%\n  pivot_longer(cols = c(WITHIN_1km_TOPPRISCH,\n                        WITHIN_350m_BUS, WITHIN_350m_KINDG,\n                        WITHIN_350m_CHILDC, WITHIN_1km_PRISCH),\n               names_to = \"facility_dist\",\n               values_to = \"count\") \n\n# Violin plot with boxplot inside\nggplot(HDB_master_long_dist, aes(x = factor(count), y = resale_price)) +\n  geom_boxplot(width = 0.1, fill = \"white\", outlier.size = 0.5) +\n  facet_wrap(~ facility_dist, ncol = 2, scales = \"free_x\") +\n  labs(x = \"Number of Facilities within distance\",\n       y = \"Resale Price ($)\",\n       title = \"HDB Resale Price Distribution by Facility Density\") +\n  theme(panel.background = element_rect(color = \"white\"),\n        plot.background = element_rect(fill = \"#EEEEEE\"),\n        strip.text = element_text(size = 15),\n        plot.title = element_text(size = 22),      \n        axis.title = element_text(size = 15),\n        axis.text.x = element_text(size = 11),\n        axis.text.y = element_text(size = 11))\n\n\n\n\n\n\n\n\n\n\n\nThe availability of top primary schools within 1km, hawker centers within 500m, and MRT stations within 500m show similar patterns in the boxplots. Suggests that the presence of these facilities could be a driver for HDB resale pricing. Interestingly, the absence of these facilities results in resale prices constrained within a narrower range compared to cases where these facilities are present, although numerous outliers are observed in both groups.\n\n\nCode\nHDB_master_long_binary &lt;- HDB_master %&gt;%\n  pivot_longer(cols = c(WITHIN_1km_TOPPRISCH_BINARY, WITHIN_500m_MRT_BINARY,\n                        WITHIN_500m_HKC_BINARY),\n               names_to = \"facility_binary\",\n               values_to = \"count\") \n\n# Violin plot with boxplot inside\nggplot(HDB_master_long_binary, aes(x = factor(count), y = resale_price)) +\n  geom_boxplot(width = 0.1, fill = \"white\", outlier.size = 0.5) +\n  facet_wrap(~ facility_binary, ncol = 3, scales = \"free_x\") +\n  labs(x = \"Availability of Facilities within distance\",\n       y = \"Resale Price ($)\",\n       title = \"HDB Resale Price Distribution by Facility Availability\") +\n  theme(panel.background = element_rect(color = \"white\"),\n        plot.background = element_rect(fill = \"#EEEEEE\"),\n        strip.text = element_text(size = 15),\n        plot.title = element_text(size = 22),      \n        axis.title = element_text(size = 15),\n        axis.text.x = element_text(size = 11),\n        axis.text.y = element_text(size = 11))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n3.2.2 Visualise HDB units prices on thematic map\n\nnames(HDB_master)\n\n [1] \"transact_date\"               \"resale_price\"               \n [3] \"floor_level\"                 \"plan_area\"                  \n [5] \"floor_area_sqm\"              \"flat_model\"                 \n [7] \"age\"                         \"geometry\"                   \n [9] \"remaining_lease_mths_num\"    \"PROX_TOPSCHOOL\"             \n[11] \"PROX_HKCENTER\"               \"PROX_SUPERMKT\"              \n[13] \"PROX_CLINIC\"                 \"PROX_ELDERCARE\"             \n[15] \"PROX_MALLS\"                  \"PROX_SPORTS\"                \n[17] \"PROX_CC\"                     \"PROX_PARK\"                  \n[19] \"PROX_MRT\"                    \"PROX_CBD\"                   \n[21] \"PROX_BIZPK\"                  \"WITHIN_1km_TOPPRISCH\"       \n[23] \"WITHIN_1km_TOPPRISCH_BINARY\" \"WITHIN_500m_MRT_BINARY\"     \n[25] \"WITHIN_500m_HKC_BINARY\"      \"WITHIN_350m_KINDG\"          \n[27] \"WITHIN_350m_CHILDC\"          \"WITHIN_350m_BUS\"            \n[29] \"WITHIN_1km_PRISCH\"          \n\n\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.4, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.5,\n          col = NA,\n          fill_alpha = 0.7,\n          fill.scale = tm_scale_continuous(values = \"brewer.reds\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 1.2,      \n          text.size = 1),\n          ) +  \n  \n  tm_title(text = \"HDB Resale Prices (2024-2025)\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.text.size = 0.7,             \n    legend.title.size = 1,                \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"#EEEEEE\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\n\n\nObservation\n\n\nThe thematic map reveals that HDB resale prices are generally higher closer to the city center, demonstrating a clear distance-decay pattern from the CBD. However, substantial price variation exists within all regions, ranging from low to high values. Also note that spatial clusters of high-priced units appear in certain mature estates despite their distance from the CBD, while some peripheral areas show unexpectedly elevated prices. This spatial heterogeneity suggests that locational factors (such as proximity to MRT stations and top primary schools) and structural characteristics (such as age) interact to influence pricing patterns across different neighborhoods.\n\n\n\n\n3.2.3 Spatial Visualization of Amenities\nBelow are thematic maps of amenity variables reveal varied spatial patterns across Singapore. These visualisations suggest spatial heterogeneity in the distribution of amenities and housing attributes; altogether supporting the need for spatial analytical approaches in modeling HDB resale prices.\n\nEducationTransportCommercialBusinessRecreation & OthersHealthcare\n\n\nPrimary schools (top 20 highlighted)\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.3, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.6,\n          fill_alpha = 0.4,\n          col = \"grey\",\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(top_primschool_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +    \n    \n  tm_title(text = \"HDB Resale Prices vs Top Primary schools\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\nKindergartens\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.3, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(kindergarten_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +   \n    \n  tm_title(text = \"HDB Resale Prices vs Kindergartens\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nChildcare centres\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.3, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(preschool_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +   \n    \n  tm_title(text = \"HDB Resale Prices vs Childcare centres\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\n\n\n**MRT station exits**\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.3, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(top_primschool_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +   \n    \n  tm_title(text = \"HDB Resale Prices vs MRT station exits\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nBus stops\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.3, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(top_primschool_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Bus stops\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\n\n\nShopping malls\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.3, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(top_primschool_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +   \n  \n  tm_title(text = \"HDB Resale Prices vs Malls\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nHawker centres\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.3, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(top_primschool_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Hawkers\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nSupermarkets\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.4, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(top_primschool_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Supermarkets\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\n\n\nCBD\n\n\nCode\nmap_cbd &lt;- tm_shape(mpsz) + \n  tm_polygons(\n    fill = \"REGION_N\", col = \"white\", lwd = 0.8,\n    fill.scale = tm_scale_categorical(\n      values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \"#FDE7B3\", \"#FDCFFA\")\n    ),\n  fill_alpha = 0.4) +\n  tm_shape(cbd_data) +\n  tm_polygons(col = \"red\", col_alpha = 0.8, lwd = 2) + \n  \n  tm_shape(HDB_master) +\n  tm_dots(col = \"PROX_CBD\", \n          size = 0.2,             \n          palette = \"-RdYlBu\",     \n          alpha = 0.5) +\n\n  tm_title(text = \"HDB Resale Prices vs CBD\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\nmap_cbd\n\n\n\n\n\n\n\n\n\nBusiness parks\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.4, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(bizpark_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.3) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Business parks\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\n\n\nParks\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.4, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(park_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.2) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Parks\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nSports halls\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.4, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(sports_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.2) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Sports halls\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\n\n\nClinics\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.4, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(clinics_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.2) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Clinics\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )\n\n\n\n\n\n\n\n\n\nEldercare services\n\n\nCode\ntm_shape(mpsz) + \n  tm_polygons(fill = \"REGION_N\", col = \"white\", lwd = 0.8, \n              fill_alpha = 0.4, fill.legend = tm_legend(show = FALSE),\n              fill.scale = tm_scale_categorical(\n                values = c(\"#FFC4C4\", \"#87BAC3\", \"#8FABD4\", \n                           \"#FDE7B3\", \"#FDCFFA\"))) +\n  \n  tm_shape(HDB_master) +\n  tm_dots(fill = \"resale_price\",\n          size = 0.3,\n          fill_alpha = 0.5,\n          fill.scale = tm_scale_continuous(values = \"brewer.blues\"),\n          fill.legend = tm_legend(title = \"Resale Price ($)\",\n          title.size = 0.7,      \n          text.size = 0.6),\n          ) +  \n  \n  tm_shape(eldercare_data) +\n  tm_dots(fill = \"#FE7743\", size = 0.2) +    \n  \n  tm_title(text = \"HDB Resale Prices vs Eldercare services\")+\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),  \n    legend.bg.alpha = 0,\n    outer.margins = 0,\n    inner.margins = c(0.1, 0.1, 0.1, 0.1), \n    bg.color = \"white\",\n    outer.bg.color = \"#EEEEEE\",\n    frame = TRUE,\n    frame.color = \"white\",\n    frame.alpha = 0.3\n  )"
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#pre-modeling-preparation",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#pre-modeling-preparation",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "4 Pre-modeling Preparation",
    "text": "4 Pre-modeling Preparation\n\n4.1 Preparing Data\nFor this study, we will divide the entire dataset of HDB_master during the period of July 2024 to September 2025 into 2 sets. The training data (Jul 2024 - June 2025) and testing data (July - Sep 2025).\n\n4.1.1 Split data for train/test data\n\nglimpse(HDB_master)\n\nRows: 14,737\nColumns: 29\n$ transact_date               &lt;date&gt; 2024-07-01, 2024-07-01, 2024-07-01, 2024-…\n$ resale_price                &lt;dbl&gt; 528888, 500000, 540000, 500000, 620000, 57…\n$ floor_level                 &lt;dbl&gt; 1, 1, 7, 1, 10, 10, 1, 4, 7, 19, 7, 7, 10,…\n$ plan_area                   &lt;chr&gt; \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", …\n$ floor_area_sqm              &lt;dbl&gt; 91, 93, 91, 91, 97, 92, 91, 97, 94, 88, 10…\n$ flat_model                  &lt;chr&gt; \"New Generation\", \"New Generation\", \"New G…\n$ age                         &lt;dbl&gt; 43, 44, 47, 43, 48, 47, 43, 48, 13, 13, 32…\n$ geometry                    &lt;POINT [m]&gt; POINT (29933.3 38362.35), POINT (300…\n$ remaining_lease_mths_num    &lt;dbl&gt; 680, 668, 631, 680, 621, 631, 680, 620, 10…\n$ PROX_TOPSCHOOL              &lt;dbl&gt; 1139.9957, 1054.7401, 785.8500, 1246.3765,…\n$ PROX_HKCENTER               &lt;dbl&gt; 289.98144, 424.99822, 132.00515, 398.27582…\n$ PROX_SUPERMKT               &lt;dbl&gt; 349.25330, 468.66713, 186.27015, 237.72203…\n$ PROX_CLINIC                 &lt;dbl&gt; 9.399557e+01, 1.415401e+02, 1.011686e+02, …\n$ PROX_ELDERCARE              &lt;dbl&gt; 334.27019, 433.83460, 397.61080, 214.39384…\n$ PROX_MALLS                  &lt;dbl&gt; 712.8886, 946.0851, 959.9848, 726.9160, 45…\n$ PROX_SPORTS                 &lt;dbl&gt; 347.0061, 507.8975, 336.9090, 260.9641, 30…\n$ PROX_CC                     &lt;dbl&gt; 316.95217, 281.23633, 270.59187, 202.78502…\n$ PROX_PARK                   &lt;dbl&gt; 154.24457, 63.25578, 242.55766, 115.96037,…\n$ PROX_MRT                    &lt;dbl&gt; 696.6567, 919.2072, 383.6496, 680.8811, 54…\n$ PROX_CBD                    &lt;dbl&gt; 7080.609, 6861.176, 7868.887, 7107.071, 75…\n$ PROX_BIZPK                  &lt;dbl&gt; 8453.334, 8495.518, 8490.800, 8331.434, 87…\n$ WITHIN_1km_TOPPRISCH        &lt;int&gt; 0, 0, 2, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, …\n$ WITHIN_1km_TOPPRISCH_BINARY &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, …\n$ WITHIN_500m_MRT_BINARY      &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ WITHIN_500m_HKC_BINARY      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ WITHIN_350m_KINDG           &lt;int&gt; 1, 0, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 0, 1, …\n$ WITHIN_350m_CHILDC          &lt;int&gt; 2, 1, 7, 3, 8, 7, 3, 8, 7, 7, 5, 3, 2, 6, …\n$ WITHIN_350m_BUS             &lt;int&gt; 8, 7, 7, 6, 7, 7, 7, 7, 4, 4, 4, 7, 5, 6, …\n$ WITHIN_1km_PRISCH           &lt;int&gt; 3, 2, 3, 3, 3, 3, 3, 3, 2, 2, 3, 3, 2, 3, …\n\n\nWe also use st_jutter() to move the point features by 1m to avoid overlapping point features.\n\n\nCode\nHDB_master_jitter &lt;- HDB_master %&gt;%\n  st_jitter(amoun = 1)\n\nwrite_rds(HDB_master_jitter, \"data/rds/HDB_master_jitter.rds\")\n\n\n\n\nCode\nset.seed(1234)\nHDB_train &lt;- HDB_master_jitter %&gt;%\n  filter(transact_date &gt;= \"2024-07-01\" & transact_date &lt;= \"2025-06-01\") \n\nHDB_test &lt;- HDB_master_jitter %&gt;%\n  filter(transact_date &gt;= \"2025-07-01\" & transact_date &lt;= \"2025-09-01\")\n\nwrite_rds(HDB_train, \"data/rds/HDB_train.rds\")\nwrite_rds(HDB_test, \"data/rds/HDB_test.rds\")\n\n\n\n\n4.1.2 Sample train data\nWe will sample 5,000 data sets for predictive modeling training.\n\nset.seed(1234)\nHDB_train_5k &lt;- HDB_train %&gt;%\n  sample_n(5000)\n\n\n\n\n4.2 Multicollinearity Check\n\n4.2.1 Correlation Matrix\nFirst we need to do a multicollinearity analysis on the predictors. We will create a correlatiom matrix. In this step, we are using this as EDA to explore the data.\n\n\nCode\npar(bg = \"#EEEEEE\",\n    mar = c(0.5, 0.5, 0.5, 0.5)) \ncorrplot(cor(st_drop_geometry(HDB_train_5k)[, c(2, 3, 5, 7, 8:28)]),\n         diag = FALSE, \n         order = \"AOE\",\n         tl.pos = \"td\", \n         tl.cex = 1, \n         tl.srt = 40, \n         tl.col = \"#3A6F43\",\n         number.cex = 0.7,\n         method = \"number\", \n         type = \"upper\",\n         bg = \"#C5C7BC\",\n         addgrid.col = \"#EEEEEE\")         \n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nFrom the scatterplot matrix, it is clear that WITHIN_1km_TOPSCH is highly correlated to WITHIN_1km_TOPSCH_BINARY. In addition, other pairs of variables PROX_TOPSCHOOL & PROX_CBD, age & remaining_lease_mths_num, PROX_MRT & WITHIN_500m_MRT_BINARY are also highly correlated (&gt;0.8 or near 0.8).\nIn view of this, it is wiser to only include either one of them in the subsequent model building. As a result, WITHIN_1km_TOPPRISCH, age, WITHIN_500m_MRT_BINARY and PROX_TOPSCHOOL are excluded in the subsequent model building.\n\n\n\nCode\ntrain_data_corr &lt;- HDB_train_5k %&gt;%\n  select(-WITHIN_1km_TOPPRISCH,\n         -age,\n         -WITHIN_500m_MRT_BINARY,\n         -PROX_TOPSCHOOL)\n\ntest_data_corr &lt;- HDB_test %&gt;%\n  select(-WITHIN_1km_TOPPRISCH,\n         -age,\n         -WITHIN_500m_MRT_BINARY,\n         -PROX_TOPSCHOOL)\n\nwrite_rds(train_data_corr, \"data/rds/train_data_corr.rds\")\nwrite_rds(test_data_corr, \"data/rds/test_data_corr.rds\")\n\n\n\n\n\n\n4.2.2 Initial Models\nAfter collinearity check, we directly removed the highly correlated variables from the datasets. Next we will perform VIF check. A high VIF indicates that a particular predictor variable is highly correlated with other predictors in the model, which can inflate the variance of its coefficient, leading to unstable and unreliable results.\nTherefore, we will check VIF before building the models, using the remaining variables below:\n\n\n [1] \"floor_level\"                 \"plan_area\"                  \n [3] \"floor_area_sqm\"              \"flat_model\"                 \n [5] \"geometry\"                    \"remaining_lease_mths_num\"   \n [7] \"PROX_HKCENTER\"               \"PROX_SUPERMKT\"              \n [9] \"PROX_CLINIC\"                 \"PROX_ELDERCARE\"             \n[11] \"PROX_MALLS\"                  \"PROX_SPORTS\"                \n[13] \"PROX_CC\"                     \"PROX_PARK\"                  \n[15] \"PROX_MRT\"                    \"PROX_CBD\"                   \n[17] \"PROX_BIZPK\"                  \"WITHIN_1km_TOPPRISCH_BINARY\"\n[19] \"WITHIN_500m_HKC_BINARY\"      \"WITHIN_350m_KINDG\"          \n[21] \"WITHIN_350m_CHILDC\"          \"WITHIN_350m_BUS\"            \n[23] \"WITHIN_1km_PRISCH\"          \n\n\nBelow we will start the VIF iteration. For each VIF iteration, we will check the VIF scores, and remove the highest to perform the next iteration until there is no high VIF scores &gt; 10.\n\nVIF1VIF2VIF3\n\n\n\n\nCode\n# Build initial model with all variables\ninitial_mlr1 &lt;- lm(\n  formula = resale_price ~ \n    floor_level + plan_area + floor_area_sqm + flat_model + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT + PROX_CLINIC + PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_PARK + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data = train_data_corr)\nwrite_rds(initial_mlr1, \"data/rds/initial_mlr1.rds\")\n\n\n\n\n\nCall:\nlm(formula = resale_price ~ floor_level + plan_area + floor_area_sqm + \n    flat_model + remaining_lease_mths_num + PROX_HKCENTER + PROX_SUPERMKT + \n    PROX_CLINIC + PROX_ELDERCARE + PROX_MALLS + PROX_SPORTS + \n    PROX_CC + PROX_PARK + PROX_MRT + PROX_CBD + PROX_BIZPK + \n    WITHIN_1km_TOPPRISCH_BINARY + WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH, \n    data = train_data_corr)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-265329  -33636   -2095   30267  233821 \n\nCoefficients:\n                                   Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                       7.970e+04  3.070e+04   2.596 0.009451 ** \nfloor_level                       4.909e+03  1.278e+02  38.417  &lt; 2e-16 ***\nplan_areaBEDOK                   -5.747e+04  9.492e+03  -6.054 1.52e-09 ***\nplan_areaBISHAN                   4.365e+04  8.396e+03   5.198 2.09e-07 ***\nplan_areaBUKIT BATOK             -6.453e+04  8.852e+03  -7.290 3.60e-13 ***\nplan_areaBUKIT MERAH              8.462e+03  1.123e+04   0.753 0.451271    \nplan_areaBUKIT PANJANG           -1.263e+05  8.915e+03 -14.164  &lt; 2e-16 ***\nplan_areaBUKIT TIMAH              1.303e+05  1.687e+04   7.720 1.40e-14 ***\nplan_areaCENTRAL AREA            -3.451e+04  1.671e+04  -2.065 0.038952 *  \nplan_areaCHOA CHU KANG           -1.042e+05  1.044e+04  -9.976  &lt; 2e-16 ***\nplan_areaCLEMENTI                 5.058e+04  9.820e+03   5.151 2.69e-07 ***\nplan_areaGEYLANG                 -2.583e+04  1.061e+04  -2.434 0.014957 *  \nplan_areaHOUGANG                 -9.220e+04  7.181e+03 -12.840  &lt; 2e-16 ***\nplan_areaJURONG EAST             -4.593e+04  1.106e+04  -4.151 3.36e-05 ***\nplan_areaJURONG WEST             -4.417e+04  1.127e+04  -3.920 8.98e-05 ***\nplan_areaKALLANG/WHAMPOA         -8.356e+03  9.575e+03  -0.873 0.382860    \nplan_areaMARINE PARADE            4.060e+04  1.867e+04   2.175 0.029667 *  \nplan_areaPASIR RIS                1.102e+04  9.241e+03   1.193 0.232986    \nplan_areaPUNGGOL                 -1.354e+05  9.448e+03 -14.328  &lt; 2e-16 ***\nplan_areaQUEENSTOWN               6.173e+04  1.194e+04   5.171 2.41e-07 ***\nplan_areaSEMBAWANG               -2.820e+04  1.183e+04  -2.383 0.017191 *  \nplan_areaSENGKANG                -1.584e+05  7.534e+03 -21.027  &lt; 2e-16 ***\nplan_areaSERANGOON                1.061e+04  8.756e+03   1.212 0.225472    \nplan_areaTAMPINES                -2.425e+04  7.888e+03  -3.074 0.002126 ** \nplan_areaTOA PAYOH                2.461e+04  8.448e+03   2.913 0.003591 ** \nplan_areaWOODLANDS               -5.409e+04  1.089e+04  -4.967 7.04e-07 ***\nplan_areaYISHUN                  -3.695e+04  8.923e+03  -4.140 3.52e-05 ***\nfloor_area_sqm                    4.452e+03  2.062e+02  21.590  &lt; 2e-16 ***\nflat_modelImproved               -1.643e+05  9.854e+03 -16.676  &lt; 2e-16 ***\nflat_modelModel A                -8.483e+04  6.438e+03 -13.176  &lt; 2e-16 ***\nflat_modelModel A2               -7.119e+04  8.044e+03  -8.849  &lt; 2e-16 ***\nflat_modelNew Generation         -9.101e+04  7.367e+03 -12.355  &lt; 2e-16 ***\nflat_modelPremium Apartment      -5.410e+04  6.865e+03  -7.880 4.00e-15 ***\nflat_modelPremium Apartment Loft  1.057e+05  2.472e+04   4.275 1.95e-05 ***\nflat_modelSimplified             -5.185e+04  7.795e+03  -6.652 3.21e-11 ***\nflat_modelStandard               -2.153e+05  2.301e+04  -9.357  &lt; 2e-16 ***\nflat_modelType S1                 2.323e+05  1.852e+04  12.543  &lt; 2e-16 ***\nremaining_lease_mths_num          5.189e+02  9.728e+00  53.337  &lt; 2e-16 ***\nPROX_HKCENTER                    -8.918e+00  2.533e+00  -3.521 0.000434 ***\nPROX_SUPERMKT                     2.312e+01  4.954e+00   4.666 3.15e-06 ***\nPROX_CLINIC                      -2.286e+00  7.725e+00  -0.296 0.767332    \nPROX_ELDERCARE                   -1.151e+01  1.850e+00  -6.222 5.31e-10 ***\nPROX_MALLS                       -2.840e+00  2.880e+00  -0.986 0.324172    \nPROX_SPORTS                       1.008e+01  2.906e+00   3.469 0.000527 ***\nPROX_CC                          -2.006e+01  3.405e+00  -5.890 4.13e-09 ***\nPROX_PARK                        -2.092e+01  7.786e+00  -2.687 0.007237 ** \nPROX_MRT                         -8.694e+01  2.926e+00 -29.709  &lt; 2e-16 ***\nPROX_CBD                         -1.466e+01  1.137e+00 -12.892  &lt; 2e-16 ***\nPROX_BIZPK                       -1.811e+00  1.096e+00  -1.653 0.098381 .  \nWITHIN_1km_TOPPRISCH_BINARY       2.031e+04  3.062e+03   6.634 3.61e-11 ***\nWITHIN_500m_HKC_BINARY            7.017e+03  2.345e+03   2.993 0.002780 ** \nWITHIN_350m_KINDG                -8.608e+02  1.021e+03  -0.843 0.399084    \nWITHIN_350m_CHILDC               -4.595e+01  3.959e+02  -0.116 0.907613    \nWITHIN_350m_BUS                   8.209e+02  2.926e+02   2.805 0.005050 ** \nWITHIN_1km_PRISCH                 1.253e+03  7.118e+02   1.761 0.078298 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 50930 on 4945 degrees of freedom\nMultiple R-squared:  0.896, Adjusted R-squared:  0.8949 \nF-statistic: 789.2 on 54 and 4945 DF,  p-value: &lt; 2.2e-16\n\n\n\n\nIn the 2nd iteration, we will remove the highest VIF plan_area.\n\n\nCode\ninitial_mlr2 &lt;- lm(\n  formula = resale_price ~ \n    floor_level + floor_area_sqm + flat_model + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT + PROX_CLINIC + PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_PARK + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data = train_data_corr)\nwrite_rds(initial_mlr2, \"data/rds/initial_mlr2.rds\")\n\n\n\n\n\nCall:\nlm(formula = resale_price ~ floor_level + floor_area_sqm + flat_model + \n    remaining_lease_mths_num + PROX_HKCENTER + PROX_SUPERMKT + \n    PROX_CLINIC + PROX_ELDERCARE + PROX_MALLS + PROX_SPORTS + \n    PROX_CC + PROX_PARK + PROX_MRT + PROX_CBD + PROX_BIZPK + \n    WITHIN_1km_TOPPRISCH_BINARY + WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH, \n    data = train_data_corr)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-216917  -41847     769   41490  328019 \n\nCoefficients:\n                                   Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                       1.326e+05  3.364e+04   3.942 8.18e-05 ***\nfloor_level                       5.578e+03  1.580e+02  35.300  &lt; 2e-16 ***\nfloor_area_sqm                    4.757e+03  2.518e+02  18.890  &lt; 2e-16 ***\nflat_modelImproved               -1.944e+05  1.176e+04 -16.525  &lt; 2e-16 ***\nflat_modelModel A                -1.174e+05  7.971e+03 -14.724  &lt; 2e-16 ***\nflat_modelModel A2               -1.080e+05  9.989e+03 -10.810  &lt; 2e-16 ***\nflat_modelNew Generation         -1.295e+05  9.062e+03 -14.286  &lt; 2e-16 ***\nflat_modelPremium Apartment      -1.069e+05  8.411e+03 -12.703  &lt; 2e-16 ***\nflat_modelPremium Apartment Loft  1.657e+05  3.047e+04   5.438 5.65e-08 ***\nflat_modelSimplified             -7.949e+04  9.715e+03  -8.182 3.51e-16 ***\nflat_modelStandard               -2.153e+05  2.887e+04  -7.459 1.02e-13 ***\nflat_modelType S1                 1.492e+05  1.724e+04   8.653  &lt; 2e-16 ***\nremaining_lease_mths_num          4.477e+02  1.181e+01  37.919  &lt; 2e-16 ***\nPROX_HKCENTER                    -2.943e+01  2.870e+00 -10.254  &lt; 2e-16 ***\nPROX_SUPERMKT                     1.996e+01  5.906e+00   3.379 0.000732 ***\nPROX_CLINIC                      -3.034e+00  9.378e+00  -0.324 0.746290    \nPROX_ELDERCARE                   -1.423e+01  1.712e+00  -8.309  &lt; 2e-16 ***\nPROX_MALLS                       -1.756e+01  3.121e+00  -5.626 1.95e-08 ***\nPROX_SPORTS                       1.590e+01  3.213e+00   4.950 7.65e-07 ***\nPROX_CC                           1.087e-01  3.949e+00   0.028 0.978050    \nPROX_PARK                         1.465e+01  9.408e+00   1.557 0.119473    \nPROX_MRT                         -5.915e+01  3.074e+00 -19.245  &lt; 2e-16 ***\nPROX_CBD                         -1.749e+01  2.875e-01 -60.819  &lt; 2e-16 ***\nPROX_BIZPK                        2.866e+00  4.162e-01   6.886 6.46e-12 ***\nWITHIN_1km_TOPPRISCH_BINARY       5.053e+04  3.260e+03  15.501  &lt; 2e-16 ***\nWITHIN_500m_HKC_BINARY           -7.367e+02  2.806e+03  -0.263 0.792893    \nWITHIN_350m_KINDG                 9.891e+03  1.223e+03   8.090 7.44e-16 ***\nWITHIN_350m_CHILDC               -2.671e+03  4.871e+02  -5.484 4.38e-08 ***\nWITHIN_350m_BUS                   6.765e+02  3.551e+02   1.905 0.056799 .  \nWITHIN_1km_PRISCH                -8.414e+03  7.735e+02 -10.877  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 64690 on 4970 degrees of freedom\nMultiple R-squared:  0.8314,    Adjusted R-squared:  0.8304 \nF-statistic: 845.2 on 29 and 4970 DF,  p-value: &lt; 2.2e-16\n\n\n\n\nIn the 3rd iteration, we will remove the highest VIF flat_model (10.98).\n\n\nCode\n# Build initial model with all variables\ninitial_mlr3 &lt;- lm(\n  formula = resale_price ~ \n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT + PROX_CLINIC + PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_PARK + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data = train_data_corr)\n\nwrite_rds(initial_mlr3, \"data/rds/initial_mlr3.rds\")\n\n\n\n\n\nCall:\nlm(formula = resale_price ~ floor_level + floor_area_sqm + remaining_lease_mths_num + \n    PROX_HKCENTER + PROX_SUPERMKT + PROX_CLINIC + PROX_ELDERCARE + \n    PROX_MALLS + PROX_SPORTS + PROX_CC + PROX_PARK + PROX_MRT + \n    PROX_CBD + PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + WITHIN_500m_HKC_BINARY + \n    WITHIN_350m_KINDG + WITHIN_350m_CHILDC + WITHIN_350m_BUS + \n    WITHIN_1km_PRISCH, data = train_data_corr)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-241242  -46501     243   44676  363447 \n\nCoefficients:\n                              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                 18618.1694 18866.9810   0.987 0.323783    \nfloor_level                  6111.9588   168.9020  36.186  &lt; 2e-16 ***\nfloor_area_sqm               4519.9072   160.3557  28.187  &lt; 2e-16 ***\nremaining_lease_mths_num      470.5848     6.9191  68.013  &lt; 2e-16 ***\nPROX_HKCENTER                 -29.7771     3.1054  -9.589  &lt; 2e-16 ***\nPROX_SUPERMKT                  21.0631     6.3281   3.328 0.000880 ***\nPROX_CLINIC                    -2.8728    10.0524  -0.286 0.775057    \nPROX_ELDERCARE                -13.4725     1.8511  -7.278 3.92e-13 ***\nPROX_MALLS                    -18.8556     3.3476  -5.633 1.87e-08 ***\nPROX_SPORTS                    20.2449     3.2844   6.164 7.65e-10 ***\nPROX_CC                       -13.0977     4.2287  -3.097 0.001964 ** \nPROX_PARK                      -1.3213    10.1503  -0.130 0.896431    \nPROX_MRT                      -58.4483     3.2705 -17.871  &lt; 2e-16 ***\nPROX_CBD                      -17.6339     0.3060 -57.620  &lt; 2e-16 ***\nPROX_BIZPK                      3.2273     0.4446   7.259 4.51e-13 ***\nWITHIN_1km_TOPPRISCH_BINARY 48496.5049  3491.3636  13.890  &lt; 2e-16 ***\nWITHIN_500m_HKC_BINARY      -8711.9213  3009.8156  -2.895 0.003814 ** \nWITHIN_350m_KINDG            8954.0938  1319.2330   6.787 1.28e-11 ***\nWITHIN_350m_CHILDC          -1478.5236   523.4964  -2.824 0.004757 ** \nWITHIN_350m_BUS              1375.4902   381.8684   3.602 0.000319 ***\nWITHIN_1km_PRISCH           -9460.8222   810.3083 -11.676  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 70150 on 4979 degrees of freedom\nMultiple R-squared:  0.8014,    Adjusted R-squared:  0.8006 \nF-statistic:  1005 on 20 and 4979 DF,  p-value: &lt; 2.2e-16\n\n\n\n\n\nCheck for multicollinearity and plot VIF scores\n\nVIF1VIF2VIF3\n\n\nBased on the following VIF scores, 4 variables are in the High Correlation category, with plan_area of 1.20e+05 being the highest.\n\n\nCode\ncheck_collinearity(initial_mlr1)\n\n\n# Check for Multicollinearity\n\nLow Correlation\n\n                        Term  VIF           VIF 95% CI adj. VIF Tolerance\n                 floor_level 1.35 [    1.31,     1.40]     1.16      0.74\n              floor_area_sqm 3.56 [    3.40,     3.73]     1.89      0.28\n               PROX_HKCENTER 2.69 [    2.57,     2.81]     1.64      0.37\n               PROX_SUPERMKT 1.46 [    1.41,     1.52]     1.21      0.68\n                 PROX_CLINIC 1.35 [    1.30,     1.40]     1.16      0.74\n              PROX_ELDERCARE 2.63 [    2.51,     2.75]     1.62      0.38\n                  PROX_MALLS 2.11 [    2.03,     2.21]     1.45      0.47\n                 PROX_SPORTS 1.83 [    1.76,     1.90]     1.35      0.55\n                     PROX_CC 1.62 [    1.57,     1.69]     1.27      0.62\n                   PROX_PARK 1.21 [    1.17,     1.25]     1.10      0.83\n                    PROX_MRT 2.36 [    2.26,     2.47]     1.54      0.42\n WITHIN_1km_TOPPRISCH_BINARY 1.70 [    1.64,     1.77]     1.30      0.59\n      WITHIN_500m_HKC_BINARY 2.48 [    2.38,     2.60]     1.58      0.40\n           WITHIN_350m_KINDG 2.21 [    2.12,     2.31]     1.49      0.45\n          WITHIN_350m_CHILDC 2.34 [    2.24,     2.44]     1.53      0.43\n             WITHIN_350m_BUS 1.33 [    1.29,     1.38]     1.15      0.75\n           WITHIN_1km_PRISCH 2.31 [    2.22,     2.42]     1.52      0.43\n Tolerance 95% CI\n     [0.71, 0.76]\n     [0.27, 0.29]\n     [0.36, 0.39]\n     [0.66, 0.71]\n     [0.72, 0.77]\n     [0.36, 0.40]\n     [0.45, 0.49]\n     [0.53, 0.57]\n     [0.59, 0.64]\n     [0.80, 0.85]\n     [0.41, 0.44]\n     [0.57, 0.61]\n     [0.39, 0.42]\n     [0.43, 0.47]\n     [0.41, 0.45]\n     [0.72, 0.78]\n     [0.41, 0.45]\n\nModerate Correlation\n\n                     Term  VIF           VIF 95% CI adj. VIF Tolerance\n remaining_lease_mths_num 5.22 [    4.97,     5.49]     2.28      0.19\n Tolerance 95% CI\n     [0.18, 0.20]\n\nHigh Correlation\n\n       Term      VIF           VIF 95% CI adj. VIF Tolerance Tolerance 95% CI\n  plan_area 1.20e+05 [1.13e+05, 1.27e+05]   346.12  8.35e-06     [0.00, 0.00]\n flat_model    44.29 [   41.96,    46.76]     6.66      0.02     [0.02, 0.02]\n   PROX_CBD    48.86 [   46.28,    51.58]     6.99      0.02     [0.02, 0.02]\n PROX_BIZPK    13.85 [   13.14,    14.60]     3.72      0.07     [0.07, 0.08]\n\n\n\n\nCode\nmlr1.vif &lt;- check_collinearity(initial_mlr1)\nplot(mlr1.vif) +\n  theme_minimal() +\n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\", color = NA),\n    panel.background = element_rect(fill = \"gray95\", color = NA),\n    axis.text.x = element_text(angle = 35, hjust = 1, vjust = 1, size = 5)\n  )\n\n\n\n\n\n\n\n\n\n\n\nAfter removing plan_area from VIF1, 1 variable remains in the High Correlation category, with flat_model of 10.98 being the highest.\n\n\nCode\ncheck_collinearity(initial_mlr2)\n\n\n# Check for Multicollinearity\n\nLow Correlation\n\n                        Term  VIF     VIF 95% CI adj. VIF Tolerance\n                 floor_level 1.28 [ 1.24,  1.33]     1.13      0.78\n              floor_area_sqm 3.29 [ 3.14,  3.45]     1.81      0.30\n    remaining_lease_mths_num 4.77 [ 4.54,  5.01]     2.18      0.21\n               PROX_HKCENTER 2.14 [ 2.05,  2.23]     1.46      0.47\n               PROX_SUPERMKT 1.29 [ 1.25,  1.33]     1.13      0.78\n                 PROX_CLINIC 1.23 [ 1.19,  1.28]     1.11      0.81\n              PROX_ELDERCARE 1.39 [ 1.35,  1.45]     1.18      0.72\n                  PROX_MALLS 1.54 [ 1.48,  1.60]     1.24      0.65\n                 PROX_SPORTS 1.38 [ 1.34,  1.43]     1.18      0.72\n                     PROX_CC 1.35 [ 1.31,  1.40]     1.16      0.74\n                   PROX_PARK 1.09 [ 1.07,  1.13]     1.05      0.91\n                    PROX_MRT 1.61 [ 1.56,  1.68]     1.27      0.62\n                    PROX_CBD 1.94 [ 1.86,  2.02]     1.39      0.52\n                  PROX_BIZPK 1.24 [ 1.20,  1.28]     1.11      0.81\n WITHIN_1km_TOPPRISCH_BINARY 1.19 [ 1.16,  1.24]     1.09      0.84\n      WITHIN_500m_HKC_BINARY 2.20 [ 2.11,  2.30]     1.48      0.45\n           WITHIN_350m_KINDG 1.97 [ 1.89,  2.05]     1.40      0.51\n          WITHIN_350m_CHILDC 2.19 [ 2.10,  2.29]     1.48      0.46\n             WITHIN_350m_BUS 1.21 [ 1.18,  1.26]     1.10      0.82\n           WITHIN_1km_PRISCH 1.69 [ 1.63,  1.76]     1.30      0.59\n Tolerance 95% CI\n     [0.75, 0.80]\n     [0.29, 0.32]\n     [0.20, 0.22]\n     [0.45, 0.49]\n     [0.75, 0.80]\n     [0.78, 0.84]\n     [0.69, 0.74]\n     [0.63, 0.67]\n     [0.70, 0.75]\n     [0.71, 0.76]\n     [0.88, 0.94]\n     [0.60, 0.64]\n     [0.50, 0.54]\n     [0.78, 0.83]\n     [0.81, 0.86]\n     [0.43, 0.47]\n     [0.49, 0.53]\n     [0.44, 0.48]\n     [0.79, 0.85]\n     [0.57, 0.61]\n\nHigh Correlation\n\n       Term   VIF     VIF 95% CI adj. VIF Tolerance Tolerance 95% CI\n flat_model 10.98 [10.42, 11.58]     3.31      0.09     [0.09, 0.10]\n\n\n\n\nCode\nmlr2.vif &lt;- check_collinearity(initial_mlr2)\nplot(mlr2.vif) +\n    theme_minimal() +\n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\", color = NA),\n    panel.background = element_rect(fill = \"gray95\", color = NA),\n    axis.text.x = element_text(angle = 35, hjust = 1, vjust = 1, size = 5)\n  )\n\n\n\n\n\n\n\n\n\n\n\nAt the 3rd iteration, we see all remaining variables are all low correlated.\n\n\nCode\ncheck_collinearity(initial_mlr3)\n\n\n# Check for Multicollinearity\n\nLow Correlation\n\n                        Term  VIF   VIF 95% CI adj. VIF Tolerance\n                 floor_level 1.25 [1.21, 1.29]     1.12      0.80\n              floor_area_sqm 1.13 [1.10, 1.17]     1.07      0.88\n    remaining_lease_mths_num 1.39 [1.35, 1.44]     1.18      0.72\n               PROX_HKCENTER 2.13 [2.05, 2.23]     1.46      0.47\n               PROX_SUPERMKT 1.26 [1.22, 1.30]     1.12      0.80\n                 PROX_CLINIC 1.20 [1.17, 1.25]     1.10      0.83\n              PROX_ELDERCARE 1.39 [1.34, 1.44]     1.18      0.72\n                  PROX_MALLS 1.51 [1.45, 1.56]     1.23      0.66\n                 PROX_SPORTS 1.23 [1.19, 1.27]     1.11      0.81\n                     PROX_CC 1.32 [1.28, 1.37]     1.15      0.76\n                   PROX_PARK 1.08 [1.06, 1.12]     1.04      0.92\n                    PROX_MRT 1.55 [1.50, 1.62]     1.25      0.64\n                    PROX_CBD 1.87 [1.79, 1.94]     1.37      0.54\n                  PROX_BIZPK 1.20 [1.17, 1.24]     1.10      0.83\n WITHIN_1km_TOPPRISCH_BINARY 1.16 [1.13, 1.21]     1.08      0.86\n      WITHIN_500m_HKC_BINARY 2.16 [2.07, 2.25]     1.47      0.46\n           WITHIN_350m_KINDG 1.95 [1.87, 2.03]     1.40      0.51\n          WITHIN_350m_CHILDC 2.15 [2.06, 2.25]     1.47      0.46\n             WITHIN_350m_BUS 1.20 [1.16, 1.24]     1.09      0.84\n           WITHIN_1km_PRISCH 1.58 [1.52, 1.64]     1.26      0.63\n Tolerance 95% CI\n     [0.77, 0.83]\n     [0.85, 0.91]\n     [0.69, 0.74]\n     [0.45, 0.49]\n     [0.77, 0.82]\n     [0.80, 0.86]\n     [0.70, 0.75]\n     [0.64, 0.69]\n     [0.79, 0.84]\n     [0.73, 0.78]\n     [0.89, 0.95]\n     [0.62, 0.67]\n     [0.51, 0.56]\n     [0.80, 0.86]\n     [0.83, 0.88]\n     [0.44, 0.48]\n     [0.49, 0.53]\n     [0.44, 0.48]\n     [0.81, 0.86]\n     [0.61, 0.66]\n\n\n\n\nCode\nmlr3.vif &lt;- check_collinearity(initial_mlr3)\nplot(mlr3.vif) +\n  theme_minimal() +\n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\", color = NA),\n    panel.background = element_rect(fill = \"gray95\", color = NA),\n    axis.text.x = element_text(angle = 35, hjust = 1, vjust = 1, size = 5)\n  )\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n4.3 Feature Selection\nFinal feature list for modeling\nAfter 3 iterations of removing high VIF variables, all VIF are now below 10. So we can conclude that there are no sign of multicollinearity among the independent variables.\nBased on the multicollinearity measuring results from VIF3, we find that some variables are not statistically significant, including PROX_CLINIC and PROX_PARK. We will revise the initial model by removing these 2 variables.\nTotal original dataset size\nTotal original dataset size was 14,737 observations, and we divided them into train set from July 2024 to June 2025 and test set from July - Sep 2025. Among 11,680 data sets during July 2024 - June 2025, we also have randomly sampled 5,000 just for training data to calibrate the machine learning models properly.\nThe rest of 3,057 obervations from July - September 2025 are test data for predictions."
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#predictive-modeling",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#predictive-modeling",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "PREDICTIVE MODELING",
    "text": "PREDICTIVE MODELING\nFrom section 5 to 6, we will calibrate 4 predictive modeling for HDB resale price using the same set of variables for a comparison and then predict the prices using the test data. The models include Multi Linear Regression model (MLR), Geographycally Weighed Regression (GWR) model, Non-spatial Random Forest model, as well as Geographical Weighted Random Forest (gwRF) model."
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#model-calibration",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#model-calibration",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "5 Model Calibration",
    "text": "5 Model Calibration\n\n5.1 MLR5.2 GWR5.3 RF5.4 GWRF\n\n\n\n5.1.1 Model calibration\nMultiple Linear Regression Building upon the initial MLR model from section 4.2.2, we calibrate the revised MLR model as below. PROX_CLINIC and PROX_PARK will be removed.\n\n\nCode\nhdb.mlr &lt;- lm(\n  formula = resale_price ~ \n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT +PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data = train_data_corr)\nwrite_rds(hdb.mlr, \"data/rds/hdb.mlr\")\n\n\n\n\n\nCall:\nlm(formula = resale_price ~ floor_level + floor_area_sqm + remaining_lease_mths_num + \n    PROX_HKCENTER + PROX_SUPERMKT + PROX_ELDERCARE + PROX_MALLS + \n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD + PROX_BIZPK + \n    WITHIN_1km_TOPPRISCH_BINARY + WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH, \n    data = train_data_corr)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-240331  -46575     262   44702  363279 \n\nCoefficients:\n                              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                 17984.8996 18744.6778   0.959 0.337370    \nfloor_level                  6110.0999   168.7308  36.212  &lt; 2e-16 ***\nfloor_area_sqm               4516.4400   159.9347  28.239  &lt; 2e-16 ***\nremaining_lease_mths_num      470.9581     6.8089  69.168  &lt; 2e-16 ***\nPROX_HKCENTER                 -29.8090     3.1031  -9.606  &lt; 2e-16 ***\nPROX_SUPERMKT                  20.5809     6.0639   3.394 0.000694 ***\nPROX_ELDERCARE                -13.5064     1.8403  -7.339 2.49e-13 ***\nPROX_MALLS                    -18.7625     3.3278  -5.638 1.81e-08 ***\nPROX_SPORTS                    20.2944     3.2784   6.190 6.49e-10 ***\nPROX_CC                       -13.1036     4.2277  -3.099 0.001950 ** \nPROX_MRT                      -58.5379     3.2571 -17.972  &lt; 2e-16 ***\nPROX_CBD                      -17.6407     0.3048 -57.880  &lt; 2e-16 ***\nPROX_BIZPK                      3.2389     0.4418   7.331 2.65e-13 ***\nWITHIN_1km_TOPPRISCH_BINARY 48512.2547  3488.1703  13.908  &lt; 2e-16 ***\nWITHIN_500m_HKC_BINARY      -8729.7068  3008.7131  -2.901 0.003730 ** \nWITHIN_350m_KINDG            8916.9919  1313.3237   6.790 1.26e-11 ***\nWITHIN_350m_CHILDC          -1468.6895   522.3372  -2.812 0.004946 ** \nWITHIN_350m_BUS              1380.1798   376.6727   3.664 0.000251 ***\nWITHIN_1km_PRISCH           -9449.7173   807.9072 -11.697  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 70130 on 4981 degrees of freedom\nMultiple R-squared:  0.8014,    Adjusted R-squared:  0.8007 \nF-statistic:  1117 on 18 and 4981 DF,  p-value: &lt; 2.2e-16\n\n\nThe output above reveals that all explanatory variables are statistically significant at 95% confident level.\n\n\n5.1.2 MLR Model calibration result\nWe use tbl_regression() to create a regression report for MLR.\n\n\nCode\ntbl_regression(hdb.mlr, \n               intercept = TRUE) %&gt;% \n  add_glance_source_note(\n    label = list(sigma ~ \"\\U03C3\"),\n    include = c(r.squared, adj.r.squared, \n                AIC, statistic,\n                p.value, sigma)) %&gt;%\n  modify_table_styling(\n    columns = label,\n    rows = variable %in% c(\"flat_type\", \"floor_range\"),\n    footnote = \"Categorical variable\"\n  ) %&gt;%\n  bold_labels()\n\n\n\n\n\n\n\n\nCharacteristic\nBeta\n95% CI\np-value\n\n\n\n\n(Intercept)\n17,985\n-18,763, 54,733\n0.3\n\n\nfloor_level\n6,110\n5,779, 6,441\n&lt;0.001\n\n\nfloor_area_sqm\n4,516\n4,203, 4,830\n&lt;0.001\n\n\nremaining_lease_mths_num\n471\n458, 484\n&lt;0.001\n\n\nPROX_HKCENTER\n-30\n-36, -24\n&lt;0.001\n\n\nPROX_SUPERMKT\n21\n8.7, 32\n&lt;0.001\n\n\nPROX_ELDERCARE\n-14\n-17, -9.9\n&lt;0.001\n\n\nPROX_MALLS\n-19\n-25, -12\n&lt;0.001\n\n\nPROX_SPORTS\n20\n14, 27\n&lt;0.001\n\n\nPROX_CC\n-13\n-21, -4.8\n0.002\n\n\nPROX_MRT\n-59\n-65, -52\n&lt;0.001\n\n\nPROX_CBD\n-18\n-18, -17\n&lt;0.001\n\n\nPROX_BIZPK\n3.2\n2.4, 4.1\n&lt;0.001\n\n\nWITHIN_1km_TOPPRISCH_BINARY\n48,512\n41,674, 55,351\n&lt;0.001\n\n\nWITHIN_500m_HKC_BINARY\n-8,730\n-14,628, -2,831\n0.004\n\n\nWITHIN_350m_KINDG\n8,917\n6,342, 11,492\n&lt;0.001\n\n\nWITHIN_350m_CHILDC\n-1,469\n-2,493, -445\n0.005\n\n\nWITHIN_350m_BUS\n1,380\n642, 2,119\n&lt;0.001\n\n\nWITHIN_1km_PRISCH\n-9,450\n-11,034, -7,866\n&lt;0.001\n\n\n\nAbbreviation: CI = Confidence Interval\n\n\nR² = 0.801; Adjusted R² = 0.801; AIC = 125,792; Statistic = 1,117; p-value = &lt;0.001; σ = 70,132\n\n\n\n\n\n\n\n\n\n\n\nWe will use Geographically Weighted Regression to build a Hedonic Pricing Model in this section.\n\n5.2.1 Bandwidth selection\nAdaptive bandwidth is the chosen approach for the GWR modeling as Singapore has varying spatial density of the housing.\nBelow we will use Cross Validation (CV) approach to compuete the Bandwidth:\nThe result below shows that the 48 is the recommended data points to be used.\n\n\nCode\nbw.adaptive &lt;- bw.gwr(\n  formula = resale_price ~ \n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT +PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data=train_data_corr, \n  approach=\"CV\", \n  kernel=\"gaussian\", \n  adaptive=TRUE, \n  longlat=FALSE)\n\nwrite_rds(bw.adaptive, \"data/rds/bw.adaptive.rds\")\n\n\n\n\n5.2.2 Model calibration\nNow we will calibrate the GWR-based hedonic pricing model using the adaptive bandwidth from section 5.2.1 and gaussian kernel.\n\n\nCode\ngwr.adaptive &lt;- gwr.basic(\n  formula = resale_price ~ \n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT +PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data = train_data_corr, \n  bw = bw.adaptive, \n  kernel = 'gaussian', \n  adaptive=TRUE, \n  longlat = FALSE)\n\nwrite_rds(gwr.adaptive, \"data/model/gwr.adaptive.rds\")\n\n\n\n\n5.2.3 GRW Model calibration\n\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2025-11-16 21:02:16.20895 \n   Call:\n   gwr.basic(formula = resale_price ~ floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + PROX_SUPERMKT + \n    PROX_ELDERCARE + PROX_MALLS + PROX_SPORTS + PROX_CC + PROX_MRT + \n    PROX_CBD + PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + WITHIN_500m_HKC_BINARY + \n    WITHIN_350m_KINDG + WITHIN_350m_CHILDC + WITHIN_350m_BUS + \n    WITHIN_1km_PRISCH, data = train_data_corr, bw = bw.adaptive, \n    kernel = \"gaussian\", adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  resale_price\n   Independent variables:  floor_level floor_area_sqm remaining_lease_mths_num PROX_HKCENTER PROX_SUPERMKT PROX_ELDERCARE PROX_MALLS PROX_SPORTS PROX_CC PROX_MRT PROX_CBD PROX_BIZPK WITHIN_1km_TOPPRISCH_BINARY WITHIN_500m_HKC_BINARY WITHIN_350m_KINDG WITHIN_350m_CHILDC WITHIN_350m_BUS WITHIN_1km_PRISCH\n   Number of data points: 5000\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n    Min      1Q  Median      3Q     Max \n-240331  -46575     262   44702  363279 \n\n   Coefficients:\n                                 Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)                 17984.8996 18744.6778   0.959 0.337370    \n   floor_level                  6110.0999   168.7308  36.212  &lt; 2e-16 ***\n   floor_area_sqm               4516.4400   159.9347  28.239  &lt; 2e-16 ***\n   remaining_lease_mths_num      470.9581     6.8089  69.168  &lt; 2e-16 ***\n   PROX_HKCENTER                 -29.8090     3.1031  -9.606  &lt; 2e-16 ***\n   PROX_SUPERMKT                  20.5809     6.0639   3.394 0.000694 ***\n   PROX_ELDERCARE                -13.5064     1.8403  -7.339 2.49e-13 ***\n   PROX_MALLS                    -18.7625     3.3278  -5.638 1.81e-08 ***\n   PROX_SPORTS                    20.2944     3.2784   6.190 6.49e-10 ***\n   PROX_CC                       -13.1036     4.2277  -3.099 0.001950 ** \n   PROX_MRT                      -58.5379     3.2571 -17.972  &lt; 2e-16 ***\n   PROX_CBD                      -17.6407     0.3048 -57.880  &lt; 2e-16 ***\n   PROX_BIZPK                      3.2389     0.4418   7.331 2.65e-13 ***\n   WITHIN_1km_TOPPRISCH_BINARY 48512.2547  3488.1703  13.908  &lt; 2e-16 ***\n   WITHIN_500m_HKC_BINARY      -8729.7068  3008.7131  -2.901 0.003730 ** \n   WITHIN_350m_KINDG            8916.9919  1313.3237   6.790 1.26e-11 ***\n   WITHIN_350m_CHILDC          -1468.6895   522.3372  -2.812 0.004946 ** \n   WITHIN_350m_BUS              1380.1798   376.6727   3.664 0.000251 ***\n   WITHIN_1km_PRISCH           -9449.7173   807.9072 -11.697  &lt; 2e-16 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 70130 on 4981 degrees of freedom\n   Multiple R-squared: 0.8014\n   Adjusted R-squared: 0.8007 \n   F-statistic:  1117 on 18 and 4981 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 2.449886e+13\n   Sigma(hat): 70012.38\n   AIC:  125791.7\n   AICc:  125791.8\n   BIC:  121092.3\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Adaptive bandwidth: 48 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                                       Min.      1st Qu.       Median\n   Intercept                    -1.2049e+07  -3.4749e+05   1.1842e+04\n   floor_level                   1.8438e+03   4.0224e+03   4.7935e+03\n   floor_area_sqm               -3.7533e+04   2.4869e+03   3.3295e+03\n   remaining_lease_mths_num     -2.2305e+03   3.5143e+02   4.2355e+02\n   PROX_HKCENTER                -3.1333e+02  -4.2946e+01  -9.7345e+00\n   PROX_SUPERMKT                -4.2869e+02  -4.0528e+01  -9.0416e+00\n   PROX_ELDERCARE               -1.3715e+03  -2.9520e+01   1.4168e+00\n   PROX_MALLS                   -4.0822e+05  -4.8520e+01  -1.6936e+01\n   PROX_SPORTS                  -1.1406e+04  -2.6529e+01  -2.5297e+00\n   PROX_CC                      -1.8800e+04  -3.7045e+01  -8.9590e+00\n   PROX_MRT                     -3.2236e+03  -1.2507e+02  -7.0820e+01\n   PROX_CBD                     -5.5311e+03  -3.9295e+01  -9.9533e+00\n   PROX_BIZPK                   -9.9768e+02  -2.2741e+01   2.1464e+00\n   WITHIN_1km_TOPPRISCH_BINARY -9.2707e+197  -3.7931e+04   1.6981e+04\n   WITHIN_500m_HKC_BINARY       -2.1467e+05  -1.4651e+04   2.6422e+03\n   WITHIN_350m_KINDG            -2.2369e+05  -1.0531e+04  -3.6266e+03\n   WITHIN_350m_CHILDC           -9.7717e+03  -1.6724e+03   3.2935e+02\n   WITHIN_350m_BUS              -7.0230e+03  -1.3048e+03   3.8400e+02\n   WITHIN_1km_PRISCH            -6.6263e+05  -5.7406e+03  -2.7017e+02\n                                    3rd Qu.        Max.\n   Intercept                     4.9035e+05  7.0323e+07\n   floor_level                   5.6303e+03  7.8355e+03\n   floor_area_sqm                4.8362e+03  2.4681e+04\n   remaining_lease_mths_num      6.5172e+02  9.7312e+02\n   PROX_HKCENTER                 3.7519e+01  3.2140e+02\n   PROX_SUPERMKT                 3.0588e+01  3.8103e+02\n   PROX_ELDERCARE                2.6409e+01  4.2582e+03\n   PROX_MALLS                    2.6397e+01  2.0714e+04\n   PROX_SPORTS                   3.6079e+01  1.0173e+03\n   PROX_CC                       2.7203e+01  3.9383e+05\n   PROX_MRT                     -3.2395e+01  2.5332e+04\n   PROX_CBD                      1.2959e+01  8.2089e+02\n   PROX_BIZPK                    2.6302e+01  2.9076e+03\n   WITHIN_1km_TOPPRISCH_BINARY   2.1687e+05 4.6772e+198\n   WITHIN_500m_HKC_BINARY        1.7253e+04  1.1974e+05\n   WITHIN_350m_KINDG             3.7494e+03  4.3950e+04\n   WITHIN_350m_CHILDC            2.9321e+03  4.2262e+04\n   WITHIN_350m_BUS               2.0789e+03  1.1532e+04\n   WITHIN_1km_PRISCH             4.3412e+03  2.4644e+04\n   ************************Diagnostic information*************************\n   Number of data points: 5000 \n   Effective number of parameters (2trace(S) - trace(S'S)): 918.0333 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 4081.967 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 119053.8 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 118063.3 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 118584.3 \n   Residual sum of squares: 4.545136e+12 \n   R-square value:  0.9631548 \n   Adjusted R-square value:  0.9548663 \n\n   ***********************************************************************\n   Program stops at: 2025-11-16 21:02:25.845373 \n\n\n\n\n\nIn this section, we want to calibrate a model to predict HDB resale price using the Random Forest method.\n\n5.3.1 Data preparation\nFirst is to extract the x, y coordinates of the training and test data sets.\n\n\nCode\ncoords &lt;- st_coordinates(HDB_master_jitter)\ncoords_train &lt;- st_coordinates(train_data_corr)\ncoords_test &lt;- st_coordinates(test_data_corr)\n\nwrite_rds(coords_train, \"data/rds/coords_train.rds\")\nwrite_rds(coords_test, \"data/rds/coords_test.rds\")\n\n\nDrop geometry field\n\ntrain_data_nogeom &lt;- train_data_corr %&gt;%\n  st_drop_geometry()\n\ntest_data_nogeom &lt;- test_data_corr %&gt;%\n  st_drop_geometry()\n\n\n\n5.3.2 Calibrate non-spatial RF model with ranger()\n\n\nCode\nset.seed(1234)\nrf &lt;- ranger(\n  formula = resale_price ~ \n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT +PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data = train_data_nogeom\n)\n\nwrite_rds(rf, \"data/model/rf.rds\")\n\n\n\n\n5.3.3 RF Model calibration\n\n\nRanger result\n\nCall:\n ranger(formula = resale_price ~ floor_level + floor_area_sqm +      remaining_lease_mths_num + PROX_HKCENTER + PROX_SUPERMKT +      PROX_ELDERCARE + PROX_MALLS + PROX_SPORTS + PROX_CC + PROX_MRT +      PROX_CBD + PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + WITHIN_500m_HKC_BINARY +      WITHIN_350m_KINDG + WITHIN_350m_CHILDC + WITHIN_350m_BUS +      WITHIN_1km_PRISCH, data = train_data_nogeom) \n\nType:                             Regression \nNumber of trees:                  500 \nSample size:                      5000 \nNumber of independent variables:  18 \nMtry:                             4 \nTarget node size:                 5 \nVariable importance mode:         none \nSplitrule:                        variance \nOOB prediction error (MSE):       1459767353 \nR squared (OOB):                  0.9408438 \n\n\n\n\n\nIn this section, we will calibrate Geographical Weighted Random Forest Model with the training data.\n\n5.4.1 Bandwidth selection\nWe will use GWR Bandwidth for GWRF: bw.adaptive.\n\n\n5.4.2 Model calibration\n\n\nCode\nset.seed(1234)\ngwRF_adaptive &lt;- grf(\n  formula = resale_price ~ \n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT +PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  dframe = train_data_nogeom, \n  bw = bw.adaptive,\n  kernel = \"adaptive\",\n  coords = coords_train,\n  ntree = 500,\n  mtry = 3)\n\nwrite_rds(gwRF_adaptive, \"data/model/gwRF_adaptive.rds\")\n\n\n\n\n5.4.3 gwRF Model calibration result\n\n\nCode\ngwRF_adaptive &lt;- read_rds(\"data/model/gwRF_adaptive.rds\")\ngwRF_adaptive$LocalModelSummary\n\n\n$l.VariableImportance\n                                  Min          Max        Mean         StD\nfloor_level                 542488469 410275437511 28189032660 45708854982\nfloor_area_sqm                      0 571507879400 28150900835 55009340082\nremaining_lease_mths_num    900986388 623058798310 57623410530 96688516999\nPROX_HKCENTER               413305074 431871320053 20045225156 34909923327\nPROX_SUPERMKT               379356298 622569970173 19054621819 41053040974\nPROX_ELDERCARE              446615197 399390161689 20454753437 36649562589\nPROX_MALLS                  416160193 331271908424 20689325809 32503530990\nPROX_SPORTS                 481791185 277757020031 18799887259 33293493181\nPROX_CC                     491092956 518543635280 20839974811 40920669707\nPROX_MRT                    428424579 427597697083 19516296558 32706153156\nPROX_CBD                    314609442 355908407481 21019515707 35952222753\nPROX_BIZPK                  420210994 318463583298 19479421208 31370709325\nWITHIN_1km_TOPPRISCH_BINARY         0 108493009910   951050624  4890233814\nWITHIN_500m_HKC_BINARY              0 187713638181  2532115068 10175776165\nWITHIN_350m_KINDG                   0 167314311957  4483184939 11515753172\nWITHIN_350m_CHILDC          129214786 366864470252 11549134264 29890189641\nWITHIN_350m_BUS             155366433 249032878802  9567379333 16437902318\nWITHIN_1km_PRISCH                   0 144862777382  4464304081  9919445580\n\n$l.MSE.OOB\n[1] 2101309087\n\n$l.r.OOB\n[1] 0.9148286\n\n$l.MSE.Pred\n[1] 209480669\n\n$l.r.Pred\n[1] 0.9915092"
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#predictions-with-test-data",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#predictions-with-test-data",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "6 Predictions with Test Data",
    "text": "6 Predictions with Test Data\n\n6.1 MLR6.2 GWR6.3 RF6.4 GWRF\n\n\n\n6.1.1 Predict with test data\n\n\nCode\nmlr_pred &lt;- predict(hdb.mlr, newdata = test_data_corr)\nwrite_rds(mlr_pred, \"data/model/mlr_pred.rds\")\n\n\n\n\n6.1.2 Append predicted values to the test dataset\n\n\nCode\nmlr_pred &lt;- read_rds(\"data/model/mlr_pred.rds\")\n\ntest_data_p_mlr &lt;- test_data_corr %&gt;%\n  mutate(mlr_pred = mlr_pred)\n\nkable(head(test_data_p_mlr))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\ngeometry\nremaining_lease_mths_num\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\nWITHIN_350m_CHILDC\nWITHIN_350m_BUS\nWITHIN_1km_PRISCH\nmlr_pred\n\n\n\n\n2025-07-01\n553000\n7\nANG MO KIO\n91\nNew Generation\nPOINT (30037.03 38360.07)\n668\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n603925.5\n\n\n2025-07-01\n630000\n7\nANG MO KIO\n97\nNew Generation\nPOINT (29298.64 38701.65)\n609\n434.3653\n350.4851\n115.6550\n270.2289\n506.7800\n291.6684\n485.2871\n177.4983\n596.5165\n7527.047\n8767.339\n0\n1\n1\n6\n6\n3\n598333.1\n\n\n2025-07-01\n550000\n7\nANG MO KIO\n91\nNew Generation\nPOINT (28566.95 38862.09)\n618\n132.0052\n186.2702\n101.1686\n397.6108\n959.9848\n336.9090\n270.5919\n242.5577\n383.6496\n7868.887\n8490.800\n1\n1\n2\n7\n7\n3\n637489.7\n\n\n2025-07-01\n878000\n4\nANG MO KIO\n95\nModel A\nPOINT (29237.64 38669.02)\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n770542.4\n\n\n2025-07-01\n966000\n19\nANG MO KIO\n97\nModel A\nPOINT (29237.37 38669.73)\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n871226.8\n\n\n2025-07-01\n520000\n1\nANG MO KIO\n91\nNew Generation\nPOINT (30036.09 38361.03)\n667\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n566793.9\n\n\n\n\n\n\n\n6.1.3 Calculate performance metrics\nCalculate RMSE, MAE and R^2 metrics\n\n\nCode\n# RMSE\nrmse_mlr &lt;- sqrt(mean((test_data_p_mlr$resale_price - test_data_p_mlr$mlr_pred)^2))\n\n# MAE\nmae_mlr &lt;- mean(abs(test_data_p_mlr$resale_price - test_data_p_mlr$mlr_pred))\n\n# R^2\nss_res &lt;- sum((test_data_p_mlr$resale_price - test_data_p_mlr$mlr_pred)^2)\nss_tot &lt;- sum((test_data_p_mlr$resale_price - mean(test_data_p_mlr$resale_price))^2)\nr2_mlr &lt;- 1 - (ss_res / ss_tot)\n\ncat(\"MLR RMSE:\", format(rmse_mlr), \"\\n\",\n    \"MLR MAE:\", format(mae_mlr), \"\\n\",\n    \"MLR R^2:\", round(r2_mlr, 4))\n\n\nMLR RMSE: 75600.55 \n MLR MAE: 58139.58 \n MLR R^2: 0.7915\n\n\n\n\n6.1.4 Visualising the predicted values\n\n\nCode\np1 &lt;- ggplot(data = test_data_p_mlr,\n       aes(x = mlr_pred,\n           y = resale_price,\n           text = paste(\"Actual: $\", format(resale_price, big.mark = \",\"),\n                       \"\\nPredicted: $\", format(mlr_pred, big.mark = \",\"),\n                       \"\\nError: $\", format(resale_price - mlr_pred, big.mark = \",\"),\n                       sep = \"\"))) +           \n  geom_point(col = \"#EF7722\", size = 0.5) +\n  geom_abline(intercept = 0, slope = 1, \n              color = \"#DC143C\", linetype = \"dashed\", linewidth = 1) +  \n  labs(title = \"MLR: Predicted vs Actual Resale Prices\",\n       x = \"Predicted Resale Price (S$)\",\n       y = \"Actual Resale Price (S$)\") +\n    theme_minimal() +  \n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\"),      \n    panel.background = element_rect(fill = \"#F5F5F5\"),   \n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\") \n  )  \nggplotly(p1, tooltip = \"text\")\n\n\n\n\n\n\nMLR predictions quite largely deviate from the actual prices, especially for higher quantums beyond $900,000.\n\n\n\n\n6.2.1 Compute predicted values\n\n\nCode\ngwr_pred &lt;- gwr.predict(\n  formula = resale_price ~\n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT +PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n  data=train_data_corr, \n  predictdata = test_data_corr, \n  bw=bw.adaptive, \n  kernel = 'gaussian', \n  adaptive=TRUE, \n  longlat = FALSE)\n\nwrite_rds(gwr_pred, \"data/model/gwr_pred.rds\")\n\n\n\n\n6.2.2 Append predicted values to the test dataset\nBelow is to append the predicted values using GWR moderling to the test dataset. You will see the first few rows of the result.\n\n\nCode\ngwr_predictions &lt;- gwr_pred$SDF$prediction\n\ntest_data_p &lt;- test_data_p_mlr\ntest_data_p$gwr_pred &lt;- gwr_predictions\n\nkable(head(test_data_p[, c(\"resale_price\", \"gwr_pred\")]))\n\n\n\n\n\nresale_price\ngwr_pred\ngeometry\n\n\n\n\n553000\n550220.6\nPOINT (30037.03 38360.07)\n\n\n630000\n563012.7\nPOINT (29298.64 38701.65)\n\n\n550000\n537551.9\nPOINT (28566.95 38862.09)\n\n\n878000\n855392.4\nPOINT (29237.64 38669.02)\n\n\n966000\n971465.0\nPOINT (29237.37 38669.73)\n\n\n520000\n511517.2\nPOINT (30036.09 38361.03)\n\n\n\n\n\n\n\n6.2.3 GWR Model performance metrics\nTo assess GWR modeling performance, we will obtain the performance metrics Root Mean Squared Error (RMSE), Mean Absolute Error (MAE) and R square metrics.\n\n\nCode\n# RMSE\ngwr_rmse &lt;- sqrt(mean((test_data_p$resale_price - test_data_p$gwr_pred)^2))\n\n# MAE\ngwr_mae &lt;- mean(abs(test_data_p$resale_price - test_data_p$gwr_pred))\n\n# R-squared\ngwr_rsq &lt;- cor(test_data_p$resale_price, test_data_p$gwr_pred)^2\n\nwrite_rds(gwr_rmse, \"data/rds/gwr_rmse.rds\")\nwrite_rds(gwr_mae, \"data/rds/gwr_mae.rds\")\nwrite_rds(gwr_rsq, \"data/rds/gwr_rsq.rds\")\n\n\n\n\nCode\ngwr_rmse &lt;- read_rds(\"data/rds/gwr_rmse.rds\")\ngwr_mae &lt;- read_rds(\"data/rds/gwr_mae.rds\")\ngwr_rsq &lt;- read_rds(\"data/rds/gwr_rsq.rds\")\n  \nprint(paste(\"GWR RMSE:\", round(gwr_rmse, 2)))\n\n\n[1] \"GWR RMSE: 38028.34\"\n\n\nCode\nprint(paste(\"GWR MAE:\", round(gwr_mae, 2)))\n\n\n[1] \"GWR MAE: 28750.29\"\n\n\nCode\nprint(paste(\"GWR R^2:\", round(gwr_rsq, 4)))\n\n\n[1] \"GWR R^2: 0.9587\"\n\n\n\n\n6.3.4 Visualising the predicted values\nLet’s visualise the actual resale price and the predicted resale price in the scatter plot.\n\n\nCode\np2 &lt;- ggplot(data = test_data_p,\n       aes(x = gwr_pred,\n           y = resale_price,\n           text = paste(\"Actual: $\", format(resale_price, big.mark = \",\"),\n                       \"\\nPredicted: $\", format(gwr_pred, big.mark = \",\"),\n                       \"\\nError: $\", format(resale_price - gwr_pred, big.mark = \",\"),\n                       sep = \"\"))) +           \n  geom_point(col = \"#8AA624\", size = 0.5) +\n  geom_abline(intercept = 0, slope = 1, \n              color = \"#DC143C\", linetype = \"dashed\", linewidth = 1) +\n  labs(title = \"GWR: Predicted vs Actual Resale Prices\",\n       x = \"Predicted Resale Price (S$)\",\n       y = \"Actual Resale Price (S$)\") +\n    theme_minimal() +  \n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\"),      \n    panel.background = element_rect(fill = \"#F5F5F5\"),   \n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\") \n  )  \n  \nggplotly(p2, tooltip = \"text\")\n\n\n\n\n\n\nThe scatterplot demonstrates strong predictive performance, with points clustering tightly along the 45-degree line (perfect prediction). The majority of predictions fall within a narrow band around the diagonal, indicating minimal systematic bias. Even the outliers remain within ±$150,000 of actual values. This tight concentration suggests the GWR model effectively captures the spatial variation in HDB pricing across Singapore’s diverse regions.\n\n\n\n\n6.3.1 Predict with test data\nMode\n\n\nCode\nrf_pred &lt;- predict(\n  rf, data = test_data_nogeom)\n\nwrite_rds(rf_pred, \"data/model/rf_pred.rds\")\n\n\n\n\n6.3.2 Append predicted values to the test dataset\n\n\nCode\nrf_predictions &lt;- rf_pred$predictions\n\ntest_data_p$rf_pred &lt;- rf_predictions\n\nkable(head(test_data_p[, c(\"resale_price\", \"gwr_pred\")]))\n\n\n\n\n\nresale_price\ngwr_pred\ngeometry\n\n\n\n\n553000\n550220.6\nPOINT (30037.03 38360.07)\n\n\n630000\n563012.7\nPOINT (29298.64 38701.65)\n\n\n550000\n537551.9\nPOINT (28566.95 38862.09)\n\n\n878000\n855392.4\nPOINT (29237.64 38669.02)\n\n\n966000\n971465.0\nPOINT (29237.37 38669.73)\n\n\n520000\n511517.2\nPOINT (30036.09 38361.03)\n\n\n\n\n\n\n\n6.3.3 RF Model performance metrics\n\n\nCode\n# RMSE\nrf_rmse &lt;- sqrt(mean((test_data_p$resale_price - test_data_p$rf_pred)^2))\n\n# MAE\nrf_mae &lt;- mean(abs(test_data_p$resale_price - test_data_p$rf_pred))\n\n# R^2\nrf_rsq &lt;- cor(test_data_p$resale_price, test_data_p$rf_pred)^2\n\nwrite_rds(rf_rmse, \"data/rds/rf_rmse.rds\")\nwrite_rds(rf_mae, \"data/rds/rf_mae.rds\")\nwrite_rds(rf_rsq, \"data/rds/rf_rsq.rds\")\n\n\n\n\n[1] \"RF RMSE: 41949.6061273766\"\n\n\n[1] \"RF MAE: 29540.7934540272\"\n\n\n[1] \"RF R^2: 0.950421105489941\"\n\n\n\n\n6.3.4 Visualising the predicted values\nLet’s visualise the actual resale price and the predicted resale price in the scatter plot.\n\n\nCode\np3 &lt;- ggplot(data = test_data_p,\n       aes(x = rf_pred,\n           y = resale_price,\n           text = paste(\"Actual: $\", format(resale_price, big.mark = \",\"),\n                       \"\\nPredicted: $\", format(rf_pred, big.mark = \",\"),\n                       \"\\nError: $\", format(resale_price - rf_pred, big.mark = \",\"),\n                       sep = \"\"))) +           \n  geom_point(col = \"#3396D3\", size = 0.5) +\n  geom_abline(intercept = 0, slope = 1, \n              color = \"#DC143C\", linetype = \"dashed\", linewidth = 1) +  \n  labs(title = \"RF: Predicted vs Actual Resale Prices\",\n       x = \"Predicted Resale Price (S$)\",\n       y = \"Actual Resale Price (S$)\") +\n    theme_minimal() +  \n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\"),      \n    panel.background = element_rect(fill = \"#F5F5F5\"),   \n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\") \n  )  \n  \nggplotly(p3, tooltip = \"text\")\n\n\n\n\n\n\nRF predictions are generally decent as they are all quite close to the slope of 1. The model also tends to predict lower than the actual resale prices, but there are few outliers.\n\n\n\n\n6.4.1 Prepare test data\n\n\nCode\ntest_data_gwrf &lt;- cbind(\n  test_data_corr, coords_test) %&gt;%\n  st_drop_geometry()\n\nkable(head(test_data_gwrf))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\nremaining_lease_mths_num\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\nWITHIN_350m_CHILDC\nWITHIN_350m_BUS\nWITHIN_1km_PRISCH\nX\nY\n\n\n\n\n2025-07-01\n553000\n7\nANG MO KIO\n91\nNew Generation\n668\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n30037.03\n38360.07\n\n\n2025-07-01\n630000\n7\nANG MO KIO\n97\nNew Generation\n609\n434.3653\n350.4851\n115.6550\n270.2289\n506.7800\n291.6684\n485.2871\n177.4983\n596.5165\n7527.047\n8767.339\n0\n1\n1\n6\n6\n3\n29298.64\n38701.65\n\n\n2025-07-01\n550000\n7\nANG MO KIO\n91\nNew Generation\n618\n132.0052\n186.2702\n101.1686\n397.6108\n959.9848\n336.9090\n270.5919\n242.5577\n383.6496\n7868.887\n8490.800\n1\n1\n2\n7\n7\n3\n28566.95\n38862.09\n\n\n2025-07-01\n878000\n4\nANG MO KIO\n95\nModel A\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n29237.64\n38669.02\n\n\n2025-07-01\n966000\n19\nANG MO KIO\n97\nModel A\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n29237.37\n38669.73\n\n\n2025-07-01\n520000\n1\nANG MO KIO\n91\nNew Generation\n667\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n30036.09\n38361.03\n\n\n\n\n\n\n\n6.4.2 gwRF Predict with test data\nBelow prediction ran for 40 sec.\n\n\nCode\ngwRF_pred &lt;- predict.grf(gwRF_adaptive,\n                         test_data_gwrf,\n                         x.var.name = \"X\",\n                         y.var.name = \"Y\",\n                         local.w = 1,\n                         global.w = 0)\n\ngwRF_pred &lt;- write_rds(gwRF_pred, \"data/model/gwRF_pred.rds\")\n\n\n\n\n6.4.3 Append predicted values to the test dataset\n\n\nCode\ngwRF_pred_df &lt;- as.data.frame(gwRF_pred)\n\ntest_data_p$gwrf_pred &lt;- gwRF_pred_df[, 1]\n\nwrite_rds(test_data_p, \"data/rds/test_data_p.rds\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\ngeometry\nremaining_lease_mths_num\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\nWITHIN_350m_CHILDC\nWITHIN_350m_BUS\nWITHIN_1km_PRISCH\nmlr_pred\ngwr_pred\nrf_pred\ngwrf_pred\ngwrf_hybrid_pred\n\n\n\n\n2025-07-01\n553000\n7\nANG MO KIO\n91\nNew Generation\nPOINT (30037.03 38360.07)\n668\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n603925.5\n550220.6\n555736.3\n547787.1\n551485.0\n\n\n2025-07-01\n630000\n7\nANG MO KIO\n97\nNew Generation\nPOINT (29298.64 38701.65)\n609\n434.3653\n350.4851\n115.6550\n270.2289\n506.7800\n291.6684\n485.2871\n177.4983\n596.5165\n7527.047\n8767.339\n0\n1\n1\n6\n6\n3\n598333.1\n563012.7\n602696.8\n662078.8\n639213.4\n\n\n2025-07-01\n550000\n7\nANG MO KIO\n91\nNew Generation\nPOINT (28566.95 38862.09)\n618\n132.0052\n186.2702\n101.1686\n397.6108\n959.9848\n336.9090\n270.5919\n242.5577\n383.6496\n7868.887\n8490.800\n1\n1\n2\n7\n7\n3\n637489.7\n537551.9\n548401.2\n542837.7\n544691.7\n\n\n2025-07-01\n878000\n4\nANG MO KIO\n95\nModel A\nPOINT (29237.64 38669.02)\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n770542.4\n855392.4\n862248.9\n858448.0\n855349.9\n\n\n2025-07-01\n966000\n19\nANG MO KIO\n97\nModel A\nPOINT (29237.37 38669.73)\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n871226.8\n971465.0\n939022.6\n897954.4\n909049.6\n\n\n2025-07-01\n520000\n1\nANG MO KIO\n91\nNew Generation\nPOINT (30036.09 38361.03)\n667\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n566793.9\n511517.2\n548529.8\n548596.2\n549775.6\n\n\n\n\n\n\n\n6.4.4 gwRF Model performance metrics\nWe calculate the root mean square error (RMSE) to measure how far predicted values are from observed values in a regression analysis.\n\n\nCode\n# RMSE\n\ngwrf_rmse &lt;- sqrt(mean((test_data_p$resale_price - test_data_p$gwrf_pred)^2))\n\n# MAE\ngwrf_mae &lt;- mean(abs(test_data_p$resale_price - test_data_p$gwrf_pred))\n\n# R^2\ngwrf_rsq &lt;- cor(test_data_p$resale_price, test_data_p$gwrf_pred)^2\n\nwrite_rds(gwrf_rmse, \"data/rds/gwrf_rmse.rds\")\nwrite_rds(gwrf_mae, \"data/rds/gwrf_mae.rds\")\nwrite_rds(gwrf_rsq, \"data/rds/gwrf_rsq.rds\")\n\n\n\n\n[1] \"gwRF MSE: 41949.6061273766\"\n\n\n[1] \"gwRF MAE: 29540.7934540272\"\n\n\n[1] \"gwRF R^2: 0.950421105489941\"\n\n\n\n\n6.4.5 Visualising the predicted values\nLet’s visualise the actual resale price and the predicted resale price in the scatter plot.\n\n\nCode\np4 &lt;- ggplot(data = test_data_p,\n       aes(x = gwrf_pred,\n           y = resale_price,\n           text = paste(\"Actual: $\", format(resale_price, big.mark = \",\"),\n                       \"\\nPredicted: $\", format(gwrf_pred, big.mark = \",\"),\n                       \"\\nError: $\", format(resale_price - gwrf_pred, big.mark = \",\"),\n                       sep = \"\"))) +           \n  geom_point(col = \"#E45A92\", size = 0.5) +\n  geom_abline(intercept = 0, slope = 1, \n              color = \"#DC143C\", linetype = \"dashed\", linewidth = 1) +   \n  labs(title = \"GWRF: Predicted vs Actual Resale Prices\",\n       x = \"Predicted Resale Price (S$)\",\n       y = \"Actual Resale Price (S$)\") +\n    theme_minimal() +  \n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\"),      \n    panel.background = element_rect(fill = \"#F5F5F5\"),   \n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\") \n  )  \n  \nggplotly(p4, tooltip = \"text\")\n\n\n\n\n\n\ngwRF model predictions are mostly close to the actual resale prices, but it has many outliers that divate for almost 50,0000 (50%) higher than the actual prices."
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#model-evaluation",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#model-evaluation",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "7 Model Evaluation",
    "text": "7 Model Evaluation\n\n\n\n\n\n\n\n\n\n\n7.1 Performance metrics (RMSE, MAE, R²)\nBased on the scatterplots and the metrics result below, we can conclude that:\n\nGeographically Weighted Regression\n\nGWR demonstrates the strongest performance, with predictions clustering tightly along the 45-degree reference line and minimal systematic bias. Even outliers remain within ±$150,000 of actual values, indicating the model effectively captures spatial variation across Singapore’s diverse housing markets.\n\nRandom Forest\n\nRandom Forest shows generally good performance with most predictions close to the diagonal, though the model exhibits a slight tendency to underpredict for higher-priced units. Outliers are minimal and predictions maintain consistency across the price range.\n\nMultiple Linear Regression\n\nMLR shows the weakest performance, with predictions substantially deviating from actual prices, especially for premium units exceeding $900,000. The scatter indicates systematic bias and inability to capture non-linear relationships in the data.\n\nGeographical Weighted Random Forest\n\ngwRF displays mixed results, with most predictions reasonably close to actual values but suffering from many significant outliers that overpredict by up to $479,244 (approximately 50% error). This inconsistency suggests the model struggles with certain spatial or feature combinations.\n\n\nCode\nmodel_comparison &lt;- data.frame(\n  Model = c(\"MLR\", \"GWR\", \"Random Forest\", \"gwRF\"),\n  RMSE = c(rmse_mlr, gwr_rmse, rf_rmse, gwrf_rmse),\n  MAE = c(mae_mlr, gwr_mae, rf_mae, gwrf_mae),\n  R_2 = c(r2_mlr, gwr_rsq, rf_rsq, gwrf_rsq)\n)\n\ndatatable(model_comparison,\n          options = list(pageLength = 10, dom = 't'),\n          rownames = FALSE,\n          class = 'cell-border stripe') %&gt;%\n  formatRound(columns = c('RMSE', 'MAE', 'R_2'), digits = 4) \n\n\n\n\n\n\nRMSE (Root Mean Squared Error) MAE (Mean Absolute Error) R² on test set Compare across all 4 models\n\n\n7.2 Model comparison\nTable from Section 7.1 is an interactive table that readers can sort the values in ascending or descending order for each metric.\nThe bar charts below helps decide that GWR is the winner among all 4 models across all 3 metrics, with the highest R² and lowest RMSE & MAE, followed by Random Forest, Geographical Weighted Random Forest and lastly Multilinear Regression.\n\nRMSE: GWR &gt; RF &gt; geRF &gt; MLR\nMAE: GWR &gt; RF &gt; geRF &gt; MLR\nR²: GWR &gt; RF &gt; geRF &gt; MLR\n\n\n\nCode\n# pivot longer\nmodel_comparison_long &lt;- model_comparison %&gt;%\n  pivot_longer(cols = c(RMSE, MAE, R_2),\n               names_to = \"metric\",\n               values_to = \"value\") %&gt;%\n  mutate(metric = recode(metric,\n                         \"R_2\" = \"R^2\",\n                         \"RMSE\" = \"RMSE\",\n                         \"MAE\" = \"MAE\"))\n\n# Create ordering within each metric\nmodel_comparison_long &lt;- model_comparison_long %&gt;%\n  group_by(metric) %&gt;%\n  mutate(\n    sort_helper = if_else(metric %in% c(\"RMSE\", \"MAE\"), value, -value),\n    Rank = if_else(metric %in% c(\"RMSE\", \"MAE\"), \n                   rank(value), \n                   rank(-value))    \n  ) %&gt;%\n  arrange(metric, sort_helper) %&gt;%  # Sort within each metric\n  mutate(\n    Model_metric = paste(Model, metric, sep = \"___\"),  # Create unique identifier\n    Model_metric = factor(Model_metric, levels = unique(Model_metric))\n  ) %&gt;%\n  ungroup()\n\np &lt;- ggplot(model_comparison_long, \n       aes(x = Model_metric, y = value, fill = Model,\n           text = paste0(\"&lt;b&gt;\", Model, \"&lt;/b&gt;\",\n                        \"\\n\", metric, \": \", format(round(value, 4), big.mark = \",\"),\n                        \"\\nRank: \", Rank, \" of 4\"))) +            \n  \n  geom_bar(stat = \"identity\", alpha = 0.8) +\n  facet_wrap(~ metric, scales = \"free\", ncol = 3) +\n  scale_x_discrete(labels = function(x) gsub(\"___.*\", \"\", x)) + \n  scale_fill_manual(values = c(\"MLR\" = \"#E2A16F\", \n                                \"GWR\" = \"#A6B28B\", \n                                \"Random Forest\" = \"#B2C6D5\", \n                                \"gwRF\" = \"#FFC6C6\")) +\n  labs(title = \"Model Performance Comparison\",\n       x = \"Model\",\n       y = \"Value\") +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"none\",\n    strip.text = element_text(size = 11, face = \"bold\"),\n    plot.background = element_rect(fill = \"#EEEEEE\"),      \n    panel.background = element_rect(fill = \"#F5F5F5\"),   \n    panel.border = element_rect(color = \"white\", fill = NA, linewidth = 1),\n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\"))\nggplotly(p, tooltip = \"text\")\n\n\n\n\n\n\n\n\n7.3 Best model selection\n\nThe best overall model\n\nThese visual patterns confirm the quantitative metrics: Geographically Weighted Regression (GWR) achieves the most reliable predictions, followed by RF, while gwRF’s outlier problem and MLR’s systematic bias limit their practical utility.\nIt has the best performance across all metrics (Lowest RMSE = 38,028; Lowest MAE = 28,750; Highest R² = 0.9587). This demonstrates superior predictive accuracy for HDB resale prices.\n\nSpatial vs Non-Spatial models\n\nThe results present an interesting finding: while GWR (spatial) outperforms all models, Random Forest outperforms Geographically Weighted Random Forest (spatial). This suggests that spatial heterogeneity matters, but its benefit depends on the modeling approach.\nGWR’s parametric framework effectively captures smooth spatial gradients in Singapore’s housing market, while GWRF’s localised tree-based partitioning may struggle with the continuous nature of spatial price variations. MLR’s poor performance (RMSE = 51,438) confirms that a simple global model is insufficient for capturing Singapore’s spatially complex housing dynamics.\n\nComputational trade-offs\n\nGWR requires significantly more computational resources, taking short time to train but 30-40 minutes to predict on 5,000 observations, as compared to negligible training and testing time for other models (tested on a high-specification laptop).\nDespite this computational cost, GWR’s superior accuracy justifies its use for applications prioritising prediction quality. For resource-constrained scenarios or applications requiring rapid retraining, Random Forest would provide a strong alternative with comparable performance (RMSE = 38,423) and minimal computational overhead."
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#discussion-conclusion",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#discussion-conclusion",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "8 Discussion & Conclusion",
    "text": "8 Discussion & Conclusion\n\n8.1 Key findings\nThe results reveal important insights about spatial modeling for HDB resale prices.\n\nSpatial heterogeneity is significant:\n\nGWR substantially outperformed all other models, achieving the lowest RMSE (38,028) and highest R² (0.9587). This demonstrates that locally-varying relationships between property characteristics and prices are crucial for accurate prediction in Singapore’s HDB market.\nDifferent neighborhoods exhibit different pricing dynamics that cannot be captured by global models. For Random Forest, despite its flexibility, its RMSE=41,950 could not match GWR’s performance. While RF can learn complex patterns, it lacks the explicit spatial weighting mechanism that allows GWR to adapt coefficients by location. The 4,000 SGD difference in RMSE represents practically significant prediction error (~10% improvement with GWR).\n\nOver-localisation problem in gwRF\n\nAdding spatial weighting to Random Forest actually degraded performance below standalone RF. With bandwidth=48 neighbors, each local RF seemed to train on insufficient data, leading to overfitting. We experimented with a hybrid approach (60% local, 40% global) partially recovered performance but still couldn’t match either GWR or RF (see Appendix).\n\nModel recommendations\n\nFor best prediction accuracy: Use GWR. It provides superior performance and spatial interpretability\nFor computational efficiency: Use RF as a faster alternative with acceptable accuracy. It ran only for 1-3 seconds for this study.\nAvoid fully local gwRF: due to overfitting and poor performance despite higher computational cost (than RF). We tested a hybrid gwRF approach to address potential over-localisation. While the hybrid model outperformed the fully local gwRF, it remained inferior to both GWR and standalone RF. This confirms that:\n\n\n8.2 Future work\nBoth GWR and gwRF used an adaptive bandwidth of 48 neighbors, optimized using cross-validation for the GWR model. Future work could explore whether gwRF benefits from a larger bandwidth given the additional data requirements of ensemble methods.\nThese findings suggest that future research on spatial ensemble methods should focus on alternative approaches to incorporating spatial information—such as spatial features or constraints—rather than geographic weighting schemes that may conflict with the inherent spatial partitioning of tree-based models\n\n\nSelf Reflection\n\n\nGeospatial studies are very exciting because the methods and models allow us to discover tremendous insights for informing policies and business strategies. Through this assignment I learned to appreciate predictive modeling methodologies in the geospatial field. The finding is also quite interesting as it kind of goes against what I initially thought - GWR and gwRF must win. It came as a surprise that gwRF actually did not!\nAll the lessons covered help me realise that there are just yet a lot more to learn. I always find data so fascinating when I come to each of the lesson since Data Analytics Lab module. Sincere thanks to Prof. Kam’s patience and encouragement on the assignments and answering questions, making the data analytics journey so amazing! Together with visual analytics, I have developed greater interest in these fields and will continue the journey. Hopefully I can really utilise the knowledge and skillset to do some good to the society."
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#reference",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#reference",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "9 Reference",
    "text": "9 Reference\n\nKam, T. S. 2025. R for Geospatial Data Science and Analytics\nGangula, K. (n.d.). Shopping mall coordinates [Data set]. Kaggle. Retrieved November 9, 2025, from https://www.kaggle.com/datasets/karthikgangula/shopping-mall-coordinates\ndata.gov.sg. (2025). multiple data sets [Data set] (refer to section 2.1) Retrieved Nov 9, 2025, from https://data.gov.sg/\nLand Transport (2025). multiple data sets [Data set] (refer to section 2.1). Retrieved Nov 9, 2025, from https://datamall.lta.gov.sg/content/datamall/en.html.\nShopping mall. (n.d.). In Wikipedia. Retrieved November 9, 2025, from https://en.wikipedia.org/wiki/Shopping_mall\nSophia Education. (2025). 2025 Singapore PSLE school rankings: Where do the top schools stand this year? Sophia Education. https://sophiaeducation.sg/2025-singapore-psle-school-rankings"
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#appendix",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#appendix",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "APPENDIX",
    "text": "APPENDIX"
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#i.-gwrf-hybrid-modeling",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#i.-gwrf-hybrid-modeling",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "I. gwRF Hybrid Modeling",
    "text": "I. gwRF Hybrid Modeling\n\ni. Adjust spatial effects\nGiven that gwRF unexpectedly underperformed relative to RF, we explore whether a hybrid approach can improve performance by balancing local spatial effects (60%) with global patterns (40%). This configuration allows the model to capture spatial heterogeneity while maintaining awareness of market-wide trends.\n\n\nCode\ngwRF_hybrid_pred &lt;- predict.grf(gwRF_adaptive,\n                         test_data_gwrf,\n                         x.var.name = \"X\",\n                         y.var.name = \"Y\",\n                         local.w = 0.6,\n                         global.w = 0.4)\n\ngwRF_hybrid_pred &lt;- write_rds(gwRF_hybrid_pred, \"data/model/gwRF_hybrid_pred.rds\")\n\n\n\n\nii. Append predicted values to the test dataset\n\n\nCode\ngwRF_hybrid_pred_df &lt;- as.data.frame(gwRF_hybrid_pred)\ntest_data_p$gwrf_hybrid_pred &lt;- gwRF_hybrid_pred_df[, 1]\nwrite_rds(test_data_p, \"data/rds/test_data_p.rds\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntransact_date\nresale_price\nfloor_level\nplan_area\nfloor_area_sqm\nflat_model\ngeometry\nremaining_lease_mths_num\nPROX_HKCENTER\nPROX_SUPERMKT\nPROX_CLINIC\nPROX_ELDERCARE\nPROX_MALLS\nPROX_SPORTS\nPROX_CC\nPROX_PARK\nPROX_MRT\nPROX_CBD\nPROX_BIZPK\nWITHIN_1km_TOPPRISCH_BINARY\nWITHIN_500m_HKC_BINARY\nWITHIN_350m_KINDG\nWITHIN_350m_CHILDC\nWITHIN_350m_BUS\nWITHIN_1km_PRISCH\nmlr_pred\ngwr_pred\nrf_pred\ngwrf_pred\ngwrf_hybrid_pred\n\n\n\n\n2025-07-01\n553000\n7\nANG MO KIO\n91\nNew Generation\nPOINT (30037.03 38360.07)\n668\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n603925.5\n550220.6\n555736.3\n547787.1\n551485.0\n\n\n2025-07-01\n630000\n7\nANG MO KIO\n97\nNew Generation\nPOINT (29298.64 38701.65)\n609\n434.3653\n350.4851\n115.6550\n270.2289\n506.7800\n291.6684\n485.2871\n177.4983\n596.5165\n7527.047\n8767.339\n0\n1\n1\n6\n6\n3\n598333.1\n563012.7\n602696.8\n662078.8\n639213.4\n\n\n2025-07-01\n550000\n7\nANG MO KIO\n91\nNew Generation\nPOINT (28566.95 38862.09)\n618\n132.0052\n186.2702\n101.1686\n397.6108\n959.9848\n336.9090\n270.5919\n242.5577\n383.6496\n7868.887\n8490.800\n1\n1\n2\n7\n7\n3\n637489.7\n537551.9\n548401.2\n542837.7\n544691.7\n\n\n2025-07-01\n878000\n4\nANG MO KIO\n95\nModel A\nPOINT (29237.64 38669.02)\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n770542.4\n855392.4\n862248.9\n858448.0\n855349.9\n\n\n2025-07-01\n966000\n19\nANG MO KIO\n97\nModel A\nPOINT (29237.37 38669.73)\n1034\n470.6946\n320.3322\n182.4673\n201.4722\n575.3650\n255.5832\n430.7326\n170.3215\n665.8857\n7507.516\n8764.249\n0\n1\n1\n7\n4\n2\n871226.8\n971465.0\n939022.6\n897954.4\n909049.6\n\n\n2025-07-01\n520000\n1\nANG MO KIO\n91\nNew Generation\nPOINT (30036.09 38361.03)\n667\n388.7647\n284.9091\n106.6490\n259.7684\n756.2974\n308.1821\n214.0083\n150.7398\n717.8941\n7065.628\n8373.493\n0\n1\n1\n3\n7\n3\n566793.9\n511517.2\n548529.8\n548596.2\n549775.6\n\n\n\n\n\n\n\niii. gwRF Model performance metrics\n\n\nCode\n# RMSE\ngwrf_hybrid_rmse &lt;- sqrt(mean((test_data_p$resale_price - test_data_p$gwrf_hybrid_pred)^2))\n\n# MAE\ngwrf_hybrid_mae &lt;- mean(abs(test_data_p$resale_price - test_data_p$gwrf_hybrid_pred))\n\n# R^2\ngwrf_hybrid_rsq &lt;- cor(test_data_p$resale_price, test_data_p$gwrf_hybrid_pred)^2\n\nwrite_rds(gwrf_hybrid_rmse, \"data/rds/gwrf_hybrid_rmse.rds\")\nwrite_rds(gwrf_hybrid_mae, \"data/rds/gwrf_hybrid_mae.rds\")\nwrite_rds(gwrf_hybrid_rsq, \"data/rds/gwrf_hybrid_rsq.rds\")\n\n\n\n\n[1] \"gwRF_hybrid MSE: 41949.6061273766\"\n\n\n[1] \"gwRF_hybrid MAE: 29540.7934540272\"\n\n\n[1] \"gwRF_hybrid R^2: 0.950421105489941\"\n\n\n\n\niv. Visualising the predicted values\nLet’s visualise the actual resale price and the predicted resale price in the scatter plot and compare the metrics with the existing models.\nWhile the hybrid gwRF model improves upon fully localised gwRF, it still underperforms compared to non-spatial Random Forest. This result suggests that explicit geographic weighting may not be necessary when rich locational features (proximity to amenities, CBD distance) are already included as predictors.\nRandom Forest’s ability to capture complex non-linear interactions between these spatial features may be more effective than gwRF’s localized approach for this dataset.\n\nPerformance metrics tableScatterplot\n\n\n\n\nCode\nmodel_comparison_v2 &lt;- data.frame(\n  Model = c(\"MLR\", \"GWR\", \"Random Forest\", \"gwRF\", \"gwRF_hb\"),\n  RMSE = c(rmse_mlr, gwr_rmse, rf_rmse, gwrf_rmse, gwrf_hybrid_rmse),\n  MAE = c(mae_mlr, gwr_mae, rf_mae, gwrf_mae, gwrf_hybrid_mae),\n  R_2 = c(r2_mlr, gwr_rsq, rf_rsq, gwrf_rsq, gwrf_hybrid_rsq)\n)\n\ndatatable(model_comparison_v2,\n          options = list(pageLength = 10, dom = 't'),\n          rownames = FALSE,\n          class = 'cell-border stripe') %&gt;%\n  formatRound(columns = c('RMSE', 'MAE', 'R_2'), digits = 4) \n\n\n\n\n\n\n\n\n\n\nCode\nggplot(data = test_data_p,\n       aes(x = gwrf_hybrid_pred,\n           y = resale_price)) +\n  geom_point(col = \"#BB6653\", size = 0.5) +\n  geom_abline(intercept = 0, slope = 1, \n               color = \"#DC143C\", linetype = \"dashed\", linewidth = 1) +  \n  labs(title = \"GWRF Hybrid: Predicted vs Actual Resale Prices\",\n       x = \"Predicted Resale Price (S$)\",\n       y = \"Actual Resale Price (S$)\") +\n    theme_minimal() +  \n  theme(\n    plot.background = element_rect(fill = \"#EEEEEE\"),      \n    panel.background = element_rect(fill = \"#F5F5F5\"),   \n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\") \n  )"
  },
  {
    "objectID": "geospatial/predict_hdb_resale/hdb_resale.html#ii.-gwrf-bandwidth-sensitivity-analysis",
    "href": "geospatial/predict_hdb_resale/hdb_resale.html#ii.-gwrf-bandwidth-sensitivity-analysis",
    "title": "Predictive Modeling for Singapore HDB Resale Prices",
    "section": "II. gwRF bandwidth sensitivity analysis",
    "text": "II. gwRF bandwidth sensitivity analysis\n\ni. Adjust bandwidth\nWe conducted a further bandwidth sensitivity analysis testing values from 48, 75, 100, 150 to 200 neighbors.\n\n\nCode\nbandwidths &lt;- c(48, 75, 100, 150, 200)\ngwrf_results &lt;- data.frame()\n\nfor(bw in bandwidths) {\n  set.seed(1234)\n  gwRF_test &lt;- grf(\n    formula = resale_price ~ \n    floor_level + floor_area_sqm + \n    remaining_lease_mths_num + PROX_HKCENTER + \n    PROX_SUPERMKT +PROX_ELDERCARE + PROX_MALLS +\n    PROX_SPORTS + PROX_CC + PROX_MRT + PROX_CBD +\n    PROX_BIZPK + WITHIN_1km_TOPPRISCH_BINARY + \n    WITHIN_500m_HKC_BINARY + WITHIN_350m_KINDG + \n    WITHIN_350m_CHILDC + WITHIN_350m_BUS + WITHIN_1km_PRISCH,\n    dframe = train_data_nogeom, \n    bw = bw,\n    kernel = \"adaptive\",\n    coords = coords_train,\n    ntree = 500,\n    mtry = 3\n  )\n  \n  gwRF_test_pred &lt;- predict.grf(\n    gwRF_test,\n    test_data_gwrf,\n    x.var.name = \"X\",\n    y.var.name = \"Y\",\n    local.w = 0.6,\n    global.w = 0.4\n  )\n  \n  predictions &lt;- as.data.frame(gwRF_test_pred)[,1]\n  \n  test_actual &lt;- as.numeric(test_data_p$resale_price)\n\ngwrf_results &lt;- rbind(gwrf_results, data.frame(\n  Bandwidth = bw,\n  RMSE = sqrt(mean((test_actual - predictions)^2)),\n  MAE = mean(abs(test_actual - predictions)),\n  R_squared = cor(test_actual, predictions)^2\n))\n  \n  print(paste(\"Completed bandwidth:\", bw))\n}\n\nwrite_rds(gwrf_results, \"data/rds/gwrf_results.rds\")\n\n\n\n\n\n\n\nBandwidth\nRMSE\nMAE\nR_squared\n\n\n\n\n48\n42933.35\n30973.33\n0.9419071\n\n\n75\n42544.71\n30658.50\n0.9435401\n\n\n100\n42523.82\n30511.26\n0.9442624\n\n\n150\n41592.95\n30061.08\n0.9472267\n\n\n200\n41396.24\n29898.66\n0.9481004\n\n\n\n\n\n\n\nii. Result visualisation\n\n\nCode\np_h &lt;- ggplot(gwrf_results, aes(x = Bandwidth, y = RMSE,\n                                text = paste0(\n                                   \"&lt;b&gt;Bandwidth:&lt;/b&gt; \", Bandwidth,\n                                   \"&lt;br&gt;&lt;b&gt;RMSE:&lt;/b&gt; $\", format(round(RMSE, 2), big.mark = \",\"),\n                                   \"&lt;br&gt;&lt;b&gt;Improvement vs RF:&lt;/b&gt; $\", format(round(41950 - RMSE, 2), big.mark = \",\")\n                                 ))) +\n  geom_line(color = \"orange\", linewidth = 1, aes(text = NULL)) +\n  geom_point(color = \"orange\", size = 3) +\n  geom_hline(yintercept = 41950, color = \"blue\", linetype = \"dashed\", linewidth = 1) +\n  geom_hline(yintercept = 38028, color = \"red\", linetype = \"dashed\", linewidth = 1) +\n  annotate(\"text\", x = max(gwrf_results$Bandwidth), y = 41950, \n           label = \"Random Forest\", hjust = 1.1, color = \"blue\") +\n  annotate(\"text\", x = max(gwrf_results$Bandwidth), y = 38028, \n           label = \"GWR\", hjust = 1.1, color = \"red\") +\n  labs(title = \"gwRF Performance by Bandwidth\",\n       subtitle = \"Hybrid model (60% local, 40% global)\",\n       x = \"Adaptive Bandwidth (Number of Neighbors)\",\n       y = \"RMSE (SGD)\") +\n  theme_minimal() +\n    theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"none\",\n    strip.text = element_text(size = 11, face = \"bold\"),\n    plot.background = element_rect(fill = \"#EEEEEE\"),      \n    panel.background = element_rect(fill = \"#F5F5F5\"),   \n    panel.border = element_rect(color = \"white\", fill = NA, linewidth = 1),\n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\"),\n    plot.subtitle = element_text(hjust = 0.5, size = 10))\n\nggplotly(p_h, tooltip = \"text\")\n\n\n\n\n\n\n\n\niii. Conclusion\nResults showed that increasing bandwidth improved gwRF performance (RMSE: 46,306 at BW=48 → 41,396 at BW=200), yet even optimal gwRF’s MAE underperformed standard RF (RMSE=29,540). This reveals a fundamental paradox: gwRF requires larger bandwidths to improve accuracy, but this negates the local spatial weighting that motivated its design. The consistent superiority of RF suggests that spatial dependencies are adequately represented through proximity features. They make explicit geographic weighting unnecessary, and potentially harmful when combined with tree-based ensemble methods."
  },
  {
    "objectID": "geospatial/proj_2-sg_bus/sg_bus.html#overview",
    "href": "geospatial/proj_2-sg_bus/sg_bus.html#overview",
    "title": "02 - Singapore Bus Passenger Travel Patterns",
    "section": "1 Overview",
    "text": "1 Overview\nPublic bus services form a critical component of Singapore’s multimodal transportation network, providing essential first-mile, last-mile, and direct connectivity for millions of daily commuters. Understanding spatial and temporal patterns in bus ridership is fundamental to optimising service provision, allocating resources efficiently, and enhancing user experience. As travel behaviors evolve and urban development continues, systematic analysis of boarding patterns enables evidence-based service planning that balances operational efficiency with accessibility requirements.\nIn this study, we aim to examine bus passenger boarding patterns across Singapore during July-September 2025, focusing on three distinct time periods: AM peak hours (6-9am), PM peak hours (5-8pm), and weekends (11am-8pm).\nThe primary objectives are to:\n\nIdentify spatial clustering patterns of high and low ridership across different time periods\nAnalyse temporal trends to determine whether demand is strengthening, weakening, or shifting spatially\nDetect spatial outliers and service gaps within the network"
  },
  {
    "objectID": "geospatial/proj_2-sg_bus/sg_bus.html#data-sources-preparation",
    "href": "geospatial/proj_2-sg_bus/sg_bus.html#data-sources-preparation",
    "title": "02 - Singapore Bus Passenger Travel Patterns",
    "section": "2 Data sources & preparation",
    "text": "2 Data sources & preparation\n\n2.1 Load packages\nThe packages that we will use for this study are outlined below:\n\n\n\nR Package\nDescription\n\n\n\n\nsf\nA package that provides simple features access for R.\n\n\nspdep\nCreates spatial weights matrices and to test for and model spatial autocorrelation in geographical data, like Moran’s I and Geary’s C and Local Moran’s I and Getis-Ord G.\n\n\ntidyverse\nIncludes the core packages like ggplot2, dplyr, readr, purrr, tibble, lubridate, etc.\n\n\nsfdep\nBuilds on the great shoulders of spdep package for spatial dependence. sfdep creates an sf and tidyverse friendly interface to the package as well as introduces new functionality that is not present in spdep.\n\n\nh3\nH3 is a geospatial indexing system using a hexagonal grid that can be (approximately) subdivided into finer and finer hexagonal grids, combining the benefits of a hexagonal grid with S2’s hierarchical subdivisions.\n\n\nknitr\nColor maps designed to improve graph readability for readers with common forms of color blindness and/or color vision deficiency.\n\n\ntmap\ngeographical maps in which spatial data distributions are visualized. This package offers a flexible, layer-based, and easy to use approach to create thematic maps, such as choropleths and bubble maps.\n\n\npatchwork\nA package that expands the API to allow for arbitrarily complex composition of plots by, among others, providing mathematical operators for combining multiple plots.\n\n\nrvest\nProvides the HTML parsing and extraction functions\n\n\nscales\nGraphical scales map data to aesthetics, and provide methods for automatically determining breaks and labels for axes and legends.\n\n\nRColorBrewer\nProvides color schemes for maps (and other graphics) designed by Cynthia Brewer as described at http://colorbrewer2.org.\n\n\nplotly\nPlotly’s R graphing library makes interactive, publication-quality graphs.\n\n\nKendall\nComputes the Kendall rank correlation and Mann-Kendall trend test.\n\n\ntsibble\nThe ‘tsibble’ provides tools to easily manipulate and analyse temporal data, such as filling in time gaps and aggregating over calendar periods.\n\n\nsftime\nClasses and methods for spatial objects that have a registered time column, in particular for irregular spatiotemporal data. The time column can be of any type, but needs to be ordinal. Regularly laid out spatiotemporal data (vector or raster data cubes) are handled by package ‘stars’.\n\n\ntrend\nThis package includes tests for trend detection, including Mann-Kendall Trend Test, partial Mann-Kendall Trend Test, multivariate (multisite) Mann-Kendall Trend Test, and more.\n\n\n\nLet’s install and load these package in R environment.\n\npacman::p_load(tidyverse, sf, spdep, sfdep, tmap, knitr, \n               h3, patchwork, rvest, RColorBrewer, scales, \n               plotly, Kendall, tsibble, sftime, trend)\n\n\n\n2.2 Import data\nWe will import 3 data sets for this study:\n\nImport Bus Stop Location shapfile from LTA DataMall into R environment\nImport Master Plan 2019 Subzone Boundary (No Sea) from https://data.gov.sg/\nImport Passenger Volume by Origin Destination Bus Stops from LTA DataMall\nImport LTA MRT Station Exit (KML) from https://data.gov.sg/\n\nWhen importing data, need to check first. Make sure bus stop code is in character form rather than numeric. If it’s latter, need to insert 0 because the stop code can start with zero.\nOpen Bustop.prj and check if the data has the information we need, or need to transform. Below we will start importing the data.\n\nMaster Plan Subzone BoundaryBus Stop LocationPassenger VolumeMRT Stations\n\n\nBelow we will import Master Plan 2019 Subzone Boundary (No Sea).\n\nmpsz &lt;- st_read(\"data/MasterPlan2019SubzoneBoundaryNoSeaKML.kml\")\n\n\nmpsz &lt;- read_rds(\"data/rds/mpsz.rds\")\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\n\nBelow we will import Bus Stop Location shapfile from LTA DataMall.\n\nBusStop = st_read(dsn = \"data/LTADataMall\",\n                  layer = \"BusStop\")\n\nReading layer `BusStop' from data source \n  `/Users/cathyc/Documents/cathyschu/analytics/geospatial/proj_2-sg_bus/data/LTADataMall' \n  using driver `ESRI Shapefile'\nSimple feature collection with 5172 features and 2 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48285.52 ymax: 52983.82\nProjected CRS: SVY21\n\n\nCheck the data type:\n\nst_crs(BusStop)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"WGS 84\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\n\nBased on the above, we identify that the the EPSG is not aligned with mpsz, so we need to transform the data for EPSG:3414 Projected coordinate system for Singapore.\n\nBusStop &lt;- BusStop %&gt;%\n  st_transform(crs = 3414)\n\nwrite_rds(BusStop, \"data/rds/BusStop.rds\")\n\nCheck again on BusStop:\n\nBusStop &lt;- read_rds(\"data/rds/BusStop.rds\")\nst_crs(BusStop)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\nNow, we see BusStop is aligned with mpsz.\n\n\nBelow code is used to import Passenger Volume by Origin Destination Bus Stops from LTA DataMall. The data retrieved are from July 2025 to September 2025 for three full months.\n\nodbus_08 &lt;- read_csv(\"data/origin_destination_bus_202508.csv\")\nodbus_09 &lt;- read_csv(\"data/origin_destination_bus_202509.csv\")\nodbus_07 &lt;- read_csv(\"data/origin_destination_bus_202507.csv\")\nodbus &lt;- rbind(odbus_08, odbus_09, odbus_07)\nwrite_csv(odbus, \"data/odbus.csv\")\n\n\nodbus &lt;- read_csv(\"data/odbus.csv\")\n\n\nst_crs(odbus)\n\nCoordinate Reference System: NA\n\n\n\n\nBelow we will import Master Plan 2019 Subzone Boundary (No Sea).\n\nmrt &lt;- st_read(\"data/LTAMRTStationExitKML.kml\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n\nBelow code is to write MRT station data into a rsd file, so we can directly call it without processing the data set again.\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\nmrt_all &lt;- mrt %&gt;%\n  mutate(\n    STATION = map_chr(Description, extract_kml_field, \"STATION_NA\"),\n    EXIT_CODE = map_chr(Description, extract_kml_field, \"EXIT_CODE\"),\n    INC_CRC = map_chr(Description, extract_kml_field, \"INC_CRC\"),\n    FMEL_UPD_D = map_chr(Description, extract_kml_field, \"FMEL_UPD_D\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\nmrt_sf &lt;- mrt_all %&gt;%\n  # Get just one exit per station \n  distinct(STATION, .keep_all = TRUE) \n  \n#  select(-Name, -Description) %&gt;%\n#  relocate(geometry, .after = last_col())\n\nwrite_rds(mrt_all, \"data/rds/mrt_all.rds\")\nwrite_rds(mrt_sf, \"data/rds/mrt_sf.rds\")\n\nPlot the MRT station exits in a tmap.\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(mpsz) +\n  tm_polygons(fill = \"#FAF3F3\", fill_alpha = 0.2) +\ntm_shape(mrt_sf) +\n  tm_symbols(\n   fill = \"#87A7B3\", size = 0.5,\n   col = \"#0C4271\",\n#   popup = \"STATION\"\n  ) +\n  tm_layout(main.title = \"MRT Stations\",\n            bg.color = \"#F6E6E4\",\n            outer.margins = c(0.01, 0.01, 0.01, 0.01))\n\n\n\n\n\n\n\n\n\nCode\n#tmap_mode(\"plot\")\n\n\n\n\n\n\n\n2.3 Data wrangling: Prepare hexagon data\nInstead of using planning zones or subzones determined by Singapore administrations, we will use prepare hexagon data in a regular and smaller unit to perform geospatial analysis.\n\n2.3.1 Extracting bus stops in Singapore\nFirst we plot the bus stops in Singapore below:\n\n\nCode\ntm_shape(mpsz) +\n  tm_polygons(fill = \"#FAF3F3\", filll_alpha = 0.2) +\n  tm_shape(BusStop) +\n  tm_dots(size = 0.25, fill = \"#9A8194\", col = \"#350B40\") +\n  tm_layout(main.title = \"All Bus Stops\",\n            bg.color = \"#F6E6E4\",\n            outer.margins = c(0.01, 0.01, 0.01, 0.01))\n\n\n\n\n\n\n\n\n\nWe see that the dots (bus stops) outside the boundaries are buses for JB, Malaysia. Therefore, these have to be excluded. One way to exclude them is to plot the mpsz layer on top of the BusStop layer.\nIf we have mpsz in front of the layer, it will capture all bus stops. When we plot first layer using Busstop before mpsz, these spots for JB will be covered.\n\nBusStop_in_SG &lt;- st_join(\n  BusStop, mpsz, #BusStop first\n  join = st_within,\n  left = FALSE\n)\n\nwrite_rds(BusStop_in_SG, \"data/rds/BusStop_in_SG.rds\")\n\nThe, we plot again:\n\n\nCode\nBusStop_in_SG &lt;- read_rds(\"data/rds/BusStop_in_SG.rds\")\n\ntm_shape(mpsz) +\n  tm_polygons(fill = \"#FAF3F3\", filll_alpha = 0.2) +\n  tm_shape(BusStop_in_SG) +\n  tm_dots(size = 0.25, fill = \"#839B97\", col = \"#184D47\") +\n  tm_layout(main.title = \"All Bus Stops (within border)\",\n            bg.color = \"#F6E6E4\",\n            outer.margins = c(0.01, 0.01, 0.01, 0.01))\n\n\n\n\n\n\n\n\n\n\n\n2.3.2 Deriving Analytical Hexagon\nWe want to create regular shapes layers with hexagon grid (square and hexagon are 2 most used), and exclude those without bus stops. Create the hexagon layer covering the entire Singapore.\nWe will need to derive the hexagon data of 375m (this distance is the perpendicular distance between the centre of the hexagon and its edges) to represent the traffic analysis zone (TAZ). cellsize is the distance between opposite edges of the hexagon. This distance is twice the perpendicular distance from the center to any edge.\n\nhexagon &lt;- st_make_grid(mpsz, cellsize = 750,\n                        what = \"polygon\",\n                        square = FALSE) %&gt;% \n# not a tibbler data frame\n  st_sf() # so need to convert to sf\n\nThe output does not have a unique ID.\n\n\n2.3.3 Filtering hexagons with bus stops\nWe only want to retain hexagons with bus stops. Use st_intersects() to return 2 values: True, False (0 or 1). The hexagon with a bus stop would be 1, and without a bus stop would return 0.\n\nhexagon$n_collisions = \n  lengths(st_intersects(\n    hexagon, BusStop_in_SG\n  )) #n_collisions show the number of bus stops.\n\nhexagon &lt;- filter(hexagon, n_collisions &gt;0) #retain all that have bus stops.\nwrite_rds(hexagon, \"data/rds/hexagon.rds\")\n\n\n\n2.3.4 Visualise the output\n\n\nCode\nhexagon &lt;- read_rds(\"data/rds/hexagon.rds\")\n\ntm_shape(mpsz) +\n  tm_polygons(fill = \"#FAF3F3\", filll_alpha = 0.2) +\n  tm_shape(hexagon) +\n  tm_fill(col = \"grey20\", fill = \"#91ADC8\", fill_alpha = 0.7) +\n  tm_layout(main.title = \"Analytical Hexagons\",\n            bg.color = \"#F6E6E4\",\n            outer.margins = c(0.01, 0.01, 0.01, 0.01))\n\n\n\n\n\n\n\n\n\nWe want to know the trips occurred in each hexagon in certain time periods.\nThe hexagons do not have an ID yet, so we will give each an ID.\n\n\n2.3.5 Assign IDs to each hexagon\n\nhexagon_geo_id&lt;- hexagon %&gt;%\n  select(, -n_collisions)\n\nhexagon_geo_id$HEX_ID &lt;- sprintf(\n  \"H%04d\", seq_len(nrow(hexagon))\n) %&gt;%\n  as.factor() #they will in ordinal scale\n\nkable(head(hexagon_geo_id))\n\nwrite_rds(hexagon_geo_id, \"data/rds/hexagon_geo_id.rds\")\n\n\nsum(hexagon$n_collisions &lt; 1, na.rm = TRUE)\n\n[1] 0\n\n\nBelow code is to ensure each hexagon is assigned an ID.\n\nhexagon_geo_id %&gt;%\n  filter(duplicated(HEX_ID) | duplicated(HEX_ID, fromLast = TRUE)) %&gt;%\n  arrange(HEX_ID)\nwrite_rds(hexagon_geo_id, \"data/rds/hexagon_geo_id.rds\")\n\n\n\nRows: 826\nColumns: 2\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 30…\n$ HEX_ID   &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009…\n\n\nWe see that the hexagon file with ID and geometry has 826 rows, meaning there are 826 Hex IDs.\n\n\n\n2.4 Prepare trip generation data\n\n2.4.1 Clearing the data\nWe don’t need the destination code. Below we will select the columns we need, including ORIGIN_PT_CODE, DAY_TYPE, TIME_PER_HOUR, and TOTAL_TRIPS. We also simplify the code to join the data sets together later.\n\ntrips &lt;- odbus %&gt;%\n  select(c(YEAR_MONTH, ORIGIN_PT_CODE, DAY_TYPE, TIME_PER_HOUR, TOTAL_TRIPS)) %&gt;%\n  rename(BUS_STOP_N = ORIGIN_PT_CODE) %&gt;% #simply the code for joining.\n  rename(HOUR_OF_DAY = TIME_PER_HOUR) %&gt;%\n  rename(TRIPS = TOTAL_TRIPS)\ntrips$BUS_STOP_N &lt;- as.factor(trips$BUS_STOP_N) #convert to factor so it's not numerical.\nkable(head(trips))\n\nwrite_rds(trips, \"data/rds/trips.rds\")\n\n\n\nRows: 17,306,071\nColumns: 5\n$ YEAR_MONTH  &lt;chr&gt; \"2025-08\", \"2025-08\", \"2025-08\", \"2025-08\", \"2025-08\", \"20…\n$ BUS_STOP_N  &lt;fct&gt; 84671, 10099, 64601, 53009, 80051, 70031, 67081, 10017, 64…\n$ DAY_TYPE    &lt;chr&gt; \"WEEKENDS/HOLIDAY\", \"WEEKENDS/HOLIDAY\", \"WEEKENDS/HOLIDAY\"…\n$ HOUR_OF_DAY &lt;dbl&gt; 9, 13, 21, 16, 18, 14, 20, 12, 23, 20, 5, 16, 6, 20, 9, 21…\n$ TRIPS       &lt;dbl&gt; 3, 31, 3, 10, 4, 1, 10, 4, 21, 17, 1, 512, 1, 2, 116, 85, …\n\n\nCombine bus stop with Hex ID into hexagon layer.\n\nbs_hex &lt;- st_intersection(\n  BusStop, hexagon_geo_id\n) %&gt;%\n  st_drop_geometry() %&gt;%\n  select(c(BUS_STOP_N, HEX_ID)) #drop away the rest\nkable(head(bs_hex))\nwrite_rds(bs_hex, \"data/rds/bs_hex.rds\")\n\n\n\nRows: 5,167\nColumns: 2\n$ BUS_STOP_N &lt;chr&gt; \"25059\", \"26379\", \"25751\", \"25761\", \"25719\", \"25711\", \"2636…\n$ HEX_ID     &lt;fct&gt; H0001, H0002, H0003, H0003, H0004, H0004, H0005, H0006, H00…\n\n\n\n\n2.4.2 Add HEX_ID into bus trips data\nUse left_join() to join trips and bus_hex. - Count trips per hexagon.\n\n\nCode\n# **Define all the combinations we need\nall_combinations &lt;- expand_grid(\n  HEX_ID = unique(bs_hex$HEX_ID),  # All 826 hexagons\n  YEAR_MONTH = c(\"2025-07\", \"2025-08\", \"2025-09\"),\n  HOUR_OF_DAY = c(6, 7, 8, 9, 17, 18, 19, 20, 11, 12, 13, 14, 15, 16),\n  DAY_TYPE = c(\"WEEKDAY\", \"WEEKENDS/HOLIDAY\")\n) %&gt;%\n  # Filter to keep only valid hour-day combinations\n  filter(\n    (DAY_TYPE == \"WEEKDAY\" & HOUR_OF_DAY %in% c(6, 7, 8, 9, 17, 18, 19, 20)) |\n    (DAY_TYPE == \"WEEKENDS/HOLIDAY\" & HOUR_OF_DAY %in% 11:20)\n  )\n\n# Aggregate trips by HEX_ID\ntrips_by_hex &lt;- trips %&gt;%\n  left_join(bs_hex %&gt;% select(BUS_STOP_N, HEX_ID), by = \"BUS_STOP_N\") %&gt;%\n  filter(!is.na(HEX_ID)) %&gt;%  # Remove trips without HEX_ID\n  group_by(HEX_ID, YEAR_MONTH, DAY_TYPE, HOUR_OF_DAY) %&gt;%\n  summarise(TRIPS = sum(TRIPS, na.rm = TRUE), .groups = 'drop')\n\n# Join with all combinations and fill missing with 0\ntrips_hex_complete &lt;- all_combinations %&gt;%\n  left_join(trips_by_hex, by = c(\"HEX_ID\", \"YEAR_MONTH\", \"DAY_TYPE\", \"HOUR_OF_DAY\")) %&gt;%\n  mutate(TRIPS = replace_na(TRIPS, 0)) %&gt;%\n  arrange(HEX_ID, YEAR_MONTH, DAY_TYPE, HOUR_OF_DAY)\n\nn_distinct(trips_hex_complete$HEX_ID)  # 826\n#trips_hex_complete %&gt;% \n#  count(YEAR_MONTH, DAY_TYPE, HOUR_OF_DAY)\n\nwrite_rds(trips_hex_complete, \"data/rds/trips_hex_complete.rds\")\n\n\n\n\nRows: 44,604\nColumns: 5\n$ HEX_ID      &lt;fct&gt; H0001, H0001, H0001, H0001, H0001, H0001, H0001, H0001, H0…\n$ YEAR_MONTH  &lt;chr&gt; \"2025-07\", \"2025-07\", \"2025-07\", \"2025-07\", \"2025-07\", \"20…\n$ HOUR_OF_DAY &lt;dbl&gt; 6, 7, 8, 9, 17, 18, 19, 20, 11, 12, 13, 14, 15, 16, 17, 18…\n$ DAY_TYPE    &lt;chr&gt; \"WEEKDAY\", \"WEEKDAY\", \"WEEKDAY\", \"WEEKDAY\", \"WEEKDAY\", \"WE…\n$ TRIPS       &lt;dbl&gt; 121, 127, 80, 67, 254, 342, 336, 206, 61, 112, 74, 66, 96,…\n\n\n\n\n\n2.5 Time preriod filtering\nIn section 2.3, we derived an analytical hexagon data of 375m to represent the traffic analysis zone (TAZ). We also processed time period filtering for 3 time intervals to compute passenger trips generated by origin at hexagon level. Below are the 3 time intervals.\n\n\n\nPeak hour period\nBus tap on time\n\n\n\n\nWeekday morning peak\n6am - 9am\n\n\nWeekday afternoon peak\n5pm - 8pm\n\n\nWeekend/holiday\n11am - 8pm\n\n\n\n\n2.5.1 Prepare study data\nBelow we will process the trips data with Hex ID for the 3 study periods.\n\n3 peak periods by hexagon3 peak periods (by month)3 peak periods (by hour)\n\n\n\n\nCode\nAM_trips_hex &lt;- trips_hex_complete %&gt;%\n  filter(HOUR_OF_DAY %in% c(6, 7, 8, 9),\n         DAY_TYPE == \"WEEKDAY\") %&gt;%\n  group_by(HEX_ID) %&gt;%\n  summarise(TRIPS = sum(TRIPS))\n\nPM_trips_hex &lt;- trips_hex_complete %&gt;%\n  filter(HOUR_OF_DAY %in% c(17, 18, 19, 20),\n         DAY_TYPE == \"WEEKDAY\") %&gt;%\n  group_by(HEX_ID) %&gt;%\n  summarise(TRIPS = sum(TRIPS)) \n\nweekend_trips_hex &lt;- trips_hex_complete %&gt;%\n  filter(HOUR_OF_DAY %in% 11:21,\n         DAY_TYPE == \"WEEKENDS/HOLIDAY\") %&gt;%\n  group_by(HEX_ID) %&gt;%\n  summarise(TRIPS = sum(TRIPS)) \n\nwrite_rds(AM_trips_hex, \"data/rds/AM_trips_hex.rds\")\nwrite_rds(PM_trips_hex, \"data/rds/PM_trips_hex.rds\")\nwrite_rds(weekend_trips_hex, \"data/rds/Weekend_trips_hex.rds\")\n\n\n\n\nView AM_trips_hex\n\n\nRows: 826\nColumns: 2\n$ HEX_ID &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009, …\n$ TRIPS  &lt;dbl&gt; 1272, 296, 798, 2703, 348, 370, 1118, 347, 16205, 5157, 621, 13…\n\n\n\nView PM_trips_hex\n\n\nRows: 826\nColumns: 2\n$ HEX_ID &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009, …\n$ TRIPS  &lt;dbl&gt; 3391, 841, 3031, 8882, 679, 892, 3940, 869, 10226, 6262, 7871, …\n\n\n\nView weekend_trips_hex\n\n\nRows: 826\nColumns: 2\n$ HEX_ID &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009, …\n$ TRIPS  &lt;dbl&gt; 3318, 437, 1417, 4262, 506, 426, 1663, 470, 22741, 7055, 2457, …\n\n\n\n\nIn this section, we want to filter the Bus tap on the time between 6am to 9am (9.59am) as morning peak hours and 5pm to 8pm as afternoon peak hours during weekdays. For weekend, we will filter for 11am to 8pm.\n\n\nCode\nAM_trips_hex_month &lt;- trips_hex_complete %&gt;%\n  filter(HOUR_OF_DAY %in% c(6, 7, 8, 9),\n         DAY_TYPE == \"WEEKDAY\") %&gt;%\n  group_by(HEX_ID, YEAR_MONTH) %&gt;%\n  summarise(TRIPS = sum(TRIPS))\n\nPM_trips_hex_month &lt;- trips_hex_complete %&gt;%\n  filter(HOUR_OF_DAY %in% c(17, 18, 19, 20),\n         DAY_TYPE == \"WEEKDAY\") %&gt;%\n  group_by(HEX_ID, YEAR_MONTH) %&gt;%\n  summarise(TRIPS = sum(TRIPS)) \n\nweekend_trips_hex_month &lt;- trips_hex_complete %&gt;%\n  filter(HOUR_OF_DAY %in% c(11:21),\n         DAY_TYPE == \"WEEKENDS/HOLIDAY\") %&gt;%\n  group_by(HEX_ID, YEAR_MONTH) %&gt;%\n  summarise(TRIPS = sum(TRIPS)) \n\nwrite_rds(AM_trips_hex_month, \"data/rds/AM_trips_hex_month.rds\")\nwrite_rds(PM_trips_hex_month, \"data/rds/PM_trips_hex_month.rds\")\nwrite_rds(weekend_trips_hex_month, \"data/rds/Weekend_trips_hex_month.rds\")\n\n\n\n\nView AM_trips_hex_month\n\n\nRows: 2,478\nColumns: 3\nGroups: HEX_ID [826]\n$ HEX_ID     &lt;fct&gt; H0001, H0001, H0001, H0002, H0002, H0002, H0003, H0003, H00…\n$ YEAR_MONTH &lt;chr&gt; \"2025-07\", \"2025-08\", \"2025-09\", \"2025-07\", \"2025-08\", \"202…\n$ TRIPS      &lt;dbl&gt; 395, 374, 503, 101, 89, 106, 315, 250, 233, 982, 825, 896, …\n\n\n\nView PM_trips_hex_month\n\n\nRows: 2,478\nColumns: 3\nGroups: HEX_ID [826]\n$ HEX_ID     &lt;fct&gt; H0001, H0001, H0001, H0002, H0002, H0002, H0003, H0003, H00…\n$ YEAR_MONTH &lt;chr&gt; \"2025-07\", \"2025-08\", \"2025-09\", \"2025-07\", \"2025-08\", \"202…\n$ TRIPS      &lt;dbl&gt; 1138, 1111, 1142, 301, 234, 306, 1129, 930, 972, 3095, 2767…\n\n\n\nView weekend_trips_hex_month\n\n\nRows: 2,478\nColumns: 3\nGroups: HEX_ID [826]\n$ HEX_ID     &lt;fct&gt; H0001, H0001, H0001, H0002, H0002, H0002, H0003, H0003, H00…\n$ YEAR_MONTH &lt;chr&gt; \"2025-07\", \"2025-08\", \"2025-09\", \"2025-07\", \"2025-08\", \"202…\n$ TRIPS      &lt;dbl&gt; 886, 1299, 1133, 109, 170, 158, 434, 494, 489, 1245, 1676, …\n\n\n\n\nIn this section, we want to filter for the each period of data with the hour of the day when trips were made.\n\n\nCode\nAM_trips_hex_hr &lt;- trips_hex_complete %&gt;%\n  filter(HOUR_OF_DAY %in% c(6, 7, 8, 9),\n         DAY_TYPE == \"WEEKDAY\") %&gt;%\n  group_by(HEX_ID, HOUR_OF_DAY) %&gt;%\n  summarise(TRIPS = sum(TRIPS)) \n\nPM_trips_hex_hr &lt;- trips_hex_complete %&gt;%\n  filter(HOUR_OF_DAY %in% c(17, 18, 19, 20),\n         DAY_TYPE == \"WEEKDAY\") %&gt;%\n  group_by(HEX_ID, HOUR_OF_DAY) %&gt;%\n  summarise(TRIPS = sum(TRIPS)) \n\nweekend_trips_hex_hr &lt;- trips_hex_complete %&gt;%\n  filter(HOUR_OF_DAY %in% c(11:21),\n         DAY_TYPE == \"WEEKENDS/HOLIDAY\") %&gt;%\n  group_by(HEX_ID, HOUR_OF_DAY) %&gt;%\n  summarise(TRIPS = sum(TRIPS))\n\nwrite_rds(AM_trips_hex_hr, \"data/rds/AM_trips_hex_hr.rds\")\nwrite_rds(PM_trips_hex_hr, \"data/rds/PM_trips_hex_hr.rds\")\nwrite_rds(weekend_trips_hex_hr, \"data/rds/weekend_trips_hex_hr.rds\")\n\n\n\n\nView AM_trips_hex_hr\n\n\nRows: 3,304\nColumns: 3\nGroups: HEX_ID [826]\n$ HEX_ID      &lt;fct&gt; H0001, H0001, H0001, H0001, H0002, H0002, H0002, H0002, H0…\n$ HOUR_OF_DAY &lt;dbl&gt; 6, 7, 8, 9, 6, 7, 8, 9, 6, 7, 8, 9, 6, 7, 8, 9, 6, 7, 8, 9…\n$ TRIPS       &lt;dbl&gt; 474, 345, 237, 216, 98, 77, 77, 44, 334, 191, 198, 75, 551…\n\n\n\nView PM_trips_hex_hr\n\n\nRows: 3,304\nColumns: 3\nGroups: HEX_ID [826]\n$ HEX_ID      &lt;fct&gt; H0001, H0001, H0001, H0001, H0002, H0002, H0002, H0002, H0…\n$ HOUR_OF_DAY &lt;dbl&gt; 17, 18, 19, 20, 17, 18, 19, 20, 17, 18, 19, 20, 17, 18, 19…\n$ TRIPS       &lt;dbl&gt; 748, 1086, 937, 620, 397, 173, 211, 60, 1327, 647, 630, 42…\n\n\n\nView weekend_trips_hex_hr\n\n\nRows: 8,260\nColumns: 3\nGroups: HEX_ID [826]\n$ HEX_ID      &lt;fct&gt; H0001, H0001, H0001, H0001, H0001, H0001, H0001, H0001, H0…\n$ HOUR_OF_DAY &lt;dbl&gt; 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 11, 12, 13, 14, 15…\n$ TRIPS       &lt;dbl&gt; 289, 365, 267, 238, 369, 402, 626, 308, 281, 173, 34, 45, …"
  },
  {
    "objectID": "geospatial/proj_2-sg_bus/sg_bus.html#exploratory-spatial-analysis",
    "href": "geospatial/proj_2-sg_bus/sg_bus.html#exploratory-spatial-analysis",
    "title": "02 - Singapore Bus Passenger Travel Patterns",
    "section": "3 Exploratory spatial analysis",
    "text": "3 Exploratory spatial analysis\n\n3.1 Peak Hour Trips by HexID\nBelow charts are plotted to have a full picture of the volume of each Hex ID in a descending manner. Next let’s plot it out.\n\nAMPMWeekend/PH\n\n\n\n\nCode\nggplot(AM_trips_hex_hr, \n       aes(x = HOUR_OF_DAY, y = TRIPS)) +\n  geom_col(fill = \"#9CAFAA\") +\n  scale_y_continuous(limits = c(0, 2.8e+07)) +\n  scale_x_continuous(breaks = unique(weekend_trips_hex_hr$HOUR_OF_DAY)) +\n  labs(title = \"AM Peak Hour Trips (6-9 AM) by Hours\",\n       x = \"Hour of Day\", y = \"Number of Trips\") + \n  theme(panel.background = element_rect(fill = \"#D0DDD0\"),\n        plot.background = element_rect(fill = \"#D6DAC8\"))\n\n\n\n\n\n\n\n\n\nInsight\nThe bar chart above shows that between 6-9am on weekdays, 7am has most people onboarding the bus (&gt; 25,000,000 passenger trips), followed by 8am, then 6am, and before 9am.\n\n\n\n\nCode\nggplot(PM_trips_hex_hr, \n       aes(x = HOUR_OF_DAY, y = TRIPS)) +\n  geom_col(fill = \"#8DBCC7\") +\n  scale_y_continuous(limits = c(0, 2.8e+07)) +\n  scale_x_continuous(breaks = unique(weekend_trips_hex_hr$HOUR_OF_DAY)) +\n  labs(title = \"PM Peak Hour Trips (5-8 PM) by Hours\",\n       x = \"Hour of Day\", y = \"Number of Trips\") + \n  theme(panel.background = element_rect(fill = \"#D0DDD0\"),\n        plot.background = element_rect(fill = \"#D6DAC8\"))\n\n\n\n\n\n\n\n\n\nInsight\nThe bar chart above shows that between 5-8pm on weekdays, 6pm has most people onboarding the bus (~ 25,000,000 passenger trips), followed by 5pm, then 7pm, and before 9pm. This indicates that most people start to leave office from 5pm. This makes sense as many people have 9am-6pm schedule, and it is also time for dinner.\n\n\nNext let’s plot it out.\n\n\nCode\nggplot(weekend_trips_hex_hr, \n       aes(x = HOUR_OF_DAY, y = TRIPS)) +\n  geom_col(fill = \"#E6B2BA\") +\n  scale_y_continuous(limits = c(0, 2.8e+07)) +\n  scale_x_continuous(breaks = unique(weekend_trips_hex_hr$HOUR_OF_DAY)) + \n  labs(title = \"Weekend/PH Peak Hour Trips (11AM-8PM) by Hours\",\n       x = \"Hour of Day\", y = \"Number of Trips\") + \n  theme(panel.background = element_rect(fill = \"#D0DDD0\"),\n        plot.background = element_rect(fill = \"#D6DAC8\"))\n\n\n\n\n\n\n\n\n\nInsight:\nWe plotted the bar chart in the same scale as AM/PM on weekdays to understand the trip volumes. It appears that on weekend/holidays, passenger trips on the bus have largely reduced. However, we can still observe that the peak hours during the off days are around lunch and dinner times at 12pm and 5-6pm.\n\n\n\n\n\n3.2 Interactive Maps for Peak Hour Trips\n\n3.2.1 Preparing data for tmap\nNow let’s join the data grouped by HEX_ID with hexagon, so we can plot it in tmap later for the three different peak hours of the week.\n\nAMPMWeekend\n\n\n\n\nCode\nAM_trips_geo &lt;- hexagon_geo_id %&gt;%\n  left_join(AM_trips_hex, by = \"HEX_ID\")\n\nAM_trips_geo_month &lt;- hexagon_geo_id %&gt;%\n  left_join(AM_trips_hex_month, by = \"HEX_ID\") \n \nAM_trips_geo_hr &lt;- hexagon_geo_id %&gt;%\n  left_join(AM_trips_hex_hr, by = \"HEX_ID\")\n\nwrite_rds(AM_trips_geo, \"data/rds/AM_trips_geo.rds\")\nwrite_rds(AM_trips_geo_month, \"data/rds/AM_trips_geo_month.rds\")\nwrite_rds(AM_trips_geo_hr, \"data/rds/AM_trips_geo_hr.rds\")\n\n\n\n\nView AM_trips_geo\n\n\nRows: 826\nColumns: 3\n$ HEX_ID   &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009…\n$ TRIPS    &lt;dbl&gt; 1272, 296, 798, 2703, 348, 370, 1118, 347, 16205, 5157, 621, …\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 30…\n\n\n\nView AM_trips_geo_month\n\n\nRows: 2,478\nColumns: 4\n$ HEX_ID     &lt;fct&gt; H0001, H0001, H0001, H0002, H0002, H0002, H0003, H0003, H00…\n$ YEAR_MONTH &lt;chr&gt; \"2025-07\", \"2025-08\", \"2025-09\", \"2025-07\", \"2025-08\", \"202…\n$ TRIPS      &lt;dbl&gt; 395, 374, 503, 101, 89, 106, 315, 250, 233, 982, 825, 896, …\n$ geometry   &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 …\n\n\n\nView AM_trips_geo_hr\n\n\nRows: 3,304\nColumns: 4\n$ HEX_ID      &lt;fct&gt; H0001, H0001, H0001, H0001, H0002, H0002, H0002, H0002, H0…\n$ HOUR_OF_DAY &lt;dbl&gt; 6, 7, 8, 9, 6, 7, 8, 9, 6, 7, 8, 9, 6, 7, 8, 9, 6, 7, 8, 9…\n$ TRIPS       &lt;dbl&gt; 474, 345, 237, 216, 98, 77, 77, 44, 334, 191, 198, 75, 551…\n$ geometry    &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538…\n\n\n\n\n\n\nCode\nPM_trips_geo &lt;- hexagon_geo_id %&gt;%\n  left_join(PM_trips_hex, by = \"HEX_ID\")\n\nPM_trips_geo_month &lt;- hexagon_geo_id %&gt;%\n  left_join(PM_trips_hex_month, by = \"HEX_ID\") \n \nPM_trips_geo_hr &lt;- hexagon_geo_id %&gt;%\n  left_join(PM_trips_hex_hr, by = \"HEX_ID\")\n\nwrite_rds(PM_trips_geo, \"data/rds/PM_trips_geo.rds\")\nwrite_rds(PM_trips_geo_month, \"data/rds/PM_trips_geo_month.rds\")\nwrite_rds(PM_trips_geo_hr, \"data/rds/PM_trips_geo_hr.rds\")\n\n\n\n\nView PM_trips_geo\n\n\nRows: 826\nColumns: 3\n$ HEX_ID   &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009…\n$ TRIPS    &lt;dbl&gt; 3391, 841, 3031, 8882, 679, 892, 3940, 869, 10226, 6262, 7871…\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 30…\n\n\n\nView PM_trips_geo_month\n\n\nRows: 2,478\nColumns: 4\n$ HEX_ID     &lt;fct&gt; H0001, H0001, H0001, H0002, H0002, H0002, H0003, H0003, H00…\n$ YEAR_MONTH &lt;chr&gt; \"2025-07\", \"2025-08\", \"2025-09\", \"2025-07\", \"2025-08\", \"202…\n$ TRIPS      &lt;dbl&gt; 1138, 1111, 1142, 301, 234, 306, 1129, 930, 972, 3095, 2767…\n$ geometry   &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 …\n\n\n\nView PM_trips_geo_hr\n\n\nRows: 3,304\nColumns: 4\n$ HEX_ID      &lt;fct&gt; H0001, H0001, H0001, H0001, H0002, H0002, H0002, H0002, H0…\n$ HOUR_OF_DAY &lt;dbl&gt; 17, 18, 19, 20, 17, 18, 19, 20, 17, 18, 19, 20, 17, 18, 19…\n$ TRIPS       &lt;dbl&gt; 748, 1086, 937, 620, 397, 173, 211, 60, 1327, 647, 630, 42…\n$ geometry    &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538…\n\n\n\n\n\n\nCode\nWKD_trips_geo &lt;- hexagon_geo_id %&gt;%\n  left_join(weekend_trips_hex, by = \"HEX_ID\")\n\nWKD_trips_geo_month &lt;- hexagon_geo_id %&gt;%\n  left_join(weekend_trips_hex_month, by = \"HEX_ID\") \n \nWKD_trips_geo_hr &lt;- hexagon_geo_id %&gt;%\n  left_join(weekend_trips_hex_hr, by = \"HEX_ID\")\n\nwrite_rds(WKD_trips_geo, \"data/rds/WKD_trips_geo.rds\")\nwrite_rds(WKD_trips_geo_month, \"data/rds/WKD_trips_geo_month.rds\")\nwrite_rds(WKD_trips_geo_hr, \"data/rds/WKD_trips_geo_hr.rds\")\n\n\n\n\nView WKD_trips_geo\n\n\nRows: 826\nColumns: 3\n$ HEX_ID   &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009…\n$ TRIPS    &lt;dbl&gt; 3318, 437, 1417, 4262, 506, 426, 1663, 470, 22741, 7055, 2457…\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 30…\n\n\n\nView WKD_trips_geo_month\n\n\nRows: 2,478\nColumns: 4\n$ HEX_ID     &lt;fct&gt; H0001, H0001, H0001, H0002, H0002, H0002, H0003, H0003, H00…\n$ YEAR_MONTH &lt;chr&gt; \"2025-07\", \"2025-08\", \"2025-09\", \"2025-07\", \"2025-08\", \"202…\n$ TRIPS      &lt;dbl&gt; 886, 1299, 1133, 109, 170, 158, 434, 494, 489, 1245, 1676, …\n$ geometry   &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 …\n\n\n\nView WKD_trips_geo_hr\n\n\nRows: 8,260\nColumns: 4\n$ HEX_ID      &lt;fct&gt; H0001, H0001, H0001, H0001, H0001, H0001, H0001, H0001, H0…\n$ HOUR_OF_DAY &lt;dbl&gt; 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 11, 12, 13, 14, 15…\n$ TRIPS       &lt;dbl&gt; 289, 365, 267, 238, 369, 402, 626, 308, 281, 173, 34, 45, …\n$ geometry    &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538…\n\n\n\n\n\n\n\n3.2.2 Visualising peak hours on hexagon\nBelow plots demonstrate the geographical distribution of the passenger trips in the 3 peak hour periods. Each page plots one of the peak hour periods. Note that there are two maps, and one plots the actual number of trips while the other uses quantile of the trips to avoid some outlier colors dominating the map.\n\nAMPMWeekends\n\n\n\n\nCode\ntmap_mode(\"view\")\n\nam_tm &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\ntm_shape(AM_trips_geo) +\n  tm_fill(\"TRIPS\", palette = \"-Spectral\", fill_alpha = 0.5) +\n  tm_borders(col = \"grey20\", lwd = 0.1) +\n  tm_layout(bg.color = \"#D0DDD0\",\n            outer.margins = c(0.01, 0.01, 0.01, 0.01),\n            main.title = \"PM Peak Hour Trips by Hexagon\",\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_shape(mrt_all) +\n  tm_symbols(fill = \"#DD7BDF\", size = 0.3, col = \"#6A0066\") +  \n  tm_view(set_zoom_limits = c(11,14))\n\n\nam_tm_qt &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\n  tm_shape(AM_trips_geo) +\n  tm_fill(\"TRIPS\", palette = \"-Spectral\", fill_alpha = 0.6,\n          style = \"quantile\"\n          ) +\n  tm_borders(col = \"grey20\", lwd = 0.1) +\n  tm_layout(bg.color = \"#D0DDD0\",\n            outer.margins = c(0.01, 0.01, 0.01, 0.01),\n            main.title = \"AM Peak Hour Trips (Quantile)\",\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_shape(mrt_all) +\n  tm_symbols(fill = \"#DD7BDF\", size = 0.3, col = \"#6A0066\") +\n  tm_view(set_zoom_limits = c(11,14))\n\n\ntmap_arrange(am_tm, am_tm_qt, \n             asp=1, ncol=1,\n             sync = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\nInsights:\nNote the following count of trips are aggregated figures from Jul-Sep 2025.\n\nDuring AM peak hours, the majority of hexagons show 200K trips or fewer (3 month data), with one hexagon near Boon Lay MRT station in Jurong West Central displaying significantly higher activity, indicating strong morning commute demand. Three hexagons in Woodlands Regional Center, area near the checkpoint and Tampines show the next highest volumes. The Woodlands check point likely reflects cross-border Malaysia-Singapore commuters.\nThe quantile plot analysis reveals the top 20% of trips distributed across residential areas islandwide, while the lowest 20% (&lt; 2,442 trips) concentrate along borders in Tuas, Lim Chu Kang, Central Water Catchment, and Seletar Aerospace - typically less residential zones.\nHigh-ridership hexagons during AM peak tend to form connected clusters across residential neighborhoods rather than appearing as isolated points. This pattern suggests that morning bus boarding reflects broader neighborhood-level commute behavior, where entire residential areas generate sustained high demand rather than activity being concentrated only at individual transit points.\n\n\n\n\n\nCode\ntmap_mode(\"view\")\npm_tm &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\ntm_shape(PM_trips_geo) +\n  tm_fill(\"TRIPS\", palette = \"-Spectral\", fill_alpha = 0.5) +\n  tm_borders(col = \"grey20\", lwd = 0.1) +\n  tm_layout(bg.color = \"#D0DDD0\",\n            outer.margins = c(0.01, 0.01, 0.01, 0.01),\n            main.title = \"PM Peak Hour Trips by Hexagon\",\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_shape(mrt_all) +\n  tm_symbols(fill = \"#DD7BDF\", size = 0.3, col = \"#6A0066\") +  \n  tm_view(set_zoom_limits = c(11,14))\n\npm_tm_qt &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\n  tm_shape(PM_trips_geo) +\n  tm_fill(\"TRIPS\", palette = \"-Spectral\", fill_alpha = 0.6,\n          style = \"quantile\"\n          ) +\n  tm_borders(col = \"grey20\", lwd = 0.1) +\n  tm_layout(bg.color = \"#D0DDD0\",\n            outer.margins = c(0.01, 0.01, 0.01, 0.01),\n            main.title = \"PM Peak Hour Trips (Quantile)\",\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_shape(mrt_all) +\n  tm_symbols(fill = \"#DD7BDF\", size = 0.3, col = \"#6A0066\") +\n  tm_view(set_zoom_limits = c(11,14))\n\ntmap_arrange(pm_tm, pm_tm_qt, \n             asp=1, ncol=1,\n             sync = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\nInsight:\nNote the following count of trips are aggregated figures from Jul-Sep 2025.\n\nIn the fixed interval plot for PM peak hours, most hexagons show 500K trips or fewer (for 3 months). Several hexagons show significantly higher boarding activity (500K - 1,000K trips), located in Woodlands Regional Centre, Jurong West Central, and Tampines West subzones.\nThese high-boarding hexagons contain or are adjacent to Woodlands, Boon Lay, and Tampines MRT stations. During PM peak hours, this suggests passengers are arriving via MRT and transferring to buses for their onward journey (likely the last mile home), or the areas have major activity centers (workplaces, shopping centers) where people begin their evening commute.\nSeveral hexagons stand out in green (500K-1,000K trips, July-Sep 2025), located at or near major MRT stations including Khatib, Yishun, Punggol, Sengkang, Hougang, Serangoon, Ang Mo Kio, Bishan, Bedok, Toa Payoh, Clementi, Bukit Batok, Bukit Panjang, Lakeside, Choa Chu Kang, and Woodlands checkpoint.\nDuring PM peak hours, high bus boarding activity is concentrated around major MRT stations island-wide. This could indicate several possibilities: 1/Commuters transferring from MRT to buses for last-mile connectivity home; 2/People finishing work/activities near these transit hubs and boarding bus; 3/ High residential density around these stations generating bus demand; 4/The widespread distribution across the island suggests that areas surrounding MRT stations are key activity centers for PM peak hour bus ridership, regardless of the specific origin of passengers.\n\n\n\n\n\nCode\ntmap_mode(\"view\")\nwkd_tm &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#A1C2BD\", alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\ntm_shape(WKD_trips_geo) +\n  tm_fill(\"TRIPS\", palette = \"-Spectral\", fill_alpha = 0.5) +\n  tm_borders(col = \"grey20\", lwd = 0.1) +\n  tm_layout(bg.color = \"#D0DDD0\",\n            outer.margins = c(0.01, 0.01, 0.01, 0.01),\n            main.title = \"Weekend Peak Hour Trips by Hexagon\",\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_shape(mrt_all) +\n  tm_symbols(fill = \"#DD7BDF\", size = 0.3, col = \"#6A0066\") +\n  tm_view(set_zoom_limits = c(11,14))\n\nwkd_tm_qt &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#A1C2BD\", alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\n  tm_shape(WKD_trips_geo) +\n  tm_fill(\"TRIPS\", palette = \"-Spectral\", fill_alpha = 0.6,\n          style = \"quantile\") +\n  tm_borders(col = \"grey20\", lwd = 0.1) +\n  tm_layout(bg.color = \"#D0DDD0\",\n            outer.margins = c(0.01, 0.01, 0.01, 0.01),\n            main.title = \"Weekend Peak Hour Trips (Quantile)\",\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_shape(mrt_all) +\n  tm_symbols(fill = \"#DD7BDF\", size = 0.3, col = \"#6A0066\") +\n  tm_view(set_zoom_limits = c(11,14))\n\ntmap_arrange(wkd_tm, wkd_tm_qt, \n             asp=1, ncol=1,\n             sync = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\nInsights:\nNote the following count of trips are aggregated figures from Jul-Sep 2025.\n\nWoodlands Regional Centre shows the highest bus boarding activity on weekends, followed by Jurong West Central (Boon Lay MRT) and Tampines (Tampines MRT), while Woodlands checkpoint and Bukit Panjang MRT areas fall in the next tier with 600K-800K trips during July-September 2025.\nHexagons with moderate-to-high ridership form two distinct patterns: clusters around MRT/LRT stations in residential areas across the island (including Woodlands, Yishun, Punggol, Sengkang, Bishan, Ang Mo Kio, Toa Payoh, Jurong East, Clementi, Choa Chu Kang, Bedok, and Tampines), and a continuous zone across central shopping and entertainment districts spanning Orchard, Little India, Chinatown, Clarke Quay, Bugis, and Harbourfront. This suggests weekend bus activity centers around leisure, shopping, and social destinations rather than work-related commutes.\nComparing weekend patterns with weekday PM peaks reveals similar overall distributions but notable differences in specific areas. Locations like Macpherson, Tanjong Pagar, Pasir Panjang, Ang Mo Kio Town Centre, and areas near Joo Koon show higher weekday ridership, likely reflecting office and industrial employment centers that quiet down on weekends.\nConversely, areas like Changi Point, Reservoir View, and Sembawang Straits become comparatively more active on weekends, while Woodlands, Yishun, Tampines, and Bedok display more spatially clustered high-ridership hexagons on weekends, suggesting these regional centers host localized leisure and social activities."
  },
  {
    "objectID": "geospatial/proj_2-sg_bus/sg_bus.html#local-measures-of-spatial-autocorrelation-lmsa-analysis",
    "href": "geospatial/proj_2-sg_bus/sg_bus.html#local-measures-of-spatial-autocorrelation-lmsa-analysis",
    "title": "02 - Singapore Bus Passenger Travel Patterns",
    "section": "4 Local Measures of Spatial Autocorrelation (LMSA) Analysis",
    "text": "4 Local Measures of Spatial Autocorrelation (LMSA) Analysis\nFor this study, we want to understand if passenger trips are evenly distributed geographically among the hexagons. From the previous plots, we can confidently yield the conclusion that they are not evenly distributed. In this section, we would like to use statistical methods to provide the evidence.\nIf this proves our assumption, then our next question will be “is there sign of spatial clustering?”. If the answer is yes, then our next question will be “where are these clusters?”\n\n4.1 Global Measures of Spatial Autocorrelation\nIn previous section 2, we have prepared the passenger trips data per hexagon area. The plots can be observed in section 3 to see equal interval classification and quantile classification.\nHere we want to compute global spatial autocorrelation statistics and to perform spatial complete randomness test for global spatial autocorrelation.\n\n4.1.1 Compute contiguity spatial weights\n\nwm_q &lt;- poly2nb(hexagon, queen = TRUE)\n\nwrite_rds(wm_q, \"data/rds/wm_q.rds\")\n\n\n\nNeighbour list object:\nNumber of regions: 826 \nNumber of nonzero links: 3958 \nPercentage nonzero weights: 0.5801171 \nAverage number of links: 4.791768 \n1 region with no links:\n826\n6 disjoint connected subgraphs\nLink number distribution:\n\n  0   1   2   3   4   5   6 \n  1  17  35 104 144 167 358 \n17 least connected regions:\n1 73 103 104 122 323 338 396 474 669 770 812 814 815 817 818 821 with 1 link\n358 most connected regions:\n7 12 15 17 23 29 31 32 35 38 41 44 45 46 47 50 51 52 53 56 57 59 61 62 65 70 71 79 86 87 91 92 98 99 100 108 109 110 115 116 117 124 125 126 129 130 131 135 136 137 140 141 142 147 152 156 163 167 174 175 181 182 183 185 192 193 194 195 196 197 203 204 205 208 209 212 214 215 216 220 223 225 226 228 229 233 235 245 246 247 250 254 255 260 264 265 266 269 274 275 285 286 292 295 296 297 300 301 302 303 304 308 311 312 313 315 316 319 320 325 328 331 332 335 340 341 349 352 361 362 368 369 378 379 386 387 388 394 398 399 406 408 409 410 417 420 429 431 435 442 443 444 447 448 453 454 457 458 463 464 467 468 469 472 477 478 481 482 483 484 485 486 489 490 491 493 494 495 496 500 501 502 503 504 505 506 507 508 514 515 516 517 518 519 520 521 524 525 526 527 528 529 530 531 536 537 538 539 540 541 542 549 550 551 552 553 554 561 562 563 564 565 566 572 573 574 575 576 577 578 579 580 583 584 585 586 587 588 589 593 594 595 596 597 599 600 604 605 606 607 610 611 613 614 615 616 617 618 622 623 624 627 628 629 630 631 634 635 640 643 644 645 650 652 653 654 657 658 661 662 663 665 672 673 674 676 678 680 681 683 684 685 689 693 694 695 702 703 706 707 708 709 714 715 719 720 721 725 726 732 733 735 736 739 740 741 742 743 745 746 747 748 749 750 752 753 754 755 756 758 759 760 761 762 766 767 768 773 774 775 776 777 778 781 782 783 786 787 788 789 790 791 792 793 798 799 804 805 with 6 links\n\n\nSummary Report:\nThere are 826 regions (hexagons) in the Singapore map. The most connected area unit has 6 neighbors (hexagon has 6 edges). There is one unit with no neighbors, and the Hex ID is 826.\n\n\n4.1.2 Row-standardised weights matrix\nNow we want to assign weights to each neighboring hexagon. In this study, each hexagon will be assigned equal weight (stylep = W).\n\nrswm_q &lt;- nb2listw(wm_q,\n                   style = \"W\", zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 826 \nNumber of nonzero links: 3958 \nPercentage nonzero weights: 0.5801171 \nAverage number of links: 4.791768 \n1 region with no links:\n826\n6 disjoint connected subgraphs\n\nWeights style: W \nWeights constants summary:\n    n     nn  S0       S1       S2\nW 825 680625 825 384.3206 3335.117\n\n\n\n\n4.1.3 Moran’s I Test\nBelow we will perform Moran’s I statistics testing by using moran.test() from spdep package. The test is being performed for the 3 different periods of time.\n\nAMPMWeekend/Public holiday\n\n\nMoran’s I Test\n\n\nCode\nmoran_test_lmsa_am &lt;- moran.test(AM_trips_geo$TRIPS,\n           listw = rswm_q,\n           zero.policy = TRUE, na.action = na.omit)\nwrite_rds(moran_test_lmsa_am, \"data/rds/moran_test_lmsa_am.rds\")\n\n\n\n\n\n    Moran I test under randomisation\n\ndata:  AM_trips_geo$TRIPS  \nweights: rswm_q  \nn reduced by no-neighbour observations  \n\nMoran I statistic standard deviate = 14.345, p-value &lt; 2.2e-16\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     0.3362907435     -0.0012135922      0.0005535647 \n\n\n\n\nStatistical conclusion\n\n\n\nGiven statistically significant spatial autocorrelation (p-value &lt; 2.2e-16), we can confidently reject the null hypothesis of random spatial distribution.\nMoran I statistic is 0.3363, as a postive value that indicates similar values cluster together.\nThe result indicates that hexagons with high passenger trips tend to be near other high-trip hexagons and hexagons with low passenger trips tend to be near other low passenger trip hexagons (cold spots). There are clear geographic clusters.\n\n\n\nMonte Carlo Moran’s I\nWe will run Monte Carlo Moran’s I simulation for 1,000 times.\n\n\nCode\nset.seed(1234)\nbperm_am = moran.mc(AM_trips_geo$TRIP,\n                 listw = rswm_q,\n                 nsim = 999,\n                 zero.policy = TRUE, na.action = na.omit)\nwrite_rds(bperm_am, \"data/rds/bperm_am.rds\")\n\n\n\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  AM_trips_geo$TRIP \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.33629, observed rank = 1000, p-value = 0.001\nalternative hypothesis: greater\n\n\n\n\nStatistical conclusion\n\n\n\np-value = 0.001 indicates that it is highly significant evidence to reject null hypothesis (that this pattern is random), and confirms the analytical test result from the Moran’s I test.\nAM peak Moran’s I = 0.336 Shows strong spatial clustering with multiple connected hexagons forming larger contiguous areas of higher ridership across residential zones, indicating broader neighborhood-level boarding patterns\n\n\n\nVisualise Moran’s I Test\nWe plot the distribution of statistical values below.\n\n\nCode\nmean_bperm_am &lt;- mean(bperm_am$res[1:999])\nprint(paste0(\"Mean of permutations: \", mean_bperm_am))\n\n\n[1] \"Mean of permutations: -0.000998253345032764\"\n\n\nCode\nvar &lt;- var(bperm_am$res[1:999])\nprint(paste0(\"Variance: \", var))\n\n\n[1] \"Variance: 0.000530214300108952\"\n\n\nCode\nsummary(bperm_am$res[1:999])\n\n\n      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. \n-0.0666092 -0.0166488 -0.0018595 -0.0009983  0.0139997  0.1060355 \n\n\n\n\nCode\nperm_data_am &lt;- data.frame(moran_i = bperm_am$res)\n\nggplot(perm_data_am, aes(x = moran_i)) +\n  geom_histogram(bins = 20, fill = \"#96A78D\", color = \"#DCDCDC\") +\n  geom_vline(xintercept = 0, color = \"blue\", linewidth = 0.5) +\n  geom_vline(xintercept = 0.3362907435, color = \"red\", linewidth = 0.5) +\n  labs(x = \"Simulated Moran's I (Weekday AM)\", y = \"Frequency\") +\n  theme(plot.background = element_rect(\"#D0DDD0\"),\n        panel.background = element_rect(fill = \"#D0DDD0\"))\n\n\n\n\n\n\n\n\n\nInsights:\n\nThe observed Moran’s I value of approximately 0.33 (red line) falls far outside the distribution of simulated random values (green histogram centered near 0). This provides strong statistical evidence that bus ridership during Weekday AM peak hours exhibits significant positive spatial autocorrelation\nThis means high-ridership hexagons are clustered together rather than randomly distributed across Singapore, and validates the earlier observations about hotspots around Boon Lay, Woodlands, and Tampines.\n\n\n\nMoran’s I Test\n\n\nCode\nmoran_test_lmsa_pm &lt;- moran.test(PM_trips_geo$TRIP,\n           listw = rswm_q,\n           zero.policy = TRUE, na.action = na.omit)\n\nwrite_rds(moran_test_lmsa_pm, \"data/rds/moran_test_lmsa_pm.rds\")\n\n\n\n\n\n    Moran I test under randomisation\n\ndata:  PM_trips_geo$TRIP  \nweights: rswm_q  \nn reduced by no-neighbour observations  \n\nMoran I statistic standard deviate = 6.1219, p-value = 4.625e-10\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     0.1401003174     -0.0012135922      0.0005328489 \n\n\n\n\nStatistical conclusion\n\n\n\nThough not as extreme as AM weekdays, PM weekdays’ Moran’s I test also shows highly significant evidence to reject the null hypothesis, showing that clustering exists, just much weaker than AM weekdays.\nPM peak Moran’s I = 0.14 Shows weaker spatial clustering because high-ridership hexagons tend to be isolated single hexagons concentrated around individual MRT stations rather than forming large connected clusters\n\n\n\nMonte Carlo Moran’s I\n\n\nCode\nset.seed(1234)\nbperm_pm = moran.mc(PM_trips_geo$TRIPS,\n                 listw = rswm_q,\n                 nsim = 999,\n                 zero.policy = TRUE, na.action = na.omit)\nwrite_rds(bperm_pm, \"data/rds/bperm_pm.rds\")\n\n\n\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  PM_trips_geo$TRIPS \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.1401, observed rank = 1000, p-value = 0.001\nalternative hypothesis: greater\n\n\n\n\nStatistical conclusion\n\n\n\np-value = 0.001 shows that there is significant evidence to reject the null hypothesis, indicating that there is clustering in PM passenger trips. This confirms the analytical test and matches the analytical result.\n\n\n\nVisualise Moran’s I Test\nWe plot the distribution of statistical values below.\n\n\nCode\nmean_bperm_pm &lt;- mean(bperm_pm$res[1:999])\nprint(paste0(\"Mean of permutations: \", mean_bperm_pm))\n\n\n[1] \"Mean of permutations: -0.00133635545730555\"\n\n\nCode\nvar_pm &lt;- var(bperm_pm$res[1:999])\nprint(paste0(\"Variance: \", var))\n\n\n[1] \"Variance: 0.000530214300108952\"\n\n\nCode\nsummary(bperm_pm$res[1:999])\n\n\n     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n-0.051721 -0.016430 -0.004006 -0.001336  0.010636  0.097041 \n\n\n\n\nCode\nperm_data_pm &lt;- data.frame(moran_i = bperm_pm$res)\n\nggplot(perm_data_pm, aes(x = moran_i)) +\n  geom_histogram(bins = 20, fill = \"#8DBCC7\", color = \"#DCDCDC\") +\n  geom_vline(xintercept = 0, color = \"blue\", linewidth = 0.5) +\n  geom_vline(xintercept = 0.1401003174, color = \"red\", linewidth = 0.5) +\n  labs(x = \"Simulated Moran's I (Weekday PM)\", y = \"Frequency\") +\n  xlim(-0.15, 0.35) +\n  theme(plot.background = element_rect(\"#D0DDD0\"),\n        panel.background = element_rect(fill = \"#D0DDD0\"))\n\n\n\n\n\n\n\n\n\nInsights - The observed Moran’s I value of approximately 0.14 (red line) falls well outside the distribution of simulated random values (blue histogram centered near 0), providing strong statistical evidence (p-value = 4.625e-10) that bus ridership during Weekday PM peak hours exhibits significant positive spatial autocorrelation, though the clustering pattern differs from AM peak.\n\nThe lower Moran’s I for PM peak reflects that high boarding activity is more localized and point-based (centered on specific transit hubs) rather than spread across connected residential areas. While both periods show statistically significant clustering, AM peak exhibits broader spatial continuity of high ridership across neighborhoods, whereas PM peak shows more dispersed, station-specific hotspots.\n\n\n\nMoran’s I Test\n\n\nCode\nmoran_test_lmsa_wkd &lt;- moran.test(WKD_trips_geo$TRIPS,\n           listw = rswm_q,\n           zero.policy = TRUE, na.action = na.omit)\nwrite_rds(moran_test_lmsa_wkd, \"data/rds/moran_test_lmsa_wkd.rds\")\n\n\n\n\n\n    Moran I test under randomisation\n\ndata:  WKD_trips_geo$TRIPS  \nweights: rswm_q  \nn reduced by no-neighbour observations  \n\nMoran I statistic standard deviate = 9.3434, p-value &lt; 2.2e-16\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n     0.2168371154     -0.0012135922      0.0005446323 \n\n\n\n\nStatistical conclusion\n\n\n\nWeekend has p-value &lt; 2.2e-16 showing extremely significant evidence for us to reject the null hypothesis.\nIts Moran I statistic = 0.21684 is the middle among the 3 periods we study, stronger than PM weekdays.\nWeekend trip origins show moderate spatial clustering, suggesting that while people depart for leisure activities from concentrated residential areas, the pattern is less rigid than weekday morning commutes but more organized than weekday afternoon movements.\n\n\n\nMonte Carlo Moran’s I\n\n\nCode\nset.seed(1234)\nbperm_wkd = moran.mc(WKD_trips_geo$TRIPS,\n                 listw = rswm_q,\n                 nsim = 999,\n                 zero.policy = TRUE, na.action = na.omit)\nwrite_rds(bperm_wkd, \"data/rds/bperm_wkd.rds\")\n\n\n\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  WKD_trips_geo$TRIPS \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.21684, observed rank = 1000, p-value = 0.001\nalternative hypothesis: greater\n\n\n\n\nStatistical conclusion\n\n\n\np-value = 0.001 shows highly significant evidence for us to reject tje null hypothesis. This confirms the analytical test result (p &lt; 2.2e-16)\nIn 1000 random permutations, none produced a Moran’s I as high as 0.217. Therefore, weekend spatial clustering is definitely NOT due to chance.\n\n\n\nVisualise Moran’s I Test\nWe plot the distribution of statistical values below.\n\n\nCode\nmean_bperm_wkd &lt;- mean(bperm_wkd$res[1:999])\nprint(paste(\"Mean of permutations: \", mean_bperm_wkd))\n\n\n[1] \"Mean of permutations:  -0.0012677874932846\"\n\n\nCode\nvar_wkd &lt;- var(bperm_wkd$res[1:999])\nprint(paste(\"Variance: \", var))\n\n\n[1] \"Variance:  0.000530214300108952\"\n\n\nCode\nsummary(bperm_wkd$res[1:999])\n\n\n     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n-0.054281 -0.016144 -0.002268 -0.001268  0.010999  0.113763 \n\n\n\n\nCode\nperm_data_wkd &lt;- data.frame(moran_i = bperm_wkd$res)\n\nggplot(perm_data_wkd, aes(x = moran_i)) +\n  geom_histogram(bins = 20, fill = \"#FFA4A4\", color = \"#DCDCDC\") +\n  geom_vline(xintercept = 0, color = \"blue\", linewidth = 0.5) +\n  geom_vline(xintercept = 0.2168371154, color = \"red\", linewidth = 0.5) +\n  labs(x = \"Simulated Moran's I (Weekend)\", y = \"Frequency\") +\n  xlim(-0.15, 0.35) +  \n  theme(plot.background = element_rect(fill = \"#D0DDD0\"),\n        panel.background = element_rect(fill = \"#D0DDD0\"))\n\n\n\n\n\n\n\n\n\nObservation\n\nThe observed Moran’s I value of approximately 0.22 (red line) falls far outside the distribution of simulated random values (pink histogram centered near 0). This provides extremely strong statistical evidence (p-value &lt; 2.2e-16) that bus ridership during weekends exhibits significant positive spatial autocorrelation.\n\n\n\n\n\n\n\n4.2 Local Measures of Spatial Autocorrelation (LMSA)\nThe Global Measures of Spatial Autocorrelation suggests that all three study periods have clustering spatial patterns. We will now use Local Measures of Spatial Autocorrelation to compute the statistic of the passenger trips, and understand where the significant clusters are located by displaying the LMSA maps.\nBelow we will continue to use spdep to compute Local Moran’s I statistic.\n\n4.2.1 Computing Contiguity Spatial Weights\n\nhexagon_contiguity &lt;- hexagon_geo_id %&gt;%\n  mutate(nb = st_contiguity(geometry),\n         wt = st_weights(nb, style = \"W\",\n                         , allow_zero = TRUE),\n         .before = 1) \nwrite_rds(hexagon_contiguity, \"data/rds/hexagon_contiguity.rds\")\n\n\n\nNeighbour list object:\nNumber of regions: 826 \nNumber of nonzero links: 3958 \nPercentage nonzero weights: 0.5801171 \nAverage number of links: 4.791768 \n1 region with no links:\n826\n6 disjoint connected subgraphs\nLink number distribution:\n\n  0   1   2   3   4   5   6 \n  1  17  35 104 144 167 358 \n17 least connected regions:\n1 73 103 104 122 323 338 396 474 669 770 812 814 815 817 818 821 with 1 link\n358 most connected regions:\n7 12 15 17 23 29 31 32 35 38 41 44 45 46 47 50 51 52 53 56 57 59 61 62 65 70 71 79 86 87 91 92 98 99 100 108 109 110 115 116 117 124 125 126 129 130 131 135 136 137 140 141 142 147 152 156 163 167 174 175 181 182 183 185 192 193 194 195 196 197 203 204 205 208 209 212 214 215 216 220 223 225 226 228 229 233 235 245 246 247 250 254 255 260 264 265 266 269 274 275 285 286 292 295 296 297 300 301 302 303 304 308 311 312 313 315 316 319 320 325 328 331 332 335 340 341 349 352 361 362 368 369 378 379 386 387 388 394 398 399 406 408 409 410 417 420 429 431 435 442 443 444 447 448 453 454 457 458 463 464 467 468 469 472 477 478 481 482 483 484 485 486 489 490 491 493 494 495 496 500 501 502 503 504 505 506 507 508 514 515 516 517 518 519 520 521 524 525 526 527 528 529 530 531 536 537 538 539 540 541 542 549 550 551 552 553 554 561 562 563 564 565 566 572 573 574 575 576 577 578 579 580 583 584 585 586 587 588 589 593 594 595 596 597 599 600 604 605 606 607 610 611 613 614 615 616 617 618 622 623 624 627 628 629 630 631 634 635 640 643 644 645 650 652 653 654 657 658 661 662 663 665 672 673 674 676 678 680 681 683 684 685 689 693 694 695 702 703 706 707 708 709 714 715 719 720 721 725 726 732 733 735 736 739 740 741 742 743 745 746 747 748 749 750 752 753 754 755 756 758 759 760 761 762 766 767 768 773 774 775 776 777 778 781 782 783 786 787 788 789 790 791 792 793 798 799 804 805 with 6 links\n\n\nBased on the summary report, we understand that there is one hexagon area, HexID = 826, without any neighbors. We will filter this neighbour out to process further LMSA statistic and analysis as it cannot create any weights.\n\n\n4.2.2 Computing Local Moran’s I\nSince there is a hexagon without no neighbor, we will filter it out and remove it from the data. We will also join the Passenger Trips to to the hexagon sf object for the 3 periods respectively.\n\n\nCode\n# Remove 826\nhexagon_contiguity_ft &lt;- hexagon_contiguity %&gt;%\n  filter(HEX_ID != \"H0826\") \n\nwrite_rds(hexagon_contiguity_ft, \"data/rds/hexagon_contiguity_ft.rds\")\n\n\n\n\nRows: 825\nColumns: 4\n$ nb       &lt;nb&gt; 3, &lt;4, 5, 7&gt;, &lt;1, 6, 10&gt;, &lt;2, 6, 7, 11&gt;, &lt;2, 7, 8, 12&gt;, &lt;3, 4,…\n$ wt       &lt;list&gt; 1, &lt;0.3333333, 0.3333333, 0.3333333&gt;, &lt;0.3333333, 0.3333333,…\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 30…\n$ HEX_ID   &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009…\n\n\nFrom the above, we can confirm that hexagon_contiguity_ft now has 825 hexagons, with nb and wt data.\n\nAMPMWeekend/PH\n\n\n** Join Moran’s I to trips data**\n\n\nCode\n# Add TRIPS data\nhexagon_data_moranI_am &lt;- hexagon_contiguity_ft %&gt;%\n  left_join(AM_trips_hex %&gt;% \n              select(HEX_ID, TRIPS), \n            by = \"HEX_ID\")\n    \n# Recreate nb and wt\nhexagon_data_moranI_am &lt;- hexagon_data_moranI_am %&gt;%\n  mutate(\n    nb = st_contiguity(geometry),\n    wt = st_weights(nb, style = \"W\")\n  )\n\nwrite_rds(hexagon_data_moranI_am, \"data/rds/hexagon_data_moranI_am.rds\")\n\n\n\n\nRows: 825\nColumns: 5\n$ nb       &lt;nb&gt; 3, &lt;4, 5, 7&gt;, &lt;1, 6, 10&gt;, &lt;2, 6, 7, 11&gt;, &lt;2, 7, 8, 12&gt;, &lt;3, 4,…\n$ wt       &lt;list&gt; 1, &lt;0.3333333, 0.3333333, 0.3333333&gt;, &lt;0.3333333, 0.3333333,…\n$ HEX_ID   &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009…\n$ TRIPS    &lt;dbl&gt; 1272, 296, 798, 2703, 348, 370, 1118, 347, 16205, 5157, 621, …\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 30…\n\n\nComputing Local Moran’s I (AM)\n\n\nCode\nset.seed(1234)\nlisa_am &lt;- hexagon_data_moranI_am %&gt;%\n  mutate(TRIPS = replace_na(TRIPS, 0)) %&gt;% \n  mutate(local_moran = local_moran(\n    TRIPS, nb, wt, nsim = 99), .before = 1) %&gt;%\n  unnest(local_moran)\n\nwrite_rds(lisa_am, \"data/rds/lisa_am.rds\")\n\n\n\n\nRows: 825\nColumns: 17\n$ ii           &lt;dbl&gt; 0.5299649, 0.5321374, 0.5242975, 0.5229072, 0.5174744, 0.…\n$ eii          &lt;dbl&gt; -0.215376764, -0.082790718, -0.004274458, -0.043576531, 0…\n$ var_ii       &lt;dbl&gt; 1.14111083, 0.20672671, 0.15910233, 0.16919269, 0.1300833…\n$ z_ii         &lt;dbl&gt; 0.6977366, 1.3524651, 1.3251525, 1.3771988, 1.4198929, 1.…\n$ p_ii         &lt;dbl&gt; 0.48534193, 0.17622658, 0.18512056, 0.16845078, 0.1556388…\n$ p_ii_sim     &lt;dbl&gt; 0.22, 0.02, 0.04, 0.02, 0.02, 0.02, 0.02, 0.02, 0.08, 0.0…\n$ p_folded_sim &lt;dbl&gt; 0.11, 0.01, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.04, 0.0…\n$ skewness     &lt;dbl&gt; -2.8520993, -1.0742867, -1.4064814, -1.2958107, -1.697815…\n$ kurtosis     &lt;dbl&gt; 10.10015533, 1.09127285, 2.53855288, 2.59410944, 4.698722…\n$ mean         &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ median       &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ pysal        &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ nb           &lt;nb&gt; 3, &lt;4, 5, 7&gt;, &lt;1, 6, 10&gt;, &lt;2, 6, 7, 11&gt;, &lt;2, 7, 8, 12&gt;, &lt;3…\n$ wt           &lt;list&gt; 1, &lt;0.3333333, 0.3333333, 0.3333333&gt;, &lt;0.3333333, 0.3333…\n$ HEX_ID       &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H…\n$ TRIPS        &lt;dbl&gt; 1272, 296, 798, 2703, 348, 370, 1118, 347, 16205, 5157, 6…\n$ geometry     &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.53…\n\n\n\n\n** Join Moran’s I to trips data**\n\n\nCode\n# Add TRIPS data\nhexagon_data_moranI_pm &lt;- hexagon_contiguity_ft %&gt;%\n  left_join(PM_trips_hex %&gt;% \n              select(HEX_ID, TRIPS), \n            by = \"HEX_ID\")\n    \n# Recreate nb and wt\nhexagon_data_moranI_pm &lt;- hexagon_data_moranI_pm %&gt;%\n  mutate(\n    nb = st_contiguity(geometry),\n    wt = st_weights(nb, style = \"W\")\n  )\n\nwrite_rds(hexagon_data_moranI_pm, \"data/rds/hexagon_data_moranI_pm.rds\")\n\n\n\n\nRows: 825\nColumns: 5\n$ nb       &lt;nb&gt; 3, &lt;4, 5, 7&gt;, &lt;1, 6, 10&gt;, &lt;2, 6, 7, 11&gt;, &lt;2, 7, 8, 12&gt;, &lt;3, 4,…\n$ wt       &lt;list&gt; 1, &lt;0.3333333, 0.3333333, 0.3333333&gt;, &lt;0.3333333, 0.3333333,…\n$ HEX_ID   &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009…\n$ TRIPS    &lt;dbl&gt; 3391, 841, 3031, 8882, 679, 892, 3940, 869, 10226, 6262, 7871…\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 30…\n\n\nComputing Local Moran’s I (PM)\n\n\nCode\nset.seed(1234)\nlisa_pm &lt;- hexagon_data_moranI_pm %&gt;%\n  mutate(TRIPS = replace_na(TRIPS, 0)) %&gt;% \n  mutate(local_moran = local_moran(\n    TRIPS, nb, wt, nsim = 99), .before = 1) %&gt;%\n  unnest(local_moran)\n\nwrite_rds(lisa_pm, \"data/rds/lisa_pm.rds\")\n\n\n\n\nRows: 825\nColumns: 17\n$ ii           &lt;dbl&gt; 0.3361974, 0.3401654, 0.3357264, 0.3140770, 0.3340480, 0.…\n$ eii          &lt;dbl&gt; -0.183443258, -0.031256341, -0.005321480, -0.024240887, -…\n$ var_ii       &lt;dbl&gt; 1.21899462, 0.11839576, 0.06293806, 0.08939094, 0.1209714…\n$ z_ii         &lt;dbl&gt; 0.4706546, 1.0794417, 1.3594355, 1.1315617, 0.9913971, 1.…\n$ p_ii         &lt;dbl&gt; 0.6378874, 0.2803908, 0.1740086, 0.2578187, 0.3214917, 0.…\n$ p_ii_sim     &lt;dbl&gt; 0.22, 0.02, 0.02, 0.02, 0.02, 0.04, 0.02, 0.04, 0.08, 0.0…\n$ p_folded_sim &lt;dbl&gt; 0.11, 0.01, 0.01, 0.01, 0.01, 0.02, 0.01, 0.02, 0.04, 0.0…\n$ skewness     &lt;dbl&gt; -4.237935, -2.279373, -1.776381, -2.609355, -2.867808, -1…\n$ kurtosis     &lt;dbl&gt; 18.907161, 6.572720, 5.182965, 9.499651, 9.487851, 5.3606…\n$ mean         &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ median       &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ pysal        &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ nb           &lt;nb&gt; 3, &lt;4, 5, 7&gt;, &lt;1, 6, 10&gt;, &lt;2, 6, 7, 11&gt;, &lt;2, 7, 8, 12&gt;, &lt;3…\n$ wt           &lt;list&gt; 1, &lt;0.3333333, 0.3333333, 0.3333333&gt;, &lt;0.3333333, 0.3333…\n$ HEX_ID       &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H…\n$ TRIPS        &lt;dbl&gt; 3391, 841, 3031, 8882, 679, 892, 3940, 869, 10226, 6262, …\n$ geometry     &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.53…\n\n\n\n\n** Join Moran’s I to trips data**\n\n\nCode\n# Add TRIPS data\nhexagon_data_moranI_wkd &lt;- hexagon_contiguity_ft %&gt;%\n  left_join(weekend_trips_hex %&gt;% \n              select(HEX_ID, TRIPS), \n            by = \"HEX_ID\")\n    \n# Recreate nb and wt\nhexagon_data_moranI_wkd &lt;- hexagon_data_moranI_wkd %&gt;%\n  mutate(\n    nb = st_contiguity(geometry),\n    wt = st_weights(nb, style = \"W\")\n  )\n\nwrite_rds(hexagon_data_moranI_wkd, \"data/rds/hexagon_data_moranI_wkd.rds\")\n\n\n\n\nRows: 825\nColumns: 5\n$ nb       &lt;nb&gt; 3, &lt;4, 5, 7&gt;, &lt;1, 6, 10&gt;, &lt;2, 6, 7, 11&gt;, &lt;2, 7, 8, 12&gt;, &lt;3, 4,…\n$ wt       &lt;list&gt; 1, &lt;0.3333333, 0.3333333, 0.3333333&gt;, &lt;0.3333333, 0.3333333,…\n$ HEX_ID   &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009…\n$ TRIPS    &lt;dbl&gt; 3318, 437, 1417, 4262, 506, 426, 1663, 470, 22741, 7055, 2457…\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 30…\n\n\nComputing Local Moran’s I (weekend)\n\n\nCode\nset.seed(1234)\nlisa_wkd &lt;- hexagon_data_moranI_wkd %&gt;%\n  mutate(TRIPS = replace_na(TRIPS, 0)) %&gt;% \n  mutate(local_moran = local_moran(\n    TRIPS, nb, wt, nsim = 99), .before = 1) %&gt;%\n  unnest(local_moran)\n\nwrite_rds(lisa_wkd, \"data/rds/lisa_wkd.rds\")\n\n\n\n\nRows: 825\nColumns: 17\n$ ii           &lt;dbl&gt; 0.3690891, 0.3818585, 0.3674109, 0.3644394, 0.3633900, 0.…\n$ eii          &lt;dbl&gt; -0.163958117, -0.055095533, -0.012479809, -0.026938411, -…\n$ var_ii       &lt;dbl&gt; 0.98206461, 0.13276306, 0.09692804, 0.10241678, 0.1168349…\n$ z_ii         &lt;dbl&gt; 0.5378927, 1.1992153, 1.2202081, 1.2229556, 1.0717492, 1.…\n$ p_ii         &lt;dbl&gt; 0.59065115, 0.23044425, 0.22238599, 0.22134648, 0.2838327…\n$ p_ii_sim     &lt;dbl&gt; 0.22, 0.02, 0.02, 0.04, 0.02, 0.04, 0.02, 0.04, 0.10, 0.0…\n$ p_folded_sim &lt;dbl&gt; 0.11, 0.01, 0.01, 0.02, 0.01, 0.02, 0.01, 0.02, 0.05, 0.0…\n$ skewness     &lt;dbl&gt; -3.8494185, -1.7485724, -1.2576222, -2.0313905, -2.300610…\n$ kurtosis     &lt;dbl&gt; 16.0913315, 3.5808065, 1.2232442, 5.6727845, 6.2538533, 1…\n$ mean         &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ median       &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ pysal        &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ nb           &lt;nb&gt; 3, &lt;4, 5, 7&gt;, &lt;1, 6, 10&gt;, &lt;2, 6, 7, 11&gt;, &lt;2, 7, 8, 12&gt;, &lt;3…\n$ wt           &lt;list&gt; 1, &lt;0.3333333, 0.3333333, 0.3333333&gt;, &lt;0.3333333, 0.3333…\n$ HEX_ID       &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H…\n$ TRIPS        &lt;dbl&gt; 3318, 437, 1417, 4262, 506, 426, 1663, 470, 22741, 7055, …\n$ geometry     &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.53…\n\n\n\n\n\n\n\n4.2.3 Mapping Local Moran’s I\nBelow we will plot Local Moran’s I and p-value for each hexagon.\n\nAMPMWeekend/PH\n\n\n\n\nCode\n#tmap_mode(\"view\")\n\n# AM Local Moran's I\nlmsa_am &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#FAF3F3\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\n  \ntm_shape(lisa_am) +\n  tm_polygons(fill = \"ii\",\n              fill.scale = tm_scale_intervals(\n              style = \"pretty\",\n              n = 5,\n              values = \"-brewer.RdBu\"), \n              fill_alpha = 0.7) + \n  tm_borders(fill_alpha = 0.5) +\n  tm_title(\"LISA Map - Local Moran's I AM Weeday Trips\") +\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),\n#    bg.color = \"#FAF3F3\",\n    outer.margins = c(0.01, 0.01, 0.01, 0.01),    ) \n\n#Local Moran's I p-value\nlmsa_am_p &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#FAF3F3\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\n\ntm_shape(lisa_am) +\n  tm_polygons(fill = \"p_ii\", \n              fill.scale = tm_scale_intervals(\n              breaks = c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n              values = \"-brewer.Reds\"),\n              fill_alpha = 0.7) + \n  tm_borders(fill_alpha = 0.5) +\n  tm_title(\"LISA Map - p-values of Local Moran's I AM Weeday Trips\") +\n  tm_layout(legend.position = c(\"right\", \"bottom\"),\n#            bg.color = \"#D0DDD0\",\n            outer.margins = c(0.01, 0.01, 0.01, 0.01),) \n\nlmsa_am\n\n\n\n\n\n\n\n\n\nCode\nlmsa_am_p\n\n\n\n\n\n\n\n\n\nCode\n#  tm_view(set_zoom_limits = c(11,14))\n\n# tmap_arrange(lmsa_am, lmsa_am_p, \n#              asp=1, ncol=1,\n#              sync = TRUE)\n\n\nObservations\n\nStatistically significant High-High clusters (high ii + p-value &lt; 0.05) are identified at Jurong West Central area, Tampines, Sengkang Town Center, Clementi, and Ang Mo Kio Town Center, showing strong spatial autocorrelation where high ridership areas cluster together. Among these, the hexagon at Boon Lay station shows the highest positive local Moran’s I value, indicating the strongest spatial autocorrelation, followed by neighboring hexagons in Jurong West Central, Tampines, Sengkang Town Center, Clementi, and Ang Mo Kio Town Center.\nJoo Koon station area shows the lowest negative local Moran’s I value but with high p-value (p &gt; 0.05), indicating this pattern is not statistically significant and could be due to random variation rather than a genuine spatial outlier. While the hexagon differs from its low-ridership neighbors (potentially due to factories generating some boarding demand for workers traveling to nearby employment areas), this pattern should not be considered a reliable spatial anomaly.\nNo statistically significant Low-High or High-Low outliers were identified in AM peak at the p &lt; 0.05 threshold, suggesting spatial patterns are predominantly characterized by clustering (High-High and Low-Low) rather than spatial anomalies during morning hours.\n\n\n\n\n\nCode\n#tmap_mode(\"view\")\n\n# AM Local Moran's I\nlmsa_pm &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#FAF3F3\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\n  \ntm_shape(lisa_pm) +\n  tm_polygons(fill = \"ii\",\n              fill.scale = tm_scale_intervals(\n              style = \"pretty\",\n              n = 5,\n              values = \"-brewer.RdBu\"), \n              fill_alpha = 0.7) + \n  tm_borders(fill_alpha = 0.5) +\n  tm_title(\"LISA Map - Local Moran's I PM Weeday Trips\") +\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\")) \n\n\n#Local Moran's I p-value\nlmsa_pm_p &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#FAF3F3\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\n\ntm_shape(lisa_pm) +\n  tm_polygons(fill = \"p_ii\", \n              fill.scale = tm_scale_intervals(\n              breaks = c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n              values = \"-brewer.Reds\"),\n              fill_alpha = 0.6) + \n  tm_borders(fill_alpha = 0.5) +\n  tm_title(\"LISA Map - p-values of Local Moran's I PM Weeday Trips\") +\n  tm_layout(legend.position = c(\"right\", \"bottom\")) \n  \n\nlmsa_pm\n\n\n\n\n\n\n\n\n\nCode\nlmsa_pm_p\n\n\n\n\n\n\n\n\n\nCode\n# tmap_arrange(lmsa_pm, lmsa_pm_p, \n#              asp=1, ncol=1,\n#              sync = TRUE)\n# \n# tmap_mode(\"plot\")\n\n\nObservations\n\nStatistically significant High-High clusters (high ii + p-value &lt; 0.05) are identified at Bedok, Tampines, Sengkang Town Center, Bras Basah, Ang Mo Kio, and Jurong West Central, showing strong spatial autocorrelation where high ridership areas cluster together. Among these, Tampines and Sengkang Town Center show the highest positive local Moran’s I values, indicating the strongest spatial autocorrelation, followed by Bras Basah, Jurong West Central, Bedok, and Ang Mo Kio.\nStatistically significant Low-High outliers (negative ii + p-value &lt; 0.05) appear at Choa Chu Kang, hexagons near Woodlands checkpoint, and Bukit Panjang areas, indicating these are significant spatial anomalies with low ridership surrounded by high-ridership neighbors. These outliers suggest service gaps, barriers, or areas where residents use alternative transportation modes despite proximity to high-demand zones.\nChoa Chu Kang shows the lowest negative local Moran’s I value among Low-High outliers, indicating it differs most distinctly from its higher-ridership neighbors..\n\n\n\n\n\nCode\n#tmap_mode(\"view\")\n\n# AM Local Moran's I\nlmsa_wkd &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#FAF3F3\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\n  \ntm_shape(lisa_wkd) +\n  tm_polygons(fill = \"ii\",\n              fill.scale = tm_scale_intervals(\n              style = \"pretty\",\n              n = 5,\n              values = \"-brewer.RdBu\"), \n              fill_alpha = 0.7) + \n  tm_borders(fill_alpha = 0.5) +\n  tm_title(\"LISA Map - Local Moran's I Weekend Trips\") +\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\")) \n\n#Local Moran's I p-value\nlmsa_wkd_p &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#FAF3F3\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\n\ntm_shape(lisa_wkd) +\n  tm_polygons(fill = \"p_ii\", \n              fill.scale = tm_scale_intervals(\n              breaks = c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n              values = \"-brewer.Reds\"),\n              fill_alpha = 0.7) + \n  tm_borders(fill_alpha = 0.5) +\n  tm_title(\"LISA Map - p-values of Local Moran's I Weekend Trips\") +\n  tm_layout(legend.position = c(\"right\", \"bottom\"))\n\nlmsa_wkd\n\n\n\n\n\n\n\n\n\nCode\nlmsa_wkd_p\n\n\n\n\n\n\n\n\n\nCode\n# tmap_arrange(lmsa_wkd, lmsa_wkd_p, \n#              asp=1, ncol=1,\n#              sync = TRUE)\n\n#tmap_mode(\"plot\")\n\n\nObservations\n\nStatistically significant High-High clusters (high ii + p-value &lt; 0.05) are identified at Bedok, Tampines, Sengkang Town Center, Bras Basah, Ang Mo Kio, and Jurong West Central, showing strong spatial autocorrelation where high ridership areas cluster together. Bras Basah & Bugis areas demonstrate especially strong clustering. Among these, Bedok and Tampines show the highest positive local Moran’s I values, indicating the strongest spatial autocorrelation, followed by Sengkang Town Center, Bras Basah, and Ang Mo Kio, with Jurong West Central showing moderate but still significant clustering.\nStatistically significant Low-High outliers (negative ii + p-value &lt; 0.05) appear at hexagons near Woodlands checkpoint, indicating these are significant spatial anomalies with low ridership surrounded by high-ridership neighbors. These outliers likely have lower ridership despite proximity to Woodlands checkpoint’s higher-ridership zones, suggesting service gaps or barriers.\nChoa Chu Kang and Woodlands Checkpoint areas show the lowest negative local Moran’s I values, indicating they differ from their neighbors with statistical significance.\n\n\n\n\n\n\n\n4.3 Visualising LISA Maps\n\n4.3.1 Plotting Moran Scatterplot\nWe leverage the Moran Scatterplot to visualise the relationship between the trip values and the average of its neighboring locations to identify spatial autocorrelation.\nCalculate spatial lag of Passenger Trips against its spatial lag version\n\nAMPMWeekend\n\n\n\nlisa_am_lag &lt;- lisa_am %&gt;%\n  mutate(lag_AM_TRIPS = st_lag(\n    TRIPS, nb, wt\n  ), .before = 1) %&gt;%\n  unnest(lag_AM_TRIPS)\n\nwrite_rds(lisa_am_lag, \"data/rds/lisa_am_lag.rds\")\n\n\n\nRows: 825\nColumns: 18\n$ lag_AM_TRIPS &lt;dbl&gt; 798.000, 1389.667, 2266.333, 601.250, 3898.500, 2319.750,…\n$ ii           &lt;dbl&gt; 0.5299649, 0.5321374, 0.5242975, 0.5229072, 0.5174744, 0.…\n$ eii          &lt;dbl&gt; -0.215376764, -0.082790718, -0.004274458, -0.043576531, 0…\n$ var_ii       &lt;dbl&gt; 1.14111083, 0.20672671, 0.15910233, 0.16919269, 0.1300833…\n$ z_ii         &lt;dbl&gt; 0.6977366, 1.3524651, 1.3251525, 1.3771988, 1.4198929, 1.…\n$ p_ii         &lt;dbl&gt; 0.48534193, 0.17622658, 0.18512056, 0.16845078, 0.1556388…\n$ p_ii_sim     &lt;dbl&gt; 0.22, 0.02, 0.04, 0.02, 0.02, 0.02, 0.02, 0.02, 0.08, 0.0…\n$ p_folded_sim &lt;dbl&gt; 0.11, 0.01, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.04, 0.0…\n$ skewness     &lt;dbl&gt; -2.8520993, -1.0742867, -1.4064814, -1.2958107, -1.697815…\n$ kurtosis     &lt;dbl&gt; 10.10015533, 1.09127285, 2.53855288, 2.59410944, 4.698722…\n$ mean         &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ median       &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ pysal        &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ nb           &lt;nb&gt; 3, &lt;4, 5, 7&gt;, &lt;1, 6, 10&gt;, &lt;2, 6, 7, 11&gt;, &lt;2, 7, 8, 12&gt;, &lt;3…\n$ wt           &lt;list&gt; 1, &lt;0.3333333, 0.3333333, 0.3333333&gt;, &lt;0.3333333, 0.3333…\n$ HEX_ID       &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H…\n$ TRIPS        &lt;dbl&gt; 1272, 296, 798, 2703, 348, 370, 1118, 347, 16205, 5157, 6…\n$ geometry     &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.53…\n\n\n\n\n\nlisa_pm_lag &lt;- lisa_pm %&gt;%\n  mutate(lag_PM_TRIPS = st_lag(\n    TRIPS, nb, wt\n  ), .before = 1) %&gt;%\n  unnest(lag_PM_TRIPS)\n\nwrite_rds(lisa_pm_lag, \"data/rds/lisa_pm_lag.rds\")\n\n\n\nRows: 825\nColumns: 18\n$ lag_PM_TRIPS &lt;dbl&gt; 3031.000, 4500.333, 3515.000, 3386.000, 6224.250, 6511.50…\n$ ii           &lt;dbl&gt; 0.3361974, 0.3401654, 0.3357264, 0.3140770, 0.3340480, 0.…\n$ eii          &lt;dbl&gt; -0.183443258, -0.031256341, -0.005321480, -0.024240887, -…\n$ var_ii       &lt;dbl&gt; 1.21899462, 0.11839576, 0.06293806, 0.08939094, 0.1209714…\n$ z_ii         &lt;dbl&gt; 0.4706546, 1.0794417, 1.3594355, 1.1315617, 0.9913971, 1.…\n$ p_ii         &lt;dbl&gt; 0.6378874, 0.2803908, 0.1740086, 0.2578187, 0.3214917, 0.…\n$ p_ii_sim     &lt;dbl&gt; 0.22, 0.02, 0.02, 0.02, 0.02, 0.04, 0.02, 0.04, 0.08, 0.0…\n$ p_folded_sim &lt;dbl&gt; 0.11, 0.01, 0.01, 0.01, 0.01, 0.02, 0.01, 0.02, 0.04, 0.0…\n$ skewness     &lt;dbl&gt; -4.237935, -2.279373, -1.776381, -2.609355, -2.867808, -1…\n$ kurtosis     &lt;dbl&gt; 18.907161, 6.572720, 5.182965, 9.499651, 9.487851, 5.3606…\n$ mean         &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ median       &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ pysal        &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low…\n$ nb           &lt;nb&gt; 3, &lt;4, 5, 7&gt;, &lt;1, 6, 10&gt;, &lt;2, 6, 7, 11&gt;, &lt;2, 7, 8, 12&gt;, &lt;3…\n$ wt           &lt;list&gt; 1, &lt;0.3333333, 0.3333333, 0.3333333&gt;, &lt;0.3333333, 0.3333…\n$ HEX_ID       &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H…\n$ TRIPS        &lt;dbl&gt; 3391, 841, 3031, 8882, 679, 892, 3940, 869, 10226, 6262, …\n$ geometry     &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.53…\n\n\n\n\n\nlisa_wkd_lag &lt;- lisa_wkd %&gt;%\n  mutate(lag_WKD_TRIPS = st_lag(\n    TRIPS, nb, wt\n  ), .before = 1) %&gt;%\n  unnest(lag_WKD_TRIPS)\n\nwrite_rds(lisa_wkd_lag, \"data/rds/lisa_wkd_lag.rds\")\n\n\n\nRows: 825\nColumns: 18\n$ lag_WKD_TRIPS &lt;dbl&gt; 1417.000, 2143.667, 3599.667, 1245.750, 5132.500, 3797.7…\n$ ii            &lt;dbl&gt; 0.3690891, 0.3818585, 0.3674109, 0.3644394, 0.3633900, 0…\n$ eii           &lt;dbl&gt; -0.163958117, -0.055095533, -0.012479809, -0.026938411, …\n$ var_ii        &lt;dbl&gt; 0.98206461, 0.13276306, 0.09692804, 0.10241678, 0.116834…\n$ z_ii          &lt;dbl&gt; 0.5378927, 1.1992153, 1.2202081, 1.2229556, 1.0717492, 1…\n$ p_ii          &lt;dbl&gt; 0.59065115, 0.23044425, 0.22238599, 0.22134648, 0.283832…\n$ p_ii_sim      &lt;dbl&gt; 0.22, 0.02, 0.02, 0.04, 0.02, 0.04, 0.02, 0.04, 0.10, 0.…\n$ p_folded_sim  &lt;dbl&gt; 0.11, 0.01, 0.01, 0.02, 0.01, 0.02, 0.01, 0.02, 0.05, 0.…\n$ skewness      &lt;dbl&gt; -3.8494185, -1.7485724, -1.2576222, -2.0313905, -2.30061…\n$ kurtosis      &lt;dbl&gt; 16.0913315, 3.5808065, 1.2232442, 5.6727845, 6.2538533, …\n$ mean          &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Lo…\n$ median        &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Lo…\n$ pysal         &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Lo…\n$ nb            &lt;nb&gt; 3, &lt;4, 5, 7&gt;, &lt;1, 6, 10&gt;, &lt;2, 6, 7, 11&gt;, &lt;2, 7, 8, 12&gt;, &lt;…\n$ wt            &lt;list&gt; 1, &lt;0.3333333, 0.3333333, 0.3333333&gt;, &lt;0.3333333, 0.333…\n$ HEX_ID        &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, …\n$ TRIPS         &lt;dbl&gt; 3318, 437, 1417, 4262, 506, 426, 1663, 470, 22741, 7055,…\n$ geometry      &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.5…\n\n\n\n\n\nMoran Scatterplot with LISA Quadrands\n\nAMPMWeekend\n\n\n\n\nCode\np1 &lt;- ggplot(data = lisa_am_lag, \n       aes(x = TRIPS, \n           y = lag_AM_TRIPS, \n           color = mean,\n           text = paste(\"HEX_ID:\", HEX_ID,           \n                       \"\\nAM Trips:\", TRIPS,\n                       \"\\nSpatial Lag:\", round(lag_AM_TRIPS, 2),\n                       \"\\nCluster:\", mean))) +\n  geom_point(size = 0.7) +\n  geom_smooth(method = \"lm\", \n              se = FALSE, \n              color = \"black\") +\n  geom_hline(yintercept=mean(lisa_am_lag$lag_AM_TRIPS), lty=2) + \n  geom_vline(xintercept=mean(lisa_am_lag$TRIPS), lty=2) +\n  scale_x_continuous(\n    labels = comma,\n    breaks = pretty_breaks(n = 6))+ \n  scale_y_continuous(\n    labels = comma,\n    breaks = pretty_breaks(n = 6))+ \n  scale_color_manual(\n    values = c(\"High-High\" = \"#FF0B55\", \n               \"Low-Low\" = \"#1572A1\",\n               \"Low-High\" = \"#93BFCF\", \n               \"High-Low\" = \"#FFB4C2\")) +\n  coord_cartesian(xlim = c(0, 1800000), ylim = c(0, 450000)) + \n  labs(x = \"TRIPS\",\n       y = \"Spatial Lag of AM_TRIPS\",\n       title = \"Moran Scatterplot with LISA Quadrants - AM Weekdays\") +\n  theme(plot.background = element_rect(\"#D0DDD0\"))\n\nggplotly(p1, tooltip = \"text\")\n\n\n\n\n\n\n\n\n\n\nCode\np2 &lt;- ggplot(data = lisa_pm_lag, \n       aes(x = TRIPS, \n           y = lag_PM_TRIPS, \n           color = mean,\n           text = paste(\"HEX_ID:\", HEX_ID,           \n                       \"\\nAM Trips:\", TRIPS,\n                       \"\\nSpatial Lag:\", round(lag_PM_TRIPS, 2),\n                       \"\\nCluster:\", mean))) +\n  geom_point(size = 0.7) +\n  geom_smooth(method = \"lm\", \n              se = FALSE, \n              color = \"black\") +\n  geom_hline(yintercept=mean(lisa_pm_lag$lag_PM_TRIPS), lty=2) + \n  geom_vline(xintercept=mean(lisa_pm_lag$TRIPS), lty=2) +\n  scale_x_continuous(\n    labels = comma,\n    breaks = pretty_breaks(n = 6))+ \n  scale_y_continuous(\n    labels = comma,\n    breaks = pretty_breaks(n = 6))+ \n  scale_color_manual(\n    values = c(\"High-High\" = \"#FF0B55\", \n               \"Low-Low\" = \"#1572A1\",\n               \"Low-High\" = \"#93BFCF\", \n               \"High-Low\" = \"#FFB4C2\")) +\n  coord_cartesian(xlim = c(0, 1800000), ylim = c(0, 450000)) + \n  labs(x = \"TRIPS\",\n       y = \"Spatial Lag of PM_TRIPS\",\n       title = \"Moran Scatterplot with LISA Quadrants - PM Weekdays\") +\n  theme(plot.background = element_rect(\"#D0DDD0\"))\n\nggplotly(p2, tooltip = \"text\")\n\n\n\n\n\n\n\n\n\n\nCode\np3 &lt;- ggplot(data = lisa_wkd_lag, \n       aes(x = TRIPS, \n           y = lag_WKD_TRIPS, \n           color = mean,\n           text = paste(\"HEX_ID:\", HEX_ID,           \n                       \"\\nAM Trips:\", TRIPS,\n                       \"\\nSpatial Lag:\", round(lag_WKD_TRIPS, 2),\n                       \"\\nCluster:\", mean))) +\n  geom_point(size = 0.7) +\n  geom_smooth(method = \"lm\", \n              se = FALSE, \n              color = \"black\") +\n  geom_hline(yintercept=mean(lisa_wkd_lag$lag_WKD_TRIPS), lty=2) + \n  geom_vline(xintercept=mean(lisa_wkd_lag$TRIPS), lty=2) +\n  scale_x_continuous(\n    labels = comma,\n    breaks = pretty_breaks(n = 6))+ \n  scale_y_continuous(\n    labels = comma,\n    breaks = pretty_breaks(n = 6))+ \n  scale_color_manual(\n    values = c(\"High-High\" = \"#FF0B55\", \n               \"Low-Low\" = \"#1572A1\",\n               \"Low-High\" = \"#93BFCF\", \n               \"High-Low\" = \"#FFB4C2\")) +\n  coord_cartesian(xlim = c(0, 1800000), ylim = c(0, 450000)) + \n  labs(x = \"TRIPS\",\n       y = \"Spatial Lag of PM_TRIPS\",\n       title = \"Moran Scatterplot with LISA Quadrants - Weekend\") +\n  theme(plot.background = element_rect(\"#D0DDD0\"))\n\nggplotly(p3, tooltip = \"text\")\n\n\n\n\n\n\n\n\n\n\n\nObservation\n\n\nThe Moran Scatterplot with LISA Quadrands show similar patterns for all 3 periods.\n\n\n\n\n4.3.2 Visualising LISA Map\nWe will use the mean where LISA classes are stored in to derive a new field called LISA-cluster.\nPrepare data for visualisation\n\nAMPMWeekend\n\n\n\n\nCode\nlisa_am_map &lt;- lisa_am %&gt;%\n  mutate(\n    LISA_cluster_am = ifelse(\n      p_ii &lt; 0.05,\n      as.character(mean), \n      \"Insignificant\"),\n    LISA_cluster_am = factor(\n      LISA_cluster_am,\n      levels = c(\"Insignificant\", \"Low-Low\", \"Low-High\", \"High-Low\", \"High-High\")\n    )\n  )\n\nwrite_rds(lisa_am_map, \"data/rds/lisa_am_map.rds\")\n\n\n\n\nRows: 825\nColumns: 18\n$ ii              &lt;dbl&gt; 0.5299649, 0.5321374, 0.5242975, 0.5229072, 0.5174744,…\n$ eii             &lt;dbl&gt; -0.215376764, -0.082790718, -0.004274458, -0.043576531…\n$ var_ii          &lt;dbl&gt; 1.14111083, 0.20672671, 0.15910233, 0.16919269, 0.1300…\n$ z_ii            &lt;dbl&gt; 0.6977366, 1.3524651, 1.3251525, 1.3771988, 1.4198929,…\n$ p_ii            &lt;dbl&gt; 0.48534193, 0.17622658, 0.18512056, 0.16845078, 0.1556…\n$ p_ii_sim        &lt;dbl&gt; 0.22, 0.02, 0.04, 0.02, 0.02, 0.02, 0.02, 0.02, 0.08, …\n$ p_folded_sim    &lt;dbl&gt; 0.11, 0.01, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.04, …\n$ skewness        &lt;dbl&gt; -2.8520993, -1.0742867, -1.4064814, -1.2958107, -1.697…\n$ kurtosis        &lt;dbl&gt; 10.10015533, 1.09127285, 2.53855288, 2.59410944, 4.698…\n$ mean            &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, …\n$ median          &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, …\n$ pysal           &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, …\n$ nb              &lt;nb&gt; 3, &lt;4, 5, 7&gt;, &lt;1, 6, 10&gt;, &lt;2, 6, 7, 11&gt;, &lt;2, 7, 8, 12&gt;,…\n$ wt              &lt;list&gt; 1, &lt;0.3333333, 0.3333333, 0.3333333&gt;, &lt;0.3333333, 0.3…\n$ HEX_ID          &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008…\n$ TRIPS           &lt;dbl&gt; 1272, 296, 798, 2703, 348, 370, 1118, 347, 16205, 5157…\n$ geometry        &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167…\n$ LISA_cluster_am &lt;fct&gt; Insignificant, Insignificant, Insignificant, Insignifi…\n\n\n\n\n\n\nCode\nlisa_pm_map &lt;- lisa_pm %&gt;%\n  mutate(\n    LISA_cluster_pm = ifelse(\n      p_ii &lt; 0.05,\n      as.character(mean), \n      \"Insignificant\"),\n    LISA_cluster_pm = factor(\n      LISA_cluster_pm,\n      levels = c(\"Insignificant\", \"Low-Low\", \"Low-High\", \"High-Low\", \"High-High\")\n    )\n  )\n\nwrite_rds(lisa_pm_map, \"data/rds/lisa_pm_map.rds\")\n\n\n\n\nRows: 825\nColumns: 18\n$ ii              &lt;dbl&gt; 0.5299649, 0.5321374, 0.5242975, 0.5229072, 0.5174744,…\n$ eii             &lt;dbl&gt; -0.215376764, -0.082790718, -0.004274458, -0.043576531…\n$ var_ii          &lt;dbl&gt; 1.14111083, 0.20672671, 0.15910233, 0.16919269, 0.1300…\n$ z_ii            &lt;dbl&gt; 0.6977366, 1.3524651, 1.3251525, 1.3771988, 1.4198929,…\n$ p_ii            &lt;dbl&gt; 0.48534193, 0.17622658, 0.18512056, 0.16845078, 0.1556…\n$ p_ii_sim        &lt;dbl&gt; 0.22, 0.02, 0.04, 0.02, 0.02, 0.02, 0.02, 0.02, 0.08, …\n$ p_folded_sim    &lt;dbl&gt; 0.11, 0.01, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.04, …\n$ skewness        &lt;dbl&gt; -2.8520993, -1.0742867, -1.4064814, -1.2958107, -1.697…\n$ kurtosis        &lt;dbl&gt; 10.10015533, 1.09127285, 2.53855288, 2.59410944, 4.698…\n$ mean            &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, …\n$ median          &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, …\n$ pysal           &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, …\n$ nb              &lt;nb&gt; 3, &lt;4, 5, 7&gt;, &lt;1, 6, 10&gt;, &lt;2, 6, 7, 11&gt;, &lt;2, 7, 8, 12&gt;,…\n$ wt              &lt;list&gt; 1, &lt;0.3333333, 0.3333333, 0.3333333&gt;, &lt;0.3333333, 0.3…\n$ HEX_ID          &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008…\n$ TRIPS           &lt;dbl&gt; 1272, 296, 798, 2703, 348, 370, 1118, 347, 16205, 5157…\n$ geometry        &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167…\n$ LISA_cluster_am &lt;fct&gt; Insignificant, Insignificant, Insignificant, Insignifi…\n\n\n\n\n\n\nCode\nlisa_wkd_map &lt;- lisa_wkd %&gt;%\n  mutate(\n    LISA_cluster_wkd = ifelse(\n      p_ii &lt; 0.05,\n      as.character(mean), \n      \"Insignificant\"),\n    LISA_cluster_wkdm = factor(\n      LISA_cluster_wkd,\n      levels = c(\"Insignificant\", \"Low-Low\", \"Low-High\", \"High-Low\", \"High-High\")\n    )\n  )\n\nwrite_rds(lisa_wkd_map, \"data/rds/lisa_wkd_map.rds\")\n\n\n\n\nRows: 825\nColumns: 19\n$ ii                &lt;dbl&gt; 0.3690891, 0.3818585, 0.3674109, 0.3644394, 0.363390…\n$ eii               &lt;dbl&gt; -0.163958117, -0.055095533, -0.012479809, -0.0269384…\n$ var_ii            &lt;dbl&gt; 0.98206461, 0.13276306, 0.09692804, 0.10241678, 0.11…\n$ z_ii              &lt;dbl&gt; 0.5378927, 1.1992153, 1.2202081, 1.2229556, 1.071749…\n$ p_ii              &lt;dbl&gt; 0.59065115, 0.23044425, 0.22238599, 0.22134648, 0.28…\n$ p_ii_sim          &lt;dbl&gt; 0.22, 0.02, 0.02, 0.04, 0.02, 0.04, 0.02, 0.04, 0.10…\n$ p_folded_sim      &lt;dbl&gt; 0.11, 0.01, 0.01, 0.02, 0.01, 0.02, 0.01, 0.02, 0.05…\n$ skewness          &lt;dbl&gt; -3.8494185, -1.7485724, -1.2576222, -2.0313905, -2.3…\n$ kurtosis          &lt;dbl&gt; 16.0913315, 3.5808065, 1.2232442, 5.6727845, 6.25385…\n$ mean              &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low…\n$ median            &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low…\n$ pysal             &lt;fct&gt; Low-Low, Low-Low, Low-Low, Low-Low, Low-Low, Low-Low…\n$ nb                &lt;nb&gt; 3, &lt;4, 5, 7&gt;, &lt;1, 6, 10&gt;, &lt;2, 6, 7, 11&gt;, &lt;2, 7, 8, 12…\n$ wt                &lt;list&gt; 1, &lt;0.3333333, 0.3333333, 0.3333333&gt;, &lt;0.3333333, 0…\n$ HEX_ID            &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H00…\n$ TRIPS             &lt;dbl&gt; 3318, 437, 1417, 4262, 506, 426, 1663, 470, 22741, 7…\n$ geometry          &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((41…\n$ LISA_cluster_wkd  &lt;chr&gt; \"Insignificant\", \"Insignificant\", \"Insignificant\", \"…\n$ LISA_cluster_wkdm &lt;fct&gt; Insignificant, Insignificant, Insignificant, Insigni…\n\n\n\n\n\nPlot the LISA map below\n\nAMPMWeekend/PH\n\n\n\n\nCode\ntmap_mode(\"view\")\n# Local Moran's I Clusters\nlisa_maps_am &lt;- \n  tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", fill_alpha = 0.6) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\n  tm_shape(lisa_am_map) + \n  tm_polygons(\n    fill = \"LISA_cluster_am\",\n    fill_alpha = 0.5,\n    fill.scale = tm_scale_categorical(\n      values = c(\n        \"#EEEDEB\",      # Insignificant\n        \"#1B3C53\",        # Low-Low\n        \"#1572A1\",   # Low-High\n        \"#D885A3\",        # High-Low\n        \"#842A3B\")),          # High-High\n    fill.legend = tm_legend(\n      title = \"LISA Cluster\",\n      position = tm_pos_in(\"right\", \"bottom\"),\n      lwd = 0.1),\n  ) +\n  tm_borders(col = \"grey20\", lwd = 0.1) +\n  tm_title(\"LISA - Local Moran's I Clusters - AM Weekdays (p &lt; 0.05)\") +\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),\n    bg.color = \"#D0DDD0\") +\n   tm_view(set_zoom_limits = c(11,16)) \n\n# Local Moran's I\nlmsa_am &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\ntm_shape(lisa_am_map) +\n  tm_polygons(fill = \"ii\",\n              fill.scale = tm_scale_intervals(\n                style = \"pretty\",\n                n = 5,\n                values = \"-brewer.RdBu\"), \n                fill_alpha = 0.7,\n              fill.legend = tm_legend(\n                title = \"Local Moran's I\"),\n              lwd = 0.1) + \n  \n  tm_borders(col = \"grey20\", lwd = 0.1) +\n  tm_title(\"Local Moran's I AM Weekday Trips\") +\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),\n    bg.color = \"#D0DDD0\") +\n   tm_view(set_zoom_limits = c(11,16)) \n\ntmap_arrange(lisa_maps_am, lmsa_am, \n             asp=1, ncol=1,\n             sync = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\nObservation\n\nThe High-High clusters form extensive zones around Woodlands, Yishun, Bukit Panjang, Sengkang & Hougang, Clementi & West Coast, Jurong West, Ang Mo Kio, Bedok, and Tampines, spanning multiple connected hexagons.\nLow-Low clusters are mainly located in the west like Joo Koon, with isolated hexagons. Some Low-High are attached to the High-High clusters like Toa payoh, Bendemeer, Bedok, Upper Thomson, Sengkang, Tampines, Punggol, Yishun, Clementi and Woodlands. Some possible reasons could be transit coverage gaps (like poor bus connectivity), land use differences (maybe non-residential land uses like parks), and last-mile connectivity issues (maybe people use different modes of transportation).\n\n\n\n\n\nCode\ntmap_mode(\"view\")\n# Local Moran's I Clusters\nlisa_map_pm &lt;- \n  tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", fill_alpha = 0.6) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\n  tm_shape(lisa_pm_map) + \n  tm_polygons(\n    fill = \"LISA_cluster_pm\",\n    fill_alpha = 0.5,\n    fill.scale = tm_scale_categorical(\n      values = c(\n        \"Insignificant\" = \"#EEEDEB\",\n        \"Low-Low\" = \"#1B3C53\",\n        \"Low-High\" = \"#1572A1\",\n        \"High-Low\" = \"#D885A3\",\n        \"High-High\" = \"#842A3B\")),          # High-High\n    fill.legend = tm_legend(\n      title = \"LISA Cluster\",\n      position = tm_pos_in(\"right\", \"bottom\"))\n  ) +\n  tm_borders() +\n  tm_title(\"LISA - Local Moran's I Clusters - PM Weekdays (p &lt; 0.05)\") +\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),\n    bg.color = \"#D0DDD0\") +\n   tm_view(set_zoom_limits = c(11,16)) \n\n# Local Moran's I\nlmsa_pm &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\ntm_shape(lisa_pm_map) +\n  tm_polygons(fill = \"ii\",\n              fill.scale = tm_scale_intervals(\n                style = \"pretty\",\n                n = 5,\n                values = \"-brewer.RdBu\"), \n                fill_alpha = 0.7,\n              fill.legend = tm_legend(\n                title = \"Local Moran's I\")) + \n  tm_borders(fill_alpha = 0.5) +\n  tm_title(\"Local Moran's I PM Weeday Trips\") +\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),\n    bg.color = \"#D0DDD0\") +\n   tm_view(set_zoom_limits = c(11,16)) \n\ntmap_arrange(lisa_map_pm, lmsa_pm, \n             asp=1, ncol=1,\n             sync = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\nObservation\n\nThe High-High clusters form extensive zones around Tampines, Ang Mo Kio, Bedok, Toa Payoh/Balestier, Dhoby Ghaut/Bras Basah & Boat Quay, and Jurong West/Boon Lay, spanning multiple connected hexagons.\nThese High-High clusters are frequently bordered by Low-High hexagons in areas such as Jelebu, Punggol, Bedok, Sengkang, and Senja, indicating pockets of low ridership surrounded by high-ridership neighbors.\nNo Low-Low clusters were observed. However, Low-High clusters are especially prominent near Jurong West Central, Serangoon, and Bukit Panjang where High-High clusters exist. These patterns may be attributable to non-residential land use, physical barriers (such as highways), or limited transit connectivity in these specific hexagons.\n\n\n\n\n\nCode\ntmap_mode(\"view\")\n# Local Moran's I Clusters\nlisa_map_wkd &lt;- \n  tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", fill_alpha = 0.6) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\n  tm_shape(lisa_wkd_map) + \n  tm_polygons(\n    fill = \"LISA_cluster_wkd\",\n    fill_alpha = 0.5,\n    fill.scale = tm_scale_categorical(\n      values = c(\n        \"Insignificant\" = \"#EEEDEB\",\n        \"Low-Low\" = \"#1B3C53\",\n        \"Low-High\" = \"#1572A1\",\n        \"High-Low\" = \"#D885A3\",\n        \"High-High\" = \"#842A3B\")),          # High-High\n        fill.legend = tm_legend(\n      title = \"LISA Cluster\",\n      position = tm_pos_in(\"left\", \"bottom\"))) +\n  tm_borders() +\n  tm_title(\"LISA - Local Moran's I Clusters - Weekends (p &lt; 0.05)\") +\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),\n    bg.color = \"#D0DDD0\") +\n   tm_view(set_zoom_limits = c(11,16)) \n\n# Local Moran's I\nlmsa_wkd &lt;- tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.5) +\ntm_shape(lisa_wkd_map) +\n  tm_polygons(fill = \"ii\",\n              fill.scale = tm_scale_intervals(\n              style = \"pretty\",\n              n = 5,\n              values = \"-brewer.RdBu\"), \n              fill_alpha = 0.7,\n              fill.legend = tm_legend(\n              title = \"Local Moran's I\")) + \n  tm_borders(fill_alpha = 0.5) +\n  tm_title(\"Local Moran's I Weekend/PH Trips\") +\n  tm_layout(\n    legend.position = c(\"right\", \"bottom\"),\n    bg.color = \"#D0DDD0\") +\n   tm_view(set_zoom_limits = c(11,16)) \n\ntmap_arrange(lisa_map_wkd, lmsa_wkd, \n             asp=1, ncol=1,\n             sync = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\nObservation\n\nThe High-High clusters form extensive zones around Woodlands, Sengkang, Hougang, Amg Mo Kio, Serangoon, Toa Payoh, Tampines, Bedok, CBD up to Orchard and City Hall, spanning multiple connected hexagons. These are the busy areas from where people transit or depart for their activities / going home on the weekends.\nNo Low-Low clusters are observed for weekend.\nLow-High clusters are observed in several locations, indicating areas with low ridership surrounded by high ridership neighbors. These include hexagons near major activity centers: Boat Quay and Robertson Quay (near Dhoby Ghaut and City Hall), Chin Bee & Kian Teck (adjacent to Jurong West Central), Toa Payoh West (near Toa Payoh Central & Braddell), and Tampines North (near Tampines East & West). Additional isolated Low-High hexagons appear in Katong, Bendemeer, Bukit Batok Central, and Choa Chu Kang North.\n\n\n\n\n\n\nAnalysis\n\n\n1. AM Peak shows strongest and most extensive spatial clustering - AM peak exhibits the largest High-High clusters across the network: Woodlands (9 hexagons), Bedok (6 hexagons), Clementi (5 hexagons), plus large clusters at Boon Lay/Jurong West Central, Tampines, Sengkang, and Ang Mo Kio. This extensive clustering reflects synchronised morning commutes from residential areas, with statistically significant spatial autocorrelation indicating neighbors consistently share similar high ridership patterns.\n\nLow-Low clusters concentrate in western border areas like Joo Koon and other non-residential zones where people travel to for work rather than from, explaining minimal boarding demand.\n\n*2. PM and Weekend Patterns Show Reduced Clustering with Spatial Fragmentation** - PM and weekend periods exhibit significantly smaller High-High clusters compared to AM. Clementi shrinks from 5 hexagons (AM) to only 2 hexagons (PM/Weekend), reflecting dispersed evening and weekend travel. - Tampines and Sengkang maintain the strongest clustering in PM, while Bedok and Tampines lead in weekends. Bras Basah appears in observational data but does not reach LISA significance thresholds. This fragmentation confirms that evening and weekend boarding demand is less spatially concentrated than morning commutes.\n3. Low-High outliers reveal service gaps and barriers within high-demand qreas - Low-High hexagons consistently appear adjacent to High-High clusters at major hubs (Toa Payoh, Bendemeer, Bedok, Upper Thomson, Sengkang, Tampines, Punggol, Yishun, Clementi, Woodlands), indicating pockets of low ridership surrounded by high-demand neighbors.\n\nThese spatial outliers suggest transit coverage gaps (poor bus connectivity), land use discontinuities (parks or non-residential areas within residential zones), or last-mile connectivity issues where residents use alternative transportation modes. PM and weekend periods show additional Low-High patterns that highlightsg areas with barriers or limited service despite proximity to high-ridership zones."
  },
  {
    "objectID": "geospatial/proj_2-sg_bus/sg_bus.html#hot-spots-and-cold-spots-analysis-hcsa",
    "href": "geospatial/proj_2-sg_bus/sg_bus.html#hot-spots-and-cold-spots-analysis-hcsa",
    "title": "02 - Singapore Bus Passenger Travel Patterns",
    "section": "5 Hot Spots and Cold Spots Analysis (HCSA)",
    "text": "5 Hot Spots and Cold Spots Analysis (HCSA)\nIn this section, we want to identify statistically significant clusters of high values (hot spots) and low values (cold spots) of a geographically referenced attribute - Singapore Bus Passenger Trips. We aim to reveal areas where passenger onboarding a bus are clustered more densely than would be expected by random chance.\n\n5.1 Deriving Distance Weight Matrix\n1. Determine the upper limit for distance band: The distance of the upper limit is what we have defined earlier for the hexagon area - 750 meters.\n\nct_am &lt;- critical_threshold(st_geometry(hexagon_contiguity_ft))\nct_am\n\n[1] 750\n\n\nThe summary report confirms that the largest first nearest neighbour distance is 750m - the distance we set for the hexagon, so using this as the upper threshold gives certainty that all units will have at least one neighbour. Below we will compute the fixed distance weight with the distance threshold from the above.\n2. Deriving Distance Weight Matrix\nWe will compute fixed distance weights for local Gi* computation, as each geographical unit has been defined as hexagon.\n\n\nCode\nhexagon_fdw_am &lt;- AM_trips_geo %&gt;% \n  mutate(nb = include_self(\n    st_dist_band(\n    st_geometry(geometry), \n                 upper = ct_am)),\n    wt = st_weights(nb, style = \"W\"),\n    .before = 1) \n\nhexagon_fdw_pm &lt;- PM_trips_geo %&gt;% \n  mutate(nb = include_self(\n    st_dist_band(\n    st_geometry(geometry), \n                 upper = ct_am)),\n    wt = st_weights(nb, style = \"W\"),\n    .before = 1) \n\nhexagon_fdw_wkd &lt;- WKD_trips_geo %&gt;% \n  mutate(nb = include_self(\n    st_dist_band(\n    st_geometry(geometry), \n                 upper = ct_am)),\n    wt = st_weights(nb, style = \"W\"),\n    .before = 1) \n\nwrite_rds(hexagon_fdw_am, \"data/rds/hexagon_fdw_am.rds\")\nwrite_rds(hexagon_fdw_pm, \"data/rds/hexagon_fdw_pm.rds\")\nwrite_rds(hexagon_fdw_wkd, \"data/rds/hexagon_fdw_wkd.rds\")\n\n\n\n\nRows: 826\nColumns: 5\n$ nb       &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;, &lt;2, 5, …\n$ wt       &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0.25, 0.2…\n$ HEX_ID   &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009…\n$ TRIPS    &lt;dbl&gt; 1272, 296, 798, 2703, 348, 370, 1118, 347, 16205, 5157, 621, …\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 30…\n\n\nRows: 826\nColumns: 5\n$ nb       &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;, &lt;2, 5, …\n$ wt       &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0.25, 0.2…\n$ HEX_ID   &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009…\n$ TRIPS    &lt;dbl&gt; 3391, 841, 3031, 8882, 679, 892, 3940, 869, 10226, 6262, 7871…\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 30…\n\n\nRows: 826\nColumns: 5\n$ nb       &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;, &lt;2, 5, …\n$ wt       &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0.25, 0.2…\n$ HEX_ID   &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009…\n$ TRIPS    &lt;dbl&gt; 3318, 437, 1417, 4262, 506, 426, 1663, 470, 22741, 7055, 2457…\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 30…\n\n\n\n\n5.2 Computing local Gi*\nIn the following, Local Gi* will be computed for the 3 study periods.\n\nAMPMWeekend/PH\n\n\n\n\nCode\nHCSA_fdw_am &lt;- hexagon_fdw_am %&gt;%\n  mutate(\n    gistar_am = local_gstar_perm(\n      TRIPS, nb, wt, nsim = 99),\n    .before = 1) %&gt;%\n  unnest(gistar_am)\n\nwrite_rds(HCSA_fdw_am, \"data/rds/HCSA_fdw_am.rds\")\n\n\nWe use glimpse() to check the computation result for Gi*, and confirm that the HCSA classes are stored in the cluster column.\n\n\nRows: 826\nColumns: 15\n$ gi_star      &lt;dbl&gt; -1.0291817, -1.4559806, -1.4437252, -1.6304842, -1.592543…\n$ cluster      &lt;fct&gt; Low, Low, Low, Low, Low, Low, Low, Low, Low, Low, Low, Lo…\n$ e_gi         &lt;dbl&gt; 0.0005642749, 0.0009029457, 0.0009768741, 0.0009847667, 0…\n$ var_gi       &lt;dbl&gt; 4.048393e-07, 4.416827e-07, 5.912131e-07, 3.856476e-07, 5…\n$ std_dev      &lt;dbl&gt; -0.8659291, -1.3370462, -1.2387105, -1.5646059, -1.351136…\n$ p_value      &lt;dbl&gt; 0.38652905, 0.18120755, 0.21545273, 0.11767534, 0.1766516…\n$ p_sim        &lt;dbl&gt; 0.28, 0.06, 0.04, 0.02, 0.04, 0.04, 0.02, 0.06, 0.10, 0.0…\n$ p_folded_sim &lt;dbl&gt; 0.14, 0.03, 0.02, 0.01, 0.02, 0.02, 0.01, 0.03, 0.05, 0.0…\n$ skewness     &lt;dbl&gt; 0.9699230, 1.7715907, 1.7602705, 0.7757232, 2.7302964, 1.…\n$ kurtosis     &lt;dbl&gt; -0.34911750, 4.92939590, 4.74566536, -0.01990249, 13.1426…\n$ nb           &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;, &lt;2,…\n$ wt           &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0.25,…\n$ HEX_ID       &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H…\n$ TRIPS        &lt;dbl&gt; 1272, 296, 798, 2703, 348, 370, 1118, 347, 16205, 5157, 6…\n$ geometry     &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.53…\n\n\n\n\n\n\nCode\nHCSA_fdw_pm &lt;- hexagon_fdw_pm %&gt;%\n  mutate(\n    gistar_pm = local_gstar_perm(\n      TRIPS, nb, wt, nsim = 99),\n    .before = 1) %&gt;%\n  unnest(gistar_pm)\nwrite_rds(HCSA_fdw_pm, \"data/rds/HCSA_fdw_pm.rds\")\n\n\nWe use glimpse() to check the computation result for Gi*, and confirm that the HCSA classes are stored in the cluster column.\n\n\nRows: 826\nColumns: 15\n$ gi_star      &lt;dbl&gt; -0.8197841, -1.1558509, -1.1583608, -1.2798757, -1.270638…\n$ cluster      &lt;fct&gt; Low, Low, Low, Low, Low, Low, Low, Low, Low, Low, Low, Lo…\n$ e_gi         &lt;dbl&gt; 0.0006348506, 0.0009183045, 0.0008855069, 0.0009363174, 0…\n$ var_gi       &lt;dbl&gt; 5.680055e-07, 6.802007e-07, 6.314232e-07, 7.940737e-07, 5…\n$ std_dev      &lt;dbl&gt; -0.7861521, -1.0560944, -1.0580319, -0.9843369, -1.170635…\n$ p_value      &lt;dbl&gt; 0.4317784, 0.2909251, 0.2900409, 0.3249499, 0.2417453, 0.…\n$ p_sim        &lt;dbl&gt; 0.20, 0.06, 0.04, 0.02, 0.02, 0.02, 0.02, 0.08, 0.06, 0.0…\n$ p_folded_sim &lt;dbl&gt; 0.10, 0.03, 0.02, 0.01, 0.01, 0.01, 0.01, 0.04, 0.03, 0.0…\n$ skewness     &lt;dbl&gt; 2.445958, 2.408965, 1.577018, 3.191245, 1.835550, 2.39958…\n$ kurtosis     &lt;dbl&gt; 7.595238, 9.279886, 2.140942, 12.524197, 3.761577, 7.5069…\n$ nb           &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;, &lt;2,…\n$ wt           &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0.25,…\n$ HEX_ID       &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H…\n$ TRIPS        &lt;dbl&gt; 3391, 841, 3031, 8882, 679, 892, 3940, 869, 10226, 6262, …\n$ geometry     &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.53…\n\n\n\n\n\n\nCode\nHCSA_fdw_wkd &lt;- hexagon_fdw_wkd %&gt;%\n  mutate(\n    gistar_wkd = local_gstar_perm(\n      TRIPS, nb, wt, nsim = 99),\n    .before = 1) %&gt;%\n  unnest(gistar_wkd)\nwrite_rds(HCSA_fdw_wkd, \"data/rds/HCSA_fdw_wkd.rds\")\n\n\nWe use glimpse() to check the computation result for Gi*, and confirm that the HCSA classes are stored in the cluster column.\n\n\nRows: 826\nColumns: 15\n$ gi_star      &lt;dbl&gt; -0.8590258, -1.2289184, -1.2030306, -1.3719497, -1.320868…\n$ cluster      &lt;fct&gt; Low, Low, Low, Low, Low, Low, Low, Low, Low, Low, Low, Lo…\n$ e_gi         &lt;dbl&gt; 0.0006420666, 0.0008174249, 0.0009436170, 0.0009864871, 0…\n$ var_gi       &lt;dbl&gt; 7.802788e-07, 4.856621e-07, 4.157300e-07, 6.947388e-07, 8…\n$ std_dev      &lt;dbl&gt; -0.6770899, -1.1271950, -1.3755218, -1.1423340, -1.120440…\n$ p_value      &lt;dbl&gt; 0.4983489, 0.2596601, 0.1689697, 0.2533152, 0.2625263, 0.…\n$ p_sim        &lt;dbl&gt; 0.30, 0.06, 0.04, 0.02, 0.02, 0.04, 0.02, 0.08, 0.16, 0.0…\n$ p_folded_sim &lt;dbl&gt; 0.15, 0.03, 0.02, 0.01, 0.01, 0.02, 0.01, 0.04, 0.08, 0.0…\n$ skewness     &lt;dbl&gt; 2.5967543, 1.6998751, 1.3784366, 1.7446061, 1.4887516, 2.…\n$ kurtosis     &lt;dbl&gt; 8.1021447, 3.2143745, 2.7652446, 3.0313670, 1.9376229, 5.…\n$ nb           &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;, &lt;2,…\n$ wt           &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0.25,…\n$ HEX_ID       &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H…\n$ TRIPS        &lt;dbl&gt; 3318, 437, 1417, 4262, 506, 426, 1663, 470, 22741, 7055, …\n$ geometry     &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.53…\n\n\n\n\n\n\n\n5.3 Visualising HCSA Map\nWe will use tmap to prepare a choropleth map showing the distribution of Gi* values.\n\n5.3.1 Prepare data for HCSA Maps\nTo prepare the HSCA map, we will derive a new field called HCSA_cluster from the cluster column.\n\nAMPMWeekend\n\n\nPrepare a new field HCSA_cluster_am for AM Weekdays HCSA map.\n\n\nCode\nHCSA_clst_am &lt;- HCSA_fdw_am %&gt;%\n  mutate(HCSA_cluster_am = case_when(\n    p_sim &gt; 0.05 ~ \"Insignificant\",\n    p_sim &lt;= 0.05 & cluster == \"High\" ~ \"Hot spot\",\n    p_sim &lt;= 0.05 & cluster == \"Low\"  ~ \"Cold spot\",\n    TRUE ~ \"Other\"),\n    HCSA_cluster_am = factor(\n      HCSA_cluster_am,\n      levels = c(\"Insignificant\", \"Hot spot\", \"Cold spot\")\n    ),\n    .before = 1\n  )\n\nwrite_rds(HCSA_clst_am, \"data/rds/HCSA_clst_am.rds\")\n\n\n\n\nRows: 826\nColumns: 16\n$ HCSA_cluster_am &lt;fct&gt; Insignificant, Insignificant, Cold spot, Cold spot, Co…\n$ gi_star         &lt;dbl&gt; -1.0291817, -1.4559806, -1.4437252, -1.6304842, -1.592…\n$ cluster         &lt;fct&gt; Low, Low, Low, Low, Low, Low, Low, Low, Low, Low, Low,…\n$ e_gi            &lt;dbl&gt; 0.0005642749, 0.0009029457, 0.0009768741, 0.0009847667…\n$ var_gi          &lt;dbl&gt; 4.048393e-07, 4.416827e-07, 5.912131e-07, 3.856476e-07…\n$ std_dev         &lt;dbl&gt; -0.8659291, -1.3370462, -1.2387105, -1.5646059, -1.351…\n$ p_value         &lt;dbl&gt; 0.38652905, 0.18120755, 0.21545273, 0.11767534, 0.1766…\n$ p_sim           &lt;dbl&gt; 0.28, 0.06, 0.04, 0.02, 0.04, 0.04, 0.02, 0.06, 0.10, …\n$ p_folded_sim    &lt;dbl&gt; 0.14, 0.03, 0.02, 0.01, 0.02, 0.02, 0.01, 0.03, 0.05, …\n$ skewness        &lt;dbl&gt; 0.9699230, 1.7715907, 1.7602705, 0.7757232, 2.7302964,…\n$ kurtosis        &lt;dbl&gt; -0.34911750, 4.92939590, 4.74566536, -0.01990249, 13.1…\n$ nb              &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;, …\n$ wt              &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0.…\n$ HEX_ID          &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008…\n$ TRIPS           &lt;dbl&gt; 1272, 296, 798, 2703, 348, 370, 1118, 347, 16205, 5157…\n$ geometry        &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167…\n\n\nThis confirms that we have HCSA_cluster_am to show the classifications for AM trips. Below we will plot the HCSA map for AM Weekdays & Local Gi* of AM weekday Trips.\n\n\nPrepare a new field HCSA_cluster_pm for PM Weekdays HCSA map.\n\n\nCode\nHCSA_clst_pm &lt;- HCSA_fdw_pm %&gt;%\n  mutate(HCSA_cluster_pm = case_when(\n    p_sim &gt; 0.05 ~ \"Insignificant\",\n    p_sim &lt;= 0.05 & cluster == \"High\" ~ \"Hot spot\",\n    p_sim &lt;= 0.05 & cluster == \"Low\"  ~ \"Cold spot\",\n    TRUE ~ \"Other\"),\n    HCSA_cluster_pm = factor(\n      HCSA_cluster_pm,\n      levels = c(\"Insignificant\", \"Hot spot\", \"Cold spot\")\n    ),\n    .before = 1\n  )\n\nwrite_rds(HCSA_clst_pm, \"data/rds/HCSA_clst_pm.rds\")\n\n\n\n\nRows: 826\nColumns: 16\n$ HCSA_cluster_pm &lt;fct&gt; Insignificant, Insignificant, Cold spot, Cold spot, Co…\n$ gi_star         &lt;dbl&gt; -0.8197841, -1.1558509, -1.1583608, -1.2798757, -1.270…\n$ cluster         &lt;fct&gt; Low, Low, Low, Low, Low, Low, Low, Low, Low, Low, Low,…\n$ e_gi            &lt;dbl&gt; 0.0006348506, 0.0009183045, 0.0008855069, 0.0009363174…\n$ var_gi          &lt;dbl&gt; 5.680055e-07, 6.802007e-07, 6.314232e-07, 7.940737e-07…\n$ std_dev         &lt;dbl&gt; -0.7861521, -1.0560944, -1.0580319, -0.9843369, -1.170…\n$ p_value         &lt;dbl&gt; 0.4317784, 0.2909251, 0.2900409, 0.3249499, 0.2417453,…\n$ p_sim           &lt;dbl&gt; 0.20, 0.06, 0.04, 0.02, 0.02, 0.02, 0.02, 0.08, 0.06, …\n$ p_folded_sim    &lt;dbl&gt; 0.10, 0.03, 0.02, 0.01, 0.01, 0.01, 0.01, 0.04, 0.03, …\n$ skewness        &lt;dbl&gt; 2.445958, 2.408965, 1.577018, 3.191245, 1.835550, 2.39…\n$ kurtosis        &lt;dbl&gt; 7.595238, 9.279886, 2.140942, 12.524197, 3.761577, 7.5…\n$ nb              &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;, …\n$ wt              &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0.…\n$ HEX_ID          &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008…\n$ TRIPS           &lt;dbl&gt; 3391, 841, 3031, 8882, 679, 892, 3940, 869, 10226, 626…\n$ geometry        &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167…\n\n\n\n\n\n\nCode\nHCSA_clst_wkd &lt;- HCSA_fdw_wkd %&gt;%\n  mutate(HCSA_cluster_wkd = case_when(\n    p_sim &gt; 0.05 ~ \"Insignificant\",\n    p_sim &lt;= 0.05 & cluster == \"High\" ~ \"Hot spot\",\n    p_sim &lt;= 0.05 & cluster == \"Low\"  ~ \"Cold spot\",\n    TRUE ~ \"Other\"),\n    HCSA_cluster_wkd = factor(\n      HCSA_cluster_wkd,\n      levels = c(\"Insignificant\", \"Hot spot\", \"Cold spot\")\n    ),\n    .before = 1\n  )\n\nwrite_rds(HCSA_clst_wkd, \"data/rds/HCSA_clst_wkd.rds\")\n\n\n\n\nRows: 826\nColumns: 16\n$ HCSA_cluster_wkd &lt;fct&gt; Insignificant, Insignificant, Cold spot, Cold spot, C…\n$ gi_star          &lt;dbl&gt; -0.8590258, -1.2289184, -1.2030306, -1.3719497, -1.32…\n$ cluster          &lt;fct&gt; Low, Low, Low, Low, Low, Low, Low, Low, Low, Low, Low…\n$ e_gi             &lt;dbl&gt; 0.0006420666, 0.0008174249, 0.0009436170, 0.000986487…\n$ var_gi           &lt;dbl&gt; 7.802788e-07, 4.856621e-07, 4.157300e-07, 6.947388e-0…\n$ std_dev          &lt;dbl&gt; -0.6770899, -1.1271950, -1.3755218, -1.1423340, -1.12…\n$ p_value          &lt;dbl&gt; 0.4983489, 0.2596601, 0.1689697, 0.2533152, 0.2625263…\n$ p_sim            &lt;dbl&gt; 0.30, 0.06, 0.04, 0.02, 0.02, 0.04, 0.02, 0.08, 0.16,…\n$ p_folded_sim     &lt;dbl&gt; 0.15, 0.03, 0.02, 0.01, 0.01, 0.02, 0.01, 0.04, 0.08,…\n$ skewness         &lt;dbl&gt; 2.5967543, 1.6998751, 1.3784366, 1.7446061, 1.4887516…\n$ kurtosis         &lt;dbl&gt; 8.1021447, 3.2143745, 2.7652446, 3.0313670, 1.9376229…\n$ nb               &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;,…\n$ wt               &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0…\n$ HEX_ID           &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H000…\n$ TRIPS            &lt;dbl&gt; 3318, 437, 1417, 4262, 506, 426, 1663, 470, 22741, 70…\n$ geometry         &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((416…\n\n\n\n\n\n\n\n5.3.2 Plot for HCSA Maps\nNext we will use the data set above to plot HCSA maps to conduct HCSA analysis.\n\nAMPMWeekend / PH\n\n\nBelow we will plot the HCSA map for AM Weekdays.\n\n\nCode\n# Gi* map\nGi_star_map_am &lt;- \n  tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.6) +\n  tm_shape(HCSA_clst_am) +\n  tm_polygons(fill = \"gi_star\",\n              fill.scale = tm_scale_intervals(\n              style = \"pretty\",\n              n = 5,\n              values = \"-brewer.rd_bu\"),\n              fill_alpha = 0.8,              \n              fill.legend = tm_legend(\n              title = \"local Gi*\",\n              position = tm_pos_in(\"right\", \"bottom\"))) + \n  tm_borders(col_alpha = 0.7) +\n  tm_title(\"Local Gi* of AM Trips\")\n\n# HCSA map\nHCSA_map_am &lt;- \n  tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.7) +\n  tm_shape(HCSA_clst_am) + \n  tm_polygons(\n    fill = \"HCSA_cluster_am\",\n    fill_alpha = 0.6,\n    fill.scale = tm_scale_categorical(\n      values = c(\n        \"Insignificant\" = \"white\",      \n        \"Cold spot\" = \"#1B3C53\",       \n        \"Hot spot\" = \"#842A3B\"         \n      )),\n    fill.legend = tm_legend(\n      title = \"HCSA Cluster AM Weekdays\",\n      position = tm_pos_in(\"right\", \"bottom\"))) +\n  tm_borders() +\n  tm_title(\"HCSA Clusters AM Weekdays (p &lt; 0.05)\") +\n  tm_shape(mrt_all) +\n  tm_symbols(fill = \"#63A361\", size = 0.4, col = \"#3A6F43\") +\n  tm_view(set_zoom_limits = c(11,14))\n\nGi_star_map_am\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(\"view\")\nHCSA_map_am\n\n\n\n\n\n\n\nCode\n# tmap_arrange(Gi_star_map_am, HCSA_map_am, \n#              asp=1, ncol=1,\n#              sync = TRUE)\n\ntmap_mode(\"plot\")\n\n\nInsight\n\nHot Spots: The bigger hot spots clustered around Tampines, Punggol, Woodlands, Jurong West Central (Boon Lay MRT), Serangon & Hougang, consisting of 4-6 connected hexagons. These are the transfer hub or boarding hub during AM peak hours when people go to work.\nOther hot spots with 2 hexagons connected are in Ang Mo Kio, Yishun and Toa Payoh, incicating a smaller scale of hub. Other independent hot spots are either adjacent to MRT stations or have an MRT station within the hexagon, including Fajar, Bendemeer, Bedok North, Springleaf, Bukit Batok Central, Yuhua East, Joo Koon, Tuas, Tuas Promenade, Clememti Central.\nCold Spots: Large number of connected cold spots are located at west, Reservoir View, Lim Chu Kang, Seletar park, Changi Point, Straits View & Marina South area.\nOther smaller cold spots scale include NUS (230), Townsville (21,900), Northshore(270), Lorong Halus North(0) & Paya Lebar West(0) and Xilin(1,730), Tagore (8,110), Nee Soon(890), Senoko North(20. These are either at the border, with little population (population indicated in the parenthesis) or is situated in a non-residential region of the subzone, so there there is little to no demand for bus trips in the morning.\n\n\n\nBelow we will plot the HCSA map for PM Weekdays\n\n\nCode\n# Gi* map\nGi_star_map_pm &lt;- \n  tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.6) +\n  tm_shape(HCSA_clst_pm) +\n  tm_polygons(fill = \"gi_star\",\n              fill.scale = tm_scale_intervals(\n              style = \"pretty\",\n              n = 5,\n              values = \"-brewer.rd_bu\"),\n              fill_alpha = 0.8,              \n              fill.legend = tm_legend(\n              title = \"local Gi*\",\n              position = tm_pos_in(\"right\", \"bottom\"))) + \n  tm_borders(col_alpha = 0.7) +\n  tm_title(\"Local Gi* of PM Trips\")\n\n# HCSA map\nHCSA_map_pm &lt;- \n  tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.7) +\n  tm_shape(HCSA_clst_pm) + \n  tm_polygons(\n    fill = \"HCSA_cluster_pm\",\n    fill_alpha = 0.6,\n    fill.scale = tm_scale_categorical(\n      values = c(\n        \"Insignificant\" = \"white\",      # Insignificant\n        \"Cold spot\" = \"#1B3C53\",        # Low-Low\n        \"Hot spot\" = \"#842A3B\"          # High-High\n      )),\n    fill.legend = tm_legend(\n      title = \"HCSA Cluster PM Weekdays\",\n      position = tm_pos_in(\"right\", \"bottom\"))) +\n  tm_borders() +\n  tm_title(\"HCSA Clusters PM Weekdays (p &lt; 0.05)\") +\n  tm_shape(mrt_all) +\n  tm_symbols(fill = \"#63A361\", size = 0.4, col = \"#3A6F43\") +\n  tm_view(set_zoom_limits = c(11,14))\n\n\nGi_star_map_pm\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(\"view\")\nHCSA_map_pm\n\n\n\n\n\n\n\nCode\n# tmap_arrange(Gi_star_map_pm, HCSA_map_pm, \n#              asp=1, ncol=1,\n#              sync = TRUE)\n\ntmap_mode(\"plot\")\n\n\nInsight\n\nHot spots: Hot spots during PM peak hours are not as large as AM peak hours. At most, we only see 2 hexagons connected together as hot spot cluster in Tampines and SengKang & Rivervale. The rest are connected to cold spots in between or are isolated hexagons among insignificants, such as Woodlands, Ang Mo Kio, Boon Lay place, and Clementi. This shows that PM peak hours the riderships are more dispersed rather than concentrating in a place. It could also be due to more people avoid peak hours after work.\nCold spots: Extensive cold spot zones are mainly in non-residential areas, including Tuas (West), Woodlands, and Reservoir View. Smaller cold spot clusters (1-2 hexagons) appear in Straits View, Lorong Halus North & Paya Lebar West, Kovan & Lorong Ah Soo, Seletar Airport Punggol, Tampines, and Changi Point.\nPM peak hours show fewer statistically significant hot and cold spot clusters compared to AM peak hours. This indicates weaker spatial clustering overall, with PM boarding demand more evenly distributed across the network and results in more areas with neutral or random spatial patterns that do not reach statistical significance thresholds.\n\n\n\nBelow we will plot the HCSA map for Weekend/Public Holidays\n\n\nCode\n# Gi* map\nGi_star_map_wkd &lt;- \n  tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.6) +\n  tm_shape(HCSA_clst_wkd) +\n  tm_polygons(fill = \"gi_star\",\n              fill.scale = tm_scale_intervals(\n              style = \"pretty\",\n              n = 5,\n              values = \"-brewer.rd_bu\"),\n              fill_alpha = 0.8,              \n              fill.legend = tm_legend(\n              title = \"local Gi*\",\n              position = tm_pos_in(\"right\", \"bottom\"))) + \n  tm_borders(col_alpha = 0.7) +\n  tm_title(\"Local Gi* of Weekend Trips\")\n\n# HCSA map\nHCSA_map_wkd &lt;- \n  tm_shape(mpsz) +\n  tm_polygons(fill = \"#FFF4EA\", fill_alpha = 0.3) +\n  tm_text(\"SUBZONE_N\", size = 0.7) +\n  tm_shape(HCSA_clst_wkd) + \n  tm_polygons(\n    fill = \"HCSA_cluster_wkd\",\n    fill_alpha = 0.6,\n    fill.scale = tm_scale_categorical(\n      values = c(\n        \"Insignificant\" = \"white\",      # Insignificant\n        \"Cold spot\" = \"#1B3C53\",        # Low-Low\n        \"Hot spot\" = \"#842A3B\"          # High-High\n      )),\n    fill.legend = tm_legend(\n      title = \"HCSA Cluster Weekend Trips\",\n      position = tm_pos_in(\"right\", \"bottom\"))) +\n  tm_borders() +\n  tm_title(\"HCSA Clusters Weekend (p &lt; 0.05)\") +\n  tm_shape(mrt_all) +\n  tm_symbols(fill = \"#63A361\", size = 0.4, col = \"#3A6F43\") +\n  tm_view(set_zoom_limits = c(11,14))\n\n\nGi_star_map_wkd\n\n\n\n\n\n\n\n\n\nCode\ntmap_mode(\"view\")\nHCSA_map_wkd\n\n\n\n\n\n\n\nCode\n# tmap_arrange(Gi_star_map_am, HCSA_map_am, \n#              asp=1, ncol=1,\n#              sync = TRUE)\n\ntmap_mode(\"plot\")\n\n\nInsight\n\nHot spots: Some hot spots clusters on the weekend are bigger than PM peak hours, such places like Boon Lay/Jurong West Central, and Tampines. Small scale of hot spot clusters appear in the area of Fajar, Ang Mo Kio, SengKang & Punggol, Bedok (near Bedok Resevoir), Bukit Merah, Bras Basah & Little India subzones.\nCold spots: Extensive cold spot zones are mainly in non-residential areas, including Tuas (West), Seletar Airport, Changi Point, Woodlands checkpoint, Straits View, and Reservoir View. Smaller cold spot clusters (1-2 hexagons) appear in Lorong Halus, Changi Airbase, Xilin, Townsville, Robertson Quay, Istana, and NUS. These areas are where low ridership happens on the weekends.\n\n\n\n\n\n\nAnalysis\n\n\n\nAM has strong clustering, PM is dispersed, weekends are moderate\n\n\nAM peak forms large hot spot clusters (4-6 hexagons) at Tampines, Punggol, Woodlands, Jurong West Central, and Serangoon & Hougang. PM peak has weak clustering with only 2-hexagon hot spots at Tampines and Sengkang & Rivervale, while other hot spots (Woodlands, Ang Mo Kio, Boon Lay Place, Clementi) appear as isolated hexagons connected to cold spots or surrounded by non-significant areas, suggesting people avoid peak hours after work or travel from dispersed destinations.\nPM shows fewer statistically significant clusters overall, meaning more areas have neutral patterns that don’t reach significance thresholds. Weekends show moderate clusters at Boon Lay/Jurong West, Tampines, and city center areas.\n\n\nBorder areas are always cold spots, plus institutional/tourist areas on weekends\n\n\nTuas, Reservoir View, Lim Chu Kang, Seletar, Changi Point, Straits View, and Woodlands checkpoint show cold spots across all periods. Low-population zones (Lorong Halus North: 0, Paya Lebar West: 0) also consistently have cold spots.\nWeekends add cold spots at institutional and tourist areas (Robertson Quay, Istana, NUS, Changi Airbase) that have minimal weekend boarding at these locations. These areas are employment-driven, not residential, making them candidates for service reduction.\n\n\nMRT stations create hot spots\n\n\nHot spots consistently appear at or near MRT/LRT stations (Fajar, Bendemeer, Bedok North, Springleaf, Bukit Batok Central) across all periods.\nLarger clusters indicate major transfer hubs, smaller ones indicate minor hubs. AM creates the largest clusters because morning commutes are concentrated, while PM creates isolated hot spots because evening travel is dispersed."
  },
  {
    "objectID": "geospatial/proj_2-sg_bus/sg_bus.html#emerging-hot-spot-analysis-ehsa",
    "href": "geospatial/proj_2-sg_bus/sg_bus.html#emerging-hot-spot-analysis-ehsa",
    "title": "02 - Singapore Bus Passenger Travel Patterns",
    "section": "6 Emerging Hot Spot Analysis (EHSA)",
    "text": "6 Emerging Hot Spot Analysis (EHSA)\nEmerging Hot Spot Analysis (EHSA) is a spatio-temporal analysis method for revealing and describing how hot spot and cold spot areas evolve over time. In the following, we will perform Mann-Kendall Test by using the spatio-temporal local Gi* values, Prepared EHSA maps of the Gi* values of the passenger trips by origin at the hexagon level. The analysis consist of four main steps:\n\nBuilding a space-time cube\nCalculating Getis-Ord local Gi* statistic for each bin by using an FDR correction\nEvaluating these hot and cold spot trends by using Mann-Kendall trend test\nCategorising each study area location by referring to the resultant trend z-score and p-value for each location with data, and with the hot spot z-score and p-value for each bin.\n\n\n6.1 Prepare data\n\n6.1.1 Create Individual Dataframe for AM, PM and Weekends:\nIn section 2.5, we have prepared data for EHSA analysis by month and by hour. Let’s verify we have all columns we need for EHSA.\n\nAMPMWeekend/PH\n\n\nBelow we will take a look at the AM trips data by hour.\n\n#By hour\nglimpse(AM_trips_geo_hr)\n\nRows: 3,304\nColumns: 4\n$ HEX_ID      &lt;fct&gt; H0001, H0001, H0001, H0001, H0002, H0002, H0002, H0002, H0…\n$ HOUR_OF_DAY &lt;dbl&gt; 6, 7, 8, 9, 6, 7, 8, 9, 6, 7, 8, 9, 6, 7, 8, 9, 6, 7, 8, 9…\n$ TRIPS       &lt;dbl&gt; 474, 345, 237, 216, 98, 77, 77, 44, 334, 191, 198, 75, 551…\n$ geometry    &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538…\n\n\n\n\nBelow we will take a look at the PM trips data by month and by hour.\n\n# By hour\nglimpse(PM_trips_geo_hr)\n\nRows: 3,304\nColumns: 4\n$ HEX_ID      &lt;fct&gt; H0001, H0001, H0001, H0001, H0002, H0002, H0002, H0002, H0…\n$ HOUR_OF_DAY &lt;dbl&gt; 17, 18, 19, 20, 17, 18, 19, 20, 17, 18, 19, 20, 17, 18, 19…\n$ TRIPS       &lt;dbl&gt; 748, 1086, 937, 620, 397, 173, 211, 60, 1327, 647, 630, 42…\n$ geometry    &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538…\n\n\n\n\nBelow we will take a look at the Weekend trips data by month and by hour.\n\n# By hour\nglimpse(WKD_trips_geo_hr)\n\nRows: 8,260\nColumns: 4\n$ HEX_ID      &lt;fct&gt; H0001, H0001, H0001, H0001, H0001, H0001, H0001, H0001, H0…\n$ HOUR_OF_DAY &lt;dbl&gt; 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 11, 12, 13, 14, 15…\n$ TRIPS       &lt;dbl&gt; 289, 365, 267, 238, 369, 402, 626, 308, 281, 173, 34, 45, …\n$ geometry    &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538…\n\n\n\n\n\n\n\n\n6.2 Calculate Local Gi* for Each Time Step\n\nAMPMWeekend\n\n\n\n\nCode\ncalc_gi_star_am &lt;- function(data, hour, nb_list, wt_list) {\n  hour_data &lt;- data %&gt;%\n    filter(HOUR_OF_DAY == hour)\n  \n  values &lt;- hour_data$TRIPS  \n  \n  gi_star_am &lt;- localG(values, listw = nb2listw(nb_list, \n                                              glist = wt_list, \n                                              style = \"W\"))\n  \n  hour_data %&gt;%\n    st_drop_geometry() %&gt;%\n    mutate(\n      GI_STAR = as.vector(gi_star_am),  # Changed to as.vector\n      P_VALUE = 2 * pnorm(-abs(as.vector(gi_star_am))),  \n      HOUR_OF_DAY = hour\n    ) %&gt;%\n    as.data.frame()  \n}\n\n# remove H0826 from AM_trips_geo_hr\nAM_trips_geo_hr_ft &lt;- AM_trips_geo_hr %&gt;%\n  filter(HEX_ID != \"H0826\")\n\nhexagon_fdw_am_ft &lt;- hexagon_fdw_am %&gt;%\n  filter(HEX_ID != \"H0826\")\n\nnb_list_am &lt;- hexagon_fdw_am_ft$nb\nwt_list_am &lt;- hexagon_fdw_am_ft$wt\n\n# Verify dimensions\nAM_trips_geo_hr_ft %&gt;%\n  st_drop_geometry() %&gt;%\n  count(HOUR_OF_DAY)\n\n# Run analysis directly\ntime_steps_am &lt;- c(6, 7, 8, 9) \ngi_results_am &lt;- map_dfr(time_steps_am, ~calc_gi_star_am(AM_trips_geo_hr_ft, .x, nb_list_am, wt_list_am))\n\nwrite_rds(gi_results_am, \"data/rds/gi_results_am.rds\")\n\n\n\n\nRows: 3,300\nColumns: 5\n$ HEX_ID      &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0…\n$ HOUR_OF_DAY &lt;dbl&gt; 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6…\n$ TRIPS       &lt;dbl&gt; 474, 98, 334, 551, 136, 224, 182, 48, 5395, 2040, 67, 5847…\n$ GI_STAR     &lt;dbl&gt; -0.9725415, -1.3891952, -1.3498210, -1.5555665, -1.4686999…\n$ P_VALUE     &lt;dbl&gt; 0.33078122, 0.16477339, 0.17707339, 0.11981121, 0.14191421…\n\n\n\n\n\n\nCode\ncalc_gi_star_pm &lt;- function(data, hour, nb_list, wt_list) {\n  hour_data &lt;- data %&gt;%\n    filter(HOUR_OF_DAY == hour)\n  \n  values &lt;- hour_data$TRIPS  \n  \n  gi_star_pm &lt;- localG(values, listw = nb2listw(nb_list, \n                                              glist = wt_list, \n                                              style = \"W\"))\n  \n  hour_data %&gt;%\n    st_drop_geometry() %&gt;%\n    mutate(\n      GI_STAR = as.vector(gi_star_pm),  # Changed to as.vector\n      P_VALUE = 2 * pnorm(-abs(as.vector(gi_star_pm))),  \n      HOUR_OF_DAY = hour\n    ) %&gt;%\n    as.data.frame()  \n}\n\n# remove H0826 from PM_trips_geo_hr\nPM_trips_geo_hr_ft &lt;- PM_trips_geo_hr %&gt;%\n  filter(HEX_ID != \"H0826\") \n\nhexagon_fdw_pm_ft &lt;- hexagon_fdw_pm %&gt;%\n  filter(HEX_ID != \"H0826\")\n\nnb_list_pm &lt;- hexagon_fdw_pm_ft$nb\nwt_list_pm &lt;- hexagon_fdw_pm_ft$wt\n\n# Verify dimensions\nPM_trips_geo_hr_ft %&gt;%\n  st_drop_geometry() %&gt;%\n  count(HOUR_OF_DAY)\n\n# Run analysis directly\ntime_steps_pm &lt;- c(17, 18, 19, 20) \ngi_results_pm &lt;- map_dfr(time_steps_pm, ~calc_gi_star_pm(PM_trips_geo_hr_ft, .x, nb_list_pm, wt_list_pm))\n\nwrite_rds(gi_results_pm, \"data/rds/gi_results_pm.rds\")\n\n\n\n\nRows: 3,300\nColumns: 5\n$ HEX_ID      &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0…\n$ HOUR_OF_DAY &lt;dbl&gt; 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17…\n$ TRIPS       &lt;dbl&gt; 748, 397, 1327, 2472, 331, 282, 1314, 273, 3072, 2340, 253…\n$ GI_STAR     &lt;dbl&gt; -0.9745925, -1.3750184, -1.3725341, -1.5217982, -1.4957015…\n$ P_VALUE     &lt;dbl&gt; 0.32976244, 0.16912575, 0.16989722, 0.12805966, 0.13473145…\n\n\n\n\n\n\nCode\ncalc_gi_star_wkd &lt;- function(data, hour, nb_list, wt_list) {\n  hour_data &lt;- data %&gt;%\n    filter(HOUR_OF_DAY == hour)\n  \n  values &lt;- hour_data$TRIPS  \n  \n  gi_star_wkd &lt;- localG(values, listw = nb2listw(nb_list, \n                                              glist = wt_list, \n                                              style = \"W\"))\n  \n  hour_data %&gt;%\n    st_drop_geometry() %&gt;%\n    mutate(\n      GI_STAR = as.vector(gi_star_pm),  # Changed to as.vector\n      P_VALUE = 2 * pnorm(-abs(as.vector(gi_star_wkd))),  \n      HOUR_OF_DAY = hour\n    ) %&gt;%\n    as.data.frame()  \n}\n\n# remove H0826 from PM_trips_geo_hr\nWKD_trips_geo_hr_ft &lt;- WKD_trips_geo_hr %&gt;%\n  filter(HEX_ID != \"H0826\") \n\nhexagon_fdw_wkd_ft &lt;- hexagon_fdw_wkd %&gt;%\n  filter(HEX_ID != \"H0826\")\n\nnb_list_wkd &lt;- hexagon_fdw_wkd_ft$nb\nwt_list_wkd &lt;- hexagon_fdw_wkd_ft$wt\n\n# Verify dimensions\nWKD_trips_geo_hr_ft %&gt;%\n  st_drop_geometry() %&gt;%\n  count(HOUR_OF_DAY)\n\n# Run analysis directly\ntime_steps_wkd &lt;- c(17, 18, 19, 20) \ngi_results_wkd &lt;- map_dfr(time_steps_wkd, ~calc_gi_star_pm(PM_trips_geo_hr_ft, .x, nb_list_wkd, wt_list_wkd))\n\nwrite_rds(gi_results_wkd, \"data/rds/gi_results_wkd.rds\")\n\n\n\n\nRows: 3,300\nColumns: 5\n$ HEX_ID      &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0…\n$ HOUR_OF_DAY &lt;dbl&gt; 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17…\n$ TRIPS       &lt;dbl&gt; 748, 397, 1327, 2472, 331, 282, 1314, 273, 3072, 2340, 253…\n$ GI_STAR     &lt;dbl&gt; -0.9745925, -1.3750184, -1.3725341, -1.5217982, -1.4957015…\n$ P_VALUE     &lt;dbl&gt; 0.32976244, 0.16912575, 0.16989722, 0.12805966, 0.13473145…\n\n\n\n\n\n\n\n6.4 Mann-Kendall Test on Gi* Values\n\n6.4.1 Run Test\n\nAMPMWeekend\n\n\n\n\nCode\nlibrary(Kendall)\n\n# Mann-Kendall test for each hexagon\nmk_results_am &lt;- gi_ehsa_results_am %&gt;%\n  group_by(HEX_ID) %&gt;%\n  arrange(HOUR_OF_DAY) %&gt;%\n  summarise(\n    mk_tau = MannKendall(GI_STAR)$tau[[1]],      # Kendall's tau\n    mk_sl = MannKendall(GI_STAR)$sl[[1]],        # p-value \n    mk_S = MannKendall(GI_STAR)$S[[1]],          # S statistic\n    mk_D = MannKendall(GI_STAR)$D[[1]],          # Denominator for tau\n    mk_varS = MannKendall(GI_STAR)$varS[[1]],    # Variance of S\n    mk_trend = case_when(\n      mk_sl &gt;= 0.05 ~ \"No trend\",\n      mk_tau &gt; 0 ~ \"Increasing\",\n      mk_tau &lt; 0 ~ \"Decreasing\"\n    ),\n    .groups = 'drop'\n  )\n\n# Join back with geometry for mapping\nehsa_results_am &lt;- hexagon_fdw_am_ft %&gt;%\n  left_join(mk_results_am, by = \"HEX_ID\")\n\nwrite_rds(ehsa_results_am, \"data/rds/ehsa_results_am.rds\")\n\n\n\n\nRows: 825\nColumns: 11\n$ nb       &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;, &lt;2, 5, …\n$ wt       &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0.25, 0.2…\n$ HEX_ID   &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009…\n$ TRIPS    &lt;dbl&gt; 1272, 296, 798, 2703, 348, 370, 1118, 347, 16205, 5157, 621, …\n$ mk_tau   &lt;dbl&gt; -0.6666666, -0.9999999, -0.6666666, -0.6666666, -0.6666666, -…\n$ mk_sl    &lt;dbl&gt; 0.30817953, 0.08942937, 0.30817953, 0.30817953, 0.30817953, 0…\n$ mk_S     &lt;dbl&gt; -4, -6, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -…\n$ mk_D     &lt;dbl&gt; 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6…\n$ mk_varS  &lt;dbl&gt; 8.666667, 8.666667, 8.666667, 8.666667, 8.666667, 8.666667, 8…\n$ mk_trend &lt;chr&gt; \"No trend\", \"No trend\", \"No trend\", \"No trend\", \"No trend\", \"…\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 30…\n\n\n\n\n\n\nCode\nlibrary(Kendall)\n\n# Mann-Kendall test for each hexagon\nmk_results_pm &lt;- gi_ehsa_results_pm %&gt;%\n  group_by(HEX_ID) %&gt;%\n  arrange(HOUR_OF_DAY) %&gt;%\n  summarise(\n    mk_tau = MannKendall(GI_STAR)$tau[[1]],      # Kendall's tau\n    mk_sl = MannKendall(GI_STAR)$sl[[1]],        # p-value \n    mk_S = MannKendall(GI_STAR)$S[[1]],          # S statistic\n    mk_D = MannKendall(GI_STAR)$D[[1]],          # Denominator for tau\n    mk_varS = MannKendall(GI_STAR)$varS[[1]],    # Variance of S\n    mk_trend = case_when(\n      mk_sl &gt;= 0.05 ~ \"No trend\",\n      mk_tau &gt; 0 ~ \"Increasing\",\n      mk_tau &lt; 0 ~ \"Decreasing\"\n    ),\n    .groups = 'drop'\n  )\n\n# Join back with geometry for mapping\nehsa_results_pm &lt;- hexagon_fdw_pm_ft %&gt;%\n  left_join(mk_results_pm, by = \"HEX_ID\")\n\nwrite_rds(ehsa_results_pm, \"data/rds/ehsa_results_pm.rds\")\n\n\n\n\nRows: 825\nColumns: 11\n$ nb       &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;, &lt;2, 5, …\n$ wt       &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0.25, 0.2…\n$ HEX_ID   &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009…\n$ TRIPS    &lt;dbl&gt; 1272, 296, 798, 2703, 348, 370, 1118, 347, 16205, 5157, 621, …\n$ mk_tau   &lt;dbl&gt; -0.6666666, -0.9999999, -0.6666666, -0.6666666, -0.6666666, -…\n$ mk_sl    &lt;dbl&gt; 0.30817953, 0.08942937, 0.30817953, 0.30817953, 0.30817953, 0…\n$ mk_S     &lt;dbl&gt; -4, -6, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -…\n$ mk_D     &lt;dbl&gt; 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6…\n$ mk_varS  &lt;dbl&gt; 8.666667, 8.666667, 8.666667, 8.666667, 8.666667, 8.666667, 8…\n$ mk_trend &lt;chr&gt; \"No trend\", \"No trend\", \"No trend\", \"No trend\", \"No trend\", \"…\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 30…\n\n\n\n\n\nlibrary(Kendall)\n\n# Mann-Kendall test for each hexagon\nmk_results_wkd &lt;- gi_ehsa_results_wkd %&gt;%\n  group_by(HEX_ID) %&gt;%\n  arrange(HOUR_OF_DAY) %&gt;%\n  summarise(\n    mk_tau = MannKendall(GI_STAR)$tau[[1]],      # Kendall's tau\n    mk_sl = MannKendall(GI_STAR)$sl[[1]],        # p-value \n    mk_S = MannKendall(GI_STAR)$S[[1]],          # S statistic\n    mk_D = MannKendall(GI_STAR)$D[[1]],          # Denominator for tau\n    mk_varS = MannKendall(GI_STAR)$varS[[1]],    # Variance of S\n    mk_trend = case_when(\n      mk_sl &gt;= 0.05 ~ \"No trend\",\n      mk_tau &gt; 0 ~ \"Increasing\",\n      mk_tau &lt; 0 ~ \"Decreasing\"\n    ),\n    .groups = 'drop'\n  )\n\n# Join back with geometry for mapping\nehsa_results_wkd &lt;- hexagon_fdw_wkd_ft %&gt;%\n  left_join(mk_results_wkd, by = \"HEX_ID\")\n\nwrite_rds(ehsa_results_wkd, \"data/rds/ehsa_results_wkd.rds\")\n\n\n\nRows: 825\nColumns: 11\n$ nb       &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;, &lt;2, 5, …\n$ wt       &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0.25, 0.2…\n$ HEX_ID   &lt;fct&gt; H0001, H0002, H0003, H0004, H0005, H0006, H0007, H0008, H0009…\n$ TRIPS    &lt;dbl&gt; 3318, 437, 1417, 4262, 506, 426, 1663, 470, 22741, 7055, 2457…\n$ mk_tau   &lt;dbl&gt; 0.9999999, 0.9999999, 0.9999999, 0.9999999, 0.9999999, 0.9999…\n$ mk_sl    &lt;dbl&gt; 0.08942938, 0.08942938, 0.08942938, 0.08942938, 0.08942938, 0…\n$ mk_S     &lt;dbl&gt; 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6…\n$ mk_D     &lt;dbl&gt; 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6…\n$ mk_varS  &lt;dbl&gt; 8.666667, 8.666667, 8.666667, 8.666667, 8.666667, 8.666667, 8…\n$ mk_trend &lt;chr&gt; \"No trend\", \"No trend\", \"No trend\", \"No trend\", \"No trend\", \"…\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.538 30…\n\n\n\n\n\n\n\n\n6.4.2 MK Test Report\n\nAMPMWeekend\n\n\n\n\nCode\nlibrary(Kendall)\n\n# Mann-Kendall test for each hexagon\nmk_results_am &lt;- gi_ehsa_results_am %&gt;%\n  group_by(HEX_ID) %&gt;%\n  arrange(HOUR_OF_DAY) %&gt;%\n  summarise(\n    mk_tau = MannKendall(GI_STAR)$tau[[1]],      # Kendall's tau\n    mk_sl = MannKendall(GI_STAR)$sl[[1]],        # p-value \n    mk_S = MannKendall(GI_STAR)$S[[1]],          # S statistic\n    mk_D = MannKendall(GI_STAR)$D[[1]],          # Denominator for tau\n    mk_varS = MannKendall(GI_STAR)$varS[[1]],    # Variance of S\n    mk_trend = case_when(\n      mk_sl &gt;= 0.05 ~ \"No trend\",\n      mk_tau &gt; 0 ~ \"Increasing\",\n      mk_tau &lt; 0 ~ \"Decreasing\"\n    ),\n    .groups = 'drop'\n  )\n\n# Join back with geometry for mapping\nehsa_results_am &lt;- hexagon_fdw_am_ft %&gt;%\n  left_join(mk_results_am, by = \"HEX_ID\")\n\nwrite_rds(ehsa_results_am, \"data/rds/ehsa_results_am.rds\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nnb\nwt\nHEX_ID\nTRIPS\nmk_tau\nmk_sl\nmk_S\nmk_D\nmk_varS\nmk_trend\ngeometry\n\n\n\n\n1, 3\n0.5, 0.5\nH0001\n1272\n-0.6666666\n0.3081795\n-4\n6\n8.666667\nNo trend\nPOLYGON ((4167.538 27510.65…\n\n\n2, 4, 5, 7\n0.25, 0.25, 0.25, 0.25\nH0002\n296\n-0.9999999\n0.0894294\n-6\n6\n8.666667\nNo trend\nPOLYGON ((4167.538 30108.73…\n\n\n1, 3, 6, 10\n0.25, 0.25, 0.25, 0.25\nH0003\n798\n-0.6666666\n0.3081795\n-4\n6\n8.666667\nNo trend\nPOLYGON ((4542.538 28160.17…\n\n\n2, 4, 6, 7, 11\n0.2, 0.2, 0.2, 0.2, 0.2\nH0004\n2703\n-0.6666666\n0.3081795\n-4\n6\n8.666667\nNo trend\nPOLYGON ((4542.538 29459.21…\n\n\n2, 5, 7, 8, 12\n0.2, 0.2, 0.2, 0.2, 0.2\nH0005\n348\n-0.6666666\n0.3081795\n-4\n6\n8.666667\nNo trend\nPOLYGON ((4542.538 30758.25…\n\n\n3, 4, 6, 10, 11\n0.2, 0.2, 0.2, 0.2, 0.2\nH0006\n370\n-0.6666666\n0.3081795\n-4\n6\n8.666667\nNo trend\nPOLYGON ((4917.538 28809.69…\n\n\n\n\n\n\n\n\n\nCode\nlibrary(Kendall)\n\n# Mann-Kendall test for each hexagon\nmk_results_pm &lt;- gi_ehsa_results_pm %&gt;%\n  group_by(HEX_ID) %&gt;%\n  arrange(HOUR_OF_DAY) %&gt;%\n  summarise(\n    mk_tau = MannKendall(GI_STAR)$tau[[1]],      # Kendall's tau\n    mk_sl = MannKendall(GI_STAR)$sl[[1]],        # p-value \n    mk_S = MannKendall(GI_STAR)$S[[1]],          # S statistic\n    mk_D = MannKendall(GI_STAR)$D[[1]],          # Denominator for tau\n    mk_varS = MannKendall(GI_STAR)$varS[[1]],    # Variance of S\n    mk_trend = case_when(\n      mk_sl &gt;= 0.05 ~ \"No trend\",\n      mk_tau &gt; 0 ~ \"Increasing\",\n      mk_tau &lt; 0 ~ \"Decreasing\"\n    ),\n    .groups = 'drop'\n  )\n\n# Join back with geometry for mapping\nehsa_results_pm &lt;- hexagon_fdw_pm_ft %&gt;%\n  left_join(mk_results_pm, by = \"HEX_ID\")\n\nwrite_rds(ehsa_results_pm, \"data/rds/ehsa_results_pm.rds\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nnb\nwt\nHEX_ID\nTRIPS\nmk_tau\nmk_sl\nmk_S\nmk_D\nmk_varS\nmk_trend\ngeometry\n\n\n\n\n1, 3\n0.5, 0.5\nH0001\n3391\n0.9999999\n0.0894294\n6\n6\n8.666667\nNo trend\nPOLYGON ((4167.538 27510.65…\n\n\n2, 4, 5, 7\n0.25, 0.25, 0.25, 0.25\nH0002\n841\n0.9999999\n0.0894294\n6\n6\n8.666667\nNo trend\nPOLYGON ((4167.538 30108.73…\n\n\n1, 3, 6, 10\n0.25, 0.25, 0.25, 0.25\nH0003\n3031\n0.9999999\n0.0894294\n6\n6\n8.666667\nNo trend\nPOLYGON ((4542.538 28160.17…\n\n\n2, 4, 6, 7, 11\n0.2, 0.2, 0.2, 0.2, 0.2\nH0004\n8882\n0.9999999\n0.0894294\n6\n6\n8.666667\nNo trend\nPOLYGON ((4542.538 29459.21…\n\n\n2, 5, 7, 8, 12\n0.2, 0.2, 0.2, 0.2, 0.2\nH0005\n679\n0.9999999\n0.0894294\n6\n6\n8.666667\nNo trend\nPOLYGON ((4542.538 30758.25…\n\n\n3, 4, 6, 10, 11\n0.2, 0.2, 0.2, 0.2, 0.2\nH0006\n892\n0.9999999\n0.0894294\n6\n6\n8.666667\nNo trend\nPOLYGON ((4917.538 28809.69…\n\n\n\n\n\n\n\n\n\nCode\nlibrary(Kendall)\n\n# Mann-Kendall test for each hexagon\nmk_results_wkd &lt;- gi_ehsa_results_wkd %&gt;%\n  group_by(HEX_ID) %&gt;%\n  arrange(HOUR_OF_DAY) %&gt;%\n  summarise(\n    mk_tau = MannKendall(GI_STAR)$tau[[1]],      # Kendall's tau\n    mk_sl = MannKendall(GI_STAR)$sl[[1]],        # p-value \n    mk_S = MannKendall(GI_STAR)$S[[1]],          # S statistic\n    mk_D = MannKendall(GI_STAR)$D[[1]],          # Denominator for tau\n    mk_varS = MannKendall(GI_STAR)$varS[[1]],    # Variance of S\n    mk_trend = case_when(\n      mk_sl &gt;= 0.05 ~ \"No trend\",\n      mk_tau &gt; 0 ~ \"Increasing\",\n      mk_tau &lt; 0 ~ \"Decreasing\"\n    ),\n    .groups = 'drop'\n  )\n\n# Join back with geometry for mapping\nehsa_results_wkd &lt;- hexagon_fdw_wkd_ft %&gt;%\n  left_join(mk_results_wkd, by = \"HEX_ID\")\n\nwrite_rds(ehsa_results_wkd, \"data/rds/ehsa_results_wkd.rds\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nnb\nwt\nHEX_ID\nTRIPS\nmk_tau\nmk_sl\nmk_S\nmk_D\nmk_varS\nmk_trend\ngeometry\n\n\n\n\n1, 3\n0.5, 0.5\nH0001\n3318\n0.9999999\n0.0894294\n6\n6\n8.666667\nNo trend\nPOLYGON ((4167.538 27510.65…\n\n\n2, 4, 5, 7\n0.25, 0.25, 0.25, 0.25\nH0002\n437\n0.9999999\n0.0894294\n6\n6\n8.666667\nNo trend\nPOLYGON ((4167.538 30108.73…\n\n\n1, 3, 6, 10\n0.25, 0.25, 0.25, 0.25\nH0003\n1417\n0.9999999\n0.0894294\n6\n6\n8.666667\nNo trend\nPOLYGON ((4542.538 28160.17…\n\n\n2, 4, 6, 7, 11\n0.2, 0.2, 0.2, 0.2, 0.2\nH0004\n4262\n0.9999999\n0.0894294\n6\n6\n8.666667\nNo trend\nPOLYGON ((4542.538 29459.21…\n\n\n2, 5, 7, 8, 12\n0.2, 0.2, 0.2, 0.2, 0.2\nH0005\n506\n0.9999999\n0.0894294\n6\n6\n8.666667\nNo trend\nPOLYGON ((4542.538 30758.25…\n\n\n3, 4, 6, 10, 11\n0.2, 0.2, 0.2, 0.2, 0.2\nH0006\n426\n0.9999999\n0.0894294\n6\n6\n8.666667\nNo trend\nPOLYGON ((4917.538 28809.69…\n\n\n\n\n\n\n\n\n\n\n6.5 Create EHSA Map\n\n6.5.1 Classify EHSA Patterns\n\nAMPMWeekend\n\n\n\n\nCode\nAM_trips_data &lt;- AM_trips_geo_hr_ft %&gt;%\n  st_drop_geometry() %&gt;%\n  mutate(HEX_ID = as.character(HEX_ID)) %&gt;%\n  arrange(HEX_ID, HOUR_OF_DAY)\n\n# Create a separate sf object with geometries\nhex_geom_sf_am &lt;- AM_trips_geo_hr_ft %&gt;%\n  group_by(HEX_ID) %&gt;%\n  slice(1) %&gt;%\n  ungroup() %&gt;%\n  mutate(HEX_ID = as.character(HEX_ID)) %&gt;%\n  select(HEX_ID, geometry)\n\n# Create spacetime cube\nAM_st &lt;- spacetime(\n  .data = AM_trips_data,\n  .geometry = hex_geom_sf_am,\n  .loc_col = \"HEX_ID\",\n  .time_col = \"HOUR_OF_DAY\")\n\n# Activate and verify\nAM_st &lt;- activate(AM_st, \"geometry\")\nis_spacetime_cube(AM_st)\n\n# Run EHSA\nehsa_am &lt;- emerging_hotspot_analysis(\n  x = AM_st,\n  .var = \"TRIPS\",\n  k = 1,\n  nsim = 99\n)\nwrite_rds(AM_st, \"data/rds/AM_st.rds\")\nwrite_rds(ehsa_am, \"data/rds/ehsa_am.rds\")\n\n\n\n\nRows: 825\nColumns: 4\n$ location       &lt;chr&gt; \"H0001\", \"H0002\", \"H0003\", \"H0004\", \"H0005\", \"H0006\", \"…\n$ tau            &lt;dbl&gt; -0.6666666, -0.6666666, -0.6666666, -0.6666666, -0.6666…\n$ p_value        &lt;dbl&gt; 0.30817953, 0.30817953, 0.30817953, 0.30817953, 0.30817…\n$ classification &lt;chr&gt; \"sporadic coldspot\", \"persistent coldspot\", \"persistent…\n\n\n\nis_spacetime_cube(AM_st)\n\n[1] TRUE\n\n\n\n\n\n\nCode\nlibrary(sfdep)\n\nPM_trips_data &lt;- PM_trips_geo_hr_ft %&gt;%\n  st_drop_geometry() %&gt;%\n  mutate(HEX_ID = as.character(HEX_ID)) %&gt;%\n  arrange(HEX_ID, HOUR_OF_DAY)\n\n# Create a separate sf object with unique geometries\nhex_geom_sf_pm &lt;- PM_trips_geo_hr_ft %&gt;%\n  group_by(HEX_ID) %&gt;%\n  slice(1) %&gt;%\n  ungroup() %&gt;%\n  mutate(HEX_ID = as.character(HEX_ID)) %&gt;%\n  select(HEX_ID, geometry)\n\n# Create spacetime cube\nPM_st &lt;- spacetime(\n  .data = PM_trips_data,\n  .geometry = hex_geom_sf_pm,\n  .loc_col = \"HEX_ID\",\n  .time_col = \"HOUR_OF_DAY\")\n\n# Activate and verify\nPM_st &lt;- activate(PM_st, \"geometry\")\nis_spacetime_cube(PM_st)\n\n# Run EHSA\nehsa_pm &lt;- emerging_hotspot_analysis(\n  x = PM_st,\n  .var = \"TRIPS\",\n  k = 1,\n  nsim = 99\n)\nwrite_rds(PM_st, \"data/rds/PM_st.rds\")\nwrite_rds(ehsa_pm, \"data/rds/ehsa_pm.rds\")\n\n\n\n\nRows: 825\nColumns: 4\n$ location       &lt;chr&gt; \"H0001\", \"H0002\", \"H0003\", \"H0004\", \"H0005\", \"H0006\", \"…\n$ tau            &lt;dbl&gt; 0.3333333, 0.3333333, 0.3333333, 0.3333333, 0.3333333, …\n$ p_value        &lt;dbl&gt; 0.7340951, 0.7340951, 0.7340951, 0.7340951, 0.7340951, …\n$ classification &lt;chr&gt; \"consecutive coldspot\", \"persistent coldspot\", \"persist…\n\n\n\nis_spacetime_cube(PM_st)\n\n[1] TRUE\n\n\n\n\n\n\nCode\nWKD_trips_data &lt;- WKD_trips_geo_hr_ft %&gt;%\n  st_drop_geometry() %&gt;%\n  mutate(HEX_ID = as.character(HEX_ID)) %&gt;%\n  arrange(HEX_ID, HOUR_OF_DAY)\n\n# Create a separate sf object with unique geometries\nhex_geom_sf_wkd &lt;- WKD_trips_geo_hr_ft %&gt;%\n  group_by(HEX_ID) %&gt;%\n  slice(1) %&gt;%\n  ungroup() %&gt;%\n  mutate(HEX_ID = as.character(HEX_ID)) %&gt;%\n  select(HEX_ID, geometry)\n\n# Create spacetime cube\nWKD_st &lt;- spacetime(\n  .data = WKD_trips_data,\n  .geometry = hex_geom_sf_wkd,\n  .loc_col = \"HEX_ID\",\n  .time_col = \"HOUR_OF_DAY\")\n\n# Activate and verify\nWKD_st &lt;- activate(WKD_st, \"geometry\")\nis_spacetime_cube(WKD_st)\n\n# Run EHSA\nehsa_wkd &lt;- emerging_hotspot_analysis(\n  x = WKD_st,\n  .var = \"TRIPS\",\n  k = 1,\n  nsim = 99\n)\n\nwrite_rds(WKD_st, \"data/rds/WKD_st.rds\")\nwrite_rds(ehsa_wkd, \"data/rds/ehsa_wkd.rds\")\n\n\n\n\nRows: 825\nColumns: 4\n$ location       &lt;chr&gt; \"H0001\", \"H0002\", \"H0003\", \"H0004\", \"H0005\", \"H0006\", \"…\n$ tau            &lt;dbl&gt; 0.4222222, 0.4222222, 0.4222222, 0.4222222, 0.4222222, …\n$ p_value        &lt;dbl&gt; 0.107404709, 0.107404709, 0.107404709, 0.107404709, 0.1…\n$ classification &lt;chr&gt; \"sporadic coldspot\", \"persistent coldspot\", \"persistent…\n\n\n\nis_spacetime_cube(WKD_st)\n\n[1] TRUE\n\n\n\n\n\n\n\n6.5.2 Summary Report\n\nAMPMWeekend\n\n\n\nehsa_summary_am &lt;- ehsa_am_map %&gt;%\n  st_drop_geometry() %&gt;%\n  count(classification) %&gt;%\n  mutate(\n    percentage = round(100 * n / sum(n), 1),\n    label = sprintf(\"%s: %d (%.1f%%)\", classification, n, percentage)\n  ) \nwrite_rds(ehsa_summary_am, \"data/rds/ehsa_summary_am.rds\")\n\n\n\n\n\n\n\n\n\n\n\n\nclassification\nn\npercentage\nlabel\n\n\n\n\nconsecutive coldspot\n50\n6.1\nconsecutive coldspot: 50 (6.1%)\n\n\nconsecutive hotspot\n47\n5.7\nconsecutive hotspot: 47 (5.7%)\n\n\nnew coldspot\n23\n2.8\nnew coldspot: 23 (2.8%)\n\n\nnew hotspot\n2\n0.2\nnew hotspot: 2 (0.2%)\n\n\nno pattern detected\n447\n54.2\nno pattern detected: 447 (54.2%)\n\n\npersistent coldspot\n106\n12.8\npersistent coldspot: 106 (12.8%)\n\n\npersistent hotspot\n11\n1.3\npersistent hotspot: 11 (1.3%)\n\n\nsporadic coldspot\n39\n4.7\nsporadic coldspot: 39 (4.7%)\n\n\nsporadic hotspot\n100\n12.1\nsporadic hotspot: 100 (12.1%)\n\n\n\n\n\n\n\n\nehsa_summary_pm &lt;- ehsa_pm_map %&gt;%\n  st_drop_geometry() %&gt;%\n  count(classification) %&gt;%\n  mutate(\n    percentage = round(100 * n / sum(n), 1),\n    label = sprintf(\"%s: %d (%.1f%%)\", classification, n, percentage)\n  ) \nwrite_rds(ehsa_summary_pm, \"data/rds/ehsa_summary_pm.rds\")\n\n\n\n\n\n\n\n\n\n\n\n\nclassification\nn\npercentage\nlabel\n\n\n\n\nconsecutive coldspot\n50\n6.1\nconsecutive coldspot: 50 (6.1%)\n\n\nconsecutive hotspot\n47\n5.7\nconsecutive hotspot: 47 (5.7%)\n\n\nnew coldspot\n23\n2.8\nnew coldspot: 23 (2.8%)\n\n\nnew hotspot\n2\n0.2\nnew hotspot: 2 (0.2%)\n\n\nno pattern detected\n447\n54.2\nno pattern detected: 447 (54.2%)\n\n\npersistent coldspot\n106\n12.8\npersistent coldspot: 106 (12.8%)\n\n\npersistent hotspot\n11\n1.3\npersistent hotspot: 11 (1.3%)\n\n\nsporadic coldspot\n39\n4.7\nsporadic coldspot: 39 (4.7%)\n\n\nsporadic hotspot\n100\n12.1\nsporadic hotspot: 100 (12.1%)\n\n\n\n\n\n\n\n\nehsa_summary_wkd &lt;- ehsa_wkd_map %&gt;%\n  st_drop_geometry() %&gt;%\n  count(classification) %&gt;%\n  mutate(\n    percentage = round(100 * n / sum(n), 1),\n    label = sprintf(\"%s: %d (%.1f%%)\", classification, n, percentage)\n  )\nwrite_rds(ehsa_summary_wkd, \"data/rds/ehsa_summary_wkd.rds\")\n\n\n\n\n\n\n\n\n\n\n\n\nclassification\nn\npercentage\nlabel\n\n\n\n\nconsecutive coldspot\n5\n0.6\nconsecutive coldspot: 5 (0.6%)\n\n\nconsecutive hotspot\n3\n0.4\nconsecutive hotspot: 3 (0.4%)\n\n\nintensifying hotspot\n7\n0.8\nintensifying hotspot: 7 (0.8%)\n\n\nnew coldspot\n14\n1.7\nnew coldspot: 14 (1.7%)\n\n\nnew hotspot\n1\n0.1\nnew hotspot: 1 (0.1%)\n\n\nno pattern detected\n446\n54.1\nno pattern detected: 446 (54.1%)\n\n\npersistent coldspot\n128\n15.5\npersistent coldspot: 128 (15.5%)\n\n\npersistent hotspot\n22\n2.7\npersistent hotspot: 22 (2.7%)\n\n\nsporadic coldspot\n97\n11.8\nsporadic coldspot: 97 (11.8%)\n\n\nsporadic hotspot\n102\n12.4\nsporadic hotspot: 102 (12.4%)\n\n\n\n\n\n\n\n\n\n\n6.5.3 Visualising EHSA Classes\n\nAMPMWeekend\n\n\n\n\nCode\nggplot(data = ehsa_am,\n       aes(x = classification)) +\n  geom_bar(fill = \"#96A78D\") +\n  theme(plot.background = element_rect(fill = \"#D0DDD0\"),\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  geom_text(aes(label =sprintf(\"%d (%.1f%%)\", after_stat(count),\n                               after_stat(count/nrow(ehsa_am)*100))), \n            stat = \"count\",\n            vjust = -0.5,           \n            size = 2.5,             \n            color = \"black\")  \n\n\n\n\n\n\n\n\n\nObservation\n\nAM peak hours: Majority are Persistent cold spot (12.8%) and Sporadic hotspot (12.1%), followed by consecutive hotspot (5.7%), consecitive coldspot (6.1%), and then sporadic coldspot. Persistent hotspot is only 1.3%.\nWith growth indicators including consecutive hotspots (5.7%), persistent hotspots (1.3%), and other emerging patterns totaling approximately 7-8%, AM shows slightly more trend development than PM peaks (~3%) and weekends (~4%).\nUnlike PM’s coldspot dominance or weekend’s extreme concentration, AM shows more even distribution between hot and cold patterns. This suggests diverse travel needs across the network.\n\n\n\n\n\nCode\nggplot(data = ehsa_pm,\n       aes(x = classification)) +\n  geom_bar(fill = \"#93BFC7\") +\n  theme(plot.background = element_rect(fill = \"#D0DDD0\"),\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  geom_text(aes(label =sprintf(\"%d (%.1f%%)\", after_stat(count),\n                               after_stat(count/nrow(ehsa_pm)*100))),  \n            stat = \"count\",\n            vjust = -0.5,           \n            size = 2.5,             \n            color = \"black\")  \n\n\n\n\n\n\n\n\n\nObservation\n\nMajority are Consecitive cold spot (12.2%), followed by Sporadic hotspot (8,5%), Persistent coldspot (5.8%), new coldspot (5.0%)\nSporadic coldspot (1.6%) and consecutive hotspot(1.5%) are seen, while the lowest are New hotspot and Persistent hotspot - both are less than 1%.\nPM peak ridership exhibits the most spatially dispersed patterns across all time periods, characterized by dominance of coldspot activity. Consecutive coldspots (12.2%) lead all categories, followed by persistent coldspots (5.8%) and new coldspots (5.0%), collectively accounting for 23% of significant patterns. This concentration of coldspot patterns suggests PM boarding demand is more scattered across the network compared to AM peaks.\n\n\n\n\n\nCode\nggplot(data = ehsa_wkd,\n       aes(x = classification)) +\n  geom_bar(fill = \"#FFA4A4\") +\n  theme(plot.background = element_rect(fill = \"#D0DDD0\"),\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  geom_text(aes(label =sprintf(\"%d (%.1f%%)\", after_stat(count),\n                               after_stat(count/nrow(ehsa_wkd)*100))), \n            stat = \"count\",\n            vjust = -0.5,           \n            size = 2.5,             \n            color = \"black\")  \n\n\n\n\n\n\n\n\n\nObservation\n\nMajority are Persistent cold spot (15.5%), followed by Sporadic hotspot (12.4%) and Sporadic coldspot (11.8%). The rest are very few, led by Persistent hotspot (2.7%), New coldspot (1.7%)\nMost of the network is underutilized: Nearly 40% of areas either never have high demand or only occasionally do, suggesting weekend bus travel is concentrated in specific locations not captured by these patterns.\nVolatility is common: The high proportion of sporadic patterns (24.2%) indicates weekend demand is influenced by variable factors like weather, events, or discretionary activities rather than routine travel.\n\n\n\n\n\n\nInsights\n\n\n\nAM peak patterns demonstrate moderate spatial stability with pockets of consecutive activity. Growth indicators (new, intensifying, consecutive, and persistent hotspots) collectively account for approximately 8% of patterns. This is higher than PM peaks (~3%) and weekends (~4%), indicating AM ridership has slightly more spatial momentum. However, most of the network experiences either stable underutilization or intermittent high demand rather than sustained strengthening. Persistent coldspots dominate at 12.8%, while sporadic hotspots lead high-demand patterns at 12.1%. The presence of consecutive hotspots (5.7%) and consecutive coldspots (6.1%) suggests some areas are experiencing short-term trend development, though few solidify into persistent patterns. Overall, AM boarding demand remains spatially concentrated in established locations during July-September 2025, like Woodlands, Boon Lay and Tampines areas.\nPM peak patterns show spatial dispersion with minimal growth momentum. Growth indicators account for only ~3% of patterns, the lowest across all time periods. Coldspot patterns dominate at 23%, indicating large portions of the network experience consistently low or declining PM boarding activity. The prevalence of consecutive coldspots (12.2%) suggests some areas are experiencing short-term weakening trends. Sporadic hotspots (8.5%) lead high-demand patterns but remain less prevalent than AM (12.1%) or weekends (12.4%). Overall, PM boarding demand is more spatially scattered and shows no evidence of strengthening or emerging new activity centers during July-September 2025.\nWeekend ridership patterns are spatially entrenched with no evidence of shifting demand centers or emerging hotspots during the study period. Growth indicators like New, Intensifying, and Consecutive hotspots collectively account for less than 4% of significant patterns, while Persistent coldspots alone comprise 15.5%. High-demand areas experience volatility rather than growth, explained by Sporadic hotspots (12.4%) being 4-5 times more prevalent than stable hotspot patterns. Low-demand areas remain consistently underutilised, with persistent and sporadic coldspots totaling 27.3%. This indicates weekend bus travel patterns were spatially fixed during July-September 2025, with demand fluctuating within established locations rather than creating new activity centers.\n\n\n\n\n\n6.5.4 Visualising EHSA Maps\nCreate color scheme\n\n\nCode\nehsa_colors &lt;- c(\n  \"consecutive hotspot\" = \"#F86F03\",     \n  \"persistent hotspot\" = \"#D92C54\",        \n  \"sporadic hotspot\" = \"#D6A99D\",          \n  \"diminishing hotspot\" = \"#FFD5D5\",       \n  \"new hotspot\" = \"#B45253\",\n  \"intensifying hotspot\" = \"#FF2DD1\",\n  \n  \"consecutive coldspot\" = \"#00FF9C\",     \n  \"persistent coldspot\" = \"#0D5EA6\",       \n  \"sporadic coldspot\" = \"#92c5de\",         \n  \"diminishing coldspot\" = \"#BFBBA9\",\n  \"intensifying hotspot\" = \"#255F38\",\n  \"new coldspot\" = \"#AAB99A\",          \n  \n  \"oscillating hotspot\" = \"#8644A2\",     \n  \"oscillating coldspot\" = \"#CB9DF0\", \n  \"no pattern detected\" = \"#f0f0f0\"                  \n)\n\n\nJoin EHSA results with geometry\n\nAMPMWeekend\n\n\n\n\nCode\nehsa_am_map &lt;- hexagon_fdw_am_ft %&gt;%\n  mutate(HEX_ID = as.character(HEX_ID)) %&gt;%\n  left_join(\n    ehsa_am %&gt;% \n      as.data.frame() %&gt;%  # Convert to regular dataframe first\n      mutate(location = as.character(location)) %&gt;%\n      select(location, classification),  # Select only needed columns\n    by = c(\"HEX_ID\" = \"location\")\n  )\n\nwrite_rds(ehsa_am_map, \"data/rds/ehsa_am_map.rds\")\n\n\n\n\nRows: 825\nColumns: 6\n$ nb             &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;, &lt;…\n$ wt             &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0.2…\n$ HEX_ID         &lt;chr&gt; \"H0001\", \"H0002\", \"H0003\", \"H0004\", \"H0005\", \"H0006\", \"…\n$ TRIPS          &lt;dbl&gt; 1272, 296, 798, 2703, 348, 370, 1118, 347, 16205, 5157,…\n$ classification &lt;chr&gt; \"sporadic coldspot\", \"persistent coldspot\", \"persistent…\n$ geometry       &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.…\n\n\nObservation\n\nAM ridership is entrenched around established hubs. Major transfer locations (Woodlands, Tampines, Sengkang, Punggol, Hougang & Serangoon, Boon Lay & Jurong West Central, Ang Mo Kio, Yishun, Bedok) show persistent/consecutive/sporadic hotspot clusters, while border areas (Tuas, Lim Chu Kang, Changi Point, Bayfront) remain persistent coldspots throughout the study period.\nColdspot patterns are spreading outward at the periphery. Tuas, Lim Chu Kang, and Changi Point show persistent coldspots at their cores with consecutive coldspots adjacent and new coldspots at the outermost edges. This suggests declining demand is diffusing spatially from border centers.\nTransfer hubs show mixed hotspot patterns (persistent/sporadic/consecutive), indicating high but fluctuating demand. Border areas show only coldspot patterns with no volatility, suggesting completely stabilized low demand.\nMinimal Network Evolution: New coldspots appear predominantly at border areas adjacent to persistent coldspots, while Kampong Ubi is the only new hotspot observed. The absence of emerging high-demand centers indicates the network is consolidating around existing hubs rather than expanding during July-September 2025.\n\n\n\n\n\nCode\nehsa_pm_map &lt;- hexagon_fdw_pm_ft %&gt;%\n  mutate(HEX_ID = as.character(HEX_ID)) %&gt;%\n  left_join(\n    ehsa_pm %&gt;% \n      as.data.frame() %&gt;%  \n      mutate(location = as.character(location)) %&gt;%\n      select(location, classification),  \n    by = c(\"HEX_ID\" = \"location\")\n  )\n\nwrite_rds(ehsa_pm_map, \"data/rds/ehsa_pm_map.rds\")\n\n\n\n\nRows: 825\nColumns: 6\n$ nb             &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;, &lt;…\n$ wt             &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0.2…\n$ HEX_ID         &lt;chr&gt; \"H0001\", \"H0002\", \"H0003\", \"H0004\", \"H0005\", \"H0006\", \"…\n$ TRIPS          &lt;dbl&gt; 3391, 841, 3031, 8882, 679, 892, 3940, 869, 10226, 6262…\n$ classification &lt;chr&gt; \"consecutive coldspot\", \"persistent coldspot\", \"persist…\n$ geometry       &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.…\n\n\n\n\n\n\nCode\nehsa_wkd_map &lt;- hexagon_fdw_wkd_ft %&gt;%\n  mutate(HEX_ID = as.character(HEX_ID)) %&gt;%\n  left_join(\n    ehsa_wkd %&gt;% \n      as.data.frame() %&gt;%  \n      mutate(location = as.character(location)) %&gt;%\n      select(location, classification),  \n    by = c(\"HEX_ID\" = \"location\")\n  )\n\nwrite_rds(ehsa_wkd_map, \"data/rds/ehsa_wkd_map.rds\")\n\n\n\n\nRows: 825\nColumns: 6\n$ nb             &lt;nb&gt; &lt;1, 3&gt;, &lt;2, 4, 5, 7&gt;, &lt;1, 3, 6, 10&gt;, &lt;2, 4, 6, 7, 11&gt;, &lt;…\n$ wt             &lt;list&gt; &lt;0.5, 0.5&gt;, &lt;0.25, 0.25, 0.25, 0.25&gt;, &lt;0.25, 0.25, 0.2…\n$ HEX_ID         &lt;chr&gt; \"H0001\", \"H0002\", \"H0003\", \"H0004\", \"H0005\", \"H0006\", \"…\n$ TRIPS          &lt;dbl&gt; 3318, 437, 1417, 4262, 506, 426, 1663, 470, 22741, 7055…\n$ classification &lt;chr&gt; \"sporadic coldspot\", \"persistent coldspot\", \"persistent…\n$ geometry       &lt;POLYGON [m]&gt; POLYGON ((4167.538 27510.65..., POLYGON ((4167.…\n\n\n\n\n\nPlot the map\n\nAMPMWeekend\n\n\n\n\nCode\ntmap_mode(\"view\")\ntm_shape(mpsz) +\n  tm_polygons(fill = \"#FAF3F3\", fill_alpha = 0.2) +\n  tm_text(\"SUBZONE_N\", size = 0.6) +  \ntm_shape(ehsa_am_map) +\n  tm_fill(col = \"classification\",\n          palette = ehsa_colors,\n          title = \"EHSA Classification\",\n                    fill_alpha = 0.7) +\n  tm_borders(col = \"grey\", lwd = 0.3) +\ntm_shape(mrt_all) +\n  tm_symbols(fill = \"#0C4271\", size = 0.2,\n   col = \"#0C4271\") +\ntm_layout(\n  main.title = \"EHSA - AM Weekdays\",\n  legend.position = c(\"right\", \"top\")\n)\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\nObservation\n\nAM ridership (6-9am) is entrenched around established residential hubs. Major transfer locations (Woodlands, Tampines, Sengkang, Punggol, Hougang & Serangoon, Boon Lay & Jurong West Central, Ang Mo Kio, Yishun, Bedok) show persistent/consecutive/sporadic hotspot clusters, reflecting predictable morning commute patterns within the 4-hour departure window. Border areas (Tuas, Lim Chu Kang, Changi Point, Bayfront) remain persistent coldspots throughout the study period, confirming these industrial/commercial zones generate minimal morning boarding demand.\nColdspot patterns are spreading outward at the periphery. Tuas, Lim Chu Kang, and Changi Point show persistent coldspots at their cores with consecutive coldspots adjacent and new coldspots at the outermost edges. This spatial diffusion suggests declining morning boarding demand is expanding from established low-activity border centers, potentially reflecting limited residential development or service coverage at the urban fringe.\nMinimal Network Evolution With the data from July-September 2025, new coldspots appear predominantly at border areas adjacent to persistent coldspots, while Kampong Ubi is the only new hotspot observed during AM peak hours (6-9am). The absence of emerging high-demand centers indicates the AM network is consolidating around existing residential hubs rather than expanding, with no new significant boarding locations developing during the study period. This suggests the spatial structure of morning commuting patterns is mature and stable.\n\n\n\n\n\nCode\ntmap_mode(\"view\")\ntm_shape(mpsz) +\n  tm_polygons(fill = \"#FAF3F3\", fill_alpha = 0.2) +\n  tm_text(\"SUBZONE_N\", size = 0.6) +\ntm_shape(ehsa_pm_map) +\n  tm_fill(col = \"classification\",\n          palette = ehsa_colors,\n          title = \"EHSA Classification\",\n            fill_alpha = 0.7) +\n  tm_borders(col = \"grey\", lwd = 0.3) +\ntm_shape(mrt_all) +\n  tm_symbols(fill = \"#0C4271\", size = 0.2,\n   col = \"#0C4271\") +\ntm_layout(\n  main.title = \"EHSA - PM Weekdays\",\n  legend.position = c(\"right\", \"top\")\n)\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\nObservation\n\nUnlike AM where coldspots are firmly established as persistent patterns, PM (5-9pm) shows more temporal variation in low-ridership areas. Areas like Bayfront & Straits View, Tanjong Rhu, Changi, Punggol, and Tuas shift between cold and non-cold states. The shift from persistent to consecutive/sporadic coldspots indicates these areas occasionally experience higher ridership during evening hours, likely due to return trips from work, evening dining and shopping activities that temporarily boost demand on certain days.\nPersistent and consecutive hotspots are significantly reduced during PM peak hours and appear only in Tampines and Jurong West. Notably, Woodlands, as a major AM persistent hotspot, shows no persistent hotspots in PM, only consecutive and sporadic patterns. This reflects the dispersed nature of evening return trips across the 4-hour window. The remaining hotspot clusters across Bukit Panjang, Bukit Batok, Clementi, Toa Payoh, Serangoon, Hougang, Sengkang, Bedok, Little India, Boat Quay, Maxwell, Tanjong Pagar, and Redhill consist mainly of sporadic hotspots, indicating highly variable PM boarding patterns driven by diverse evening destinations and staggered travel timing.\n\n\n\n\n\nCode\ntmap_mode(\"view\")\ntm_shape(mpsz) +\n  tm_polygons(fill = \"#FAF3F3\", fill_alpha = 0.2) +\n  tm_text(\"SUBZONE_N\", size = 0.6) +\ntm_shape(ehsa_wkd_map) +\n  tm_fill(col = \"classification\",\n          palette = ehsa_colors,\n          title = \"EHSA Classification\",\n          fill_alpha = 0.7) +\n  tm_borders(col = \"grey\", lwd = 0.3) +\ntm_shape(mrt_all) +\n  tm_symbols(fill = \"#0C4271\", size = 0.2,\n   col = \"#0C4271\") +\ntm_layout(\n  main.title = \"EHSA - Weekend\",\n  legend.position = c(\"right\", \"top\")\n)\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\nObservation\n\nWeekend patterns during peak activity hours show more persistent hotspots (2.7%) compared to PM peaks (&lt;1%), concentrated at major hubs like Tampines, Woodlands, Ang Mo Kio, Sengkang, and the city center corridor like Tampines, Woodlands, Ang Mo Kio, Sengkang, and the city center corridor from Lavender to Chinatown and Redhill, encompassing Little India, Bras Basah, Dhoby Ghaut. Notably, Boon Lay/Jurong West show intensifying hotspots, forming larger consolidated clusters. The city center forms the most extensive hotspot zone, combining sporadic and persistent patterns, with Woodlands, Tampines, and Boon Lay standing out as the most prominent weekend boarding hubs.\nBorder locations display persistent coldspots during weekend peak hours (11am-8pm), contrasting with weekday activity. This indicates minimal boarding activity during prime weekend leisure hours. It confirms that border areas are primarily industrial/commercial zones where ridership is employment-driven rather than residential or recreational.\nNew coldspots emerge not only at borders (connecting persistent coldspot clusters) but also at Ulu Pandan and Tagore, suggesting expanding underutilisation in non-border areas. Some new coldspots like Waterway East and Toh Tuck appear adjacent to hotspot clusters, indicating pockets of low ridership surrounded by high-demand zones, potentially reflecting physical barriers, land use discontinuities, or service coverage gaps.\n\n\n\n\n\n\nInsights\n\n\n\n\n\nPattern\nAM Peak\nPM Peak\nWeekends\n\n\n\n\nPersistent hotspots\n1.3%\n&lt;1%\n2.7%\n\n\nConsecutive hotspots\n5.7%\n1.5%\n&lt;1%\n\n\nSporadic hotspots\n12.1%\n8.5%\n12.4%\n\n\nDominant pattern\nSporadic\nSporadic\nSporadic\n\n\nPersistent coldspots\n12.8%\n5.8%\n15.5%\n\n\nConsecutive coldspots\n6.1%\n12.2%\n0.6%\n\n\nSporadic coldspots\n4.7%\n1.6%\n11.8%\n\n\nNew coldspots\n2.8%\n5.0%\n1.7%\n\n\n\nWe identified the following clusters through EHSA maps.\n\nWestNorthCentralEastNorthEast\n\n\n\nTuas forms a large coldspot cluster across all periods, with over 50% transitioning from persistent to consecutive coldspots in AM and remaining persistent on weekends, confirming this industrial area has minimal residential population and declining weekday boarding demand. The exception is one hexagon at Tuas South Ave 9 (CSL building and grocery shops) showing activity, indicating sparse residential presence with localised weekend demand around essential services, but overall the area remains consistently underutilised for bus services.\nBoon Lay/Jurong West forms a large AM hotspot cluster (15 hexagons: 6 consecutive, 8 sporadic, 1 persistent) centered on Boon Lay MRT that shrinks in PM but expands on weekends with intensifying hotspots covering logistics offices, data centers, and foreign worker lodging services. The unique weekend intensification pattern, where some new coldspots transition to intensifying hotspots, warrants investigation as it suggests growing weekend activity potentially driven by foreign worker travel patterns or increased commercial/logistics operations during off-peak days.\nBukit Panjang / Choa Chu Kang form a large sporadic hotspot cluster that is larger during AM peak and weekends, which confirms this residential area generates strong but inconsistent morning commuting demand and active weekend local travel, though the sporadic nature suggests day-to-day volatility rather than stable patterns.\nLim Chu Kang, Reservoir View (Kranji) form a coldspot cluster extending to Turf Club. It is consitituted by persisten coldspots, consecutive coldspots and few new coldspots & sporadic coldspots and mostlyy persistent / Sporadic coldspots on the weekend. As there are some industrial estate and dormitories here, it makes sense that it has some activities during weekdays and totally quiet on the weekend.\nChoa Chu Kang, Bukit Panjang form a large sporadic hotspot cluster, too. It is a mainly residential area so the scale of cluster is larger in the morning peak hours and on the weekend.\nClementi forms a medium-scale AM hotspot cluster (6 hexagons) with mostly consecutive hotspots that shrinks during PM and weekends, indicating strong morning residential departures with short-term strengthening trends but dispersed evening returns and moderate weekend activity.\nKentridge and NUS form a 7-hexagon sporadic coldspot cluster in AM and weekends but become insignificant during PM, reflecting the area’s institutional character (university, hospital, tech offices) where people travel to rather than from. Minimal outbound morning boarding with some PM departures when the cluster disappears as workers/students leave via dispersed routes or alternative modes.\n\n\n\n\nWoodlands forms one of the largest AM hotspot cluster (17 hexagons) spanning the checkpoint, Woodlands, and Admiralty residential areas with 50% persistent hotspots, indicating exceptionally strong and stable morning boarding demand. The cluster shrinks to 7 hexagons centered on Woodlands MRT during PM (mostly consecutive hotspots) but remains strong on weekends, confirming this is a major residential hub with active local activities and consistent cross-border commuting patterns throughout the week.\nSenoko forms a medium coldspot cluster with consecutive and new patterns in AM that disappears during PM and returns as sporadic coldspots on weekends, except for one hexagon at Senoko Power Station showing an intensifying hotspot with only one visible bus stop. This anomaly warrants investigation as it suggests either data collection issues, shift worker patterns, or unreported service activity.\nYishun is another noticeble cluster comprised of mostly sporadic hotspot and one consecutive hotspot covering Yishun MRT. In the afternoon, this cluster is much smaller (from 11 to 3 hexagons). On the weekend, it is a medium cluster with purely sporadic hotspots. This shows its strong morning commutes but highly dispersed evening and weekend demand.\nAng Mo Kio forms a solid hotspot cluster with sporadic and consecutive hotspots. Similar to Yishun, the cluster shrinks in the PM peak hours (9 to 5 hexagons) and increased slight on the weekends (7 hexagons), which mirrors Yishun’s pattern of strong morning residential departures, dispersed evening returns, and moderate weekend activity.\nYio Chu Kang North forms a sporadic coldspot cluster connecting with the Kranji cluster. This cluster only shows up on the weekend, showing occasional activities in this area only. This reflects occasional low activity and poor transit connectivity (1-3km from nearest MRT), resulting in inconsistent bus demand.\nSeletar Airport forms a consistent size of coldspot cluster with 7-8 hexagons. It shows mostly persistent coldspots on the weekend, while in the morning there are 2 consecutive spots and in the PM peak hours it’s mostly consecutive coldspots. This indicats limited airport-related bus demand with declining weekday trends.\n\n\n\n\nCBD areas together form a long line of cluster of 9 hexagons, spanning across Rocher, City hall, Bugis, Tanjong Pagar and Outram Park. This cluster only forms during PM peak hours and expands larger to connect with Bendemeer and the Tiong Baruh cluster on the weekend, resulting in a very large cluster in the central area. While in PM peak hours it is mostly sporadic hotspots, it has some persisten hotspots along Orchard, Clarke Quay and Bras Basah. This indicates that this area is hotspots for people to take the bus after work, and on the weekend the area expands to be shopping and creational spots. This confirms the area’s dual role as a major departure point after work and a weekend shopping/leisure destination, contrasting with AM’s minimal boarding activity.\nBayfront and Staits View also form a coldspot cluster, spanning across City Hall till Staits View. This cluster in the morning is comprised of persistent coldspots, with sporadic coldspots in City Hall & Shenton Way, as well as sporadic coldspots in Marina South and Marina South Pier station. In the PM peak hour it becomes smaller - City Hall is no longer part of the cluster, and shows half sporadic coldspots and half consecutive coldspots. On the weekend is even quieter with half persistent coldspots and half sporadic coldspots. As this cluster maintains coldspot patterns across all periods, it confirms it as an employment destination with minimal bus boarding due to strong MRT connectivity and lack of residential population.\nToa Payoh forms a large AM hotspot cluster with sporadic and consecutive hotspots that shrinks to one-third its size in PM (sporadic only) and recovers slightly on weekends (8 hexagons) with one persistent hotspot near Toa Payoh MRT. This explains strong morning residential departures that disperse significantly in the evening with moderate but more stable weekend activity centered on the MRT hub.\nTiong Bahru shows a unique spatial shift from a medium AM residential cluster (5 hexagons at Tiong Bahru MRT) toward Redhill in PM peak, then merges with CBD/Orchard on weekends to form the largest cluster. It possesses a multifaceted role as a residential departure hub, evening activity center with local dining/shopping, and a weekend commercial-leisure destination that integrates with central city activities.\n\n\n\n\nLorong/Paya Lebar (near Paya Lebar Air Base) forms a 5-7 hexagon coldspot cluster across all periods, showing declining weekday patterns (persistent, consecutive, and new coldspots in AM; more new coldspots in PM) but stabilising on weekends (persistent/sporadic), indicating this military-adjacent area has minimal residential population and weakening weekday boarding demand, likely due to restricted access, limited public transit needs for military personnel, or reliance on alternative transportation modes.\nBedok forms a medium AM cluster (8 hexagons) with consecutive and sporadic hotspots indicating strengthening trends near the MRT, indicating volatile demand outwards the cluster, shrinking to 4 hexagons in PM but expanding to 6 on weekends with 2 persistent hotspots at Bedok MRT. The weekend persistent hotspots reveal Bedok MRT functions as a stable, major transit hub and commercial/leisure destination beyond its residential role.\nTampines forms a large, stable hotspot cluster across all periods (13 hexagons AM, 7 PM, 8 weekends) with persistent hotspots consistently centered on Tampines and Tampines East MRT stations, surrounded by consecutive and sporadic patterns at cluster edges. The increase to 5 persistent hotspot hexagons on weekends (compared to fewer in AM/PM) reveals Tampines functions as one of Singapore’s most consistently active regional hubs, serving as both a major residential commuting center and a premier weekend commercial/leisure destination with exceptionally stable demand across all time periods.\nAljunied/Paya Lebar forms a small AM sporadic cluster (4 hexagons) spanning Aljunied, Paya Lebar, and Dakota stations that becomes insignificant in PM but resurfaces on weekends, shifting to center only on Paya Lebar toward Eunos MRT. This spatial shift reflects the area’s mixed character: volatile morning commuting demand across multiple stations driven by offices in Paya Lebar, but weekend activity concentrates exclusively at Paya Lebar MRT’s shopping mall (Paya Lebar Quarter). Possibly shpping/dinning-driven weekend demand for local activities while Aljunied and Dakota revert to purely residential functions with minimal weekend boarding.\nChangi/Changi Point has two distinct AM coldspot clusters: Changi Business Park (7 hexagons) and Changi Airbase (14 hexagons). The Business Park cluster shrinks dramatically to just 2 new coldspots in PM, indicating declining demand. On weekends, both clusters merge into a continuous corridor of persistent and sporadic coldspots. The pattern progression—from mixed patterns in AM, to new/consecutive coldspots in PM, to persistent/sporadic on weekends—reveals weakening weekday demand with stabilised low weekend activity. This reflects the area’s employment-driven (Business Park) and restricted-access (Airbase) character with minimal residential population, resulting in consistently low bus boarding across all periods.\n\n\n\n\nPunggol, Sengkang, Hougang, Serangoon and Kovan form the largest AM hotspot cluster (27 hexagons) with predominantly sporadic patterns, 7 consecutive hotspots, and 2 persistent hotspots at Hougang and Sengkang MRT stations.\nThis massive cluster fragments dramatically in PM into 3 separate small clusters (Sengkang, Hougang, Serangoon), all dominated by sporadic hotspots. The fragmentation reveals this northeastern corridor’s strong residential character—extensive morning departures become dispersed, volatile evening returns. On weekends, the 3 clusters persist but grow slightly larger than PM, indicating more active weekend local activities.\nSengkang shows unique patterns: new coldspots emerge in PM (indicating some areas experience declining evening demand), but 2 persistent hotspots remain at Sengkang MRT and LRT stations on weekends, confirming these transit nodes function as stable weekend activity hubs. The persistence of sporadic patterns across PM and weekends, despite fragmentation, indicates this region maintains active but inconsistent demand driven by diverse travel purposes rather than concentrated, predictable flows."
  },
  {
    "objectID": "geospatial/proj_2-sg_bus/sg_bus.html#key-findings-conclusions",
    "href": "geospatial/proj_2-sg_bus/sg_bus.html#key-findings-conclusions",
    "title": "02 - Singapore Bus Passenger Travel Patterns",
    "section": "7 Key findings & Conclusions",
    "text": "7 Key findings & Conclusions\n\nSummary\nThis study analysed bus ridership patterns across AM peak (6-9am), PM peak (5-8pm), and weekend (11am-8pm) periods using three complementary spatial analysis methods: LISA for spatial autocorrelation, HCSA for hot/cold spot identification, and EHSA for temporal trend classification.\n1. Time Periods Show Fundamentally Different Spatial Patterns\nAM peak exhibits strong spatial clustering at major residential hubs, with concentrated and predictable boarding demand. PM peak shows dramatic dispersion with fragmented clusters and isolated hot spots, reflecting diverse evening destinations. Weekends display the highest spatial entrenchment, with 15.5% persistent coldspots at borders but concentrated activity at specific commercial and leisure hubs.\n2. Major Residential Hubs Demonstrate Directional Asymmetry\nLarge morning boarding clusters at residential areas (Woodlands, Tampines, Punggol/Sengkang/Hougang/Serangoon/Kovan, Boon Lay/Jurong West) do not translate to concentrated evening returns. Morning outflows are synchronized and spatially concentrated, while evening patterns fragment and disperse. This asymmetry confirms directional travel behavior where residential areas serve as departure origins in the morning but not concentrated destinations in the evening.\n3. Border and Non-Residential Areas Show Persistent Underutilisation\nBorder areas (Tuas, Lim Chu Kang, Changi Point, Seletar) and non-residential zones (Bayfront, institutional areas) consistently show coldspot patterns across all periods with declining trends. These areas function as employment destinations where people travel to via alternative modes rather than from via bus, indicating minimal boarding demand and presenting clear service rationalization opportunities.\n4. Network Shows Consolidation Rather Than Expansion\nGrowth indicators remain minimal across all periods, with only one new hotspot emerging (Kampong Ubi) against multiple expanding border coldspots. The network consolidates around existing hubs rather than creating new demand centers, indicating a mature spatial structure where demand fluctuates within established patterns rather than generating new activity centers.\n5. Sporadic Patterns Dominate High-Demand Locations\n\nAcross all time periods, sporadic hotspots (on-and-off high ridership) dominate (AM: 12.1%, PM: 8.5%, Weekends: 12.4%), while persistent hotspots (stable high ridership) remain rare (AM: 1.3%, PM: &lt;1%, Weekends: 2.7%). This volatility indicates inconsistent demand even at high-ridership locations, requiring flexible service capacity rather than fixed schedules. 6. Unique Patterns Warrant Further Investigation\nBoon Lay/Jurong West uniquely shows intensifying weekend hotspots around foreign worker lodging and logistics facilities. Low-High spatial outliers (low ridership pockets surrounded by high-demand neighbors) appear at multiple major hubs, indicating service gaps, land use barriers, or last-mile connectivity issues within high-demand areas.\n\n7. Multi-Method Validation Strengthens Confidence\nThe convergence of LISA, HCSA, and EHSA findings provides robust evidence for our findings. Locations showing consistent patterns across all three methods (such as Woodlands, Tampines, border coldspots). They together demonstrate high analytical confidence, while discrepancies between methods reveal nuances in spatial versus temporal patterns.\n\n\nFuture Study\n\nStudying the entire map of Singapore is a fulfilling task to understand Singapore better. To understand better and elicit the actual reasons would need deeper research in the geographical data to explain why certain places would form clusters and some not.\nIn this study, we analysed the data with 3 periods by hour. Further study can focus on month or track multi-year trends to distinguish long-term structural changes from temporary fluctuations.\nIt will insightful to combine bus boarding/alighting with MRT tap-in/tap-out data for comprehensive multimodal journey analysis. In addition, further research can validate directional asymmetry findings by confirming whether AM boarding origins correspond to PM alighting destinations.\n\nIt is amazing to explore how to manipulate data and the methods to understsand geographical insights on the maps. The hands-on experience was time-consuming, but worthwhile to know much better how certain methods and codes work to polulate the results. I feel there are much more to learn and to do - looking forward to the next."
  },
  {
    "objectID": "geospatial/proj_2-sg_bus/sg_bus.html#reference",
    "href": "geospatial/proj_2-sg_bus/sg_bus.html#reference",
    "title": "02 - Singapore Bus Passenger Travel Patterns",
    "section": "Reference",
    "text": "Reference\n\nGovernment of Singapore. (n.d.). Data.gov.sg: Singapore’s open data portal. Retrieved October 15, 2025, from https://data.gov.sg\nKam, T. S. (2022, December 8). R for geospatial data science and analytics. https://r4gdsa.netlify.app/\nLand Transport Authority (LTA). (n.d.). DataMall. Retrieved October 28, 2025, from https://datamall.lta.gov.sg/content/datamall/en.html\nWikipedia. (n.d.). Subzones of Singapore. Retrieved October 20, 2025, from https://en.wikipedia.org/wiki/Subzones_of_Singapore"
  },
  {
    "objectID": "geospatial/proj_3-predict_hdb_resale/malls_sg.html",
    "href": "geospatial/proj_3-predict_hdb_resale/malls_sg.html",
    "title": "shopping_malls_sg",
    "section": "",
    "text": "pacman::p_load(rvest, tidyverse)\n\n\nurl &lt;- \"https://en.wikipedia.org/wiki/List_of_shopping_malls_in_Singapore\"\npage &lt;- read_html(url)\n\nmall_names &lt;- page %&gt;%\n  html_nodes(\"div.mw-parser-output ul li\") %&gt;%\n  html_text() %&gt;%\n  trimws()\n\nmall_names &lt;- mall_names[nchar(mall_names) &gt; 0]\n\nmall_df &lt;- data.frame(Mall_Name = mall_names) %&gt;%\n  arrange(Mall_Name) %&gt;%\n  filter(!Mall_Name %in% c(\"v\", \"t\", \"e\")) %&gt;%\n  unique()\n\nmall_df\n\n                          Mall_Name\n1                           AMK Hub\n3           Alexandra Retail Centre\n5                    Amber Mansions\n6                        Bedok Mall\n8                       Bedok Point\n9                    Bugis Junction\n11                           Bugis+\n13              Bukit Panjang Plaza\n14                   Canberra Plaza\n16                   Capitol Centre\n17                   Capitol Piazza\n18                Capitol Singapore\n19       Cathay Cineleisure Orchard\n21                   Causeway Point\n23                   Century Square\n25                     Change Alley\n26                Changi City Point\n28                  Chinatown Point\n30                 City Square Mall\n32                    CityLink Mall\n34                    Clementi Mall\n35                      Compass One\n37                     Dawson Place\n38                     Djitsun Mall\n39                    Downtown East\n40                              Duo\n41                   Eastpoint Mall\n43              Ellenborough Market\n44                   Esplanade Mall\n45                   Far East Plaza\n47          Forum The Shopping Mall\n48               Fu Lu Shou Complex\n49                            Funan\n51            Funan DigitaLife Mall\n52                        GV Yishun\n53          Gek Poh Shopping Centre\n54                      Great World\n55                 Great World City\n56                          HDB Hub\n58              HarbourFront Centre\n60                   Heartland Mall\n62                     Hillion Mall\n64     Holland Road Shopping Centre\n65    Holland Village Shopping Mall\n66                        Hougang 1\n67                     Hougang Mall\n69                              IMM\n71                      ION Orchard\n73                            JCube\n74                              Jem\n76             Jewel Changi Airport\n78                      Junction 10\n80                       Junction 8\n82      Jurong Entertainment Centre\n83                     Jurong Point\n85                Kallang Wave Mall\n87           Katong Shopping Centre\n89                         Le Quest\n90             Leisure Park Kallang\n92                      Liang Court\n93                      Liat Towers\n94                            Lot 1\n95                          Lot One\n96                      Lucky Plaza\n98                 Mandarin Gallery\n99             Marina Bay Link Mall\n101                Marina Bay Sands\n102                   Marina Square\n104                   Millenia Walk\n106                  Mustafa Centre\n108                             NEX\n109                             Nex\n110                   Ngee Ann City\n112                 Northpoint City\n114                   Novena Square\n115     Novena Square Shopping Mall\n116                  Oasis Terraces\n118                 Orchard Central\n120                 Orchard Gateway\n122                  Orchard Towers\n123                Our Tampines Hub\n125              Palais Renaissance\n127                      Parc Point\n128                  Parkway Parade\n130              Paya Lebar Quarter\n131               Paya Lebar Square\n132                 Peninsula Plaza\n133            People's Park Centre\n135           People's Park Complex\n137                    Pioneer Mall\n139                Plantation Plaza\n140                 Plaza Singapura\n142              Punggol Coast Mall\n143                   Punggol Plaza\n145       Queensway Shopping Centre\n147                    Raffles City\n149                  Rochester Mall\n150          Scotts Shopping Centre\n151                    Seletar Mall\n152       Sembawang Shopping Centre\n154           Shaw House and Centre\n156                      Shaw Tower\n157                  Sim Lim Square\n159                 Singpost Center\n160                     South Beach\n161    Specialists' Shopping Centre\n162                        Square 2\n164                       Sun Plaza\n166                     Suntec City\n167                Suntec City Mall\n168                      Tampines 1\n170                   Tampines Mall\n172                      Tang Plaza\n173         Tanglin Shopping Centre\n174            Tanjong Pagar Centre\n175                    Tekka Centre\n177                      The Cathay\n178                 The Centrepoint\n180               The Clementi Mall\n181                 The Golden Mile\n182                    The Majestic\n183                     The Paragon\n185                   The Rail Mall\n187                The Seletar Mall\n188 The Shoppes at Marina Bay Sands\n189                 The South Beach\n190                  The Star Vista\n192                       The Verge\n193                   Thomson Plaza\n195               Tiong Bahru Plaza\n197                   United Square\n198                        VivoCity\n200                  Waterway Point\n202                West Coast Plaza\n204                       West Mall\n206                        Westgate\n208                  Wheelock Place\n210                     White Sands\n212                     Wisma Atria\n214                   Yew Tee Point\n215                      i12 Katong\n\nwrite_csv(mall_df, \"data/rawdata/singapore_malls.csv\")"
  },
  {
    "objectID": "geospatial/proj_1/test.html#introduction",
    "href": "geospatial/proj_1/test.html#introduction",
    "title": "Spatial Analysis of Essential Services in Singapore - Laundry, Beauty & Dental Business",
    "section": "Introduction",
    "text": "Introduction\nIn this study, we are interested in understanding the spatial and spatio-temporal patterns of new businesses and firms established in Singapore. Based on the Singapore Standard Industrial Classification 2020, there are over 1,500 business types. Among these, we will focus on Laundry services (including Laundry and dry cleaning services and self-operated laundries), Beauty services (including Hairdressing salons/shops, beauty salons and spas, as well as manicure and pedicure services, and Dental services.\nThe 3 chosen businesses are essential for working adults / professionals to take care of self for outlook and health. We would like to observe how these activities evolve and potentially to enhance quality of life and well-being.\nWe will start from processing the data, perform Kernel Density Estimation, Clarke-Evans test, and then conduct analysis with visualisation and test results. First-order and second-order spatial and spatio-temporal analyses are conducted to understand the overall new businesses and their temporal patterns during the period of time Jan 2024 to June 2025.\nDue to data set sizes, we will analyse spatial patterns by quarter for all 3 Services. Different spatial point pattern testing methods are used to analyse the 3 business types: G-function for Dental Services, L-function for Beauty Services, and F-function for Laundry Services."
  },
  {
    "objectID": "geospatial/proj_1/test.html#loading-the-r-packages",
    "href": "geospatial/proj_1/test.html#loading-the-r-packages",
    "title": "Spatial Analysis of Essential Services in Singapore - Laundry, Beauty & Dental Business",
    "section": "1 Loading the R packages",
    "text": "1 Loading the R packages\nWe will use tidyverse, sf, tmap, tmap, and httr packages to process data sets, along with other packages for computing KDE and plotting visualisations.\n\nR Packages\n\n\n\n\n\n\nR Package\nPurpose\n\n\n\n\ntidyverse\nthe tidyverse package is designed to make it easy to install and load core packages from the tidyverse in a single command. There are ggplot2, dplyr, tidyr, readr, purrr, and tibble, etc to manipulate, tidy, import, visualise data.\n\n\nsf\nprovides support for working with simple features, a standardized way to represent geographic vector data. It serves as a comprehensive tool for handling spatial data within the R environment.\n\n\ntmap\nserves the purpose of creating thematic maps, offering a flexible and intuitive way to visualize spatial data. It is designed to produce both static and interactive maps using a consistent, layer-based syntax similar to ggplot2.\n\n\nhttr\nserves as a tool for interacting with web APIs and performing HTTP requests within the R environment.\n\n\nknitr\nseamlessly integrate R code, its output (including text, tables, and graphics), and narrative text within a single document.\n\n\nrvest\nsimplify the process of scraping and manipulating web data. It allows for the extraction of information from websites and transforms it into a format suitable for analysis in R.\n\n\nspatstat\nprovides functions for spatial statistics with a strong focus on analysing spatial point patterns.\n\n\nterra\nprovides methods for manipulating geographic (spatial) data in both raster and vector formats.\n\n\nraster\nprovides functions which reads, writes, manipulates, analyses and model of gridded spatial data (i.e. raster). In this hands-on exercise, it will be used to convert image output generate by spatstat into raster format.\n\n\nsparr\nprovides a suite of functions for analyzing spatial and spatiotemporal point patterns, particularly focusing on the estimation and inference of relative risk surfaces.\n\n\n\n\npacman::p_load(tidyverse, sf, tmap, httr, knitr, rvest, spatstat, terra, raster, sparr)"
  },
  {
    "objectID": "geospatial/proj_1/test.html#the-data",
    "href": "geospatial/proj_1/test.html#the-data",
    "title": "Spatial Analysis of Essential Services in Singapore - Laundry, Beauty & Dental Business",
    "section": "2 The Data",
    "text": "2 The Data\nThere are mainly two raw public datasets used in this study.\n\nACRA (Accounting and Corporate Regulatory Authority) Information on Corporate Entities datasets: contains the business entities information, including their names, registration, status, and location.\nThe Master Plan 2019 Boundary: consists of the geographical boundary of Singapore at the planning subzone level. The data is based on URA Master Plan 2019.\nSingapore Residents by Planning Area / Subzone, Age Group, Sex and Type of Dwelling, June 2024: respopagesextod2024.csv is an aspatial data fie. It can be downloaded at Department of Statistics, Singapore.\n\n\n2.1 Importing ACRA data\nWe downloaded the ACRA (Accounting and Corporate Regulatory Authority) Information on Corporate Entities datasets from data.gov.sg, and will import the ACRA data and transform them as tibble frame.\nThen, we will write the data into .rds to store it in the data folder. This is so no need to process data every time.\n\nwrite_rds(acra_data, \"data/rds/acra_data.rds\")\n\n\nacra_data &lt;- read_rds(\"data/rds/acra_data.rds\")\n\n\n\n2.2 Tidying ACRA data\nWith this step, we will extract the business codes 9601, 9602, and 86204, then rename the columns and transform the data type necessarily.\nThe business types chosen are:\n\nBusiness Code & Types\n\n\n\n\n\n\nBusiness Code\nTypes / subtypes\n\n\n\n\n9601\nWashing and (Dry-) Cleaning of Textile and Fur Products\n\n\n96011\nLaundry and dry cleaning services except self-operated laundries\n\n\n96012\nSelf-operated laundries\n\n\n9602\nHairdressing, Beauty and Other Personal Care Services\n\n\n96021\nHairdressing salons/shops (including barber shops)\n\n\n96022\nBeauty salons and spas (including slimming, skin care and hair care centres)\n\n\n96023\nManicure and pedicure services\n\n\n86024\nDental services\n\n\n\nWe use below code to retrieve the data between Jan 1, 2024 to June 30, 2025 for the 3 different major business types.\n\n9601960286204\n\n\nWashing and (Dry-) Cleaning of Textile and Fur Products Business Code 9601 encompasses Laundry cleaning and self-operated laundries (96011 & 96012)\n\nbiz_9601 &lt;- acra_data %&gt;%\n  dplyr::select(1:24) %&gt;%\n  filter(primary_ssic_code == 96011 | primary_ssic_code == 96012) %&gt;%\n  rename(date = registration_incorporation_date) %&gt;%\n  mutate(date = as.Date(date),\n         YEAR = year(date),\n         MONTH_NUM = month(date),\n         MONTH_ABBR = month(date, label = TRUE, abbr = TRUE)) %&gt;% #this gives Jan, Feb, Mar...\n  mutate(postal_code = str_pad(postal_code,\n                               width = 6, side = \"left\", pad = \"0\")) %&gt;% #if missing digits, will replace with zero.\nfilter(YEAR == 2024 | YEAR == 2025 & MONTH_NUM &lt;= 6)\n\n\nbiz_9601 &lt;- write_rds(biz_9601, \"data/rds/biz_9601.rds\")\n\n\nbiz_9601 &lt;- read_rds(\"data/rds/biz_9601.rds\")\nglimpse(biz_9601)\n\nRows: 150\nColumns: 27\n$ uen                               &lt;chr&gt; \"202401518M\", \"202409043N\", \"2025075…\n$ issuance_agency_id                &lt;chr&gt; \"ACRA\", \"ACRA\", \"ACRA\", \"ACRA\", \"ACR…\n$ entity_name                       &lt;chr&gt; \"ALL DAY EVERYDAY PTE. LTD.\", \"ABEND…\n$ entity_type_description           &lt;chr&gt; \"Local Company\", \"Local Company\", \"L…\n$ business_constitution_description &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"Sole-Propri…\n$ company_type_description          &lt;chr&gt; \"Exempt Private Company Limited by S…\n$ paf_constitution_description      &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ entity_status_description         &lt;chr&gt; \"Live Company\", \"Live Company\", \"Liv…\n$ date                              &lt;date&gt; 2024-01-10, 2024-03-07, 2025-02-20,…\n$ uen_issue_date                    &lt;date&gt; 2024-01-10, 2024-03-07, 2025-02-20,…\n$ address_type                      &lt;chr&gt; \"LOCAL\", \"LOCAL\", \"LOCAL\", \"LOCAL\", …\n$ block                             &lt;chr&gt; \"105\", \"138\", \"7030\", \"160\", \"842G\",…\n$ street_name                       &lt;chr&gt; \"BISHAN STREET 12\", \"JOO SENG ROAD\",…\n$ level_no                          &lt;chr&gt; \"05\", \"02\", \"02\", \"14\", \"14\", \"na\", …\n$ unit_no                           &lt;chr&gt; \"242\", \"02\", \"11\", \"04\", \"86\", \"na\",…\n$ building_name                     &lt;chr&gt; \"BISHAN VIEW\", \"na\", \"NORTHSTAR @ AM…\n$ postal_code                       &lt;chr&gt; \"570105\", \"368361\", \"569880\", \"06891…\n$ other_address_line1               &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ other_address_line2               &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ account_due_date                  &lt;chr&gt; \"2026-07-31\", \"2026-07-31\", \"2026-08…\n$ annual_return_date                &lt;chr&gt; \"2025-06-29\", \"2025-07-01\", \"na\", \"n…\n$ primary_ssic_code                 &lt;dbl&gt; 96012, 96011, 96011, 96012, 96012, 9…\n$ primary_ssic_description          &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ primary_user_described_activity   &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ YEAR                              &lt;dbl&gt; 2024, 2024, 2025, 2025, 2024, 2025, …\n$ MONTH_NUM                         &lt;dbl&gt; 1, 3, 2, 6, 7, 4, 11, 1, 2, 5, 4, 4,…\n$ MONTH_ABBR                        &lt;ord&gt; Jan, Mar, Feb, Jun, Jul, Apr, Nov, J…\n\n\nThere are 150 observations we have retrieved for this analysis.\n\n\nHairdressing, Beauty and Other Personal Care Services Business Code 9602 includes hair dressing, beauty salons and manicure & pedicure services.\n\nbiz_9602 &lt;- acra_data %&gt;%\n  dplyr::select(1:24) %&gt;%\n  filter(primary_ssic_code == 96021 | primary_ssic_code == 96022 | primary_ssic_code == 96023) %&gt;%\n  rename(date = registration_incorporation_date) %&gt;%\n  mutate(date = as.Date(date),\n         YEAR = year(date),\n         MONTH_NUM = month(date),\n         MONTH_ABBR = month(date, label = TRUE, abbr = TRUE)) %&gt;% #this gives Jan, Feb, Mar...\n  mutate(postal_code = str_pad(postal_code,\n                               width = 6, side = \"left\", pad = \"0\")) %&gt;% #if missing digits, will replace with zero.\nfilter(YEAR == 2024 | YEAR == 2025 & MONTH_NUM &lt;= 6)\n\n\nbiz_9602 &lt;- write_rds(biz_9602, \"data/rds/biz_9602.rds\")\n\n\nbiz_9602 &lt;- read_rds(\"data/rds/biz_9602.rds\")\nglimpse(biz_9602)\n\nRows: 1,762\nColumns: 27\n$ uen                               &lt;chr&gt; \"202400273N\", \"202400385D\", \"2024010…\n$ issuance_agency_id                &lt;chr&gt; \"ACRA\", \"ACRA\", \"ACRA\", \"ACRA\", \"ACR…\n$ entity_name                       &lt;chr&gt; \"A-VINZ (KV) PTE. LTD.\", \"ACTINIC VE…\n$ entity_type_description           &lt;chr&gt; \"Local Company\", \"Local Company\", \"L…\n$ business_constitution_description &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ company_type_description          &lt;chr&gt; \"Exempt Private Company Limited by S…\n$ paf_constitution_description      &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ entity_status_description         &lt;chr&gt; \"Live Company\", \"Struck Off\", \"Live …\n$ date                              &lt;date&gt; 2024-01-02, 2024-01-02, 2024-01-06,…\n$ uen_issue_date                    &lt;date&gt; 2024-01-02, 2024-01-02, 2024-01-06,…\n$ address_type                      &lt;chr&gt; \"LOCAL\", \"LOCAL\", \"LOCAL\", \"LOCAL\", …\n$ block                             &lt;chr&gt; \"7030\", \"9\", \"67\", \"250\", \"1\", \"371\"…\n$ street_name                       &lt;chr&gt; \"ANG MO KIO AVENUE 5\", \"RAFFLES PLAC…\n$ level_no                          &lt;chr&gt; \"07\", \"19\", \"01\", \"19\", \"01\", \"B1\", …\n$ unit_no                           &lt;chr&gt; \"36\", \"21\", \"459\", \"03\", \"20\", \"60\",…\n$ building_name                     &lt;chr&gt; \"NORTHSTAR @ AMK\", \"REPUBLIC PLAZA\",…\n$ postal_code                       &lt;chr&gt; \"569880\", \"048619\", \"330067\", \"17910…\n$ other_address_line1               &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ other_address_line2               &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ account_due_date                  &lt;chr&gt; \"2026-07-31\", \"2025-07-31\", \"2026-07…\n$ annual_return_date                &lt;chr&gt; \"2025-07-30\", \"na\", \"2025-07-10\", \"2…\n$ primary_ssic_code                 &lt;dbl&gt; 96021, 96021, 96022, 96021, 96021, 9…\n$ primary_ssic_description          &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"BEAUT…\n$ primary_user_described_activity   &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ YEAR                              &lt;dbl&gt; 2024, 2024, 2024, 2024, 2024, 2024, …\n$ MONTH_NUM                         &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, …\n$ MONTH_ABBR                        &lt;ord&gt; Jan, Jan, Jan, Jan, Jan, Jan, Feb, F…\n\n\nThere are 1762 observations we have retrieved for this analysis.\n\n\nDental services\n\nbiz_86204 &lt;- acra_data %&gt;%\n  dplyr::select(1:24) %&gt;%\n  filter(primary_ssic_code == 86204) %&gt;%\n  rename(date = registration_incorporation_date) %&gt;%\n  mutate(date = as.Date(date),\n         YEAR = year(date),\n         MONTH_NUM = month(date),\n         MONTH_ABBR = month(date, label = TRUE, abbr = TRUE)) %&gt;% #this gives Jan, Feb, Mar...\n  mutate(postal_code = str_pad(postal_code,\n                               width = 6, side = \"left\", pad = \"0\")) %&gt;% #if missing digits, will replace with zero.\nfilter(YEAR == 2024 | YEAR == 2025 & MONTH_NUM &lt;= 6)\n\n\nbiz_86204 &lt;- write_rds(biz_86204, \"data/rds/biz_86204.rds\")\n\n\nbiz_86204 &lt;- read_rds(\"data/rds/biz_86204.rds\")\nglimpse(biz_86204)\n\nRows: 81\nColumns: 27\n$ uen                               &lt;chr&gt; \"202401990E\", \"202402057R\", \"2024020…\n$ issuance_agency_id                &lt;chr&gt; \"ACRA\", \"ACRA\", \"ACRA\", \"ACRA\", \"ACR…\n$ entity_name                       &lt;chr&gt; \"AZURE DENTAL PTE. LTD.\", \"ASTER DEN…\n$ entity_type_description           &lt;chr&gt; \"Local Company\", \"Local Company\", \"L…\n$ business_constitution_description &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ company_type_description          &lt;chr&gt; \"Exempt Private Company Limited by S…\n$ paf_constitution_description      &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ entity_status_description         &lt;chr&gt; \"Struck Off\", \"Live Company\", \"Live …\n$ date                              &lt;date&gt; 2024-01-12, 2024-01-13, 2024-01-13,…\n$ uen_issue_date                    &lt;date&gt; 2024-01-12, 2024-01-13, 2024-01-13,…\n$ address_type                      &lt;chr&gt; \"LOCAL\", \"LOCAL\", \"LOCAL\", \"LOCAL\", …\n$ block                             &lt;chr&gt; \"781\", \"111\", \"111\", \"239\", \"1\", \"60…\n$ street_name                       &lt;chr&gt; \"BUKIT TIMAH ROAD\", \"SOMERSET ROAD\",…\n$ level_no                          &lt;chr&gt; \"na\", \"04\", \"04\", \"na\", \"04\", \"15\", …\n$ unit_no                           &lt;chr&gt; \"na\", \"01\", \"01\", \"na\", \"08\", \"01\", …\n$ building_name                     &lt;chr&gt; \"na\", \"111 SOMERSET\", \"111 SOMERSET\"…\n$ postal_code                       &lt;chr&gt; \"269759\", \"238164\", \"238164\", \"79946…\n$ other_address_line1               &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ other_address_line2               &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ account_due_date                  &lt;chr&gt; \"2026-07-31\", \"2026-07-31\", \"2026-07…\n$ annual_return_date                &lt;chr&gt; \"2025-04-07\", \"2025-07-14\", \"2025-07…\n$ primary_ssic_code                 &lt;dbl&gt; 86204, 86204, 86204, 86204, 86204, 8…\n$ primary_ssic_description          &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"DEALI…\n$ primary_user_described_activity   &lt;chr&gt; \"na\", \"na\", \"na\", \"na\", \"na\", \"na\", …\n$ YEAR                              &lt;dbl&gt; 2024, 2024, 2024, 2024, 2024, 2024, …\n$ MONTH_NUM                         &lt;dbl&gt; 1, 1, 1, 2, 3, 3, 4, 4, 2, 2, 4, 5, …\n$ MONTH_ABBR                        &lt;ord&gt; Jan, Jan, Jan, Feb, Mar, Mar, Apr, A…\n\n\nThere are 81 observations we have retrieved for this analysis.\n\n\n\n\n\n2.3 Geocoding\nWe will perform the following in this step: (Avoid doing so for &gt; 5K datasets)\n\nExtract unique postal code from the poastal_code field of the tidied tibble data frame.\nPerform geocode by submitting the postal code to SLA OneMap Reverse Geocode API.\nSave the return results into 2 data frame namely found and not_found.\n\n\n9601960286204\n\n\nBelow is to perform geocoding for the Laundry Services type.\n\npostcodes_9601 &lt;- unique(biz_9601$postal_code)\n\nurl &lt;- \"https://onemap.gov.sg/api/common/elastic/search\"\n\nfound_9601 &lt;- data.frame()\nnot_found_9601 &lt;- data.frame(postcode_9601 = character())\n\nfor (pc_9601 in postcodes_9601) {\n  query_9601 &lt;- list(\n    searchVal = pc_9601,\n    returnGeom = \"Y\",\n    getAddrDetails = \"Y\",\n    pageNum = \"1\"\n  )\n  \n  res_9601 &lt;- GET(url, query = query_9601)\n  json_9601 &lt;- content(res_9601)\n  \n  if(json_9601$found != 0) {\n    df_9601 &lt;- as.data.frame(json_9601$results, stringsAsFactors = FALSE)\n    df_9601$input_postcode_9601 &lt;- pc_9601\n    found_9601 &lt;- bind_rows(found_9601, df_9601)\n  } else{\n    not_found_9601 &lt;- bind_rows(not_found_9601, data.frame(postcode_9601 = pc_9601))\n  }\n}\n\n\n\nBelow is to perform geocoding for the Beauty Services type.\n\npostcodes_9602 &lt;- unique(biz_9602$postal_code)\n\nurl &lt;- \"https://onemap.gov.sg/api/common/elastic/search\"\n\nfound_9602 &lt;- data.frame()\nnot_found_9602 &lt;- data.frame(postcode_9602 = character())\n\nfor (pc_9602 in postcodes_9602) {\n  query_9602 &lt;- list(\n    searchVal = pc_9602,\n    returnGeom = \"Y\",\n    getAddrDetails = \"Y\",\n    pageNum = \"1\"\n  )\n  res_9602 &lt;- GET(url, query = query_9602)\n  json_9602 &lt;- content(res_9602)\n  \n  if(json_9602$found != 0) {\n    df_9602 &lt;- as.data.frame(json_9602$results, stringsAsFactors = FALSE)\n    df_9602$input_postcode_9602 &lt;- pc_9602\n    found_9602 &lt;- bind_rows(found_9602, df_9602)\n  } else{\n    not_found_9602 &lt;- bind_rows(not_found_9602, data.frame(postcode_9602 = pc_9602))\n  }\n}\n\n\n\nBelow is to perform geocoding for the Dental Services type.\n\npostcodes_86204 &lt;- unique(biz_86204$postal_code)\n\nurl &lt;- \"https://onemap.gov.sg/api/common/elastic/search\"\n\nfound_86204 &lt;- data.frame()\nnot_found_86204 &lt;- data.frame(postcode_86204 = character())\n\nfor (pc_86204 in postcodes_86204) {\n  query_86204 &lt;- list(\n    searchVal = pc_86204,\n    returnGeom = \"Y\",\n    getAddrDetails = \"Y\",\n    pageNum = \"1\"\n  )\n  \n  res_86204 &lt;- GET(url, query = query_86204)\n  json_86204 &lt;- content(res_86204)\n  \n  if(json_86204$found != 0) {\n    df_86204 &lt;- as.data.frame(json_86204$results, stringsAsFactors = FALSE)\n    df_86204$input_postcode_86204 &lt;- pc_86204\n    found_86204 &lt;- bind_rows(found_86204, df_86204)\n  } else{\n    not_found_86204 &lt;- bind_rows(not_found_86204, data.frame(postcode_86204 = pc_86204))\n  }\n}\n\n\n\n\n\n\n2.4 Appending the location information\nIn this step, we will append the location information to the business entities based on their postal code.\n\n9601960286204\n\n\nBelow is to perform location appendix for the Laundry Services type.\n\nbiz_9601 = biz_9601 %&gt;%\n  left_join(found_9601,\n            by = c('postal_code' = 'POSTAL'))\n\n\n\nBelow is to perform location appendix for the Beauty Services type.\n\nbiz_9602 = biz_9602 %&gt;%\n  left_join(found_9602,\n            by = c('postal_code' = 'POSTAL'))\n\n\n\nBelow is to perform location appendix for the Dental Services type.\n\nbiz_86204 = biz_86204 %&gt;%\n  left_join(found_86204,\n            by = c('postal_code' = 'POSTAL'))\n\n\n\n\n\n\n2.5 Converting into SF data frame\nNow we will convert the tibble data frame to a sf object.\n\n9601960286204\n\n\nBelow is to convert data type for the Laundry Services type.\n\nbiz_9601_sf &lt;- st_as_sf(biz_9601,\n                         coords = c(\"X\", \"Y\"),\n                         crs = 3414)\nwrite_rds(biz_9601_sf, \"data/rds/biz_9601_sf.rds\")\n\n\nbiz_9601_sf &lt;- read_rds(\"data/rds/biz_9601_sf.rds\")\n\n\n\nBelow is to convert data type for the Beauty Services type.\n\nbiz_9602_sf &lt;- st_as_sf(biz_9602,\n                         coords = c(\"X\", \"Y\"),\n                         crs = 3414)\nwrite_rds(biz_9602_sf, \"data/rds/biz_9602_sf.rds\")\n\n\nbiz_9602_sf &lt;- read_rds(\"data/rds/biz_9602_sf.rds\")\n\n\n\nBelow is to convert data type for the Dental Services type.\n\nbiz_86204_sf &lt;- st_as_sf(biz_86204,\n                         coords = c(\"X\", \"Y\"),\n                         crs = 3414)\nwrite_rds(biz_86204_sf, \"data/rds/biz_86204_sf.rds\")\n\n\nbiz_86204_sf &lt;- read_rds(\"data/rds/biz_86204_sf.rds\")\n\n\n\n\nTake a look at the simple feature data (Laundry service).\n\nkable(head(biz_9601_sf))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nuen\nissuance_agency_id\nentity_name\nentity_type_description\nbusiness_constitution_description\ncompany_type_description\npaf_constitution_description\nentity_status_description\ndate\nuen_issue_date\naddress_type\nblock\nstreet_name\nlevel_no\nunit_no\nbuilding_name\npostal_code\nother_address_line1\nother_address_line2\naccount_due_date\nannual_return_date\nprimary_ssic_code\nprimary_ssic_description\nprimary_user_described_activity\nYEAR\nMONTH_NUM\nMONTH_ABBR\nSEARCHVAL\nBLK_NO\nROAD_NAME\nBUILDING\nADDRESS\nLATITUDE\nLONGITUDE\ninput_postcode_9601\nSEARCHVAL.1\nBLK_NO.1\nROAD_NAME.1\nBUILDING.1\nADDRESS.1\nPOSTAL.1\nX.1\nY.1\nLATITUDE.1\nLONGITUDE.1\nSEARCHVAL.2\nBLK_NO.2\nROAD_NAME.2\nBUILDING.2\nADDRESS.2\nPOSTAL.2\nX.2\nY.2\nLATITUDE.2\nLONGITUDE.2\nSEARCHVAL.3\nBLK_NO.3\nROAD_NAME.3\nBUILDING.3\nADDRESS.3\nPOSTAL.3\nX.3\nY.3\nLATITUDE.3\nLONGITUDE.3\nSEARCHVAL.4\nBLK_NO.4\nROAD_NAME.4\nBUILDING.4\nADDRESS.4\nPOSTAL.4\nX.4\nY.4\nLATITUDE.4\nLONGITUDE.4\nSEARCHVAL.5\nBLK_NO.5\nROAD_NAME.5\nBUILDING.5\nADDRESS.5\nPOSTAL.5\nX.5\nY.5\nLATITUDE.5\nLONGITUDE.5\nSEARCHVAL.6\nBLK_NO.6\nROAD_NAME.6\nBUILDING.6\nADDRESS.6\nPOSTAL.6\nX.6\nY.6\nLATITUDE.6\nLONGITUDE.6\nSEARCHVAL.7\nBLK_NO.7\nROAD_NAME.7\nBUILDING.7\nADDRESS.7\nPOSTAL.7\nX.7\nY.7\nLATITUDE.7\nLONGITUDE.7\nSEARCHVAL.8\nBLK_NO.8\nROAD_NAME.8\nBUILDING.8\nADDRESS.8\nPOSTAL.8\nX.8\nY.8\nLATITUDE.8\nLONGITUDE.8\nSEARCHVAL.9\nBLK_NO.9\nROAD_NAME.9\nBUILDING.9\nADDRESS.9\nPOSTAL.9\nX.9\nY.9\nLATITUDE.9\nLONGITUDE.9\ngeometry\n\n\n\n\n202401518M\nACRA\nALL DAY EVERYDAY PTE. LTD.\nLocal Company\nna\nExempt Private Company Limited by Shares\nna\nLive Company\n2024-01-10\n2024-01-10\nLOCAL\n105\nBISHAN STREET 12\n05\n242\nBISHAN VIEW\n570105\nna\nna\n2026-07-31\n2025-06-29\n96012\nna\nna\n2024\n1\nJan\nBISHAN VIEW\n105\nBISHAN STREET 12\nBISHAN VIEW\n105 BISHAN STREET 12 BISHAN VIEW SINGAPORE 570105\n1.34589493632505\n103.847365252767\n570105\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nPOINT (29563.24 36447.74)\n\n\n202409043N\nACRA\nABENDANCE PTE. LTD.\nLocal Company\nna\nExempt Private Company Limited by Shares\nna\nLive Company\n2024-03-07\n2024-03-07\nLOCAL\n138\nJOO SENG ROAD\n02\n02\nna\n368361\nna\nna\n2026-07-31\n2025-07-01\n96011\nna\nna\n2024\n3\nMar\n138 JOO SENG ROAD SINGAPORE 368361\n138\nJOO SENG ROAD\nNIL\n138 JOO SENG ROAD SINGAPORE 368361\n1.3377756933485\n103.884646509523\n368361\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nPOINT (33712.25 35550.02)\n\n\n202507525N\nACRA\nAWESOME LAUNDRY PTE. LTD.\nLocal Company\nna\nExempt Private Company Limited by Shares\nna\nLive Company\n2025-02-20\n2025-02-20\nLOCAL\n7030\nANG MO KIO AVENUE 5\n02\n11\nNORTHSTAR @ AMK\n569880\nna\nna\n2026-08-31\nna\n96011\nna\nna\n2025\n2\nFeb\nBANYAN TREE EDUCATION @ AMK\n7030\nANG MO KIO AVENUE 5\nBANYAN TREE EDUCATION @ AMK\n7030 ANG MO KIO AVENUE 5 BANYAN TREE EDUCATION @ AMK SINGAPORE 569880\n1.37792345221534\n103.875389838376\n569880\nDISCOVERY PLANET LIMITED PARTNERSHIP\n7030\nANG MO KIO AVENUE 5\nDISCOVERY PLANET LIMITED PARTNERSHIP\n7030 ANG MO KIO AVENUE 5 DISCOVERY PLANET LIMITED PARTNERSHIP SINGAPORE 569880\n569880\n32682.0063954461\n39989.3313855752\n1.37792345221534\n103.875389838376\nESHKOL VALLEY @ NORTHSTAR PTE. LTD.\n7030\nANG MO KIO AVENUE 5\nESHKOL VALLEY @ NORTHSTAR PTE. LTD.\n7030 ANG MO KIO AVENUE 5 ESHKOL VALLEY @ NORTHSTAR PTE. LTD. SINGAPORE 569880\n569880\n32682.0063954461\n39989.3313855752\n1.37792345221534\n103.875389838376\nLITTLE FOOTPRINTS SCHOOLHOUSE (AMK) PTE. LTD.\n7030\nANG MO KIO AVENUE 5\nLITTLE FOOTPRINTS SCHOOLHOUSE (AMK) PTE. LTD.\n7030 ANG MO KIO AVENUE 5 LITTLE FOOTPRINTS SCHOOLHOUSE (AMK) PTE. LTD. SINGAPORE 569880\n569880\n32682.0063954461\n39989.3313855752\n1.37792345221534\n103.875389838376\nLUCAS CHILDREN ACADEMY PTE. LTD.\n7030\nANG MO KIO AVENUE 5\nLUCAS CHILDREN ACADEMY PTE. LTD.\n7030 ANG MO KIO AVENUE 5 LUCAS CHILDREN ACADEMY PTE. LTD. SINGAPORE 569880\n569880\n32682.0063954461\n39989.3313855752\n1.37792345221534\n103.875389838376\nNORTHSTAR @ AMK\n7030\nANG MO KIO AVENUE 5\nNORTHSTAR @ AMK\n7030 ANG MO KIO AVENUE 5 NORTHSTAR @ AMK SINGAPORE 569880\n569880\n32700.5844903681\n39939.0796920396\n1.37746899102804\n103.875556768146\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nPOINT (32682.01 39989.33)\n\n\n202527692C\nACRA\nASH + EVE PTE. LTD.\nLocal Company\nna\nPrivate Company Limited by Shares\nna\nLive Company\n2025-06-26\n2025-06-26\nLOCAL\n160\nROBINSON ROAD\n14\n04\nSINGAPORE BUSINESS FEDERATION CENTER\n068914\nna\nna\n2026-12-31\nna\n96012\nna\nna\n2025\n6\nJun\nSINGAPORE BUSINESS FEDERATION CENTER (SBF CENTER)\n160\nROBINSON ROAD\nSINGAPORE BUSINESS FEDERATION CENTER (SBF CENTER)\n160 ROBINSON ROAD SINGAPORE BUSINESS FEDERATION CENTER (SBF CENTER) SINGAPORE 068914\n1.27812790985944\n103.847854628243\n068914\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nPOINT (29617.75 28954.42)\n\n\n53489069E\nACRA\nAQUAFRESH EXPRESS\nSole Proprietorship/ Partnership\nSole-Proprietor\nna\nna\nCeased Registration\n2024-07-24\n2024-07-24\nLOCAL\n842G\nTAMPINES STREET 82\n14\n86\nTAMPINES ARCADIA\n527842\nna\nna\nna\nna\n96012\nna\nna\n2024\n7\nJul\nTAMPINES ARCADIA\n842G\nTAMPINES STREET 82\nTAMPINES ARCADIA\n842G TAMPINES STREET 82 TAMPINES ARCADIA SINGAPORE 527842\n1.35207674741611\n103.937111715862\n527842\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nPOINT (39551.01 37131.54)\n\n\n53503312E\nACRA\nA & B LAUNDRY\nSole Proprietorship/ Partnership\nPartnership\nna\nna\nLive\n2025-04-30\n2025-04-30\nLOCAL\n5\nKIM CHUAN TERRACE\nna\nna\nna\n537028\nna\nna\nna\nna\n96012\nna\nna\n2025\n4\nApr\n5 KIM CHUAN TERRACE SINGAPORE 537028\n5\nKIM CHUAN TERRACE\nNIL\n5 KIM CHUAN TERRACE SINGAPORE 537028\n1.33932059888709\n103.890529559767\n537028\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nPOINT (34366.97 35720.86)\n\n\n\n\n\n\n\n2.6 Import geospatial data into R\nThe Master Plan 2019 Boundary (No Sea) (KML) was downloaded from data.gov.sg that consists of the geographical boundary of Singapore at the planning subzone level. The data is based on URA Master Plan 2019. We will use this to plot the boundaries of the subzones.\n\nImport dataTidy dataCheck data\n\n\n\nmpsz &lt;- st_read(\"data/geospatial/MasterPlan2019SubzoneBoundaryNoSeaKML.kml\") %&gt;%\n  st_zm(drop = TRUE, what = \"ZM\") %&gt;%\n  st_transform(crs = 3414)\n\n\n\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)\n  rows &lt;- page %&gt;% html_elements(\"tr\")\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;%\n    html_element(\"td\") %&gt;%\n    html_text2()\n  \n  if (length(value) == 0) NA_character_ else value\n}\n\nmpsz &lt;- mpsz %&gt;%\n  mutate(\n    REGION_N = map_chr(Description, extract_kml_field, \"REGION_N\"),\n    PLN_AREA_N = map_chr(Description, extract_kml_field, \"PLN_AREA_N\"),\n    SUBZONE_N = map_chr(Description, extract_kml_field, \"SUBZONE_N\"),\n    SUBZONE_C = map_chr(Description, extract_kml_field, \"SUBZONE_C\")\n  ) %&gt;%\n  dplyr::select(-Name, -Description) %&gt;%\n  relocate(geometry, .after = last_col())\n\nmpsz_cl &lt;- mpsz %&gt;%\n  filter(SUBZONE_N != \"SOUTHERN GROUP\",\n         PLN_AREA_N != \"WESTERN ISLANDS\",\n         PLN_AREA_N != \"NORTH-EASTERN ISLANDS\")\n\n\n\n\nwrite_rds(mpsz_cl, \"data/rds/mpsz_cl.rds\")\n\n\nmpsz_cl &lt;- read_rds(\"data/rds/mpsz_cl.rds\")\n\n\nkable(head(mpsz_cl))\n\n\n\n\n\n\n\n\n\n\n\nREGION_N\nPLN_AREA_N\nSUBZONE_N\nSUBZONE_C\ngeometry\n\n\n\n\nCENTRAL REGION\nBUKIT MERAH\nDEPOT ROAD\nBMSZ12\nMULTIPOLYGON (((25910.34 29…\n\n\nCENTRAL REGION\nBUKIT MERAH\nBUKIT MERAH\nBMSZ02\nMULTIPOLYGON (((26750.09 29…\n\n\nCENTRAL REGION\nOUTRAM\nCHINATOWN\nOTSZ03\nMULTIPOLYGON (((29161.2 297…\n\n\nCENTRAL REGION\nDOWNTOWN CORE\nPHILLIP\nDTSZ04\nMULTIPOLYGON (((29814.11 29…\n\n\nCENTRAL REGION\nDOWNTOWN CORE\nRAFFLES PLACE\nDTSZ05\nMULTIPOLYGON (((30137.77 29…\n\n\nCENTRAL REGION\nOUTRAM\nCHINA SQUARE\nOTSZ04\nMULTIPOLYGON (((29699.44 29…\n\n\n\n\n\n\n\n\n\n\n2.7 Prepare population data\n\nImport dataData wranglingJoin population and geospatial data\n\n\n\npopdata &lt;- read_csv(\"data/aspatial/respopagesextod2024.csv\")\n\n\n\n\npopdata2024 &lt;- popdata %&gt;%\n  group_by(PA, SZ) %&gt;%\n  summarise(TOTAL_POP = sum(`Pop`)) %&gt;%\n  ungroup() \n\n\nwrite_rds(popdata2024, \"data/rds/popdata2024.rds\")\n\n\npopdata2024 &lt;- read_rds(\"data/rds/popdata2024.rds\")\nkable(head(popdata2024))\n\n\n\n\nPA\nSZ\nTOTAL_POP\n\n\n\n\nAng Mo Kio\nAng Mo Kio Town Centre\n4910\n\n\nAng Mo Kio\nCheng San\n27040\n\n\nAng Mo Kio\nChong Boon\n25310\n\n\nAng Mo Kio\nKebun Bahru\n22090\n\n\nAng Mo Kio\nSembawang Hills\n6920\n\n\nAng Mo Kio\nShangri-La\n17570\n\n\n\n\n\n\n\nUse left_join to join the population data and geospatial data.\n\npopdata2024 &lt;- popdata2024 %&gt;%\n  mutate_at(.vars = vars(PA, SZ),\n            .funs = list(toupper)) %&gt;%\n  filter(`TOTAL_POP` &gt; 0)\nmpsz_pop2024 &lt;- left_join(mpsz_cl, popdata2024,\n                          by = c(\"SUBZONE_N\" = \"SZ\"))\n\nThen write it into a rds file.\n\nwrite_rds(mpsz_pop2024, \"data/rds/mpsz_pop2024.rds\")\n\nWe will call it from rds file to save computation.\n\nmpsz_pop2024 &lt;- read_rds(\"data/rds/mpsz_pop2024.rds\")"
  },
  {
    "objectID": "geospatial/proj_1/test.html#first-order-analysis",
    "href": "geospatial/proj_1/test.html#first-order-analysis",
    "title": "Spatial Analysis of Essential Services in Singapore - Laundry, Beauty & Dental Business",
    "section": "3 First-order Analysis",
    "text": "3 First-order Analysis\nIn this section, we will work on first-order analysis to understand the point patterns for laundry, beauty, and dental services and to learn how event density varies across space.\n\nLaundry ServicesBeauty ServicesDental Services\n\n\n\nMapping geospatial data sets\n\npar(bg = \"#EEEEEE\")\nplot(st_geometry(mpsz_cl), border = \"grey70\")\nplot(st_geometry(biz_9601_sf), add = TRUE, col = \"#FF9800\", pch = 16, cex = 0.8)\n\n\n\n\n\n\n\n\n\n\nMapping with population\n\npar(bg = \"#EEEEEE\")\n\ntmap::tm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"TOTAL_POP\", \n          col = \"#7077A1\", lwd = 0.3) +\ntmap::tm_shape(biz_9601_sf) +\n  tm_dots(fill = \"orange\", size = 0.3, fill_alpha = 0.9) +\ntm_layout(bg.color =  \"#EEEEEE\",\n          outer.bg.color = NA,\n          frame = FALSE,\n          legend.bg.color = \"transparent\",      \n          legend.frame = FALSE)\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\nNew laundry businesses show a clear spatial pattern that aligns with both residential density and commercial activity.\nResidential Area Patterns: Laundry businesses concentrate in high-density residential areas. Areas with lower population density show correspondingly fewer or no new laundry establishments, which suggests a strong relationship between residential demand and business location decisions.\nCommercial District Concentration: The Central Business District (CBD) exhibits high concentrations of new laundry businesses. It likely serves the large working population who require convenient dry cleaning services near their workplaces.\nSpatial Distribution: This dual pattern - clustering in both high-density residential areas and the CBD, indicates that laundry services strategically locate to serve both residential neighborhoods and working professionals.\n\n\n\n\n\n\nMapping geospatial data sets\n\npar(bg = \"#EEEEEE\")\nplot(st_geometry(mpsz_cl), border = \"grey70\")\nplot(st_geometry(biz_9602_sf), add = TRUE, col = \"#BA487F\", pch = 16, cex = 0.5)\n\n\n\n\n\n\n\n\n\n\nMapping with population\n\npar(bg = \"#EEEEEE\")\n#tmap_mode(\"plot\")\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(col = \"TOTAL_POP\", \n          border.col = \"#7077A1\", lwd = 0.3) +\ntm_shape(biz_9602_sf) +\n  tm_dots(col = \"deeppink3\", size = 0.2, alpha = 0.9) +\ntm_layout(bg.color =  \"#EEEEEE\",\n          outer.bg.color = NA,\n          frame = FALSE,\n          legend.bg.color = \"transparent\",      \n          legend.frame = FALSE)\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\nNew beauty service establishments show a spatial pattern similar to laundry services, but with significantly higher overall density concentrations.\nResidential Area Distribution: In residential neighborhoods, beauty services show a more dispersed pattern compared to the central areas. While the density of new establishments correlates positively with residential population levels, areas with low population still have few business providers. Even for non-residential areas in the west, there are also new businesses there, likely to serve working professional or representing locations of chain store offices.\nCommercial Center Concentration: Beauty services demonstrate particularly strong density in central south areas, likely targeting areas with high concentrations of commercial buildings and shopping centers. This concentration is even more evident than that observed for laundry services.\n\n\n\n\n\n\nMapping geospatial data sets\n\npar(bg = \"#EEEEEE\")\nplot(st_geometry(mpsz_cl), border = \"grey70\")\nplot(st_geometry(biz_86204_sf), add = TRUE, col = \"#18978F\", pch = 16, cex = 0.8)\n\n\n\n\n\n\n\n\n\n\nMapping with population\n\npar(bg = \"#EEEEEE\")\ntmap_mode(\"plot\")\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(col = \"TOTAL_POP\", \n          border.col = \"#7077A1\", lwd = 0.3) +\ntm_shape(biz_86204_sf) +\n  tm_dots(col = \"darkcyan\", size = 0.3, alpha = 0.9) +\ntm_layout(bg.color =  \"#EEEEEE\",\n          outer.bg.color = NA,\n          frame = FALSE,\n          legend.bg.color = \"transparent\",      \n          legend.frame = FALSE)\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\nDental service establishments display a distinctly different spatial pattern compared to laundry and beauty services and show a more selective location strategy.\nSelective Geographic Distribution: Unlike the other 2 business types, dental services do not establish in every subzone. Instead, they cluster in specific subzones. They also have a clear preference for central locations over residential areas.\nCentral Location Dominance: The majority of new dental services concentrate in central Singapore, significantly outnumbering those in residential areas. This pattern suggests that dental practices strategically locate in medical or commercial buildingswhere they can serve a broader catchment area.\nLimited Residential Presence: While some new dental services do establish in residential neighborhoods, these are relatively few and appear in select subzones only. This selective distribution indicates that residential areas are not the preferred location type for new dental businesses. This is likely due to different service requirements and patient accessibility needs compared to laundry and beauty services.\n\n\n\n\n\n\n\n3.1 Spatial KDE\nTo compute the businesses’ spatial KDE, we will first perform data wrangling before we compute KDE and plot the results.\n\n3.1.1 Geospatial data wrangling\nIn this section, we will convert the sf objects to spatstat ppp and owin object.\n\nLaundry ServicesBeauty ServicesDental Services\n\n\nConvert sf data frames to ppp class\n\nbiz_9601_ppp &lt;- as.ppp(biz_9601_sf)\nwrite_rds(biz_9601_ppp, \"data/rds/biz_9601_ppp.rds\")\n\n\nbiz_9601_ppp &lt;- read_rds(\"data/rds/biz_9601_ppp.rds\")\n\nCreate Owin object\n\nsg_owin &lt;- as.owin(mpsz_cl)\n\nCombine point events object and owin object\n\nbiz_9601_ppp = biz_9601_ppp[sg_owin]\nbiz_9601_ppp\n\nMarked planar point pattern: 150 points\nMark variables: \n   uen issuance_agency_id entity_name entity_type_description \nbusiness_constitution_description company_type_description \npaf_constitution_description entity_status_description date uen_issue_date \naddress_type block street_name level_no unit_no building_name postal_code \nother_address_line1 other_address_line2 account_due_date annual_return_date \nprimary_ssic_code primary_ssic_description primary_user_described_activity YEAR \nMONTH_NUM MONTH_ABBR SEARCHVAL BLK_NO ROAD_NAME BUILDING ADDRESS LATITUDE \nLONGITUDE input_postcode_9601 SEARCHVAL.1 BLK_NO.1 ROAD_NAME.1 BUILDING.1 \nADDRESS.1 POSTAL.1 X.1 Y.1 LATITUDE.1 LONGITUDE.1 SEARCHVAL.2 BLK_NO.2 \nROAD_NAME.2 BUILDING.2 ADDRESS.2 POSTAL.2 X.2 Y.2 LATITUDE.2 LONGITUDE.2 \nSEARCHVAL.3 BLK_NO.3 ROAD_NAME.3 BUILDING.3 ADDRESS.3 POSTAL.3 X.3 Y.3 \nLATITUDE.3 LONGITUDE.3 SEARCHVAL.4 BLK_NO.4 ROAD_NAME.4 BUILDING.4 ADDRESS.4 \nPOSTAL.4 X.4 Y.4 LATITUDE.4 LONGITUDE.4 SEARCHVAL.5 BLK_NO.5 ROAD_NAME.5 \nBUILDING.5 ADDRESS.5 POSTAL.5 X.5 Y.5 LATITUDE.5 LONGITUDE.5 SEARCHVAL.6 \nBLK_NO.6 ROAD_NAME.6 BUILDING.6 ADDRESS.6 POSTAL.6 X.6 Y.6 LATITUDE.6 \nLONGITUDE.6 SEARCHVAL.7 BLK_NO.7 ROAD_NAME.7 BUILDING.7 ADDRESS.7 POSTAL.7 X.7 \nY.7 LATITUDE.7 LONGITUDE.7 SEARCHVAL.8 BLK_NO.8 ROAD_NAME.8 BUILDING.8 \nADDRESS.8 POSTAL.8 X.8 Y.8 LATITUDE.8 LONGITUDE.8 SEARCHVAL.9 BLK_NO.9 \nROAD_NAME.9 BUILDING.9 ADDRESS.9 POSTAL.9 X.9 Y.9 LATITUDE.9 LONGITUDE.9\nwindow: polygonal boundary\nenclosing rectangle: [2667.54, 55941.94] x [21448.47, 50256.33] units\n\n\n\n\nConvert sf data frames to ppp class\n\nbiz_9602_ppp &lt;- as.ppp(biz_9602_sf)\nwrite_rds(biz_9602_ppp, \"data/rds/biz_9602_ppp.rds\")\n\n\nbiz_9602_ppp &lt;- read_rds(\"data/rds/biz_9602_ppp.rds\")\n\nCombine point events object and owin object\n\nbiz_9602_ppp = biz_9602_ppp[sg_owin]\nbiz_9602_ppp\n\nMarked planar point pattern: 1762 points\nMark variables: \n   uen issuance_agency_id entity_name entity_type_description \nbusiness_constitution_description company_type_description \npaf_constitution_description entity_status_description date uen_issue_date \naddress_type block street_name level_no unit_no building_name postal_code \nother_address_line1 other_address_line2 account_due_date annual_return_date \nprimary_ssic_code primary_ssic_description primary_user_described_activity YEAR \nMONTH_NUM MONTH_ABBR SEARCHVAL BLK_NO ROAD_NAME BUILDING ADDRESS LATITUDE \nLONGITUDE SEARCHVAL.1 BLK_NO.1 ROAD_NAME.1 BUILDING.1 ADDRESS.1 POSTAL.1 X.1 \nY.1 LATITUDE.1 LONGITUDE.1 SEARCHVAL.2 BLK_NO.2 ROAD_NAME.2 BUILDING.2 \nADDRESS.2 POSTAL.2 X.2 Y.2 LATITUDE.2 LONGITUDE.2 SEARCHVAL.3 BLK_NO.3 \nROAD_NAME.3 BUILDING.3 ADDRESS.3 POSTAL.3 X.3 Y.3 LATITUDE.3 LONGITUDE.3 \nSEARCHVAL.4 BLK_NO.4 ROAD_NAME.4 BUILDING.4 ADDRESS.4 POSTAL.4 X.4 Y.4 \nLATITUDE.4 LONGITUDE.4 SEARCHVAL.5 BLK_NO.5 ROAD_NAME.5 BUILDING.5 ADDRESS.5 \nPOSTAL.5 X.5 Y.5 LATITUDE.5 LONGITUDE.5 input_postcode_9602 SEARCHVAL.6 \nBLK_NO.6 ROAD_NAME.6 BUILDING.6 ADDRESS.6 POSTAL.6 X.6 Y.6 LATITUDE.6 \nLONGITUDE.6 SEARCHVAL.7 BLK_NO.7 ROAD_NAME.7 BUILDING.7 ADDRESS.7 POSTAL.7 X.7 \nY.7 LATITUDE.7 LONGITUDE.7 SEARCHVAL.8 BLK_NO.8 ROAD_NAME.8 BUILDING.8 \nADDRESS.8 POSTAL.8 X.8 Y.8 LATITUDE.8 LONGITUDE.8 SEARCHVAL.9 BLK_NO.9 \nROAD_NAME.9 BUILDING.9 ADDRESS.9 POSTAL.9 X.9 Y.9 LATITUDE.9 LONGITUDE.9\nwindow: polygonal boundary\nenclosing rectangle: [2667.54, 55941.94] x [21448.47, 50256.33] units\n\n\n\n\nConvert sf data frames to ppp class\n\nbiz_86204_ppp &lt;- as.ppp(biz_86204_sf)\nwrite_rds(biz_86204_ppp, \"data/rds/biz_86204_ppp.rds\")\n\n\nbiz_86204_ppp &lt;- read_rds(\"data/rds/biz_86204_ppp.rds\")\n\nCombine point events object and owin object\n\nbiz_86204_ppp = biz_86204_ppp[sg_owin]\nbiz_86204_ppp\n\nMarked planar point pattern: 81 points\nMark variables: \n   uen issuance_agency_id entity_name entity_type_description \nbusiness_constitution_description company_type_description \npaf_constitution_description entity_status_description date uen_issue_date \naddress_type block street_name level_no unit_no building_name postal_code \nother_address_line1 other_address_line2 account_due_date annual_return_date \nprimary_ssic_code primary_ssic_description primary_user_described_activity YEAR \nMONTH_NUM MONTH_ABBR SEARCHVAL BLK_NO ROAD_NAME BUILDING ADDRESS LATITUDE \nLONGITUDE input_postcode_86204 SEARCHVAL.1 BLK_NO.1 ROAD_NAME.1 BUILDING.1 \nADDRESS.1 POSTAL.1 X.1 Y.1 LATITUDE.1 LONGITUDE.1 SEARCHVAL.2 BLK_NO.2 \nROAD_NAME.2 BUILDING.2 ADDRESS.2 POSTAL.2 X.2 Y.2 LATITUDE.2 LONGITUDE.2 \nSEARCHVAL.3 BLK_NO.3 ROAD_NAME.3 BUILDING.3 ADDRESS.3 POSTAL.3 X.3 Y.3 \nLATITUDE.3 LONGITUDE.3 SEARCHVAL.4 BLK_NO.4 ROAD_NAME.4 BUILDING.4 ADDRESS.4 \nPOSTAL.4 X.4 Y.4 LATITUDE.4 LONGITUDE.4 SEARCHVAL.5 BLK_NO.5 ROAD_NAME.5 \nBUILDING.5 ADDRESS.5 POSTAL.5 X.5 Y.5 LATITUDE.5 LONGITUDE.5\nwindow: polygonal boundary\nenclosing rectangle: [2667.54, 55941.94] x [21448.47, 50256.33] units\n\n\n\n\n\n\n\n3.1.2 Clark-Evans test\nIn this section, we will perform Clark-Evans tests for the 3 business entities separately, to quantify whether a point pattern is clustered, random, or uniformly spaced. The result will help us understand the underlying spatial patterns of each business type. This will inform our interpretation of the subsequent KDE analysis.\n\nLaundry ServicesBeauty ServicesDental Services\n\n\nThe test hypotheses are:\nH₀ = The distribution of laundry services are randomly distributed.\nH₁ = The distribution of laundry services are not randomly distributed.\nThe 95% confident interval will be used.\n\nset.seed(1234)\nclarkevans_9601 &lt;- clarkevans.test(biz_9601_ppp,\n                correction=\"none\",\n                clipregion=\"sg_owin\",\n                alternative=c(\"clustered\"),\n                method=\"MonteCarlo\",\n                nsim=99)\n\nwrite_rds(clarkevans_9601, \"data/rds/clarkevans_9601.rds\")\n\n\nclarkevans_9601 &lt;- read_rds(\"data/rds/clarkevans_9601.rds\")\nclarkevans_9601\n\n\n    Clark-Evans test\n    No edge correction\n    Monte Carlo test based on 99 simulations of CSR with fixed n\n\ndata:  biz_9601_ppp\nR = 0.59188, p-value = 0.01\nalternative hypothesis: clustered (R &lt; 1)\n\n\n\n\nInsight\n\n\nLaundry service R = 0.59183 & p-value = 0.05 shows the distribution is not random. As R value is between 0.5-1.0, there are some clustering in residential areas. It is more dispersed to serve neighbourhood needs, but it is not random.\n\n\n\n\nThe test hypotheses are:\nH₀ = The distribution of beauty services are randomly distributed.\nH₁ = The distribution of beauty services are not randomly distributed. ’\nThe 95% confident interval will be used.\n\nset.seed(1234)\nclarkevans_9602 &lt;- clarkevans.test(biz_9602_ppp,\n                correction=\"none\",\n                clipregion=\"sg_owin\",\n                alternative=c(\"clustered\"),\n                method=\"MonteCarlo\",\n                nsim=99)\nwrite_rds(clarkevans_9602, \"data/rds/clarkevans_9602.rds\")\n\n\nclarkevans_9602 &lt;- read_rds(\"data/rds/clarkevans_9602.rds\")\nclarkevans_9602\n\n\n    Clark-Evans test\n    No edge correction\n    Monte Carlo test based on 99 simulations of CSR with fixed n\n\ndata:  biz_9602_ppp\nR = 0.35847, p-value = 0.01\nalternative hypothesis: clustered (R &lt; 1)\n\n\n\n\nInsight\n\n\nBeauty services R = 0.35901 & p-value = 0.05 indicates that they are not random. The R value is 0.0-0.5, showing strong clustering, meaning that the points are very close together.\n\n\n\n\nThe test hypotheses are:\nH₀ = The distribution of dental services are randomly distributed.\nH₁ = The distribution of dental services are not randomly distributed.\nThe 95% confident interval will be used.\n\nset.seed(1234)\nclarkevans_86204 &lt;- clarkevans.test(biz_86204_ppp,\n                correction=\"none\",\n                clipregion=\"sg_owin\",\n                alternative=c(\"clustered\"),\n                method=\"MonteCarlo\",\n                nsim=99)\nwrite_rds(clarkevans_86204, \"data/rds/clarkevans_86204.rds\")\n\n\nclarkevans_86204 &lt;- read_rds(\"data/rds/clarkevans_86204.rds\")\nclarkevans_86204\n\n\n    Clark-Evans test\n    No edge correction\n    Monte Carlo test based on 99 simulations of CSR with fixed n\n\ndata:  biz_86204_ppp\nR = 0.49038, p-value = 0.01\nalternative hypothesis: clustered (R &lt; 1)\n\n\n\n\nInsight\n\n\nDental service R = 0.49038 & p-value = 0.05, so the distribution of dental businesses are not random. As R value is around 0.5, it shows moderate to strong clustering. This is possibly due to medical professional buildings or proximity to hospitals.\n\n\n\n\n\n\n\n3.1.3 Compute KDE with automatic bandwidth\nNow we will compute KDE to visualise and analyse first-order spatial point patterns. We use automatic bandwidth and smoothing kernel “gaussian” to derive the results.\n\nLaundry ServicesBeauty ServicesDental Services\n\n\n\nbiz_9601_ppp_km &lt;- rescale.ppp(biz_9601_ppp, 1000, \"km\")\nbw.ppl(biz_9601_ppp_km)\n\n   sigma \n1.247144 \n\n\n\npar(bg = \"#EEEEEE\")\n\nkde_biz_9601_ab &lt;- density(\n  biz_9601_ppp_km, sigma = bw.ppl, edge = TRUE, kernel = \"gaussian\"\n)\nplot(kde_biz_9601_ab, main = \"bw.ppl\",\n     col = terrain.colors(256))\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\nThe KDE output reveals a clustered spatial pattern with distinct concentration hierarchies across Singapore.\nTwo major clusters dominate the distribution pattern. The highest density cluster is located in the city center area, coinciding with areas of intense commercial activity. A secondary major cluster is still within the central area (Chinatown, Boat Quay) with lower but still significant density values. Other clusters of much lower density are distributed across northern, eastern, and western Singapore.\nInterestingly, these density areas show connectivity patterns, forming corridors or networks that link different concentration areas. This creates an integrated service network rather than isolated hot spots. The overall pattern suggests that the laundry services concentrate heavily in commercial centers for maximum accessibility, while maintaining smaller service nodes throughout residential areas to ensure neighborhood-level coverage.\n\n\n\n\n\nbiz_9602_ppp_km &lt;- rescale.ppp(biz_9602_ppp, 1000, \"km\")\nbw.ppl(biz_9602_ppp_km)\n\n    sigma \n0.4404606 \n\n\n\npar(bg = \"#EEEEEE\")\nkde_biz_9602_ab &lt;- density(\n  biz_9602_ppp_km, sigma = bw.ppl, edge = TRUE, kernel = \"gaussian\"\n)\nplot(kde_biz_9602_ab, main = \"bw.ppl\",\n     col = terrain.colors(256))\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\nThe automatic bandwidth KDE output reveals a clustered pattern with multiple major concentration areas of varying intensities. Several highest density clusters (with density values reaching 60+) are located in the central region, where both commercial and residential activities converge. These hot spots show much higher density values compared to laundry services, indicating greater market concentration.\nAdditional clustering of lower density is distributed across northern, eastern, and western Singapore. These smaller clusters maintain strategic proximity to residential areas, serving both living and working communities.\nThe overall pattern suggests that beauty services are heavily concentrated in commercial/shopping centers with many other satellite clusters in residential areas to serve nearby residents.\n\n\n\n\n\nbiz_86204_ppp_km &lt;- rescale.ppp(biz_86204_ppp, 1000, \"km\")\nbw.ppl(biz_86204_ppp_km)\n\n   sigma \n1.519248 \n\n\n\npar(bg = \"#EEEEEE\")\nkde_biz_86204_ab &lt;- density(\n  biz_86204_ppp_km, sigma = bw.ppl, edge = TRUE, kernel = \"gaussian\"\n)\nplot(kde_biz_86204_ab, main = \"bw.ppl\",\n     col = terrain.colors(256))\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\nThe dental services KDE output reveals very concentrated clustered pattern with only few major concentration areas of varying intensities. The largest cluster is located at the central region, followed by a few satellite clusters in residential areas.\nThis shows that the overall new dental services employ a central-focused strategy for location, with most clinics located in large medical, commercial, or office buildings, rather than neighborhood buildings. Since residents normally visit dental clinics 1-2 times a year, dental businesses likely locate centrally to cater the service to a broader customers base, so as to ensrure the location is conveniently accessible by the majority of customers.\n\n\n\n\n\n\n\n\n3.2 Spatio-Temporal KDE\nJaundry, Beauty, and Dental business types have 150, 1762 and 81 points respectively during Jan 2024 - June 2025. In this study, we will slice the data compute quarterly spatio-temporal KDE to understand seasonal patterns.\n\n3.2.1 Visualise business entity points by quarter\n\nLaundry ServicesBeauty ServicesDental Services\n\n\n\nbiz_9601_quarter &lt;- biz_9601_sf %&gt;%\n  mutate(\n    quarter = case_when(\n      MONTH_NUM %in% c(1, 2, 3) ~ \"Q1\",\n      MONTH_NUM %in% c(4, 5, 6) ~ \"Q2\",\n      MONTH_NUM %in% c(7, 8, 9) ~ \"Q3\",\n      MONTH_NUM %in% c(10, 11, 12) ~ \"Q4\"\n    ),\n    year_quarter = paste(YEAR, quarter, sep = \"-\")\n  )\n\ntmap_options(bg.color = \"#EEEEEE\")\ntm_shape(mpsz_pop2024) + \n  tm_polygons(fill = \"#FFF2F2\", col = \"grey80\") +\ntm_shape(biz_9601_quarter) +\n  tm_dots(fill =\"#476EAE\", size = 0.4) +\n  tm_facets(by = \"year_quarter\", free.coords = FALSE, drop.units = TRUE,\n            ncol = 2) +\ntm_layout(\n    main.title = \"Laundry Services - Quarterly Density\",\n    bg.color = \"#EED3D9\")\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\nThe visualisation above shows the new laundry businesses spatial patters by quarter from 2024-Q1 to 2025-Q2. Several dustubct temporal trends are evident.\n\nNorthern areas: After notable laundry service establishments in northern Singapore during the first half of 2024 (Q1-Q2), new business openings in this region significantly decreased, with zero to very few establishments in subsequent quarters.\nOther areas: On the other hand, the central and eastern regions show sustained business growth throughout the study period and maintained consistent establishment patterns across all quarters.\n\n\n\n\n\n\nbiz_9602_quarter &lt;- biz_9602_sf %&gt;%\n  mutate(\n    quarter = case_when(\n      MONTH_NUM %in% c(1, 2, 3) ~ \"Q1\",\n      MONTH_NUM %in% c(4, 5, 6) ~ \"Q2\",\n      MONTH_NUM %in% c(7, 8, 9) ~ \"Q3\",\n      MONTH_NUM %in% c(10, 11, 12) ~ \"Q4\"\n    ),\n    year_quarter = paste(YEAR, quarter, sep = \"-\")\n  )\n\ntmap_options(bg.color = \"#EEEEEE\")\ntm_shape(mpsz_pop2024) + \n  tm_polygons(fill = \"#FFF2F2\", col = \"grey80\") +\ntm_shape(biz_9602_quarter) +\n  tm_dots(fill =\"#BA487F\", size = 0.2) +\n  tm_facets(by = \"year_quarter\", free.coords = FALSE, drop.units = TRUE,\n            ncol = 2) +\ntm_layout(\n    main.title = \"Beauty Services - Quarterly Density\",\n    bg.color = \"#CADABF\")\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\nThe point patterns revealed in the 6 plots above explains consistent growth of the beauty services in both residential and commercial areas, with more density in the city center. Similar to other businesses, the beauty salons or shops may concentrate in commercial / shopping centers in the city center, hence the higher density. There are also beauty services catering to residential areas for easy access at customers’ convenience.\n\n\n\n\n\nbiz_86204_quarter &lt;- biz_86204_sf %&gt;%\n  mutate(\n    quarter = case_when(\n      MONTH_NUM %in% c(1, 2, 3) ~ \"Q1\",\n      MONTH_NUM %in% c(4, 5, 6) ~ \"Q2\",\n      MONTH_NUM %in% c(7, 8, 9) ~ \"Q3\",\n      MONTH_NUM %in% c(10, 11, 12) ~ \"Q4\"\n    ),\n    year_quarter = paste(YEAR, quarter, sep = \"-\")\n  )\n\ntmap_options(bg.color = \"#EEEEEE\")\ntm_shape(mpsz_pop2024) + \n  tm_polygons(fill = \"#FFF2F2\", col = \"grey80\") +\n  tm_shape(biz_86204_quarter) +\n  tm_dots(fill = \"#EF7722\", size = 0.4) +\n  tm_facets(by = \"year_quarter\", free.coords = FALSE, drop.units = TRUE,\n            ncol = 2) +\ntm_layout(\n    main.title = \"Dental Services - Quarterly Density\",\n    bg.color = \"#B5C0D0\")\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\nDental service establishments demonstrate a distinctly concentrated spatial strategy with consistent temporal patterns throughout the six quarters from January 2024 to June 2025.\nCentral Region Dominance: New dental services show persistent clustering in central Singapore across all quarters, indicating this area’s strategic importance for dental practice viability. This central concentration likely reflects proximity to medical districts and commercial centers that maximize patient accessibility.\nRegional Distribution Patterns: For northern Singapore, it consistently shows minimal to zero new establishments, suggesting either market saturation or unfavorable conditions for dental practice development. In wester areas, there is very imited expansion and indicates geographic constraints on viable dental service locations. Only in the eastern region it shows moderate but consistent activity - this may suggest emerging opportunities in this specific residential areas.\nThis pattern also shows that dental healthcare accessibility gaps do exist in northern and outer western areas. Future urban planning should consider medical service corridors to improve healthcare distribution in underserved areas.\n\n\n\n\n\n\n\n3.2.2 Compute Spatio-Temporal STKDE by quarter\n\nLaundry ServicesBeauty ServicesDental Services\n\n\n# extract laundry data by quarter\nkde_biz_9601_quarter &lt;- biz_9601_quarter %&gt;%\n  dplyr::select(year_quarter)\n\n# create ppp\nbiz_9601_quarter_ppp &lt;- as.ppp(kde_biz_9601_quarter)\n  \n\n# include owin object\nbiz_9601_quarter_owin &lt;- biz_9601_quarter_ppp[sg_owin]\n\n# Extract laundry data with quarter column\nkde_biz_9601_quarter &lt;- biz_9601_quarter %&gt;%\n  dplyr::select(year_quarter)\n\n# Create ppp object\nbiz_9601_quarter_ppp &lt;- as.ppp(kde_biz_9601_quarter)\n\n# Check marks are present\ntable(marks(biz_9601_quarter_ppp))  \n\n\n2024-Q1 2024-Q2 2024-Q3 2024-Q4 2025-Q1 2025-Q2 \n     26      23      31      16      31      23 \n\n# Subset to window \nbiz_9601_quarter_owin &lt;- biz_9601_quarter_ppp[sg_owin]\n\n# Verify marks are still there \ntable(marks(biz_9601_quarter_owin))  \n\n\n2024-Q1 2024-Q2 2024-Q3 2024-Q4 2025-Q1 2025-Q2 \n     26      23      31      16      31      23 \n\n\n\npar(bg = \"#EEEEEE\")\nplot(biz_9601_quarter_owin)\n\n\n\n\n\n\n\n\n\nCompute STKDE\n\n# If marks are present, convert to numeric\nmarks(biz_9601_quarter_owin) &lt;- case_when(\n  marks(biz_9601_quarter_owin) == \"2024-Q1\" ~ 1,\n  marks(biz_9601_quarter_owin) == \"2024-Q2\" ~ 2,\n  marks(biz_9601_quarter_owin) == \"2024-Q3\" ~ 3,\n  marks(biz_9601_quarter_owin) == \"2024-Q4\" ~ 4,\n  marks(biz_9601_quarter_owin) == \"2025-Q1\" ~ 5,\n  marks(biz_9601_quarter_owin) == \"2025-Q2\" ~ 6\n)\n\n# Verify conversion worked\nsummary(marks(biz_9601_quarter_owin))\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   1.00    2.00    3.00    3.48    5.00    6.00 \n\n# Run spatiotemporal density\nst_kde_9601 &lt;- spattemp.density(biz_9601_quarter_owin)\nsummary(st_kde_9601)\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 2692.247 (spatial)\n  lambda = 0.0882 (temporal)\n\nNo. of observations\n  150 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [2667.538, 55941.94] x [21448.47, 50256.33]\n\nTemporal bound\n  [1, 6]\n\nEvaluation\n  128 x 128 x 6 trivariate lattice\n  Density range: [2.767051e-23, 1.279652e-08]\n\n\n\n\nPlot STKDE object\n\ntims &lt;- c(1,2,3,4,5,6)\npar(mfrow = c(2,3), bg = \"#EEEEEE\")\nfor(i in tims){\n  plot(st_kde_9601, i,\n       override.par = FALSE,\n       fix.range = TRUE, main = paste(\"Laundry Services KDE at Quarter\", i\n     ), col = terrain.colors(256))\n}\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\n\nThe KDE results reveal dynamic spatial-temporal patterns in new laundry service establishments across six quarters, showing both consistency and strategic shifts in location preferences.\nCentral Region Stability: Throughout most quarters, the central region maintains consistent high-density concentrations. This indicates this area’s sustained viability as a core service hub. This persistence suggests stable demand patterns and favorable business conditions in Singapore’s commercial center.\nTemporal Variations: 2024-Q1 shows pronounced northern clustering alongside central concentration, indicating initial market exploration in residential areas. 2024-Q2 ~2025-Q2 demonstrates market rationalisation with reduced northern activity and strengthened central focus. It is notable that the eastern region has intermittent activity. This may suggest emerging opportunities in this residential areas\nBased on the spatial-temporal KDE results above, new laundry services do not have consistent density across the 6 quarters. There may be other factors that influence business decisions to expand the service. This also shows that the density consistently concentrate in central region most of the time, except the first quarter in 2024 there was a pronounced growth in the north and east region.\n\n\n\n\n\n\n\n# extract laundry data by quarter\nkde_biz_9602_quarter &lt;- biz_9602_quarter %&gt;%\n  dplyr::select(year_quarter)\n\n# create ppp\nbiz_9602_quarter_ppp &lt;- as.ppp(kde_biz_9602_quarter)\n  \n\n# include owin object\nbiz_9602_quarter_owin &lt;- biz_9602_quarter_ppp[sg_owin]\n\n\npar(bg = \"#EEEEEE\")\nplot(biz_9602_quarter_owin)\n\n\n\n\n\n\n\n\n\nCompute STKDE\n\n#convert year_quarter to numeric\nmarks(biz_9602_quarter_owin) &lt;- case_when(\n  marks(biz_9602_quarter_owin) == \"2024-Q1\" ~ 1,\n  marks(biz_9602_quarter_owin) == \"2024-Q2\" ~ 2,\n  marks(biz_9602_quarter_owin) == \"2024-Q3\" ~ 3,\n  marks(biz_9602_quarter_owin) == \"2024-Q4\" ~ 4,\n  marks(biz_9602_quarter_owin) == \"2025-Q1\" ~ 5,\n  marks(biz_9602_quarter_owin) == \"2025-Q2\" ~ 6\n)\n\nst_kde_9602 &lt;- spattemp.density(biz_9602_quarter_owin)\nsummary(st_kde_9602)\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 1364.177 (spatial)\n  lambda = 0.0161 (temporal)\n\nNo. of observations\n  1762 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [2667.538, 55941.94] x [21448.47, 50256.33]\n\nTemporal bound\n  [1, 6]\n\nEvaluation\n  128 x 128 x 6 trivariate lattice\n  Density range: [1.627173e-39, 1.255234e-07]\n\n\n\n\nPlot STKDE object\n\ntims &lt;- c(1,2,3,4,5,6)\npar(mfrow = c(2,3), bg = \"#EEEEEE\")\nfor(i in tims){\n  plot(st_kde_9602, i,\n       override.par = FALSE,\n       fix.range = TRUE, main = paste(\"Beauty Services KDE at Quarter\", i\n     ), col = terrain.colors(256))\n}\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\nThe KDE analysis reveals dynamic expansion patterns in beauty service establishments with notable temporal variations across six quarters.\nCentral Region Dominance: Beauty services maintain consistently high density concentrations in the central region throughout all quarters. This persistent central clustering reflects the strategic importance of commercial districts and shopping areas for beauty businesses.\nTemporal Growth Patterns: 2024-Q1 shows strong initial central concentration. 2024-Q2&Q3 demonstrates market consolidation with maintained central focus. The most significant development is the progressive density increase in eastern and northeastern residential areas from 2025-Q1 through 2025-Q2. This expansion suggests market maturation enabling viable residential location strategies, increased demand in these areas, and business model evolution toward neighborhood-based services.\n\n\n\n\n\n\n# extract laundry data by quarter\nkde_biz_86204_quarter &lt;- biz_86204_quarter %&gt;%\n  dplyr::select(year_quarter)\n\n# create ppp\nbiz_86204_quarter_ppp &lt;- as.ppp(kde_biz_86204_quarter)\n  \n\n# include owin object\nbiz_86204_quarter_owin &lt;- biz_86204_quarter_ppp[sg_owin]\n\n\npar(bg = \"#EEEEEE\")\nplot(biz_86204_quarter_owin)\n\n\n\n\n\n\n\n\n\nCompute STKDE\n\n#convert year_quarter to numeric\nmarks(biz_86204_quarter_owin) &lt;- case_when(\n  marks(biz_86204_quarter_owin) == \"2024-Q1\" ~ 1,\n  marks(biz_86204_quarter_owin) == \"2024-Q2\" ~ 2,\n  marks(biz_86204_quarter_owin) == \"2024-Q3\" ~ 3,\n  marks(biz_86204_quarter_owin) == \"2024-Q4\" ~ 4,\n  marks(biz_86204_quarter_owin) == \"2025-Q1\" ~ 5,\n  marks(biz_86204_quarter_owin) == \"2025-Q2\" ~ 6\n)\n\nst_kde_86204 &lt;- spattemp.density(biz_86204_quarter_owin)\nsummary(st_kde_86204)\n\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 2190.678 (spatial)\n  lambda = 0.1279 (temporal)\n\nNo. of observations\n  81 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [2667.538, 55941.94] x [21448.47, 50256.33]\n\nTemporal bound\n  [1, 6]\n\nEvaluation\n  128 x 128 x 6 trivariate lattice\n  Density range: [9.274425e-36, 1.45099e-08]\n\n\n\n\nPlot STKDE object\n\ntims &lt;- c(1,2,3,4,5,6)\npar(mfrow = c(2,3), bg = \"#EEEEEE\")\nfor(i in tims){\n  plot(st_kde_86204, i,\n       override.par = FALSE,\n       fix.range = TRUE, main = paste(\"Dental Services KDE at Quarter\", i),\n       col = terrain.colors(256))\n}\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\nThe dental services KDE reveals a highly concentrated spatial strategy that differs markedly from both laundry and beauty services in its focus and temporal stability.\nCentral Region Concentration: New dental services demonstrate central clustering during 2024-Q1, 2024-Q3 though 2025-Q2. This concentration reflects the specialised nature of dental healthcare services and their dependence on medical districts, accessibility, and infrastructure. Western Region (Holland area) shows sporadic activity only in Q1, with limited subsequent expansion frp, 2024-Q4, suggesting either market testing or saturation.\nLimited Spatial Distribution: Unlike beauty services’ multi-hub strategy, dental services show highly focused clustering patterns with minimal spatial expansion in peripheral areas. This concentration is influenced by 1/ lower establishment numbers compared to other service types and 2/ higher capital requirements for dental practice setup.\nService Distribution Pattern: The concentrated pattern indicates that dental services operate fundamentally differently from daily-use services, requiring strategic central locations to serve customers from across Singapore rather than neighborhood-based provision."
  },
  {
    "objectID": "geospatial/proj_1/test.html#second-order-analysis",
    "href": "geospatial/proj_1/test.html#second-order-analysis",
    "title": "Spatial Analysis of Essential Services in Singapore - Laundry, Beauty & Dental Business",
    "section": "4 Second-order Analysis",
    "text": "4 Second-order Analysis\nWith the second-order analysis, we will examine the spatial relationships between points in a pattern.\n\n4.1 Spatial analysis\nIn this section, we will compute spatial point patterns using randomness tests.\n\nLaundry ServicesBeauty ServicesDental Services - G-function\n\n\nFor laundry services, we will use F-function to analyse spatial point process as this function is best for random locations to nearest business. Laundry services may be important to residents, be it dry cleaning or self-operated. We want to observe its distribution whether the placement is random or follows specific spatial strategy.\n\nset.seed(1222)\n\n\nF-function estimation\n\npar(bg = \"#EEEEEE\")\nF_9601 = Fest(biz_9601_ppp)\nwrite_rds(F_9601, \"data/rds/F_9601.rds\")\n\n\npar(bg = \"#EEEEEE\")\nF_9601 &lt;- read_rds(\"data/rds/F_9601.rds\")\nplot(F_9601)\n\n\n\n\n\n\n\n\n\n\nComplete spatial randomness test\nWe use the hypothesis test below to confirm the spatial patterns above.\nH₀ = The distribution of laundry services are randomly distributed.\nH₁ = The distribution of laundry services are not randomly distributed. The null hypothesis will be rejected is p-value is smaller than alpha value of 0.05.\n\nF_9601.csr &lt;- envelope(biz_9601_ppp, Fest, correction = \"all\", nsim = 99)\nwrite_rds(F_9601.csr, \"data/rds/F_9601.csr\")\n\n\n\nPlot simulation\n\npar(bg = \"#EEEEEE\")\nF_9601.csr &lt;- read_rds(\"data/rds/F_9601.csr\")\nplot(F_9601.csr)\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\nThe plot shows the observed line falls below the theoretical line and at or near the lower boundary of the envelope at the shorter distance, indicating clustering that is statistically significant. The clustering effect is strongest at distances of 500-2000. This indicates that the laundry businesses tend to cluster together with empty areas between.\n\n\n\n\n\nFor beauty services such as hair salons, manicure and pedicure, personal care services, we will use K-function to analyze clustering patterns by examining the expected number of neighboring businesses within given distances. The intention is to identify and quantify clustering at multiple spatial scales.\n\nL-function estimate\n\nL_9602 = Lest(biz_9602_ppp, correction = \"Ripley\")\n\n\nwrite_rds(L_9602, \"data/rds/L_9602.rds\")\n\n\npar(bg = \"#EEEEEE\")\nL_9602 &lt;- read_rds(\"data/rds/L_9602.rds\")\nplot(L_9602, . -r ~ r, ylab = \"L(d)-r\", xlab = \"d(m)\")\n\n\n\n\n\n\n\n\n\n\nSpatial randomness test\nThe hypothesis and test are as follows:\nH₀ = The distribution of Beauty services are randomly distributed.\nH₁ = The distribution of Beauty services are not randomly distributed.\nThe null hypothesis will be rejected if p-value is smaller than alpha value of 0.05.\n\nL_9602.csr &lt;- envelope(biz_9602_ppp, Lest, nsim = 99, rank = 1)\nwrite_rds(L_9602.csr, \"data/rds/L_9602.csr\")\n\n\n\nPlot L-function test\n\npar(bg = \"#EEEEEE\")\nL_9602.csr &lt;- read_rds(\"data/rds/L_9602.csr\")\nplot(L_9602.csr, . - r ~ r, xlab = \"d\", ylab = \"L(d)-r\")\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\n\nBeauty services show the strongest clustering pattern of all 3 business types. The very thin gray envelope means there’s very little uncertainty about randomness. They likely cluster in beauty districts, shopping malls, or commercial strips.\nThe clustering is so strong it suggests very specific location requirements, which could be high foot traffic areas, fashion/shopping districts, or areas with complementary businesses (like clothing, restaurants), or is easy to access with parking, public transport, near large residences.\nThe clustering likely creates agglomeration economies with shared customers, referrals, comparison shopping.\n\n\n\n\n\n\nFor dental services, we will use G-function to analyse the nearest neighbor distance distribution.\n\nG-function estimate\n\nG_86204 = Lest(biz_86204_ppp, correction = \"border\")\nwrite_rds(G_86204, \"data/rds/G_86204.rds\")\n\n\npar(bg = \"#EEEEEE\")\nG_86204 &lt;- read_rds(\"data/rds/G_86204.rds\")\nplot(G_86204, xlim = c(0, 500))\n\n\n\n\n\n\n\n\n\n\nSpatial randomness test\nThe hypothesis and test are as follows:\nH₀ = The distribution of Beauty services are randomly distributed.\nH₁ = The distribution of Beauty services are not randomly distributed.\nThe null hypothesis will be rejected if p-value is smaller than alpha value of 0.05.\n\nG_86204.csr &lt;- envelope(biz_86204_ppp, Gest, nsim = 99)\nwrite_rds(G_86204.csr, \"data/rds/G_86204.csr\")\n\n\n\nPlot G-function test\n\npar(bg = \"#EEEEEE\")\nG_86204.csr &lt;- read_rds(\"data/rds/G_86204.csr\")\nplot(G_86204.csr)\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\nThe observed line is completely above the envelope, and shows a very strong clustering pattern with highly statistically significant. With our obervation earlier on the density of dental businesses in the maps, the pattern suggests dental services form tight professional clusters rather than being distributed based on residential density alone. The results also suggests dental services cluster in professional districts where they benefit from shared facilities & infrastructure, referral network, patient convenience, and zones that concentrates medical services.\n\n\n\n\n\n\n\n\n4.2 Spatio-Temporal analysis\n\nLaundry ServicesBeauty ServicesDental Services\n\n\n\nPerform F-function estimation\n\nbiz_9601_quarter_split &lt;- split(biz_9601_quarter_owin, f = as.factor(marks(biz_9601_quarter_owin)))\n\nF_9601_quarter &lt;- lapply(biz_9601_quarter_split, Fest)\n\npar(mfrow = c(3,2), bg = \"#EEEEEE\")\nbiz_9601_quarter_names &lt;- c(\"2024-Q1\", \"2024-Q2\", \"2024-Q3\", \"2024-Q4\", \"2025-Q1\", \"2025-Q2\")\n\nfor (i in 1:6) {\n  plot(F_9601_quarter[[i]],\n       main = paste(\"Laundry Services F-function -\", biz_9601_quarter_names[i]))\n}\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\nDuring the 6 quarters of observation, most of the time the F_km line is consistenly below F_pois line, except 2024-Q2 and 2024-Q4. This means new laundry services tend to cluster when they open.\nFor 2024-Q2, F_km appears to cross above and below F_pois at different distances, rather than being consistently above. 2024-Q4 had new entrants that may have pursued different strategies, potentially targeting underserved areas, new development launch, etc.\n\n\n\n\nPerform spatial randomness test for each quarter\nHypothesis test: H₀ = The distribution of laundry services is randomly distributed.\nH₁= The distribution of laundry services is not randomly distributed.\nAlpha value = 0.05.\n\nF_9601_quarter.csr &lt;- lapply(biz_9601_quarter_split, function(x) envelope(x, Fest, nsim = 99))\nwrite_rds(F_9601_quarter.csr, \"data/rds/F_9601_quarter.csr\")\n\n\n\nPlot result of test\n\npar(mfrow = c(3, 2), bg = \"#EEEEEE\")\nF_9601_quarter.csr &lt;- read_rds(\"data/rds/F_9601_quarter.csr\")\nbiz_9601_quarter_labels &lt;- c(paste0(\"2024-Q\", 1:4), paste0(\"2025-Q\", 1:2))\n\nfor (i in 1:6) {\n  plot(F_9601_quarter.csr[[i]], main = paste(\"Laundry F-function:\", biz_9601_quarter_labels[i]))\n}\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\n\nBased on the test result, we found no statistically significant deviation from randomness in any quarter. Therefore, earlier on we observed that F_km below F_pois for 2024-Q4 is not strong enough to be statistically significant. This means weak clustering tendencies, meaning that new laundry services show mild clustering preferences but not strong ones. In addition, the spatial choices are more opportunistic than strategically clustered.\nFor business, we observed that in the short term laundry services seem to have less rigid location strategies compared to other service types.\n\n\n\n\n\n\n\nPerform L-function estimation by quarter\n\nbiz_9602_quarter_split &lt;- split(biz_9602_quarter_owin, f = as.factor(marks(biz_9602_quarter_owin)))\n\nL_9602_quarter &lt;- lapply(biz_9602_quarter_split, Lest)\n\npar(mfcol = c(3,2), bg = \"#EEEEEE\")\nbiz_9602_quarter_names &lt;- c(\"2024-Q1\", \"2024-Q2\", \"2024-Q3\", \"2024-Q4\",\"2025-Q1\", \"2025-Q2\")\n\nfor (i in 1:6) {\n  plot(L_9602_quarter[[i]],\n       main = paste(\"Beauty Services L-function -\", biz_9602_quarter_names[i]))\n}\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\n\nIn the visualisation for L-function estimation, the consistent gap between observed and expected values indicates beauty services exhibit robust spatial clustering that persists across all 6 quarters. This clustering is stronger than what would be expected from Singapore’s underlying density patterns alone.\nThis temporal pattern suggests beauty services create commercial districts or beauty clusters that are economically beneficial for both businesses (shared customers, reduced marketing costs) and consumers (convenience, comparison shopping).\nIt also indicates this clustering strategy is economically stable and likely to continue (6 plots appear to be quite similar), which makes it valuable information for urban planning and business location decisions.\n\n\n\n\n\nPerform spatial randomness test for each quarter\nHypothesis test:\nH₀ = The distribution of laundry services is randomly distributed.\nH₁= The distribution of laundry services is not randomly distributed.\nAlpha value = 0.05.\n\nL_9602_quarter.csr &lt;- lapply(biz_9602_quarter_split, function(x) envelope(x, Lest, nsim = 99))\nwrite_rds(L_9602_quarter.csr, \"data/rds/L_9602_quarter.csr\")\n\n\n\nPlot result of test\n\npar(mfrow = c(3, 2), bg = \"#EEEEEE\")\nL_9602_quarter.csr &lt;- read_rds(\"data/rds/L_9602_quarter.csr\")\nbiz_9602_quarter_labels &lt;- c(paste0(\"2024-Q\", 1:4), paste0(\"2025-Q\", 1:2))\n\nfor (i in 1:6) {\n  plot(L_9602_quarter.csr[[i]], main = paste(\"Beauty L-function:\", biz_9602_quarter_labels[i]))\n}\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\n\nThe observed L-function being well above the envelope across all six quarters indicates beauty services have very strong clustering that significantly exceeds random expectation. The combination of strong effect size, narrow confidence intervals, and temporal consistency makes this statistically robust clustering patterns and economically meaningful.\nThe remarkable similarity across all 6 quarters suggests beauty service clustering is a stable market characteristic rather than a temporary or seasonal phenomenon. This indicates that established location strategies that persist over time, mature market dynamics where clustering benefits are well-understood, and possibily consistent consumer preferences for beauty service districts.\nSince the pattern holds across the entire distance range (0-6000r) in all 6 quarters, beauty services cluster at multiple spatial scales simultaneously, such as local clustering (shopping centers, beauty districts), regional clustering (concentration in central Singapore).\nThe consistency also suggests beauty services have developed optimal location strategies that create sustainable competitive advantages through agglomeration, consumer convenience through service concentration, as well as market patterns that new businesses can reliably follow.\n\n\n\n\n\n\n\nPerform G-function estimation by quarter\n\nbiz_86204_quarter_split &lt;- split(biz_86204_quarter_owin, f = as.factor(marks(biz_86204_quarter_owin)))\n\nG_86204_quarter &lt;- lapply(biz_86204_quarter_split, Gest)\n\npar(mfrow = c(3,2), bg = \"#EEEEEE\")\nbiz_86204_quarter_names &lt;- c(\"2024-Q1\", \"2024-Q2\", \"2024-Q3\", \"2024-Q4\", \"2025-Q1\", \"2025-Q2\", \"2025-Q3\", \"2025-Q4\")\n\nfor (i in 1:6) {\n  plot(G_86204_quarter[[i]], xlim = c(0, 3000),\n       main = paste(\"Dental Services G-function -\", biz_86204_quarter_names[i]))\n}\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\n\nQuarters with many steps include 2024-Q1, 2024-Q3, 2-24-Q4, and 2025-Q1: These quarters indicate that dental clinics established at multiple distance scales. Some are very close neighbors (medical complexes) and some medium-distance neighbors (same district).\nQuarters with fewer steps like 2024-Q2 and 2025-Q2: The 2 quarters have more uniform spacing between establishments, showing simpler spatial arrangements. They are either very tight clustering or more dispersed patterns (see 3.2.1).\n\n\n\n\n\nPerform spatial randomness test for each quarter\nHypothesis test: H₀ = The distribution of laundry services is randomly distributed. H₁= The distribution of laundry services is not randomly distributed.\nAlpha value = 0.05.\n\nG_86204_quarter.csr &lt;- lapply(biz_86204_quarter_split, function(x) envelope(x, Gest, nsim = 99))\nwrite_rds(G_86204_quarter.csr, \"data/rds/G_86204_quarter.csr\")\n\n\n\nPlot result of test\n\npar(mfrow = c(3, 2), bg = \"#EEEEEE\")\nG_86204_quarter.csr &lt;- read_rds(\"data/rds/G_86204_quarter.csr\")\nbiz_86204_quarter_labels &lt;- c(paste0(\"2024-Q\", 1:4), paste0(\"2025-Q\", 1:2))\n\nfor (i in 1:6) {\n  plot(G_86204_quarter.csr[[i]], xlim = c(0,3000), main = paste(\"Dental G-function:\", biz_86204_quarter_labels[i]))\n}\n\n\n\n\n\n\n\n\n\n\nAnalysis\n\n\n\nStrong clustering quarters like 2024-Q1, 2024-Q3, 2024-Q4, 2025-Q2: have multiple distance ranges showing significant clustering and suggests these are periods of active medical district development.\nWeak clustering quarters 2024-Q2 & 2025-Q1: Their observed patterns are mostly within envelope, meaning it’s more random spatial distribution of new establishments. In these 2 quarters, the market conditions may have favored dispersed rather than clustered locations.\nOverall dental clustering patterns could be dynamic and context-dependent rather than consistently uniform. Some periods favor medical complex development with tight clustering and other periods see district expansion with medium-distance clustering. Market conditions can influence whether new practices cluster tightly or spread out."
  },
  {
    "objectID": "geospatial/proj_1/test.html#conclusion",
    "href": "geospatial/proj_1/test.html#conclusion",
    "title": "Spatial Analysis of Essential Services in Singapore - Laundry, Beauty & Dental Business",
    "section": "5 Conclusion",
    "text": "5 Conclusion\nOur study reveals each business type exhibits distinct clustering behaviors driven by different operational needs. The beauty services show multi-scale agglomeration - heavy concentration in central region and forming clusters in suburban residential areas. Dental services exhibit tight professional clustering in central region, and laundry services have accessibility-focused patterns.\n\n5.1 Key findings\n\nLaundry service accessibility - The F-function analysis revealed that despite clustering tendencies, laundry services maintain adequate accessibility across Singapore, suggesting successful market coverage that balances agglomeration benefits with customer convenience needs.The industry also grows consistently with clusters concentrated on mostly central region except 2024-Q1 when it also clusters in the north and the east region.\nBeauty service stable growth - Beauty services grow very consistently throughout the 18 months since 2024 January. The highest density consistenly focuses on the central region while it also forms smaller clusters in suburban areas. The KDE output shows several very condensed cuslters in the central region. Along with its consistent growth in similar areas, we observed that the new beauty salons tend to open close to each other.\nDental service clustering variations - Our analysis for dental services shows temporal variable clustering patterns (strong in 2024-Q1, 2024-Q3, 2025-Q2 but random in 2024-Q2, 2025-Q1), so clustering isn’t constant but responds to market conditions or seasonal establishment patterns. This reveals that clustering behavior varies significantly over time, so suggests responsiveness to market conditions rather than static location patterns. Overall dental businesses also grow consistenly because new businesses emerge every quarter. However, regionally each quarter the growth is consistent only in central region. New dental businesses appear in different regions each quarter.\nOverall we see that the 3 business types all have much higher density in central region and have varying establishment densities across other regions. Laundry services and beauty services that residents need to patron periodically have higher density in more populated areas. Although dental services exhibit similar patterns, the new establishments in suburban areas are very few and only appear in areas with more condensed population.\nSupport urban land use planning and management\n\nTransit planning: Central region service concentration justifies continued public transit investment and transit-oriented development strategies.\nWestern region gaps: Consistently lower establishment density in western Singapore indicates infrastructure or regulatory barriers requiring investigation.\nProfessional districts: Dental services’ tight clustering validates targeted development of medical/professional zones with shared facilities/buildings.\n\n\n\n\n5.2 Limitation\n\nThe datasets used for this study are based on new business registration date, rather than their current practice status. Therefore, this study is not able to see a full picture of the current density and spatial spread to identify where are the real hot zones and observe their rise and fall.\nWe also observed that large dataset requires heavy computation capability, and often the simulation and rendering take much longer time than expected. Therefore, in this study, the numbre of simulation is kept minimum.\n\n\n\n5.3 Future works\nThere are many business categories to study wider range of the businesses spatial growth. In addition, for each business, we can deep dive into their status and location to investigate these industries’ growth and decline."
  },
  {
    "objectID": "geospatial/proj_1/test.html#references",
    "href": "geospatial/proj_1/test.html#references",
    "title": "Spatial Analysis of Essential Services in Singapore - Laundry, Beauty & Dental Business",
    "section": "6 References",
    "text": "6 References\n\nAccounting and Corporate Regulatory Authority. (2025). ACRA information on corporate entities [Data set]. Data.gov.sg. https://data.gov.sg/datasets?query=ACRA+information&page=1&resultId=2\nKam, T. S. (2022, December 8). R for geospatial data science and analytics. https://r4gdsa.netlify.app/\nPaez, A. (2021). Point pattern analysis IV. In An introduction to spatial data analysis and statistics: A course in R. https://paezha.github.io/spatial-analysis-r/point-pattern-analysis-iv.html#f-function\nSingapore Department of Statistics. (2020). Singapore standard industrial classification (SSIC) 2020. https://classification.codes/classifications/industry/ssic-singapore\nUrban Redevelopment Authority. (2024, June 6). Master Plan 2019 planning area boundary (no sea) [Data set]. Data.gov.sg. https://data.gov.sg/datasets?query=master+plan&page=1&resultId=d_4765db0e87b9c86336792efe8a1f7a66"
  }
]